!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=105)}([function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteNullValue=t.toDate=t.getFunctionArguments=t.ExpressionParser=t.allSettled=t.inOrderPromise=t.debouncePromise=t.compareObject=t.throttle=t.convertImageSourceToBase64=t.isWMSReverse=t.getProjectionSrs=t.inputCss=t.getBaseUrl=t.toJSON=t.getVideoType=t.isObject=t.notNULL=t.cloneObject=t.returnPoint=t.formatPoints=t.newGuid=t.extendDeep=t.isBoolean=t.deepClone=t.isString=t.Log=t.getOutStatisticsParameter=t.getGeometryParameter=t.isNull=t.createGeometry=t.normalize=t.defined=t.defaultValue=t.getGUID=t.bind=t.getParameterString=t.urlAppend=t.transformResult=t.isInTheSameDomain=t.isNumber=t.isArray=t.extend=void 0;var n=r(19),i=r(393),o=r(394),a=r(97),s=function(e){return e&&e.__esModule?e:{default:e}}(r(96)),l=r(395),u=r(406);t.extend=n.extend,t.isArray=n.isArray,t.isNumber=n.isNumber,t.isInTheSameDomain=n.isInTheSameDomain,t.transformResult=n.transformResult,t.urlAppend=n.urlAppend,t.getParameterString=n.getParameterString,t.bind=n.bind,t.getGUID=n.getGUID,t.defaultValue=n.defaultValue,t.defined=n.defined,t.normalize=i.normalize,t.createGeometry=o.createGeometry,t.isNull=n.isNull,t.getGeometryParameter=n.getGeometryParameter,t.getOutStatisticsParameter=n.getOutStatisticsParameter,t.Log=s.default,t.isString=n.isString,t.deepClone=n.deepClone,t.isBoolean=n.isBoolean,t.extendDeep=n.extendDeep,t.newGuid=n.newGuid,t.formatPoints=n.formatPoints,t.returnPoint=n.returnPoint,t.cloneObject=n.cloneObject,t.notNULL=n.notNULL,t.isObject=n.isObject,t.getVideoType=n.getVideoType,t.toJSON=n.toJSON,t.getBaseUrl=n.getBaseUrl,t.inputCss=n.inputCss,t.getProjectionSrs=n.getProjectionSrs,t.isWMSReverse=n.isWMSReverse,t.convertImageSourceToBase64=n.convertImageSourceToBase64,t.throttle=n.throttle,t.compareObject=n.compareObject,t.debouncePromise=a.debouncePromise,t.inOrderPromise=a.inOrderPromise,t.allSettled=a.allSettled,t.ExpressionParser=l.ExpressionParser,t.getFunctionArguments=n.getFunctionArguments,t.toDate=u.toDate,t.deleteNullValue=n.deleteNullValue},function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(264));t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(e,i.key,i)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},function(e,t,r){e.exports={default:r(281),__esModule:!0}},function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(53));t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,n.default)(t))&&"function"!=typeof t?e:t}},function(e,t,r){"use strict";t.__esModule=!0;var n=a(r(286)),i=a(r(165)),o=a(r(53));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,o.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(n.default?(0,n.default)(e,t):e.__proto__=t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NormalizationType=t.TemporalUnit=t.TDTLayerType=t.VisualVariableType=t.CustomWKID=t.SeverVectorTileSubLayerType=t.TileSliceType=t.ColorNameToHexMap=t.SceneSubLayerType=t.ArcType=t.AreaUnits=t.LinearUnits=t.MaterialType=t.WaveStrength=t.WaterbodySize=t.PatternStyle=t.ProfileType=t.AnchorType=t.LinePatternStyle=t.LineMarkerStyle=t.LineMarkerPlacement=t.LineJoinType=t.LineCapType=t.Symbol3DLayerType=t.WMTSCorporation=t.RadiusUnit=t.PictureFormat=t.UrlServerType=t.ShadowMode=t.SceneMode=t.VerticalAlignment=t.HorizontalAlignment=t.ElevationMode=t.IGSSymbolType=t.SymbolType=t.IGSRendererType=t.SketchEditorToolEventType=t.SketchEditorState=t.SketchEditorEventType=t.SketchEditMode=t.SketchDataType=t.VideoSourceType=t.VectorTileGeometryType=t.RendererType=t.AngleUnit=t.LengthUnit=t.ViewEventType=t.LoadStatus=t.LogType=t.IGSGeometryType=t.TokenAttachType=t.LayerType=t.GeometryType=t.SpatialRelation=t.StatisticType=t.MapEventType=t.LayerEventType=t.FetchMethod=t.ReturnFormat=void 0;var n=le(r(308)),i=le(r(309)),o=le(r(310)),a=le(r(311)),s=le(r(312)),l=le(r(313)),u=le(r(95)),c=le(r(314)),f=le(r(315)),h=le(r(316)),d=le(r(317)),p=le(r(318)),y=le(r(319)),g=le(r(320)),v=le(r(321)),m=le(r(322)),_=le(r(323)),S=le(r(324)),x=le(r(327)),b=le(r(328)),w=le(r(329)),k=le(r(330)),M=le(r(331)),E=le(r(332)),I=le(r(127)),T=le(r(333)),L=le(r(334)),P=le(r(128)),C=le(r(129)),N=le(r(335)),O=le(r(336)),R=le(r(337)),V=le(r(338)),G=le(r(339)),A=le(r(340)),F=le(r(341)),D=le(r(130)),j=le(r(131)),B=le(r(342)),q=le(r(343)),U=le(r(344)),J=le(r(345)),z=le(r(346)),W=le(r(169)),H=le(r(170)),X=le(r(171)),Y=le(r(347)),Z=le(r(348)),K=le(r(349)),Q=le(r(350)),$=le(r(351)),ee=le(r(168)),te=le(r(352)),re=le(r(353)),ne=le(r(132)),ie=le(r(55)),oe=le(r(354)),ae=le(r(355)),se=le(r(172));function le(e){return e&&e.__esModule?e:{default:e}}t.ReturnFormat=n.default,t.FetchMethod=i.default,t.LayerEventType=o.default,t.MapEventType=a.default,t.StatisticType=s.default,t.SpatialRelation=l.default,t.GeometryType=u.default,t.LayerType=c.default,t.TokenAttachType=f.default,t.IGSGeometryType=h.default,t.LogType=d.default,t.LoadStatus=p.default,t.ViewEventType=y.default,t.LengthUnit=g.default,t.AngleUnit=v.default,t.RendererType=m.default,t.VectorTileGeometryType=_.default,t.VideoSourceType=S.default,t.SketchDataType=x.default,t.SketchEditMode=b.default,t.SketchEditorEventType=w.default,t.SketchEditorState=k.default,t.SketchEditorToolEventType=M.default,t.IGSRendererType=E.default,t.SymbolType=I.default,t.IGSSymbolType=T.default,t.ElevationMode=L.default,t.HorizontalAlignment=P.default,t.VerticalAlignment=C.default,t.SceneMode=N.default,t.ShadowMode=O.default,t.UrlServerType=R.default,t.PictureFormat=V.default,t.RadiusUnit=G.default,t.WMTSCorporation=A.default,t.Symbol3DLayerType=F.default,t.LineCapType=D.default,t.LineJoinType=j.default,t.LineMarkerPlacement=B.default,t.LineMarkerStyle=q.default,t.LinePatternStyle=U.default,t.AnchorType=J.default,t.ProfileType=z.default,t.PatternStyle=W.default,t.WaterbodySize=H.default,t.WaveStrength=X.default,t.MaterialType=Y.default,t.LinearUnits=Z.default,t.AreaUnits=K.default,t.ArcType=Q.default,t.SceneSubLayerType=$.default,t.ColorNameToHexMap=ee.default,t.TileSliceType=te.default,t.SeverVectorTileSubLayerType=re.default,t.CustomWKID=ne.default,t.VisualVariableType=ie.default,t.TDTLayerType=oe.default,t.TemporalUnit=ae.default,t.NormalizationType=se.default},function(e,t,r){"use strict";t.__esModule=!0;var n=o(r(3)),i=o(r(283));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t,r,o){null===t&&(t=Function.prototype);var a=(0,i.default)(t,r);if(void 0===a){var s=(0,n.default)(t);return null===s?void 0:e(s,r,o)}if("value"in a)return a.value;var l=a.get;return void 0!==l?l.call(o):void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zondy=t.TimeInterval=t.TimeInfo=t.TimeExtent=t.NormalizationType=t.TemporalUnit=t.FeatureExpressionInfo=t.CustomWKID=t.SeverVectorTileSubLayerType=t.SpatialRelation=t.SceneSubLayerType=t.ArcType=t.AreaUnits=t.LinearUnits=t.LineMarkerStyle=t.LineMarkerPlacement=t.LineJoinType=t.LineCapType=t.Symbol3DLayerType=t.WMTSCorporation=t.FeatureRender=t.RadiusUnit=t.EPSG=t.Font=t.UrlServerType=t.CoordnateTransform=t.BaiduProject=t.Projection=t.ShadowMode=t.SceneMode=t.ElevationInfo=t.WMTSStyle=t.TileMatrixSet=t.SketchEditorToolEventType=t.SketchEditorState=t.SketchEditorEventType=t.SketchEditMode=t.SketchDataType=t.VideoSourceType=t.ViewEventType=t.ProjectInfoBySrsID=t.ProjectInfo=t.getFeaturesFromFeatureSet=t.FeatureSet=t.Feature=t.OutStatistic=t.ErrorEvent=t.LayerEvent=t.Color=t.Event=t.Evented=t.CollectionFlattener=t.Collection=void 0;var n=I(r(0)),i=r(46),o=I(r(80)),a=I(r(124)),s=I(r(304)),l=I(r(54)),u=I(r(125)),c=I(r(126)),f=I(r(305)),h=I(r(306)),d=I(r(307)),p=r(6),y=I(r(173)),g=I(r(356)),v=I(r(357)),m=I(r(81)),_=I(r(193)),S=I(r(192)),x=r(133),b=I(r(135)),w=I(r(174)),k=I(r(194)),M=I(r(392)),E=I(r(195));function I(e){return e&&e.__esModule?e:{default:e}}t.Collection=a.default,t.CollectionFlattener=s.default,t.Evented=o.default,t.Event=i.Event,t.Color=l.default,t.LayerEvent=i.LayerEvent,t.ErrorEvent=i.ErrorEvent,t.OutStatistic=f.default,t.Feature=x.Feature,t.FeatureSet=x.FeatureSet,t.getFeaturesFromFeatureSet=x.getFeaturesFromFeatureSet,t.ProjectInfo=h.default,t.ProjectInfoBySrsID=d.default,t.ViewEventType=p.ViewEventType,t.VideoSourceType=p.VideoSourceType,t.SketchDataType=p.SketchDataType,t.SketchEditMode=p.SketchEditMode,t.SketchEditorEventType=p.SketchEditorEventType,t.SketchEditorState=p.SketchEditorState,t.SketchEditorToolEventType=p.SketchEditorToolEventType,t.TileMatrixSet=y.default,t.WMTSStyle=g.default,t.ElevationInfo=v.default,t.SceneMode=p.SceneMode,t.ShadowMode=p.ShadowMode,t.Projection=m.default,t.BaiduProject=_.default,t.CoordnateTransform=S.default,t.UrlServerType=p.UrlServerType,t.Font=u.default,t.EPSG=c.default,t.RadiusUnit=p.RadiusUnit,t.FeatureRender=b.default,t.WMTSCorporation=p.WMTSCorporation,t.Symbol3DLayerType=p.Symbol3DLayerType,t.LineCapType=p.LineCapType,t.LineJoinType=p.LineJoinType,t.LineMarkerPlacement=p.LineMarkerPlacement,t.LineMarkerStyle=p.LineMarkerStyle,t.LinearUnits=p.LinearUnits,t.AreaUnits=p.AreaUnits,t.ArcType=p.ArcType,t.SceneSubLayerType=p.SceneSubLayerType,t.SpatialRelation=p.SpatialRelation,t.SeverVectorTileSubLayerType=p.SeverVectorTileSubLayerType,t.CustomWKID=p.CustomWKID,t.FeatureExpressionInfo=w.default,t.TemporalUnit=p.TemporalUnit,t.NormalizationType=p.NormalizationType,t.TimeExtent=k.default,t.TimeInfo=M.default,t.TimeInterval=E.default,t.zondy=function e(){(0,n.default)(this,e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.editGeometryByArc3=t.editFeatureByArc3=t.GeometryEngine=t.createGeometry=t.SpatialReference=t.MultiLineString=t.MultiPolygon=t.Circle=t.MultiPoint=t.Point=t.LineString=t.Polygon=t.Extent=t.Geometry=void 0;var n=y(r(29)),i=y(r(58)),o=y(r(83)),a=y(r(185)),s=y(r(37)),l=y(r(188)),u=y(r(189)),c=y(r(186)),f=y(r(191)),h=y(r(57)),d=r(36),p=y(r(66));function y(e){return e&&e.__esModule?e:{default:e}}t.Geometry=n.default,t.Extent=i.default,t.Polygon=o.default,t.LineString=a.default,t.Point=s.default,t.MultiPoint=l.default,t.Circle=u.default,t.MultiPolygon=c.default,t.MultiLineString=f.default,t.SpatialReference=h.default,t.createGeometry=d.createGeometry,t.GeometryEngine=p.default,t.editFeatureByArc3=d.editFeatureByArc3,t.editGeometryByArc3=d.editGeometryByArc3},function(e,t,r){e.exports={default:r(270),__esModule:!0}},function(e,t,r){e.exports={default:r(251),__esModule:!0}},function(e,t){var r=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=r)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(11)),i=y(r(14)),o=y(r(0)),a=y(r(2)),s=r(1),l=r(6),u=y(r(136)),c=y(r(137)),f=y(r(196)),h=r(99),d=y(r(67)),p=y(r(30));function y(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(t){(0,o.default)(this,e),t=(0,s.defaultValue)(t,{}),this._url=(0,s.defaultValue)(t.url,"");var r=d.default.getBaseUrlAndParams(this._url);this._baseUrl=p.default.matchString(r.baseUrl),this._queryParameters=r.params,this.enableGlobeFetch=(0,s.defaultValue)(t.enableGlobeFetch,!0),this.clientId=(0,s.defaultValue)(t.clientId,(0,s.getGUID)()),this._requestInterceptor=(0,s.defaultValue)(t.requestInterceptor,new u.default),this._responseInterceptor=(0,s.defaultValue)(t.responseInterceptor,new c.default),this._requestTimeout=(0,s.defaultValue)(t.requestTimeout,45e3),this._headers=(0,s.defaultValue)(t.headers,void 0),this._tokenKey=(0,s.defaultValue)(t.tokenKey,"token"),this._tokenValue=(0,s.defaultValue)(t.tokenValue,void 0),this._tokenAttachType=(0,s.defaultValue)(t.tokenAttachType,l.TokenAttachType.normal),this._fetchService=void 0,this.enableGlobeFetch?this._globeOptions={requestInterceptor:this._requestInterceptor,responseInterceptor:this._responseInterceptor,requestTimeout:this._requestTimeout,headers:this._headers,tokenKey:this._tokenKey,tokenValue:this._tokenValue,tokenAttachType:this._tokenAttachType,fetchService:this._fetchService}:this._privateOptions={requestInterceptor:this._requestInterceptor,responseInterceptor:this._responseInterceptor,requestTimeout:this._requestTimeout,headers:this._headers,tokenKey:this._tokenKey,tokenValue:this._tokenValue,tokenAttachType:this._tokenAttachType,fetchService:this._fetchService},this._initFetch()}return(0,a.default)(e,[{key:"queryServerInfo",value:function(e){return this._querySimpleInfo(e,function(e){return e.indexOf("/igs/rest/mrcs/docs/")>-1?e.replace("mrcs/docs","mrms/info")+"?f=json":e.indexOf("/igs/rest/mrms/docs/")>-1?e.replace("docs","info")+"?f=json":e.indexOf("/igs/rest/mrms/tile/")>-1?e.replace("tile","info")+"?f=json":e.indexOf("/igs/rest/g3d/")>-1?e+"/GetDocInfo":e+"?f=json"})}},{key:"_initFetch",value:function(){return this.enableGlobeFetch&&!zondy.service._fetchService?this._globeOptions?zondy.service._fetchService=new f.default("",this._globeOptions):zondy.service._fetchService=new f.default("",{}):this.enableGlobeFetch||this._fetchService||(this._privateOptions?this._fetchService=new f.default("",this._privateOptions):this._fetchService=new f.default("",{})),this.enableGlobeFetch?zondy.service._fetchService:this._fetchService}},{key:"_getFetch",value:function(){var e=this.enableGlobeFetch?zondy.service._fetchService:this._fetchService;return e||(e=this._initFetch()),e}},{key:"_getRequest",value:function(e,t){s.Log.info("请求链接:",e),s.Log.info("请求参数:",t);var r=(0,s.defaultValue)(t.success,void 0),n=(0,s.defaultValue)(t.failure,void 0);return this._getFetch().request({url:e,extensionOptions:t,method:"GET",success:function(e){e&&r&&r(e)},failure:function(e){n&&n(e)}})}},{key:"_postRequest",value:function(e,t){return this._sendBodyRequest("POST",e,t)}},{key:"_deleteRequest",value:function(e,t){return this._sendBodyRequest("DELETE",e,t)}},{key:"_putRequest",value:function(e,t){return this._sendBodyRequest("PUT",e,t)}},{key:"_patchRequest",value:function(e,t){return this._sendBodyRequest("PATCH",e,t)}},{key:"_sendBodyRequest",value:function(e,t,r){var n=(0,s.defaultValue)(r.success,void 0),i=(0,s.defaultValue)(r.failure,void 0),o=(0,s.defaultValue)(r.data,{}),a=(0,s.defaultValue)(r.headers,void 0),u=(0,s.defaultValue)(r.responseType,void 0),c=(0,s.defaultValue)(r.tokenAttachType,l.TokenAttachType.normal);return this._getFetch().request({url:t,method:e,data:o,headers:a,responseType:u,tokenAttachType:c,success:function(e){e&&n&&n(e)},failure:function(e){i&&i(e)}})}},{key:"_setFetchValue",value:function(e,t){this.enableGlobeFetch&&zondy.service._fetchService?zondy.service._fetchService[e]=t:this.enableGlobeFetch||(zondy.service._fetchService[e]=t)}},{key:"_checkAndRequest",value:function(e,t,r){if(r=(0,s.defaultValue)(r,{}),!e.isChecked)return this.requestInterceptor&&this.requestInterceptor.failure&&this.requestInterceptor.failure instanceof Function&&this.requestInterceptor.failure({succeed:!1,msg:e.errorMessage,errorType:e.errorType,data:void 0}),r.failure&&r.failure instanceof Function&&r.failure({succeed:!1,msg:e.errorMessage,errorType:e.errorType,data:void 0}),i.default.reject({succeed:!1,msg:e.errorMessage,data:void 0,errorType:e.errorType});var n=(0,s.defaultValue)(r.method,l.FetchMethod.get),o=(0,s.cloneObject)(this._queryParameters);defined(this.tokenKey)&&defined(this.tokenValue)&&delete o[this.tokenKey];var a=d.default.getStringFromObject(o);switch(e.queryString&&a&&(a="&"+a),n){case l.FetchMethod.post:var u=(0,s.deepClone)(r);return u.data=e.queryString+a,this._postRequest(t,u);case l.FetchMethod.delete:var c=(0,s.deepClone)(r);return c.data=e.queryString+a,this._deleteRequest(t,c);case l.FetchMethod.put:var f=(0,s.deepClone)(r);return f.data=e.queryString+a,this._putRequest(t,f);case l.FetchMethod.get:default:var h=t;return e.queryString+a&&(h=d.default.completeUrlEndMark(h),h+=e.queryString+a),this._getRequest(h,r)}}},{key:"_checkPathParameters",value:function(e,t){t=(0,s.defaultValue)(t,{layerId:{type:"String"}});var r=(0,h.checkPathParameters)(t,e);return r.isChecked?{succeed:!0}:(this.requestInterceptor&&this.requestInterceptor.failure&&this.requestInterceptor.failure instanceof Function&&this.requestInterceptor.failure({succeed:!1,msg:r.errorMessage,errorType:r.errorType,data:void 0}),{succeed:!1,msg:r.errorMessage,errorType:r.errorType})}},{key:"_querySimpleInfo",value:function(e,t){if(e=(0,s.defaultValue)(e,{}),t&&t instanceof Function){var r=t(this._baseUrl);return e.method=l.FetchMethod.get,s.Log.info("发起请求，基地址为：",r),this._checkAndRequest({isChecked:!0,errorMessage:"",errorType:"",queryString:""},r,e)}return!1}},{key:"_queryInfoByLayerId",value:function(e,t){e=(0,s.defaultValue)(e,{});var r=this._checkPathParameters(e);if(!r.succeed)return e.failure&&e.failure instanceof Function&&e.failure({succeed:!1,msg:r.msg,data:void 0}),i.default.reject({succeed:!1,msg:r.msg,data:void 0});if(t&&t instanceof Function){var n=t(this._baseUrl,e);return e.method=l.FetchMethod.get,s.Log.info("发起请求，基地址为：",n),this._checkAndRequest({isChecked:!0,errorMessage:"",errorType:"",queryString:""},n,e)}}},{key:"_queryByParameters",value:function(e,t,r,n){e=(0,s.defaultValue)(e,{});var o=this._checkPathParameters(e,t);if(!o.succeed)return e.failure&&e.failure instanceof Function&&e.failure({succeed:!1,msg:o.msg,data:void 0,errorType:o.errorType}),i.default.reject({succeed:!1,msg:o.msg,data:void 0,errorType:o.errorType});if(n&&n instanceof Function){var a=n(this._baseUrl,e);return s.Log.info("发起请求，基地址为：",a),this._checkAndRequest((0,h.checkParam)(e,r),a,e)}}}]),e}();(0,n.default)(g.prototype,{requestInterceptor:{configurable:!1,get:function(){return this._requestInterceptor},set:function(e){this._setFetchValue("requestInterceptor",e),this._requestInterceptor=e}},responseInterceptor:{configurable:!1,get:function(){return this._responseInterceptor},set:function(e){this._setFetchValue("responseInterceptor",e),this._responseInterceptor=e}},requestTimeout:{configurable:!1,get:function(){return this._requestTimeout},set:function(e){this._setFetchValue("requestTimeout",e),this._requestTimeout=e}},headers:{configurable:!1,get:function(){return this._headers},set:function(e){this._setFetchValue("headers",e),this._headers=e}},tokenKey:{configurable:!1,get:function(){return this._tokenKey},set:function(e){this._setFetchValue("tokenKey",e),this._tokenKey=e}},tokenValue:{configurable:!1,get:function(){return this._tokenValue},set:function(e){this._setFetchValue("tokenValue",e),this._tokenValue=e}},tokenAttachType:{configurable:!1,get:function(){return this._tokenAttachType},set:function(e){this._setFetchValue("tokenAttachType",e),this._tokenAttachType=e}}}),(0,n.default)(g.prototype,{url:{get:function(){return this._url},set:function(e){this._url=e}}}),t.default=g},function(e,t,r){e.exports={default:r(253),__esModule:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelCacheLayer=t.TileLayer=t.SubLayer=t.SceneLayer=t.MapImageLayer=t.FeatureLayer=t.VectorTileSubLayer=t.VectorTileLayer=t.Layer=void 0;var n=h(r(40)),i=h(r(493)),o=h(r(220)),a=h(r(496)),s=h(r(517)),l=h(r(518)),u=h(r(69)),c=h(r(519)),f=h(r(520));function h(e){return e&&e.__esModule?e:{default:e}}t.Layer=n.default,t.VectorTileLayer=i.default,t.VectorTileSubLayer=o.default,t.FeatureLayer=a.default,t.MapImageLayer=s.default,t.SceneLayer=l.default,t.SubLayer=u.default,t.TileLayer=c.default,t.ModelCacheLayer=f.default},function(e,t,r){e.exports={default:r(407),__esModule:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(16)),i=g(r(10)),o=g(r(14)),a=g(r(23)),s=g(r(3)),l=g(r(0)),u=g(r(2)),c=g(r(4)),f=g(r(5)),h=g(r(13)),d=r(1),p=r(99),y=r(218);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){return(0,l.default)(this,t),(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e))}return(0,f.default)(t,e),(0,u.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{}}},{key:"_getWorkflowParameters",value:function(e){var t=this,r={};return(0,a.default)(e).forEach(function(e){try{var n=t[e];if(void 0===n)return void d.Log.error("传入参数错误！");n&&n.clone?r[e]=n.clone():r[e]=n}catch(e){d.Log.error(e)}}),r}},{key:"_processParams",value:function(e,t){var r={};return(0,a.default)(t).forEach(function(n){try{var i=e[n],o=n;if(t[n]&&t[n].process){var a=t[n];i="function"==typeof a.process?a.process(i):a.process}t[n]&&t[n].alias&&(o=t[n].alias),r[o]=i}catch(e){d.Log.error(e)}}),r}},{key:"_queryByParameters",value:function(e,t,r,n){e=(0,d.defaultValue)(e,{});var a=this._checkPathParameters(e,t);if(!a.succeed)return e.failure&&e.failure instanceof Function&&e.failure({succeed:!1,msg:a.msg,data:void 0,errorType:a.errorType}),o.default.reject({succeed:!1,msg:a.msg,data:void 0,errorType:a.errorType});if(n&&n instanceof Function){var s=n(this.url,e),l=(0,p.checkParam)(e,r),u=this._processParams(e,r);return l&&(l.queryString="&parameters="+(0,i.default)(u)),d.Log.info("发起请求，基地址为：",s),this._checkAndRequest(l,s,e)}}},{key:"execute",value:function(e){var t=e||{},r=this._getCheckQueryOpts(),i=this._getWorkflowParameters(r);return this._queryByParameters((0,n.default)(i,t),{},r,function(e){return e+"/execute?f=json"})}},{key:"submit",value:function(e){var t=e||{},r=this._getCheckQueryOpts(),i=this._getWorkflowParameters(r);return this._queryByParameters((0,n.default)(i,t),{},r,function(e){return e+"/submit?f=json"})}},{key:"queryTaskStatus",value:function(e){return this._queryByParameters(e,{taskId:{type:"String"}},{},function(e,t){return e+"/"+t.taskId+"?f=json"})}},{key:"queryTaskResult",value:function(e){return this._queryByParameters(e,{taskId:{type:"String"}},{},function(e,t){return e+"/"+t.taskId+"/results?f=json"})}}],[{key:"createWorkFlow",value:function(e){return(0,y.createWorkflow)(e)}}]),t}(h.default);t.default=v},function(e,t,r){var n=r(20),i=r(12),o=r(34),a=r(45),s=r(33),l=function(e,t,r){var u,c,f,h=e&l.F,d=e&l.G,p=e&l.S,y=e&l.P,g=e&l.B,v=e&l.W,m=d?i:i[t]||(i[t]={}),_=m.prototype,S=d?n:p?n[t]:(n[t]||{}).prototype;for(u in d&&(r=t),r)(c=!h&&S&&void 0!==S[u])&&s(m,u)||(f=c?S[u]:r[u],m[u]=d&&"function"!=typeof S[u]?r[u]:g&&c?o(f,n):v&&S[u]==f?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(f):y&&"function"==typeof f?o(Function.call,f):f,y&&((m.virtual||(m.virtual={}))[u]=f,e&l.R&&_&&!_[u]&&a(_,u,f)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteNullValue=t.getFunctionArguments=t.compareObject=t.throttle=t.convertImageSourceToBase64=t.isWMSReverse=t.getProjectionSrs=t.jsonClone=t.toJSON=t.inputCss=t.getBaseUrl=t.isFunction=t.getVideoType=t.isObject=t.notNULL=t.cloneObject=t.returnPoint=t.formatPoints=t.newGuid=t.extendDeep=t.isBoolean=t.deepClone=t.isString=t.getOutStatisticsParameter=t.getGeometryParameter=t.isNull=t.isNumber=t.defined=t.defaultValue=t.getGUID=t.bind=t.getParameterString=t.urlAppend=t.transformResult=t.isInTheSameDomain=t.isArray=t.extend=void 0;var n=u(r(120)),i=u(r(10)),o=u(r(23)),a=u(r(53)),s=r(8),l=r(6);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){return void 0!==e&&null!==e?e:t}function f(e){return void 0!==e&&null!==e&&""!==e}function h(e){if(null===e||"object"!==(void 0===e?"undefined":(0,a.default)(e)))return e;if(e instanceof Date){var t=new Date;return t.setTime(e.getTime()),t}if(e instanceof Array)return e.slice(0);if(e instanceof Object){var r={};for(var n in e)e.hasOwnProperty(n)&&(e[n]instanceof Object?e[n]instanceof Array?r[n]=JSON.parse((0,i.default)(e[n])):"layer"!==n&&"_scene"!==n&&(r[n]=h(e[n])):r[n]=e[n]);return r}throw new Error("Unable to copy obj! Its type isn't supported.")}function d(e){var t=(new TextEncoder).encode(e);return"data:image/svg+xml;base64,"+btoa(String.fromCharCode.apply(null,t))}function p(e){return Object.prototype.toString.call(e).substring(8).split(/]/)[0]}t.extend=function(e,t){if(e=e||{},t)for(var r in t){var n=t[r];void 0!==n&&(e[r]=n)}return e},t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isInTheSameDomain=function(e){if(!e)return!0;var t=e.indexOf("//"),r=document.location.toString(),n=r.indexOf("//");if(-1===t)return!0;var i=e.substring(0,t),o=i,a=r.substring(n+2);n=a.indexOf("/");var s=a.indexOf(":"),l=a.substring(0,n),u=document.location.protocol;if(-1!==s||(l+=":"+("http:"===u.toLowerCase()?80:443)),u.toLowerCase()!==o.toLowerCase())return!1;var c=(o=e.substring(t+2)).indexOf(":");t=o.indexOf("/");var f=o.substring(0,t),h=void 0;return-1!==c?h=o.substring(0,c):(h=o.substring(0,t),f+=":"+("http:"===i.toLowerCase()?80:443)),h===document.domain&&f===l},t.transformResult=function(e){return e.responseText&&"string"==typeof e.responseText&&(e=JSON.parse(e.responseText)),e},t.urlAppend=function(e,t){var r=e;if(t){var n=(e+" ").split(/[?&]/);r+=" "===n.pop()?t:n.length?"&"+t:"?"+t}return r},t.getParameterString=function(e){var t=[];for(var r in e){var n=e[r];if(null!==n&&"function"!=typeof n){var i=void 0;if("object"===(void 0===n?"undefined":(0,a.default)(n))&&n.constructor===Array){for(var o=[],s=void 0,l=0,u=n.length;l<u;l++)s=n[l],o.push(encodeURIComponent(null===s||void 0===s?"":s));i=o.join(",")}else i=encodeURIComponent(n);t.push(encodeURIComponent(r)+"="+i)}}return t.join("&")},t.bind=function(e,t){var r=Array.prototype.slice.apply(arguments,[2]);return function(){var n=r.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(t,n)}},t.getGUID=function(){for(var e="",t=1;t<=32;t++)e+=Math.floor(16*Math.random()).toString(16),8!==t&&12!==t&&16!==t&&20!==t||(e+="-");return e},t.defaultValue=c,t.defined=f,t.isNumber=function(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&"object"!==(void 0===e?"undefined":(0,a.default)(e))&&"string"!=typeof e},t.isNull=function(e){return void 0===e||null===e||""===e||"object"===(void 0===e?"undefined":(0,a.default)(e))&&0===(0,o.default)(e).length},t.getGeometryParameter=function(e){var t="";return e&&(t+="&geometry="+e.toString()+"&geometryType="+e.getIGSType()),t},t.getOutStatisticsParameter=function(e){var t="";if(e instanceof Array&&e.length>0){t+="&outStatistics=[";for(var r=0;r<e.length;r++){var n=void 0;if(!(e[r]instanceof s.OutStatistic)){var i=c(e[r],{});n=new s.OutStatistic({statisticType:i.statisticType,onStatisticField:i.onStatisticField,outStatisticFieldName:i.outStatisticFieldName})}n&&(t+=n.toString())}t+="]"}return t},t.isString=function(e){return"string"==typeof e},t.deepClone=function(e){var t=e.success,r=e.failure,n=JSON.parse((0,i.default)(e));return n.success=t,n.failure=r,n},t.isBoolean=function(e){return"boolean"==typeof e},t.extendDeep=function e(t,r){var n=void 0,i=Object.prototype.toString;for(n in t=t||{},r)r.hasOwnProperty(n)&&("object"===(0,a.default)(r[n])?("[object Null]"!==i.call(t[n])&&"[object Undefined]"!==i.call(t[n])||(t[n]="[object Array]"===i.call(r[n])?[]:{}),e(t[n],r[n])):t[n]=r[n],""!==r[n]&&null!==r[n]||(t[n]=r[n]));return t},t.newGuid=function(){for(var e="",t=1;t<=32;t++)e+=Math.floor(16*Math.random()).toString(16),8!==t&&12!==t&&16!==t&&20!==t||(e+="-");return e},t.formatPoints=function e(t){for(var r=0;r<t.length;r++)t[r]instanceof Array?e(t[r]):t[r]instanceof Object&&(t[r]=t[r].toArray());return t},t.returnPoint=function(e,t,r){return new e({longitude:r[0],latitude:r[1],z:r[2],spatialReference:h(t.spatialReference)})},t.cloneObject=h,t.notNULL=function(e){return""!==e&&null!==e&&void 0!==e},t.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},t.getVideoType=function(e){if(e instanceof HTMLVideoElement)return l.VideoSourceType.videoHTML;if("object"===(void 0===e?"undefined":(0,a.default)(e)))return l.VideoSourceType.videoPlayer;if("string"!=typeof e)return null;var t=e.split(":");if("http"===t[0]||"https"===t[0]){var r=e.split(".").pop();if(r===l.VideoSourceType.hls)return l.VideoSourceType.hls;if(r===l.VideoSourceType.mp4)return l.VideoSourceType.mp4}else if(t[0]===l.VideoSourceType.rtmp)return l.VideoSourceType.rtmp;return null},t.isFunction=function(e){return"function"==typeof e},t.getBaseUrl=function(e){var t=document.createElement("a");t.setAttribute("href",e);var r=t.hostname,n=t.port;return t.protocol+"//"+r+(n.length?":"+n:"")},t.inputCss=function(e){if(window.document){var t=window.document.createElement("style");t.type="text/css",t.innerHTML=e,window.document.body.appendChild(t)}},t.toJSON=function(e,t){return e instanceof t?e.toJSON():e},t.jsonClone=function(e){return e=c(e,{}),JSON.parse((0,i.default)(e))},t.getProjectionSrs=function(e){var t=void 0;return e.wkid?t="EPSG:"+e.wkid:e.wkt&&(t={wkt:e.wkt,v:""},t=(0,i.default)(t)),t},t.isWMSReverse=function(e,t){var r=t.wkid,n=!1;return"1.3.0"===e&&(t.isGeographic||r>=2327&&r<=2442||r>=4491&&r<=4554||r>=21413&&r<=21423||r>=21473&&r<=21483)&&(n=!0),n},t.convertImageSourceToBase64=function(e){var t="";return"string"==typeof e?t=/<svg\s|<svg>/i.test(e)?d(e):e:e instanceof SVGElement?t=d((new XMLSerializer).serializeToString(e)):e instanceof Image?t=e.src:e instanceof HTMLCanvasElement&&(t=e.toDataURL("image/png")),t},t.throttle=function(e,t,r){var n=void 0,i=void 0;function o(){n=!1,i&&(a.apply(r,i),i=!1)}function a(){n?i=arguments:(n=!0,e.apply(r,arguments),setTimeout(o,t))}return a},t.compareObject=function e(t,r){if(arguments.length<2)throw"Incorrect number of parameters";var i=p(t);if(i!==p(r))return!1;if("Array"!==i&&"Object"!==i&&"Set"!==i&&"Map"!==i)return"Number"===i&&"NaN"===t.toString()?"NaN"===r.toString():"Date"===i||"RegExp"===i?t.toString()===r.toString():t===r;if("Array"===i){if(t.length!==r.length)return!1;if(0===t.length)return!0;for(var a=0;a<t.length;a++)if(!e(t[a],r[a]))return!1}else if("Object"===i){var s=(0,o.default)(t),l=(0,o.default)(r),u=void 0;if(s.length!==l.length)return!1;for(var c=0;c<s.length;c++){if((u=s[c])!==l[c])return!1;if(!e(t[u],r[u]))return!1}}else if(("Set"===i||"Map"===i)&&!e((0,n.default)(t),(0,n.default)(r)))return!1;return!0},t.getFunctionArguments=function(e){var t=e.toLocaleString().split("function(")[1];return(t=(t=t.split(")")[0]).replaceAll(" ","")).split(",")},t.deleteNullValue=function(e){return e instanceof Object&&(0,o.default)(e).forEach(function(t){f(t)&&f(e[t])||delete e[t]}),e}},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){var n=r(110)("wks"),i=r(89),o=r(20).Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StylePattern3D=t.ColorMaterial=t.WaterSymbol3DLayer=t.TextHalo=t.TextSymbol3DLayer=t.Edges3D=t.ExtrudeSymbol3DLayer=t.ObjectSymbol3DLayer=t.IconResource=t.PointSymbol3DOutline=t.IconSymbol3DLayer=t.FillSymbol3DOutline=t.FillSymbol3DLayer=t.PathSymbol3DLayer=t.LineSymbol3DLayer=t.LineStylePattern3D=t.LineStyleMarker3D=t.Symbol3DLayer=t.Symbol3DVerticalOffset=t.Callout3D=t.LineCallout3D=t.PolygonSymbol3D=t.PointSymbol3D=t.LineSymbol3D=t.LabelSymbol3D=t.Symbol3D=t.Symbol=t.createSymbol=t.MapGISTextSymbol=t.PictureFillSymbol=t.PictureMarkerSymbol=t.TextSymbol=t.SimpleMarkerSymbol=t.SimpleLineSymbol=t.SimpleFillSymbol=void 0;var n=S(r(56)),i=S(r(82)),o=S(r(180)),a=S(r(376)),s=S(r(379)),l=S(r(134)),u=S(r(380)),c=S(r(381)),f=S(r(382)),h=S(r(383)),d=S(r(384)),p=S(r(385)),y=S(r(386)),g=S(r(179)),v=r(176),m=r(6),_=r(31);function S(e){return e&&e.__esModule?e:{default:e}}t.SimpleFillSymbol=s.default,t.SimpleLineSymbol=l.default,t.SimpleMarkerSymbol=a.default,t.TextSymbol=o.default,t.PictureMarkerSymbol=u.default,t.PictureFillSymbol=c.default,t.MapGISTextSymbol=f.default,t.createSymbol=function(e){var t=null;switch((e||{}).type){case m.SymbolType.simpleMarker:t=new a.default(e);break;case m.SymbolType.simpleLine:t=new l.default(e);break;case m.SymbolType.simpleFill:t=new s.default(e);break;case m.SymbolType.pictureMarker:t=new u.default(e);break;case m.SymbolType.pictureFill:t=new c.default(e);break;case m.SymbolType.text:t=new o.default(e);break;case m.SymbolType.mapgisText:t=new f.default(e);break;case m.SymbolType.label3D:t=new h.default(e);break;case m.SymbolType.point3D:t=new p.default(e);break;case m.SymbolType.line3D:t=new d.default(e);break;case m.SymbolType.polygon3D:t=new y.default(e);break;default:t=new a.default(e)}return t},t.Symbol=n.default,t.Symbol3D=i.default,t.LabelSymbol3D=h.default,t.LineSymbol3D=d.default,t.PointSymbol3D=p.default,t.PolygonSymbol3D=y.default,t.LineCallout3D=_.LineCallout3D,t.Callout3D=_.Callout3D,t.Symbol3DVerticalOffset=_.Symbol3DVerticalOffset,t.Symbol3DLayer=v.Symbol3DLayer,t.LineStyleMarker3D=_.LineStyleMarker3D,t.LineStylePattern3D=_.LineStylePattern3D,t.LineSymbol3DLayer=v.LineSymbol3DLayer,t.PathSymbol3DLayer=v.PathSymbol3DLayer,t.FillSymbol3DLayer=v.FillSymbol3DLayer,t.FillSymbol3DOutline=_.FillSymbol3DOutline,t.IconSymbol3DLayer=v.IconSymbol3DLayer,t.PointSymbol3DOutline=_.PointSymbol3DOutline,t.IconResource=_.IconResource,t.ObjectSymbol3DLayer=v.ObjectSymbol3DLayer,t.ExtrudeSymbol3DLayer=v.ExtrudeSymbol3DLayer,t.Edges3D=_.Edges3D,t.TextSymbol3DLayer=v.TextSymbol3DLayer,t.TextHalo=_.TextHalo,t.WaterSymbol3DLayer=v.WaterSymbol3DLayer,t.ColorMaterial=_.ColorMaterial,t.StylePattern3D=g.default},function(e,t,r){e.exports={default:r(246),__esModule:!0}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayerBaseUrlRegExp=t.ServerBaseUrlRegExp=t.BaseRegExp=t.ServerUtil=t.UrlUtil=t.RequestConfig=t.WorkFlowServer=t.Interceptor=t.CAttStruct=t.CAttDataRow=t.GeometryFilter=t.convertIGSClippingString=t.FetchRequest=t.ServiceConfigRequestInterceptors=t.ServiceConfigToken=t.Config=t.formatBaseUrl=t.ArcGISVectorTileServer=t.ArcGISFeatureServer=t.ArcGISGeometryServer=t.ThemesInfo=t.ThemeServer=t.ItemValue=t.FolderInfoAttribute=t.FolderInfo=t.ExpInfo=t.CUniqueThemeInfo=t.CUniqueTheme=t.CThemeInfo=t.CTheme=t.CSimpleTheme=t.CRegInfo=t.CRangeThemeInfo=t.CRangeTheme=t.CRandomTheme=t.CPntInfo=t.CMultiClassTheme=t.CLinInfo=t.CGraduatedSymbolTheme=t.CFourColorTheme=t.CDotDensityTheme=t.CChartType=t.CChartThemeRepresentInfo=t.CChartThemeInfo=t.CChartTheme=t.CChartLabelFormat=t.CAnnInfo=t.CAllOtherDataItemInfoSource=t.ISSceneServer=t.ArcGISMapServer=t.WFSServer=t.WMTSServer=t.WMSServer=t.SceneServer=t.ResourceServer=t.PlotServer=t.VectorTileServer=t.TileServer=t.RootServer=t.SecurityServer=t.TerrainServer=t.PoiServer=t.Cesium3DTilesServer=t.AddressServer=t.GeometryServer=t.ImageServer=t.M3DServer=t.FeatureServer=t.MapServer=t.ResponseInterceptor=t.RequestInterceptor=t.BaseServer=t.FetchServer=void 0;var n=d(r(13)),i=d(r(136)),o=d(r(137)),a=d(r(196)),s=d(r(98)),l=r(99),u=d(r(198)),c=r(38),f=r(139),h=r(490);function d(e){return e&&e.__esModule?e:{default:e}}t.FetchServer=a.default,t.BaseServer=n.default,t.RequestInterceptor=i.default,t.ResponseInterceptor=o.default,t.MapServer=f.MapServer,t.FeatureServer=f.FeatureServer,t.M3DServer=f.M3DServer,t.ImageServer=f.ImageServer,t.GeometryServer=f.GeometryServer,t.AddressServer=f.AddressServer,t.Cesium3DTilesServer=f.Cesium3DTilesServer,t.PoiServer=f.PoiServer,t.TerrainServer=f.TerrainServer,t.SecurityServer=f.SecurityServer,t.RootServer=f.RootServer,t.TileServer=f.TileServer,t.VectorTileServer=f.VectorTileServer,t.PlotServer=f.PlotServer,t.ResourceServer=f.ResourceServer,t.SceneServer=f.SceneServer,t.WMSServer=f.WMSServer,t.WMTSServer=f.WMTSServer,t.WFSServer=f.WFSServer,t.ArcGISMapServer=f.ArcGISMapServer,t.ISSceneServer=h.ISSceneServer,t.CAllOtherDataItemInfoSource=f.CAllOtherDataItemInfoSource,t.CAnnInfo=f.CAnnInfo,t.CChartLabelFormat=f.CChartLabelFormat,t.CChartTheme=f.CChartTheme,t.CChartThemeInfo=f.CChartThemeInfo,t.CChartThemeRepresentInfo=f.CChartThemeRepresentInfo,t.CChartType=f.CChartType,t.CDotDensityTheme=f.CDotDensityTheme,t.CFourColorTheme=f.CFourColorTheme,t.CGraduatedSymbolTheme=f.CGraduatedSymbolTheme,t.CLinInfo=f.CLinInfo,t.CMultiClassTheme=f.CMultiClassTheme,t.CPntInfo=f.CPntInfo,t.CRandomTheme=f.CRandomTheme,t.CRangeTheme=f.CRangeTheme,t.CRangeThemeInfo=f.CRangeThemeInfo,t.CRegInfo=f.CRegInfo,t.CSimpleTheme=f.CSimpleTheme,t.CTheme=f.CTheme,t.CThemeInfo=f.CThemeInfo,t.CUniqueTheme=f.CUniqueTheme,t.CUniqueThemeInfo=f.CUniqueThemeInfo,t.ExpInfo=f.ExpInfo,t.FolderInfo=f.FolderInfo,t.FolderInfoAttribute=f.FolderInfoAttribute,t.ItemValue=f.ItemValue,t.ThemeServer=f.ThemeServer,t.ThemesInfo=f.ThemesInfo,t.ArcGISGeometryServer=f.ArcGISGeometryServer,t.ArcGISFeatureServer=f.ArcGISFeatureServer,t.ArcGISVectorTileServer=f.ArcGISVectorTileServer,t.formatBaseUrl=l.formatBaseUrl,t.Config=u.default,t.ServiceConfigToken=l.ServiceConfigToken,t.ServiceConfigRequestInterceptors=l.ServiceConfigRequestInterceptors,t.FetchRequest=s.default,t.convertIGSClippingString=l.convertIGSClippingString,t.GeometryFilter=c.GeometryFilter,t.CAttDataRow=f.CAttDataRow,t.CAttStruct=f.CAttStruct,t.Interceptor=c.Interceptor,t.WorkFlowServer=f.WorkFlowServer,t.RequestConfig=c.RequestConfig,t.UrlUtil=c.UrlUtil,t.ServerUtil=c.ServerUtil,t.BaseRegExp=c.BaseRegExp,t.ServerBaseUrlRegExp=c.ServerBaseUrlRegExp,t.LayerBaseUrlRegExp=c.LayerBaseUrlRegExp},function(e,t,r){e.exports=!r(52)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(28),i=r(150),o=r(113),a=Object.defineProperty;t.f=r(26)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(24);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(11)),i=v(r(10)),o=v(r(3)),a=v(r(0)),s=v(r(2)),l=v(r(4)),u=v(r(5)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(35)),f=v(r(80)),h=r(1),d=r(6),p=r(36),y=v(r(57)),g=r(9);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r.spatialReference=(0,h.defaultValue)(y.default.fromJSON(e.spatialReference),new y.default("EPSG:4326")),r.hasZ=!1,r.type=d.GeometryType.geometry,r.extensionOptions=(0,h.defaultValue)(e.extensionOptions,{}),r}return(0,u.default)(t,e),(0,s.default)(t,[{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toJSON",value:function(){return{spatialReference:this.spatialReference instanceof y.default?this.spatialReference.toJSON():this.spatialReference,hasZ:this.hasZ,type:this.type,extensionOptions:(0,h.cloneObject)(this.extensionOptions)}}},{key:"toGeoJSON",value:function(){return{type:this.type,coordinates:this.coordinates}}},{key:"fromGeoJSON",value:function(e){(e||e.type!==this.type)&&new Error("GeoJSON类型和几何类型不一致"),(0,h.defined)(this.coordinates)&&(this.coordinates=e.coordinates)}},{key:"toXML",value:function(){return""}},{key:"getType",value:function(){return this.type}},{key:"getIGSType",value:function(){return d.IGSGeometryType.geometry}},{key:"getGeometryType",value:function(){return this.type}},{key:"toString",value:function(){return""}}],[{key:"fromGeoJSON",value:function(e){return(0,p.createGeometryByGeoJSON)(e,new y.default("EPSG:4326"))}},{key:"fromJSON",value:function(e){return e=(0,h.defaultValue)(e,{}),(0,p.createGeometry)(e)}},{key:"isClockwise",value:function(e){e=(0,h.defaultValue)(e,void 0),(0,h.isNull)(e)&&h.Log.error("geometry1不能为空！"),e instanceof Array||h.Log.error("输入参数类型错误，需要输入点数组！");for(var t=0;t<e.length;t++)if(e[t]instanceof Array)for(var r=0;r<e[t].length;r++)e[t][r]instanceof Array&&h.Log.error("输入参数类型错误，需要输入二维数组！");else h.Log.error("输入参数类型错误，需要输入二维数组！");if(e[0].length===e[e.length-1].length&&(0,i.default)(e[0])===(0,i.default)(e[e.length-1])||h.Log.error("输入的点数组必须首尾闭合！"),!(0,h.isNull)(e)){var n=c.lineString(e);return c.booleanClockwise(n)}}},{key:"fromRings",value:function(e,t){e=(0,h.defaultValue)(e,void 0);var r=(0,h.defaultValue)(y.default.fromJSON(t),new y.default("EPSG:4326"));(0,h.isNull)(e)&&h.Log.error("geometry1不能为空！"),e instanceof Array||h.Log.error("输入参数类型错误，需要输入点数组！"),3!==this._multiarr(e)&&h.Log.error("输入参数错误，需要输入三维数组！");var n=void 0;if(1===e.length){var o=e[0];return o[0].length===o[o.length-1].length&&(0,i.default)(o[0])===(0,i.default)(o[o.length-1])||o.push(o[0]),new g.Polygon({coordinates:[o],spatialReference:r})}for(var a=[],s=0;s<e.length;s++){var l={geometry:void 0,area:null,inner:[]};(0,i.default)(e[s][0])!==(0,i.default)(e[s][e[s].length-1])&&e[s].push(e[s][0]);var u=new g.Polygon({coordinates:[e[s]],spatialReference:r});l.geometry=u,l.area=g.GeometryEngine.planarArea(u),a.push(l)}for(var c=this._processArr([],a),f=[],d=function(e){var t=[c[e].geometry.coordinates[0]];c[e].inner.length>=1&&c[e].inner.forEach(function(e){t.push(e.geometry.coordinates[0])}),f.push(t)},p=0;p<c.length;p++)d(p);for(var v=[],m=0;m<c.length;m++)n=new g.Polygon({coordinates:f[m],spatialReference:r}),v.push(n);return v}},{key:"_processArr",value:function(e,t){t.sort(function(e,t){return t.area-e.area});for(var r=t[0],n=[],i=1;i<t.length;i++)g.GeometryEngine.disjoint(r.geometry,t[i].geometry)?n.push(t[i]):g.GeometryEngine.contains(r.geometry,t[i].geometry)?r.inner.push(t[i]):n.push(t[i]);if(r.inner.length>1)for(var o=0;o<r.inner.length;o++)for(var a=r.inner[o],s=o+1;s<r.inner.length;s++)g.GeometryEngine.intersects(a.geometry,r.inner[s].geometry)&&(g.GeometryEngine.contains(a.geometry,r.inner[s].geometry)?(n.push(r.inner[s]),r.inner.splice(s,1),s--):h.Log.error("输入的几何存在拓扑错误，请检查"));return e.push(r),n.length>1?this._processArr(e,n):1===n.length&&e.push(n[0]),e}},{key:"_multiarr",value:function(e){for(var t=[],r=1,n=0;n<e.length;n++)if(e[n]instanceof Array)for(var i=0;i<e[n].length;i++)t.push(e[n][i]);return t.length&&(r=1,r+=this._multiarr(t)),r}},{key:"_parseString",value:function(e){for(var t=[],r=e.split("*"),n=0;n<r.length;n++){for(var i=r[n].split(" "),o=[],a=0;a<i.length;a++)if(o.push(i[a].split(",")),i[a].indexOf("#")>-1){i[a]=i[a].replace("#",""),o.splice(a-1,2);var s=[i[a-1].split(","),i[a].split(","),i[a+1].split(",")];o.push(s),a++}for(var l=[],u=0;u<o.length;u++){var c=void 0;if(o[u][0]instanceof Array){for(var f=[],h=0;h<o[u].length;h++)c=o[u][h].map(function(e){return Number(e)}),f.push(c);l.push(f)}else c=o[u].map(function(e){return Number(e)}),l.push(c)}t.push(l)}return t}}]),t}(f.default);(0,n.default)(m.prototype,{extent:{configurable:!1,get:function(){}}}),t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(7)),l=f(r(5)),u=r(1),c=f(r(138));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,o.default)(t,null,[{key:"initRegExps",value:function(){var e=this;this.regExps={};var t="http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/{ServerName}/"+c.default.requestWordRegExp;[{key:"MapServerV1",value:"mrms/docs"},{key:"MapServerV1Wrong",value:"mrcs/docs"},{key:"TileServerV1",value:"mrms/tile"},{key:"FeatureServerV1",value:"mrfs/docs"},{key:"VectorTileServerV1",value:"mrcs/vtiles"},{key:"SceneServerV1",value:"g3d"}].forEach(function(r){e.regExps[r.key]=new RegExp(t.replace("{ServerName}",r.value))}),this.regExps.GeometryServerV1=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/mrgs/geomservice/calArea"),this.regExps.WorkflowServerV1=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/mrfws/execute/"+c.default.requestWordRegExp),this.regExps.WMTSServerV1=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/ogc/"+c.default.requestWordRegExp+"/WMTSServer"),this.regExps.WMSV1=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/ogc/doc/"+c.default.requestWordRegExp+"/WMSServer"),this.regExps.WFSV1=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/ogc/layer/"+c.default.requestWordRegExp+"/WFSServer"),this.regExps.ResourceServerV1=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/mrcs"),this.regExps.MapServerV1GDBP=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/mrms/layers"),this.regExps.SceneServerV1=new RegExp(t.replace("{ServerName}","g3d"));var r="(http|https)://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/services/("+c.default.requestWordRegExp+"|"+c.default.requestWordRegExp+"/"+c.default.requestWordRegExp+")/";[{key:"MapServerV2",value:"MapServer"},{key:"TileServerV2",value:"TileServer"},{key:"FeatureServerV2",value:"FeatureServer"},{key:"VectorTileServerV2",value:"VectorTileServer"},{key:"SceneServerV2",value:"SceneServer"},{key:"M3dServerV2",value:"M3dServer"},{key:"3DTilesServerV2",value:"3DTilesServer"},{key:"TerrainServerV2",value:"TerrainServer"},{key:"ImageServerV2",value:"ImageServer"},{key:"PlotServerV2",value:"PlotServer"},{key:"AddressServerV2",value:"AddressServer"},{key:"PoiServerV2",value:"PoiServer"},{key:"WMTSServerV2",value:"WMTSServer"},{key:"WMSServerV2",value:"WMSServer"},{key:"WFSServerV2",value:"WFSServer"},{key:"IGS-ArcGISMapServer",value:"arcgis/MapServer"},{key:"IGS-ArcGISFeatureServer",value:"arcgis/FeatureServer"},{key:"IGS-ArcGISVectorTileServer",value:"arcgis/VectorTileServer"}].forEach(function(t){e.regExps[t.key]=new RegExp(""+r+t.value)}),[{key:"ResourceServerV2",value:"ResourceServer"},{key:"GeometryServerV2",value:"GeometryServer"}].forEach(function(t){e.regExps[t.key]=new RegExp("(http|https)://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/services/system/"+t.value)}),this.regExps.WorkflowServer=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/services/workflow/"+c.default.requestWordRegExp+"/WorkflowServer");var n="(http|https)://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/arcgis/rest/services/("+c.default.requestWordRegExp+"|"+c.default.requestWordRegExp+"/"+c.default.requestWordRegExp+")/";[{key:"ArcGISMapServer",value:"MapServer"},{key:"ArcGISVectorTileServer",value:"VectorTileServer"}].forEach(function(t){e.regExps[t.key]=new RegExp(""+n+t.value)})}},{key:"matchString",value:function(e){if((0,u.defined)(e)){var r=e.indexOf("?"),i="",o="";return r<0?i=e:(i=e.substring(0,r),o=e.substring(r,e.length)),(i=(0,s.default)(t.__proto__||(0,n.default)(t),"matchString",this).call(this,i))+o}}}]),t}(c.default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorMaterial=t.TextHalo=t.Edges3D=t.IconResource=t.PointSymbol3DOutline=t.FillSymbol3DOutline=t.LineStylePattern3D=t.LineStyleMarker3D=t.Symbol3DVerticalOffset=t.Callout3D=t.LineCallout3D=void 0;var n=p(r(359)),i=p(r(177)),o=p(r(360)),a=p(r(361)),s=p(r(362)),l=p(r(363)),u=p(r(364)),c=p(r(365)),f=p(r(366)),h=p(r(178)),d=r(367);function p(e){return e&&e.__esModule?e:{default:e}}t.LineCallout3D=n.default,t.Callout3D=i.default,t.Symbol3DVerticalOffset=o.default,t.LineStyleMarker3D=a.default,t.LineStylePattern3D=s.default,t.FillSymbol3DOutline=l.default,t.PointSymbol3DOutline=u.default,t.IconResource=c.default,t.Edges3D=f.default,t.TextHalo=h.default,t.ColorMaterial=d.ColorMaterial},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),t=(0,i.defaultValue)(t,{}),(0,i.extend)(this,t),this.Name=t&&t.Name?t.Name:null,this.IsBaseTheme=!t||!t.IsBaseTheme||t.IsBaseTheme,this.Visible=!t||!t.Visible||t.Visible}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(74);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){(function(e){!function(t){"use strict";var r=6371008.8,n={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*r,kilometers:6371.0088,kilometres:6371.0088,meters:r,metres:r,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:r/1852,radians:1,yards:6967335.223679999},i={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/r,yards:1.0936133},o={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:3.86e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046};function a(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function s(e,t,r){switch(e){case"Point":return l(t).geometry;case"LineString":return h(t).geometry;case"Polygon":return c(t).geometry;case"MultiPoint":return g(t).geometry;case"MultiLineString":return y(t).geometry;case"MultiPolygon":return v(t).geometry;default:throw new Error(e+" is invalid")}}function l(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!T(e[0])||!T(e[1]))throw new Error("coordinates must contain numbers");return a({type:"Point",coordinates:e},t,r)}function u(e,t,r){return void 0===r&&(r={}),p(e.map(function(e){return l(e,t)}),r)}function c(e,t,r){void 0===r&&(r={});for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return a({type:"Polygon",coordinates:e},t,r)}function f(e,t,r){return void 0===r&&(r={}),p(e.map(function(e){return c(e,t)}),r)}function h(e,t,r){if(void 0===r&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:e},t,r)}function d(e,t,r){return void 0===r&&(r={}),p(e.map(function(e){return h(e,t)}),r)}function p(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function y(e,t,r){return void 0===r&&(r={}),a({type:"MultiLineString",coordinates:e},t,r)}function g(e,t,r){return void 0===r&&(r={}),a({type:"MultiPoint",coordinates:e},t,r)}function v(e,t,r){return void 0===r&&(r={}),a({type:"MultiPolygon",coordinates:e},t,r)}function m(e,t,r){return void 0===r&&(r={}),a({type:"GeometryCollection",geometries:e},t,r)}function _(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r}function S(e,t){void 0===t&&(t="kilometers");var r=n[t];if(!r)throw new Error(t+" units is invalid");return e*r}function x(e,t){void 0===t&&(t="kilometers");var r=n[t];if(!r)throw new Error(t+" units is invalid");return e/r}function b(e,t){return k(x(e,t))}function w(e){var t=e%360;return t<0&&(t+=360),t}function k(e){return e%(2*Math.PI)*180/Math.PI}function M(e){return e%360*Math.PI/180}function E(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return S(x(e,t),r)}function I(e,t,r){if(void 0===t&&(t="meters"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=o[t];if(!n)throw new Error("invalid original units");var i=o[r];if(!i)throw new Error("invalid final units");return e/n*i}function T(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function L(e){return!!e&&e.constructor===Object}function P(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!T(e))throw new Error("bbox must only contain numbers")})}function C(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}var N=Object.freeze({__proto__:null,earthRadius:r,factors:n,unitsFactors:i,areaFactors:o,feature:a,geometry:s,point:l,points:u,polygon:c,polygons:f,lineString:h,lineStrings:d,featureCollection:p,multiLineString:y,multiPoint:g,multiPolygon:v,geometryCollection:m,round:_,radiansToLength:S,lengthToRadians:x,lengthToDegrees:b,bearingToAzimuth:w,radiansToDegrees:k,degreesToRadians:M,convertLength:E,convertArea:I,isNumber:T,isObject:L,validateBBox:P,validateId:C});function O(e,t,r){if(null!==e)for(var n,i,o,a,s,l,u,c,f=0,h=0,d=e.type,p="FeatureCollection"===d,y="Feature"===d,g=p?e.features.length:1,v=0;v<g;v++){s=(c=!!(u=p?e.features[v].geometry:y?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var m=0;m<s;m++){var _=0,S=0;if(null!==(a=c?u.geometries[m]:u)){l=a.coordinates;var x=a.type;switch(f=!r||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===t(l,h,v,_,S))return!1;h++,_++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===t(l[n],h,v,_,S))return!1;h++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-f;i++){if(!1===t(l[n][i],h,v,_,S))return!1;h++}"MultiLineString"===x&&_++,"Polygon"===x&&S++}"Polygon"===x&&_++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(S=0,i=0;i<l[n].length;i++){for(o=0;o<l[n][i].length-f;o++){if(!1===t(l[n][i][o],h,v,_,S))return!1;h++}S++}_++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===O(a.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function R(e,t,r,n){var i=r;return O(e,function(e,n,o,a,s){i=0===n&&void 0===r?e:t(i,e,n,o,a,s)},n),i}function V(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function G(e,t,r){var n=r;return V(e,function(e,i){n=0===i&&void 0===r?e:t(n,e,i)}),n}function A(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function F(e,t,r){var n=r;return A(e,function(e,i){n=0===i&&void 0===r?e:t(n,e,i)}),n}function D(e){var t=[];return O(e,function(e){t.push(e)}),t}function j(e,t){var r,n,i,o,a,s,l,u,c,f,h=0,d="FeatureCollection"===e.type,p="Feature"===e.type,y=d?e.features.length:1;for(r=0;r<y;r++){for(s=d?e.features[r].geometry:p?e.geometry:e,u=d?e.features[r].properties:p?e.properties:{},c=d?e.features[r].bbox:p?e.bbox:void 0,f=d?e.features[r].id:p?e.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=l?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,h,u,c,f))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===t(o.geometries[n],h,u,c,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,h,u,c,f))return!1;h++}}function B(e,t,r){var n=r;return j(e,function(e,i,o,a,s){n=0===i&&void 0===r?e:t(n,e,i,o,a,s)}),n}function q(e,t){j(e,function(e,r,n,i,o){var s,l=null===e?null:e.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==t(a(e,n,{bbox:i,id:o}),r,0)&&void 0}switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var u=0;u<e.coordinates.length;u++){var c=e.coordinates[u];if(!1===t(a({type:s,coordinates:c},n),r,u))return!1}})}function U(e,t,r){var n=r;return q(e,function(e,i,o){n=0===i&&0===o&&void 0===r?e:t(n,e,i,o)}),n}function J(e,t){q(e,function(e,r,n){var i=0;if(e.geometry){var o=e.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var a,s=0,l=0,u=0;return!1!==O(e,function(o,c,f,d,p){if(void 0===a||r>s||d>l||p>u)return a=o,s=r,l=d,u=p,void(i=0);var y=h([a,o],e.properties);if(!1===t(y,r,n,p,i))return!1;i++,a=o})&&void 0}}})}function z(e,t,r){var n=r,i=!1;return J(e,function(e,o,a,s,l){n=!1===i&&void 0===r?e:t(n,e,o,a,s,l),i=!0}),n}function W(e,t){if(!e)throw new Error("geojson is required");q(e,function(e,r,n){if(null!==e.geometry){var i=e.geometry.type,o=e.geometry.coordinates;switch(i){case"LineString":if(!1===t(e,r,n,0,0))return!1;break;case"Polygon":for(var a=0;a<o.length;a++)if(!1===t(h(o[a],e.properties),r,n,a))return!1}}})}function H(e,t,r){var n=r;return W(e,function(e,i,o,a){n=0===i&&void 0===r?e:t(n,e,i,o,a)}),n}function X(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,a=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=l.length+a-1),h([l[a],l[a+1]],s,t);case"Polygon":return o<0&&(o=l.length+o),a<0&&(a=l[o].length+a-1),h([l[o][a],l[o][a+1]],s,t);case"MultiLineString":return i<0&&(i=l.length+i),a<0&&(a=l[i].length+a-1),h([l[i][a],l[i][a+1]],s,t);case"MultiPolygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),a<0&&(a=l[i][o].length-a-1),h([l[i][o][a],l[i][o][a+1]],s,t)}throw new Error("geojson is invalid")}function Y(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,a=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return l(u,s,t);case"MultiPoint":return i<0&&(i=u.length+i),l(u[i],s,t);case"LineString":return a<0&&(a=u.length+a),l(u[a],s,t);case"Polygon":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),l(u[o][a],s,t);case"MultiLineString":return i<0&&(i=u.length+i),a<0&&(a=u[i].length+a),l(u[i][a],s,t);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),a<0&&(a=u[i][o].length-a),l(u[i][o][a],s,t)}throw new Error("geojson is invalid")}var Z=Object.freeze({__proto__:null,coordAll:D,coordEach:O,coordReduce:R,featureEach:A,featureReduce:F,findPoint:Y,findSegment:X,flattenEach:q,flattenReduce:U,geomEach:j,geomReduce:B,lineEach:W,lineReduce:H,propEach:V,propReduce:G,segmentEach:J,segmentReduce:z});function K(e){var t=[1/0,1/0,-1/0,-1/0];return O(e,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}function Q(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function $(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ee(e){if(e.length>1&&T(e[0])&&T(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return ee(e[0]);throw new Error("coordinates must only contain numbers")}function te(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)}function re(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)}function ne(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,i=e.features;n<i.length;n++){var o=i[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+o.geometry.type)}}function ie(e){return"Feature"===e.type?e.geometry:e}function oe(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}K.default=K;var ae=Object.freeze({__proto__:null,getCoord:Q,getCoords:$,containsNumber:ee,geojsonType:te,featureOf:re,collectionOf:ne,getGeom:ie,getType:oe}),se=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,ce=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,n,i=
/*
    object-assign
    (c) Sindre Sorhus
    @license MIT
    */
function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),o=1;o<arguments.length;o++){for(var a in r=Object(arguments[o]))le.call(r,a)&&(i[a]=r[a]);if(se){n=se(r);for(var s=0;s<n.length;s++)ue.call(r,n[s])&&(i[n[s]]=r[n[s]])}}return i},fe={successCallback:null,verbose:!1},he={};
/**
     * @license GNU Affero General Public License.
     * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
     * v. 1.2.0
     * https://github.com/RaumZeit/MarchingSquares.js
     *
     * MarchingSquaresJS is free software: you can redistribute it and/or modify
     * it under the terms of the GNU Affero General Public License as published by
     * the Free Software Foundation, either version 3 of the License, or
     * (at your option) any later version.
     *
     * MarchingSquaresJS is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     * GNU Affero General Public License for more details.
     *
     * As additional permission under GNU Affero General Public License version 3
     * section 7, third-party projects (personal or commercial) may distribute,
     * include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
     * requirement that said third-party project for that reason alone becomes
     * subject to any requirement of the GNU Affero General Public License version 3.
     * Any modifications to MarchingSquaresJS, however, must be shared with the public
     * and made available.
     *
     * In summary this:
     * - allows you to use MarchingSquaresJS at no cost
     * - allows you to use MarchingSquaresJS for both personal and commercial purposes
     * - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
     *   license as long as this license notice is included
     * - enables you to keep the source code of your program that uses MarchingSquaresJS
     *   undisclosed
     * - forces you to share any modifications you have made to MarchingSquaresJS,
     *   e.g. bug-fixes
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
     */function de(e,t,r){r=r||{};for(var n=Object.keys(fe),i=0;i<n.length;i++){var o=n[i],a=r[o];a=null!=a?a:fe[o],he[o]=a}he.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+t);var s=function(e){var t=[],r=0;return e.cells.forEach(function(n,i){n.forEach(function(n,o){if(void 0!==n&&5!==(h=n).cval&&10!==h.cval&&!ye(n)){var a=function(e,t,r){var n,i,o=e.length,a=[],s=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],l=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],u=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],c=e[t][r],f=c.cval,h=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][f],d=ve(c,h);a.push([r+d[0],t+d[1]]),d=ve(c,h=u[f]),a.push([r+d[0],t+d[1]]),ge(c);for(var p=r+s[f],y=t+l[f],g=f;p>=0&&y>=0&&y<o&&(p!=r||y!=t)&&void 0!==(c=e[y][p]);){if(0===(f=c.cval)||15===f)return{path:a,info:"mergeable"};h=u[f],n=s[f],i=l[f],5!==f&&10!==f||(5===f?c.flipped?-1===l[g]?(h="left",n=-1,i=0):(h="right",n=1,i=0):-1===s[g]&&(h="bottom",n=0,i=-1):10===f&&(c.flipped?-1===s[g]?(h="top",n=0,i=1):(h="bottom",n=0,i=-1):1===l[g]&&(h="left",n=-1,i=0))),d=ve(c,h),a.push([p+d[0],y+d[1]]),ge(c),p+=n,y+=i,g=f}return{path:a,info:"closed"}}(e.cells,i,o),s=!1;if("mergeable"===a.info)for(var l=a.path[a.path.length-1][0],u=a.path[a.path.length-1][1],c=r-1;c>=0;c--)if(Math.abs(t[c][0][0]-l)<=1e-7&&Math.abs(t[c][0][1]-u)<=1e-7){for(var f=a.path.length-2;f>=0;--f)t[c].unshift(a.path[f]);s=!0;break}s||(t[r++]=a.path)}var h})}),t}(function(e,t){for(var r=e.length-1,n=e[0].length-1,i={rows:r,cols:n,cells:[]},o=0;o<r;++o){i.cells[o]=[];for(var a=0;a<n;++a){var s=0,l=e[o+1][a],u=e[o+1][a+1],c=e[o][a+1],f=e[o][a];if(!(isNaN(l)||isNaN(u)||isNaN(c)||isNaN(f))){s|=l>=t?8:0,s|=u>=t?4:0,s|=c>=t?2:0;var h,d,p,y,g=!1;if(5==(s|=f>=t?1:0)||10===s){var v=(l+u+c+f)/4;5===s&&v<t?(s=10,g=!0):10===s&&v<t&&(s=5,g=!0)}0!==s&&15!==s&&(h=d=p=y=.5,1===s?(p=1-pe(t,l,f),d=1-pe(t,c,f)):2===s?(d=pe(t,f,c),y=1-pe(t,u,c)):3===s?(p=1-pe(t,l,f),y=1-pe(t,u,c)):4===s?(h=pe(t,l,u),y=pe(t,c,u)):5===s?(h=pe(t,l,u),y=pe(t,c,u),d=1-pe(t,c,f),p=1-pe(t,l,f)):6===s?(d=pe(t,f,c),h=pe(t,l,u)):7===s?(p=1-pe(t,l,f),h=pe(t,l,u)):8===s?(p=pe(t,f,l),h=1-pe(t,u,l)):9===s?(d=1-pe(t,c,f),h=1-pe(t,u,l)):10===s?(h=1-pe(t,u,l),y=1-pe(t,u,c),d=pe(t,f,c),p=pe(t,f,l)):11===s?(h=1-pe(t,u,l),y=1-pe(t,u,c)):12===s?(p=pe(t,f,l),y=pe(t,c,u)):13===s?(d=1-pe(t,c,f),y=pe(t,c,u)):14===s?(p=pe(t,f,l),d=pe(t,f,c)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+s),i.cells[o][a]={cval:s,flipped:g,top:h,right:y,bottom:d,left:p})}}}return i}(e,t));return"function"==typeof he.successCallback&&he.successCallback(s),s}function pe(e,t,r){return(e-t)/(r-t)}function ye(e){return 0===e.cval||15===e.cval}function ge(e){ye(e)||5===e.cval||10===e.cval||(e.cval=15)}function ve(e,t){return"top"===t?[e.top,1]:"bottom"===t?[e.bottom,0]:"right"===t?[1,e.right]:"left"===t?[0,e.left]:void 0}var me=Se,_e=Se;function Se(e,t,r,n,i){!function e(t,r,n,i,o){for(;i>n;){if(i-n>600){var a=i-n+1,s=r-n+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);e(t,r,Math.max(n,Math.floor(r-s*u/a+c)),Math.min(i,Math.floor(r+(a-s)*u/a+c)),o)}var f=t[r],h=n,d=i;for(xe(t,n,r),o(t[i],f)>0&&xe(t,n,i);h<d;){for(xe(t,h,d),h++,d--;o(t[h],f)<0;)h++;for(;o(t[d],f)>0;)d--}0===o(t[n],f)?xe(t,n,d):xe(t,++d,i),d<=r&&(n=d+1),r<=d&&(i=d-1)}}(e,t,r||0,n||e.length-1,i||be)}function xe(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function be(e,t){return e<t?-1:e>t?1:0}me.default=_e;var we=Me,ke=Me;function Me(e,t){if(!(this instanceof Me))return new Me(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&this._initFormat(t),this.clear()}function Ee(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function Ie(e,t){Te(e,0,e.children.length,t,e)}function Te(e,t,r,n,i){i||(i=Ge(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=t;a<r;a++)o=e.children[a],Le(i,e.leaf?n(o):o);return i}function Le(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function Pe(e,t){return e.minX-t.minX}function Ce(e,t){return e.minY-t.minY}function Ne(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Oe(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Re(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function Ve(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function Ge(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ae(e,t,r,n,i){for(var o,a=[t,r];a.length;)(r=a.pop())-(t=a.pop())<=n||(o=t+Math.ceil((r-t)/n/2)*n,me(e,o,t,r,i),a.push(t,o,o,r))}function Fe(e){var t={exports:{}};return e(t,t.exports),t.exports}Me.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,r=[],n=this.toBBox;if(!Ve(e,t))return r;for(var i,o,a,s,l=[];t;){for(i=0,o=t.children.length;i<o;i++)a=t.children[i],Ve(e,s=t.leaf?n(a):a)&&(t.leaf?r.push(a):Re(e,s)?this._all(a,r):l.push(a));t=l.pop()}return r},collides:function(e){var t=this.data,r=this.toBBox;if(!Ve(e,t))return!1;for(var n,i,o,a,s=[];t;){for(n=0,i=t.children.length;n<i;n++)if(o=t.children[n],Ve(e,a=t.leaf?r(o):o)){if(t.leaf||Re(e,a))return!0;s.push(o)}t=s.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=Ge([]),this},remove:function(e,t){if(!e)return this;for(var r,n,i,o,a=this.data,s=this.toBBox(e),l=[],u=[];a||l.length;){if(a||(a=l.pop(),n=l[l.length-1],r=u.pop(),o=!0),a.leaf&&-1!==(i=Ee(e,a.children,t)))return a.children.splice(i,1),l.push(a),this._condense(l),this;o||a.leaf||!Re(a,s)?n?(r++,a=n.children[r],o=!1):a=null:(l.push(a),u.push(r),r=0,n=a,a=a.children[0])}return this},toBBox:function(e){return e},compareMinX:Pe,compareMinY:Ce,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},_build:function(e,t,r,n){var i,o=r-t+1,a=this._maxEntries;if(o<=a)return Ie(i=Ge(e.slice(t,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(i=Ge([])).leaf=!1,i.height=n;var s,l,u,c,f=Math.ceil(o/a),h=f*Math.ceil(Math.sqrt(a));for(Ae(e,t,r,h,this.compareMinX),s=t;s<=r;s+=h)for(Ae(e,s,u=Math.min(s+h-1,r),f,this.compareMinY),l=s;l<=u;l+=f)c=Math.min(l+f-1,u),i.children.push(this._build(e,l,c,n-1));return Ie(i,this.toBBox),i},_chooseSubtree:function(e,t,r,n){for(var i,o,a,s,l,u,c,f,h,d;n.push(t),!t.leaf&&n.length-1!==r;){for(c=f=1/0,i=0,o=t.children.length;i<o;i++)l=Ne(a=t.children[i]),h=e,d=a,(u=(Math.max(d.maxX,h.maxX)-Math.min(d.minX,h.minX))*(Math.max(d.maxY,h.maxY)-Math.min(d.minY,h.minY))-l)<f?(f=u,c=l<c?l:c,s=a):u===f&&l<c&&(c=l,s=a);t=s||t.children[0]}return t},_insert:function(e,t,r){var n=this.toBBox,i=r?e:n(e),o=[],a=this._chooseSubtree(i,this.data,t,o);for(a.children.push(e),Le(a,i);t>=0&&o[t].children.length>this._maxEntries;)this._split(o,t),t--;this._adjustParentBBoxes(i,o,t)},_split:function(e,t){var r=e[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var o=this._chooseSplitIndex(r,i,n),a=Ge(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,Ie(r,this.toBBox),Ie(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(r,a)},_splitRoot:function(e,t){this.data=Ge([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Ie(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,r){var n,i,o,a,s,l,u,c,f,h,d,p,y,g;for(l=u=1/0,n=t;n<=r-t;n++)f=i=Te(e,0,n,this.toBBox),h=o=Te(e,n,r,this.toBBox),d=void 0,p=void 0,y=void 0,g=void 0,d=Math.max(f.minX,h.minX),p=Math.max(f.minY,h.minY),y=Math.min(f.maxX,h.maxX),g=Math.min(f.maxY,h.maxY),a=Math.max(0,y-d)*Math.max(0,g-p),s=Ne(i)+Ne(o),a<l?(l=a,c=n,u=s<u?s:u):a===l&&s<u&&(u=s,c=n);return c},_chooseSplitAxis:function(e,t,r){var n=e.leaf?this.compareMinX:Pe,i=e.leaf?this.compareMinY:Ce;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)},_allDistMargin:function(e,t,r,n){e.children.sort(n);var i,o,a=this.toBBox,s=Te(e,0,t,a),l=Te(e,r-t,r,a),u=Oe(s)+Oe(l);for(i=t;i<r-t;i++)o=e.children[i],Le(s,e.leaf?a(o):o),u+=Oe(s);for(i=r-t-1;i>=t;i--)o=e.children[i],Le(l,e.leaf?a(o):o),u+=Oe(l);return u},_adjustParentBBoxes:function(e,t,r){for(var n=r;n>=0;n--)Le(t[n],e)},_condense:function(e){for(var t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children).splice(t.indexOf(e[r]),1):this.clear():Ie(e[r],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}},we.default=ke;var De=function(e,t,r){var n=e*t,i=je*e,o=i-(i-e),a=e-o,s=je*t,l=s-(s-t),u=t-l,c=a*u-(n-o*l-a*l-o*u);return r?(r[0]=c,r[1]=n,r):[c,n]},je=+(Math.pow(2,27)+1),Be=function(e,t){var r=0|e.length,n=0|t.length;if(1===r&&1===n)return function(e,t){var r=e+t,n=r-e,i=e-(r-n)+(t-n);return i?[i,r]:[r]}(e[0],t[0]);var i,o,a=new Array(r+n),s=0,l=0,u=0,c=Math.abs,f=e[l],h=c(f),d=t[u],p=c(d);h<p?(o=f,(l+=1)<r&&(h=c(f=e[l]))):(o=d,(u+=1)<n&&(p=c(d=t[u]))),l<r&&h<p||u>=n?(i=f,(l+=1)<r&&(h=c(f=e[l]))):(i=d,(u+=1)<n&&(p=c(d=t[u])));for(var y,g,v=i+o,m=v-i,_=o-m,S=_,x=v;l<r&&u<n;)h<p?(i=f,(l+=1)<r&&(h=c(f=e[l]))):(i=d,(u+=1)<n&&(p=c(d=t[u]))),(_=(o=S)-(m=(v=i+o)-i))&&(a[s++]=_),S=x-((y=x+v)-(g=y-x))+(v-g),x=y;for(;l<r;)(_=(o=S)-(m=(v=(i=f)+o)-i))&&(a[s++]=_),S=x-((y=x+v)-(g=y-x))+(v-g),x=y,(l+=1)<r&&(f=e[l]);for(;u<n;)(_=(o=S)-(m=(v=(i=d)+o)-i))&&(a[s++]=_),S=x-((y=x+v)-(g=y-x))+(v-g),x=y,(u+=1)<n&&(d=t[u]);return S&&(a[s++]=S),x&&(a[s++]=x),s||(a[s++]=0),a.length=s,a},qe=function(e,t,r){var n=e+t,i=n-e,o=t-i,a=e-(n-i);return r?(r[0]=a+o,r[1]=n,r):[a+o,n]},Ue=function(e,t){var r=e.length;if(1===r){var n=De(e[0],t);return n[0]?n:[n[1]]}var i=new Array(2*r),o=[.1,.1],a=[.1,.1],s=0;De(e[0],t,o),o[0]&&(i[s++]=o[0]);for(var l=1;l<r;++l){De(e[l],t,a);var u=o[1];qe(u,a[0],o),o[0]&&(i[s++]=o[0]);var c=a[1],f=o[1],h=c+f,d=f-(h-c);o[1]=h,d&&(i[s++]=d)}return o[1]&&(i[s++]=o[1]),0===s&&(i[s++]=0),i.length=s,i},Je=function(e,t){var r=0|e.length,n=0|t.length;if(1===r&&1===n)return function(e,t){var r=e+t,n=r-e,i=e-(r-n)+(t-n);return i?[i,r]:[r]}(e[0],-t[0]);var i,o,a=new Array(r+n),s=0,l=0,u=0,c=Math.abs,f=e[l],h=c(f),d=-t[u],p=c(d);h<p?(o=f,(l+=1)<r&&(h=c(f=e[l]))):(o=d,(u+=1)<n&&(p=c(d=-t[u]))),l<r&&h<p||u>=n?(i=f,(l+=1)<r&&(h=c(f=e[l]))):(i=d,(u+=1)<n&&(p=c(d=-t[u])));for(var y,g,v=i+o,m=v-i,_=o-m,S=_,x=v;l<r&&u<n;)h<p?(i=f,(l+=1)<r&&(h=c(f=e[l]))):(i=d,(u+=1)<n&&(p=c(d=-t[u]))),(_=(o=S)-(m=(v=i+o)-i))&&(a[s++]=_),S=x-((y=x+v)-(g=y-x))+(v-g),x=y;for(;l<r;)(_=(o=S)-(m=(v=(i=f)+o)-i))&&(a[s++]=_),S=x-((y=x+v)-(g=y-x))+(v-g),x=y,(l+=1)<r&&(f=e[l]);for(;u<n;)(_=(o=S)-(m=(v=(i=d)+o)-i))&&(a[s++]=_),S=x-((y=x+v)-(g=y-x))+(v-g),x=y,(u+=1)<n&&(d=-t[u]);return S&&(a[s++]=S),x&&(a[s++]=x),s||(a[s++]=0),a.length=s,a},ze=Fe(function(e){function t(e,t){for(var r=new Array(e.length-1),n=1;n<e.length;++n)for(var i=r[n-1]=new Array(e.length-1),o=0,a=0;o<e.length;++o)o!==t&&(i[a++]=e[n][o]);return r}function r(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",r(e.slice(0,t)),",",r(e.slice(t)),")"].join("")}function n(e){if(2===e.length)return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")];for(var i=[],o=0;o<e.length;++o)i.push(["scale(",r(n(t(e,o))),",",(a=o,1&a?"-":""),e[0][o],")"].join(""));return i;var a}function i(e){for(var i=[],o=[],a=function(e){for(var t=new Array(e),r=0;r<e;++r){t[r]=new Array(e);for(var n=0;n<e;++n)t[r][n]=["m",n,"[",e-r-1,"]"].join("")}return t}(e),s=[],l=0;l<e;++l)0==(1&l)?i.push.apply(i,n(t(a,l))):o.push.apply(o,n(t(a,l))),s.push("m"+l);var u=r(i),c=r(o),f="orientation"+e+"Exact",h=["function ",f,"(",s.join(),"){var p=",u,",n=",c,",d=sub(p,n);return d[d.length-1];};return ",f].join("");return new Function("sum","prod","scale","sub",h)(Be,De,Ue,Je)}var o=i(3),a=i(4),s=[function(){return 0},function(){return 0},function(e,t){return t[0]-e[0]},function(e,t,r){var n,i=(e[1]-r[1])*(t[0]-r[0]),a=(e[0]-r[0])*(t[1]-r[1]),s=i-a;if(i>0){if(a<=0)return s;n=i+a}else{if(!(i<0))return s;if(a>=0)return s;n=-(i+a)}var l=3.3306690738754716e-16*n;return s>=l||s<=-l?s:o(e,t,r)},function(e,t,r,n){var i=e[0]-n[0],o=t[0]-n[0],s=r[0]-n[0],l=e[1]-n[1],u=t[1]-n[1],c=r[1]-n[1],f=e[2]-n[2],h=t[2]-n[2],d=r[2]-n[2],p=o*c,y=s*u,g=s*l,v=i*c,m=i*u,_=o*l,S=f*(p-y)+h*(g-v)+d*(m-_),x=7.771561172376103e-16*((Math.abs(p)+Math.abs(y))*Math.abs(f)+(Math.abs(g)+Math.abs(v))*Math.abs(h)+(Math.abs(m)+Math.abs(_))*Math.abs(d));return S>x||-S>x?S:a(e,t,r,n)}];!function(){for(;s.length<=5;)s.push(i(s.length));for(var t=[],r=["slow"],n=0;n<=5;++n)t.push("a"+n),r.push("o"+n);var o=["function getOrientation(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(n=2;n<=5;++n)o.push("case ",n,":return o",n,"(",t.slice(0,n).join(),");");o.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),r.push(o.join(""));var a=Function.apply(void 0,r);for(e.exports=a.apply(void 0,[function(e){var t=s[e.length];return t||(t=s[e.length]=i(e.length)),t.apply(void 0,e)}].concat(s)),n=0;n<=5;++n)e.exports[n]=s[n]}()}),We=function(e){var t=e.length;if(t<3){for(var r=new Array(t),n=0;n<t;++n)r[n]=n;return 2===t&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:r}var i=new Array(t);for(n=0;n<t;++n)i[n]=n;i.sort(function(t,r){return e[t][0]-e[r][0]||e[t][1]-e[r][1]});var o=[i[0],i[1]],a=[i[0],i[1]];for(n=2;n<t;++n){for(var s=i[n],l=e[s],u=o.length;u>1&&He(e[o[u-2]],e[o[u-1]],l)<=0;)u-=1,o.pop();for(o.push(s),u=a.length;u>1&&He(e[a[u-2]],e[a[u-1]],l)>=0;)u-=1,a.pop();a.push(s)}r=new Array(a.length+o.length-2);for(var c=0,f=(n=0,o.length);n<f;++n)r[c++]=o[n];for(var h=a.length-2;h>0;--h)r[c++]=a[h];return r},He=ze[3],Xe=Ze,Ye=Ze;function Ze(e,t){if(!(this instanceof Ze))return new Ze(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||Ke,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function Ke(e,t){return e<t?-1:e>t?1:0}Ze.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,r=this.compare,n=t[e];e>0;){var i=e-1>>1,o=t[i];if(r(n,o)>=0)break;t[e]=o,e=i}t[e]=n},_down:function(e){for(var t=this.data,r=this.compare,n=this.length>>1,i=t[e];e<n;){var o=1+(e<<1),a=o+1,s=t[o];if(a<this.length&&r(t[a],s)<0&&(o=a,s=t[a]),r(s,i)>=0)break;t[e]=s,e=o}t[e]=i}},Xe.default=Ye;var Qe=function(e,t){for(var r=e[0],n=e[1],i=!1,o=0,a=t.length-1;o<t.length;a=o++){var s=t[o][0],l=t[o][1],u=t[a][0],c=t[a][1];l>n!=c>n&&r<(u-s)*(n-l)/(c-l)+s&&(i=!i)}return i},$e=ze[3],et=rt,tt=rt;function rt(e,t,r){t=Math.max(0,void 0===t?2:t),r=r||0;for(var n,i=function(e){for(var t=e[0],r=e[0],n=e[0],i=e[0],o=0;o<e.length;o++){var a=e[o];a[0]<t[0]&&(t=a),a[0]>n[0]&&(n=a),a[1]<r[1]&&(r=a),a[1]>i[1]&&(i=a)}var s=[t,r,n,i],l=s.slice();for(o=0;o<e.length;o++)Qe(e[o],s)||l.push(e[o]);var u=We(l),c=[];for(o=0;o<u.length;o++)c.push(l[u[o]]);return c}(e),o=we(16,["[0]","[1]","[0]","[1]"]).load(e),a=[],s=0;s<i.length;s++){var l=i[s];o.remove(l),n=ut(l,n),a.push(n)}var u=we(16);for(s=0;s<a.length;s++)u.insert(lt(a[s]));for(var c=t*t,f=r*r;a.length;){var h=a.shift(),d=h.p,p=h.next.p,y=ct(d,p);if(!(y<f)){var g=y/c;(l=nt(o,h.prev.p,d,p,h.next.next.p,g,u))&&Math.min(ct(l,d),ct(l,p))<=g&&(a.push(h),a.push(ut(l,h)),o.remove(l),u.remove(h),u.insert(lt(h)),u.insert(lt(h.next)))}}h=n;var v=[];do{v.push(h.p),h=h.next}while(h!==n);return v.push(h.p),v}function nt(e,t,r,n,i,o,a){for(var s=new Xe(null,it),l=e.data;l;){for(var u=0;u<l.children.length;u++){var c=l.children[u],f=l.leaf?ft(c,r,n):ot(r,n,c);f>o||s.push({node:c,dist:f})}for(;s.length&&!s.peek().node.children;){var h=s.pop(),d=h.node,p=ft(d,t,r),y=ft(d,n,i);if(h.dist<p&&h.dist<y&&st(r,d,a)&&st(n,d,a))return d}(l=s.pop())&&(l=l.node)}return null}function it(e,t){return e.dist-t.dist}function ot(e,t,r){if(at(e,r)||at(t,r))return 0;var n=ht(e[0],e[1],t[0],t[1],r.minX,r.minY,r.maxX,r.minY);if(0===n)return 0;var i=ht(e[0],e[1],t[0],t[1],r.minX,r.minY,r.minX,r.maxY);if(0===i)return 0;var o=ht(e[0],e[1],t[0],t[1],r.maxX,r.minY,r.maxX,r.maxY);if(0===o)return 0;var a=ht(e[0],e[1],t[0],t[1],r.minX,r.maxY,r.maxX,r.maxY);return 0===a?0:Math.min(n,i,o,a)}function at(e,t){return e[0]>=t.minX&&e[0]<=t.maxX&&e[1]>=t.minY&&e[1]<=t.maxY}function st(e,t,r){for(var n,i,o,a,s=Math.min(e[0],t[0]),l=Math.min(e[1],t[1]),u=Math.max(e[0],t[0]),c=Math.max(e[1],t[1]),f=r.search({minX:s,minY:l,maxX:u,maxY:c}),h=0;h<f.length;h++)if(n=f[h].p,i=f[h].next.p,o=e,n!==(a=t)&&i!==o&&$e(n,i,o)>0!=$e(n,i,a)>0&&$e(o,a,n)>0!=$e(o,a,i)>0)return!1;return!0}function lt(e){var t=e.p,r=e.next.p;return e.minX=Math.min(t[0],r[0]),e.minY=Math.min(t[1],r[1]),e.maxX=Math.max(t[0],r[0]),e.maxY=Math.max(t[1],r[1]),e}function ut(e,t){var r={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(r.next=t.next,r.prev=t,t.next.prev=r,t.next=r):(r.prev=r,r.next=r),r}function ct(e,t){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function ft(e,t,r){var n=t[0],i=t[1],o=r[0]-n,a=r[1]-i;if(0!==o||0!==a){var s=((e[0]-n)*o+(e[1]-i)*a)/(o*o+a*a);s>1?(n=r[0],i=r[1]):s>0&&(n+=o*s,i+=a*s)}return(o=e[0]-n)*o+(a=e[1]-i)*a}function ht(e,t,r,n,i,o,a,s){var l,u,c,f,h=r-e,d=n-t,p=a-i,y=s-o,g=e-i,v=t-o,m=h*h+d*d,_=h*p+d*y,S=p*p+y*y,x=h*g+d*v,b=p*g+y*v,w=m*S-_*_,k=w,M=w;0===w?(u=0,k=1,f=b,M=S):(f=m*b-_*x,(u=_*b-S*x)<0?(u=0,f=b,M=S):u>k&&(u=k,f=b+_,M=S)),f<0?(f=0,-x<0?u=0:-x>m?u=k:(u=-x,k=m)):f>M&&(f=M,-x+_<0?u=0:-x+_>m?u=k:(u=-x+_,k=m));var E=(1-(c=0===f?0:f/M))*i+c*a-((1-(l=0===u?0:u/k))*e+l*r),I=(1-c)*o+c*s-((1-l)*t+l*n);return E*E+I*I}function dt(e,t){void 0===t&&(t={}),t.concavity=t.concavity||1/0;var r=[];if(O(e,function(e){r.push([e[0],e[1]])}),!r.length)return null;var n=et(r,t.concavity);return n.length>3?c([n]):null}function pt(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var n=Q(e),i=ie(t),o=i.type,a=t.bbox,s=i.coordinates;if(a&&!1===function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}(n,a))return!1;"Polygon"===o&&(s=[s]);for(var l=!1,u=0;u<s.length&&!l;u++)if(yt(n,s[u][0],r.ignoreBoundary)){for(var c=!1,f=1;f<s[u].length&&!c;)yt(n,s[u][f],!r.ignoreBoundary)&&(c=!0),f++;c||(l=!0)}return l}function yt(e,t,r){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var i=0,o=t.length-1;i<t.length;o=i++){var a=t[i][0],s=t[i][1],l=t[o][0],u=t[o][1];if(e[1]*(a-l)+s*(l-e[0])+u*(e[0]-a)==0&&(a-e[0])*(l-e[0])<=0&&(s-e[1])*(u-e[1])<=0)return!r;s>e[1]!=u>e[1]&&e[0]<(l-a)*(e[1]-s)/(u-s)+a&&(n=!n)}return n}function gt(e,t){var r=[];return A(e,function(e){var n=!1;if("Point"===e.geometry.type)j(t,function(t){pt(e,t)&&(n=!0)}),n&&r.push(e);else{if("MultiPoint"!==e.geometry.type)throw new Error("Input geometry must be a Point or MultiPoint");var i=[];j(t,function(t){O(e,function(e){pt(e,t)&&(n=!0,i.push(e))})}),n&&r.push(g(i))}}),p(r)}function vt(e,t,r){void 0===r&&(r={});var n=Q(e),i=Q(t),o=M(i[1]-n[1]),a=M(i[0]-n[0]),s=M(n[1]),l=M(i[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(l);return S(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),r.units)}function mt(e,t){var r=!1;return p(function(e){if(e.length<3)return[];e.sort(St);for(var t,r,n,i,o,a,s=e.length-1,l=e[s].x,u=e[0].x,c=e[s].y,f=c;s--;)e[s].y<c&&(c=e[s].y),e[s].y>f&&(f=e[s].y);var h,d=u-l,p=f-c,y=d>p?d:p,g=.5*(u+l),v=.5*(f+c),m=[new _t({__sentinel:!0,x:g-20*y,y:v-y},{__sentinel:!0,x:g,y:v+20*y},{__sentinel:!0,x:g+20*y,y:v-y})],_=[],S=[];for(s=e.length;s--;){for(S.length=0,h=m.length;h--;)(d=e[s].x-m[h].x)>0&&d*d>m[h].r?(_.push(m[h]),m.splice(h,1)):d*d+(p=e[s].y-m[h].y)*p>m[h].r||(S.push(m[h].a,m[h].b,m[h].b,m[h].c,m[h].c,m[h].a),m.splice(h,1));for(xt(S),h=S.length;h;)r=S[--h],t=S[--h],n=e[s],i=r.x-t.x,o=r.y-t.y,a=2*(i*(n.y-r.y)-o*(n.x-r.x)),Math.abs(a)>1e-12&&m.push(new _t(t,r,n))}for(Array.prototype.push.apply(_,m),s=_.length;s--;)(_[s].a.__sentinel||_[s].b.__sentinel||_[s].c.__sentinel)&&_.splice(s,1);return _}(e.features.map(function(e){var n={x:e.geometry.coordinates[0],y:e.geometry.coordinates[1]};return t?n.z=e.properties[t]:3===e.geometry.coordinates.length&&(r=!0,n.z=e.geometry.coordinates[2]),n})).map(function(e){var t=[e.a.x,e.a.y],n=[e.b.x,e.b.y],i=[e.c.x,e.c.y],o={};return r?(t.push(e.a.z),n.push(e.b.z),i.push(e.c.z)):o={a:e.a.z,b:e.b.z,c:e.c.z},c([[t,n,i,t]],o)}))}et.default=tt;var _t=function(e,t,r){this.a=e,this.b=t,this.c=r;var n,i,o=t.x-e.x,a=t.y-e.y,s=r.x-e.x,l=r.y-e.y,u=o*(e.x+t.x)+a*(e.y+t.y),c=s*(e.x+r.x)+l*(e.y+r.y),f=2*(o*(r.y-t.y)-a*(r.x-t.x));this.x=(l*u-a*c)/f,this.y=(o*c-s*u)/f,n=this.x-e.x,i=this.y-e.y,this.r=n*n+i*i};function St(e,t){return t.x-e.x}function xt(e){var t,r,n,i,o,a=e.length;e:for(;a;)for(r=e[--a],t=e[--a],n=a;n;)if(o=e[--n],t===(i=e[--n])&&r===o||t===o&&r===i){e.splice(a,2),e.splice(n,2),a-=2;continue e}}function bt(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return wt(e);case"FeatureCollection":return function(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach(function(r){switch(r){case"type":case"features":return;default:t[r]=e[r]}}),t.features=e.features.map(function(e){return wt(e)}),t}(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return kt(e);default:throw new Error("unknown GeoJSON type")}}function wt(e){var t={type:"Feature"};return Object.keys(e).forEach(function(r){switch(r){case"type":case"properties":case"geometry":return;default:t[r]=e[r]}}),t.properties=function e(t){var r={};return t?(Object.keys(t).forEach(function(n){var i=t[n];"object"==typeof i?null===i?r[n]=null:Array.isArray(i)?r[n]=i.map(function(e){return e}):r[n]=e(i):r[n]=i}),r):r}(e.properties),t.geometry=kt(e.geometry),t}function kt(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),"GeometryCollection"===e.type?(t.geometries=e.geometries.map(function(e){return kt(e)}),t):(t.coordinates=function e(t){var r=t;return"object"!=typeof r[0]?r.slice():r.map(function(t){return e(t)})}(e.coordinates),t)}function Mt(e){return e[0].toString()+","+e[1].toString()}function Et(e){return e}function It(e,t){var r=function(e){if(null==e)return Et;var t,r,n=e.scale[0],i=e.scale[1],o=e.translate[0],a=e.translate[1];return function(e,s){s||(t=r=0);var l=2,u=e.length,c=new Array(u);for(c[0]=(t+=e[0])*n+o,c[1]=(r+=e[1])*i+a;l<u;)c[l]=e[l],++l;return c}}(e.transform),n=e.arcs;function i(e,t){t.length&&t.pop();for(var i=n[e<0?~e:e],o=0,a=i.length;o<a;++o)t.push(r(i[o],o));e<0&&function(e,t){for(var r,n=e.length,i=n-t;i<--n;)r=e[i],e[i++]=e[n],e[n]=r}(t,a)}function o(e){return r(e)}function a(e){for(var t=[],r=0,n=e.length;r<n;++r)i(e[r],t);return t.length<2&&t.push(t[0]),t}function s(e){for(var t=a(e);t.length<4;)t.push(t[0]);return t}function l(e){return e.map(s)}return function e(t){var r,n=t.type;switch(n){case"GeometryCollection":return{type:n,geometries:t.geometries.map(e)};case"Point":r=o(t.coordinates);break;case"MultiPoint":r=t.coordinates.map(o);break;case"LineString":r=a(t.arcs);break;case"MultiLineString":r=t.arcs.map(a);break;case"Polygon":r=l(t.arcs);break;case"MultiPolygon":r=t.arcs.map(l);break;default:return null}return{type:n,coordinates:r}}(t)}var Tt=Object.prototype.hasOwnProperty;function Lt(e,t,r,n,i,o){3===arguments.length&&(n=o=Array,i=null);for(var a=new n(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),s=new o(e),l=e-1,u=0;u<e;++u)a[u]=i;return{set:function(n,o){for(var u=t(n)&l,c=a[u],f=0;c!=i;){if(r(c,n))return s[u]=o;if(++f>=e)throw new Error("full hashmap");c=a[u=u+1&l]}return a[u]=n,s[u]=o,o},maybeSet:function(n,o){for(var u=t(n)&l,c=a[u],f=0;c!=i;){if(r(c,n))return s[u];if(++f>=e)throw new Error("full hashmap");c=a[u=u+1&l]}return a[u]=n,s[u]=o,o},get:function(n,o){for(var u=t(n)&l,c=a[u],f=0;c!=i;){if(r(c,n))return s[u];if(++f>=e)break;c=a[u=u+1&l]}return o},keys:function(){for(var e=[],t=0,r=a.length;t<r;++t){var n=a[t];n!=i&&e.push(n)}return e}}}function Pt(e,t){return e[0]===t[0]&&e[1]===t[1]}var Ct=new ArrayBuffer(16),Nt=new Float64Array(Ct),Ot=new Uint32Array(Ct);function Rt(e){Nt[0]=e[0],Nt[1]=e[1];var t=Ot[0]^Ot[1];return 2147483647&(t<<5^t>>7^Ot[2]^Ot[3])}function Vt(e,t,r,n){Gt(e,t,r),Gt(e,t,t+n),Gt(e,t+n,r)}function Gt(e,t,r){for(var n,i=t+(r---t>>1);t<i;++t,--r)n=e[t],e[t]=e[r],e[r]=n}function At(e){var t={type:"GeometryCollection",geometries:e.features.map(Ft)};return null!=e.bbox&&(t.bbox=e.bbox),t}function Ft(e){var t,r=Dt(e.geometry);for(t in null!=e.id&&(r.id=e.id),null!=e.bbox&&(r.bbox=e.bbox),e.properties){r.properties=e.properties;break}return r}function Dt(e){if(null==e)return{type:null};var t="GeometryCollection"===e.type?{type:"GeometryCollection",geometries:e.geometries.map(Dt)}:"Point"===e.type||"MultiPoint"===e.type?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};return null!=e.bbox&&(t.bbox=e.bbox),t}function jt(e){var t,r=e[0],n=e[1];return n<r&&(t=r,r=n,n=t),r+31*n}function Bt(e,t){var r,n=e[0],i=e[1],o=t[0],a=t[1];return i<n&&(r=n,n=i,i=r),a<o&&(r=o,o=a,a=r),n===o&&i===a}function qt(e,t){if(void 0===t&&(t={}),"FeatureCollection"!==oe(e))throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");!1!==t.mutate&&void 0!==t.mutate||(e=bt(e));var r=[];q(e,function(e){r.push(e.geometry)});var n=function(e,t){var r=function(e){var t=1/0,r=1/0,n=-1/0,i=-1/0;function o(e){null!=e&&Tt.call(a,e.type)&&a[e.type](e)}var a={GeometryCollection:function(e){e.geometries.forEach(o)},Point:function(e){s(e.coordinates)},MultiPoint:function(e){e.coordinates.forEach(s)},LineString:function(e){l(e.arcs)},MultiLineString:function(e){e.arcs.forEach(l)},Polygon:function(e){e.arcs.forEach(l)},MultiPolygon:function(e){e.arcs.forEach(u)}};function s(e){var o=e[0],a=e[1];o<t&&(t=o),o>n&&(n=o),a<r&&(r=a),a>i&&(i=a)}function l(e){e.forEach(s)}function u(e){e.forEach(l)}for(var c in e)o(e[c]);return n>=t&&i>=r?[t,r,n,i]:void 0}(e=function(e){var t,r,n={};for(t in e)n[t]=null==(r=e[t])?{type:null}:("FeatureCollection"===r.type?At:"Feature"===r.type?Ft:Dt)(r);return n}(e)),n=t>0&&r&&function(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=o-n?(r-1)/(o-n):1,l=a-i?(r-1)/(a-i):1;function u(e){return[Math.round((e[0]-n)*s),Math.round((e[1]-i)*l)]}function c(e,t){for(var r,o,a,u,c,f=-1,h=0,d=e.length,p=new Array(d);++f<d;)r=e[f],u=Math.round((r[0]-n)*s),c=Math.round((r[1]-i)*l),u===o&&c===a||(p[h++]=[o=u,a=c]);for(p.length=h;h<t;)h=p.push([p[0][0],p[0][1]]);return p}function f(e){return c(e,2)}function h(e){return c(e,4)}function d(e){return e.map(h)}function p(e){null!=e&&Tt.call(y,e.type)&&y[e.type](e)}var y={GeometryCollection:function(e){e.geometries.forEach(p)},Point:function(e){e.coordinates=u(e.coordinates)},MultiPoint:function(e){e.coordinates=e.coordinates.map(u)},LineString:function(e){e.arcs=f(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(f)},Polygon:function(e){e.arcs=d(e.arcs)},MultiPolygon:function(e){e.arcs=e.arcs.map(d)}};for(var g in e)p(e[g]);return{scale:[1/s,1/l],translate:[n,i]}}(e,r,t),i=function(e){var t,r,n,i,o=e.coordinates,a=e.lines,s=e.rings,l=a.length+s.length;for(delete e.lines,delete e.rings,n=0,i=a.length;n<i;++n)for(t=a[n];t=t.next;)++l;for(n=0,i=s.length;n<i;++n)for(r=s[n];r=r.next;)++l;var u=Lt(2*l*1.4,Rt,Pt),c=e.arcs=[];for(n=0,i=a.length;n<i;++n){t=a[n];do{f(t)}while(t=t.next)}for(n=0,i=s.length;n<i;++n)if((r=s[n]).next)do{f(r)}while(r=r.next);else h(r);function f(e){var t,r,n,i,a,s,l,f;if(n=u.get(t=o[e[0]]))for(l=0,f=n.length;l<f;++l)if(d(i=n[l],e))return e[0]=i[0],void(e[1]=i[1]);if(a=u.get(r=o[e[1]]))for(l=0,f=a.length;l<f;++l)if(p(s=a[l],e))return e[1]=s[0],void(e[0]=s[1]);n?n.push(e):u.set(t,[e]),a?a.push(e):u.set(r,[e]),c.push(e)}function h(e){var t,r,n,i,a;if(r=u.get(o[e[0]]))for(i=0,a=r.length;i<a;++i){if(y(n=r[i],e))return e[0]=n[0],void(e[1]=n[1]);if(g(n,e))return e[0]=n[1],void(e[1]=n[0])}if(r=u.get(t=o[e[0]+v(e)]))for(i=0,a=r.length;i<a;++i){if(y(n=r[i],e))return e[0]=n[0],void(e[1]=n[1]);if(g(n,e))return e[0]=n[1],void(e[1]=n[0])}r?r.push(e):u.set(t,[e]),c.push(e)}function d(e,t){var r=e[0],n=t[0],i=e[1];if(r-i!=n-t[1])return!1;for(;r<=i;++r,++n)if(!Pt(o[r],o[n]))return!1;return!0}function p(e,t){var r=e[0],n=t[0],i=e[1],a=t[1];if(r-i!=n-a)return!1;for(;r<=i;++r,--a)if(!Pt(o[r],o[a]))return!1;return!0}function y(e,t){var r=e[0],n=t[0],i=e[1]-r;if(i!==t[1]-n)return!1;for(var a=v(e),s=v(t),l=0;l<i;++l)if(!Pt(o[r+(l+a)%i],o[n+(l+s)%i]))return!1;return!0}function g(e,t){var r=e[0],n=t[0],i=e[1],a=t[1],s=i-r;if(s!==a-n)return!1;for(var l=v(e),u=s-v(t),c=0;c<s;++c)if(!Pt(o[r+(c+l)%s],o[a-(c+u)%s]))return!1;return!0}function v(e){for(var t=e[0],r=e[1],n=t,i=n,a=o[n];++n<r;){var s=o[n];(s[0]<a[0]||s[0]===a[0]&&s[1]<a[1])&&(i=n,a=s)}return i-t}return e}(function(e){var t,r,n,i=function(e){var t,r,n,i,o=e.coordinates,a=e.lines,s=e.rings,l=function(){for(var e=Lt(1.4*o.length,x,b,Int32Array,-1,Int32Array),t=new Int32Array(o.length),r=0,n=o.length;r<n;++r)t[r]=e.maybeSet(r,r);return t}(),u=new Int32Array(o.length),c=new Int32Array(o.length),f=new Int32Array(o.length),h=new Int8Array(o.length),d=0;for(t=0,r=o.length;t<r;++t)u[t]=c[t]=f[t]=-1;for(t=0,r=a.length;t<r;++t){var p=a[t],y=p[0],g=p[1];for(n=l[y],i=l[++y],++d,h[n]=1;++y<=g;)S(t,n,n=i,i=l[y]);++d,h[i]=1}for(t=0,r=o.length;t<r;++t)u[t]=-1;for(t=0,r=s.length;t<r;++t){var v=s[t],m=v[0]+1,_=v[1];for(S(t,l[_-1],n=l[m-1],i=l[m]);++m<=_;)S(t,n,n=i,i=l[m])}function S(e,t,r,n){if(u[r]!==e){u[r]=e;var i=c[r];if(i>=0){var o=f[r];i===t&&o===n||i===n&&o===t||(++d,h[r]=1)}else c[r]=t,f[r]=n}}function x(e){return Rt(o[e])}function b(e,t){return Pt(o[e],o[t])}u=c=f=null;var w,k=function(e,t,r,n,i){3===arguments.length&&(n=Array,i=null);for(var o=new n(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),a=e-1,s=0;s<e;++s)o[s]=i;return{add:function(n){for(var s=t(n)&a,l=o[s],u=0;l!=i;){if(r(l,n))return!0;if(++u>=e)throw new Error("full hashset");l=o[s=s+1&a]}return o[s]=n,!0},has:function(n){for(var s=t(n)&a,l=o[s],u=0;l!=i;){if(r(l,n))return!0;if(++u>=e)break;l=o[s=s+1&a]}return!1},values:function(){for(var e=[],t=0,r=o.length;t<r;++t){var n=o[t];n!=i&&e.push(n)}return e}}}(1.4*d,Rt,Pt);for(t=0,r=o.length;t<r;++t)h[w=l[t]]&&k.add(o[w]);return k}(e),o=e.coordinates,a=e.lines,s=e.rings;for(r=0,n=a.length;r<n;++r)for(var l=a[r],u=l[0],c=l[1];++u<c;)i.has(o[u])&&(t={0:u,1:l[1]},l[1]=u,l=l.next=t);for(r=0,n=s.length;r<n;++r)for(var f=s[r],h=f[0],d=h,p=f[1],y=i.has(o[h]);++d<p;)i.has(o[d])&&(y?(t={0:d,1:f[1]},f[1]=d,f=f.next=t):(Vt(o,h,p,p-d),o[p]=o[h],y=!0,d=h));return e}(function(e){var t=-1,r=[],n=[],i=[];function o(e){e&&Tt.call(a,e.type)&&a[e.type](e)}var a={GeometryCollection:function(e){e.geometries.forEach(o)},LineString:function(e){e.arcs=s(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(s)},Polygon:function(e){e.arcs=e.arcs.map(l)},MultiPolygon:function(e){e.arcs=e.arcs.map(u)}};function s(e){for(var n=0,o=e.length;n<o;++n)i[++t]=e[n];var a={0:t-o+1,1:t};return r.push(a),a}function l(e){for(var r=0,o=e.length;r<o;++r)i[++t]=e[r];var a={0:t-o+1,1:t};return n.push(a),a}function u(e){return e.map(l)}for(var c in e)o(e[c]);return{type:"Topology",coordinates:i,lines:r,rings:n,objects:e}}(e))),o=i.coordinates,a=Lt(1.4*i.arcs.length,jt,Bt);function s(e){e&&Tt.call(l,e.type)&&l[e.type](e)}e=i.objects,i.bbox=r,i.arcs=i.arcs.map(function(e,t){return a.set(e,t),o.slice(e[0],e[1]+1)}),delete i.coordinates,o=null;var l={GeometryCollection:function(e){e.geometries.forEach(s)},LineString:function(e){e.arcs=u(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(u)},Polygon:function(e){e.arcs=e.arcs.map(u)},MultiPolygon:function(e){e.arcs=e.arcs.map(c)}};function u(e){var t=[];do{var r=a.get(e);t.push(e[0]<e[1]?r:~r)}while(e=e.next);return t}function c(e){return e.map(u)}for(var f in e)s(e[f]);return n&&(i.transform=n,i.arcs=function(e){for(var t=-1,r=e.length;++t<r;){for(var n,i,o=e[t],a=0,s=1,l=o.length,u=o[0],c=u[0],f=u[1];++a<l;)n=(u=o[a])[0],i=u[1],n===c&&i===f||(o[s++]=[n-c,i-f],c=n,f=i);1===s&&(o[s++]=[0,0]),o.length=s}return e}(i.arcs)),i}({geoms:m(r).geometry});return function(e){return It(e,function(e,t){var r={},n=[],i=[];function o(e){e.forEach(function(t){t.forEach(function(t){(r[t=t<0?~t:t]||(r[t]=[])).push(e)})}),n.push(e)}function a(t){return function(e){for(var t,r=-1,n=e.length,i=e[n-1],o=0;++r<n;)t=i,i=e[r],o+=t[0]*i[1]-t[1]*i[0];return Math.abs(o)}(It(e,{type:"Polygon",arcs:[t]}).coordinates[0])}return t.forEach(function e(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"Polygon":o(t.arcs);break;case"MultiPolygon":t.arcs.forEach(o)}}),n.forEach(function(e){if(!e._){var t=[],n=[e];for(e._=1,i.push(t);e=n.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){r[e<0?~e:e].forEach(function(e){e._||(e._=1,n.push(e))})})})}}),n.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:i.map(function(t){var n,i=[];if(t.forEach(function(e){e.forEach(function(e){e.forEach(function(e){r[e<0?~e:e].length<2&&i.push(e)})})}),(n=(i=function(e,t){var r={},n={},i={},o=[],a=-1;function s(e,t){for(var n in e){var i=e[n];delete t[i.start],delete i.start,delete i.end,i.forEach(function(e){r[e<0?~e:e]=1}),o.push(i)}}return t.forEach(function(r,n){var i,o=e.arcs[r<0?~r:r];o.length<3&&!o[1][0]&&!o[1][1]&&(i=t[++a],t[a]=r,t[n]=i)}),t.forEach(function(t){var r,o,a=function(t){var r,n=e.arcs[t<0?~t:t],i=n[0];return e.transform?(r=[0,0],n.forEach(function(e){r[0]+=e[0],r[1]+=e[1]})):r=n[n.length-1],t<0?[r,i]:[i,r]}(t),s=a[0],l=a[1];if(r=i[s])if(delete i[r.end],r.push(t),r.end=l,o=n[l]){delete n[o.start];var u=o===r?r:r.concat(o);n[u.start=r.start]=i[u.end=o.end]=u}else n[r.start]=i[r.end]=r;else if(r=n[l])if(delete n[r.start],r.unshift(t),r.start=s,o=i[s]){delete i[o.end];var c=o===r?r:o.concat(r);n[c.start=o.start]=i[c.end=r.end]=c}else n[r.start]=i[r.end]=r;else n[(r=[t]).start=s]=i[r.end=l]=r}),s(i,n),s(n,i),t.forEach(function(e){r[e<0?~e:e]||o.push([e])}),o}(e,i)).length)>1)for(var o,s,l=1,u=a(i[0]);l<n;++l)(o=a(i[l]))>u&&(s=i[0],i[0]=i[l],i[l]=s,u=o);return i}).filter(function(e){return e.length>0})}}.apply(this,arguments))}(n,n.objects.geoms.geometries)}function Ut(e,t){void 0===t&&(t={});var r="object"==typeof t?t.mutate:t;if(!e)throw new Error("geojson is required");var n=oe(e),i=[];switch(n){case"LineString":i=Jt(e);break;case"MultiLineString":case"Polygon":$(e).forEach(function(e){i.push(Jt(e))});break;case"MultiPolygon":$(e).forEach(function(e){var t=[];e.forEach(function(e){t.push(Jt(e))}),i.push(t)});break;case"Point":return e;case"MultiPoint":var o={};$(e).forEach(function(e){var t=e.join("-");Object.prototype.hasOwnProperty.call(o,t)||(i.push(e),o[t]=!0)});break;default:throw new Error(n+" geometry not supported")}return e.coordinates?!0===r?(e.coordinates=i,e):{type:n,coordinates:i}:!0===r?(e.geometry.coordinates=i,e):a({type:n,coordinates:i},e.properties,{bbox:e.bbox,id:e.id})}function Jt(e){var t=$(e);if(2===t.length&&!zt(t[0],t[1]))return t;var r=[],n=t.length-1,i=r.length;r.push(t[0]);for(var o=1;o<n;o++){var a=r[r.length-1];t[o][0]===a[0]&&t[o][1]===a[1]||(r.push(t[o]),(i=r.length)>2&&Wt(r[i-3],r[i-1],r[i-2])&&r.splice(r.length-2,1))}if(r.push(t[t.length-1]),i=r.length,zt(t[0],t[t.length-1])&&i<4)throw new Error("invalid polygon");return Wt(r[i-3],r[i-1],r[i-2])&&r.splice(r.length-2,1),r}function zt(e,t){return e[0]===t[0]&&e[1]===t[1]}function Wt(e,t,r){var n=r[0],i=r[1],o=e[0],a=e[1],s=t[0],l=t[1],u=s-o,c=l-a;return 0==(n-o)*c-(i-a)*u&&(Math.abs(u)>=Math.abs(c)?u>0?o<=n&&n<=s:s<=n&&n<=o:c>0?a<=i&&i<=l:l<=i&&i<=a)}function Ht(e,t,r){var n=t.x,i=t.y,o=r.x-n,a=r.y-i;if(0!==o||0!==a){var s=((e.x-n)*o+(e.y-i)*a)/(o*o+a*a);s>1?(n=r.x,i=r.y):s>0&&(n+=o*s,i+=a*s)}return(o=e.x-n)*o+(a=e.y-i)*a}function Xt(e,t,r){if(e.length<=2)return e;var n=void 0!==t?t*t:1;return function(e,t){var r=e.length-1,n=[e[0]];return function e(t,r,n,i,o){for(var a,s=i,l=r+1;l<n;l++){var u=Ht(t[l],t[r],t[n]);u>s&&(a=l,s=u)}s>i&&(a-r>1&&e(t,r,a,i,o),o.push(t[a]),n-a>1&&e(t,a,n,i,o))}(e,0,r,t,n),n.push(e[r]),n}(e=r?e:function(e,t){for(var r,n,i,o,a,s=e[0],l=[s],u=1,c=e.length;u<c;u++)i=s,o=void 0,a=void 0,(o=(n=r=e[u]).x-i.x)*o+(a=n.y-i.y)*a>t&&(l.push(r),s=r);return s!==r&&l.push(r),l}(e,n),n)}function Yt(e,t,r){return Xt(e.map(function(e){return{x:e[0],y:e[1],z:e[2]}}),t,r).map(function(e){return e.z?[e.x,e.y,e.z]:[e.x,e.y]})}function Zt(e,t,r){return e.map(function(e){var n=e.map(function(e){return{x:e[0],y:e[1]}});if(n.length<4)throw new Error("invalid polygon");for(var i=Xt(n,t,r).map(function(e){return[e.x,e.y]});!Kt(i);)i=Xt(n,t-=.01*t,r).map(function(e){return[e.x,e.y]});return i[i.length-1][0]===i[0][0]&&i[i.length-1][1]===i[0][1]||i.push(i[0]),i})}function Kt(e){return!(e.length<3||3===e.length&&e[2][0]===e[0][0]&&e[2][1]===e[0][1])}var Qt=function(){function e(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(t=0;t<this.length-1;t++){var r=this.points[t],n=this.points[t+1];this.centers.push({x:(r.x+n.x)/2,y:(r.y+n.y)/2,z:(r.z+n.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),t=0;t<this.centers.length-1;t++){var i=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,o=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,a=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+i),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+o),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+a)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+i),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+o),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+a)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return e.prototype.cacheSteps=function(e){var t=[],r=this.pos(0);t.push(0);for(var n=0;n<this.duration;n+=10){var i=this.pos(n);Math.sqrt((i.x-r.x)*(i.x-r.x)+(i.y-r.y)*(i.y-r.y)+(i.z-r.z)*(i.z-r.z))>e&&(t.push(n),r=i)}return t},e.prototype.vector=function(e){var t=this.pos(e+10),r=this.pos(e-10);return{angle:180*Math.atan2(t.y-r.y,t.x-r.x)/3.14,speed:Math.sqrt((r.x-t.x)*(r.x-t.x)+(r.y-t.y)*(r.y-t.y)+(r.z-t.z)*(r.z-t.z))}},e.prototype.pos=function(e){var t=e-this.delay;t<0&&(t=0),t>this.duration&&(t=this.duration-1);var r=t/this.duration;if(r>=1)return this.points[this.length-1];var n=Math.floor((this.points.length-1)*r);return function(e,t,r,n,i){var o=function(e){var t=e*e;return[t*e,3*t*(1-e),3*e*(1-e)*(1-e),(1-e)*(1-e)*(1-e)]}(e);return{x:i.x*o[0]+n.x*o[1]+r.x*o[2]+t.x*o[3],y:i.y*o[0]+n.y*o[1]+r.y*o[2]+t.y*o[3],z:i.z*o[0]+n.z*o[1]+r.z*o[2]+t.z*o[3]}}((this.length-1)*r-n,this.points[n],this.controls[n][1],this.controls[n+1][0],this.points[n+1])},e}();function $t(e,t){void 0===t&&(t={});for(var r=t.resolution||1e4,n=t.sharpness||.85,i=[],o=ie(e).coordinates.map(function(e){return{x:e[0],y:e[1]}}),a=new Qt({duration:r,points:o,sharpness:n}),s=function(e){var t=a.pos(e);Math.floor(e/100)%2==0&&i.push([t.x,t.y])},l=0;l<a.duration;l+=10)s(l);return s(a.duration),h(i,t.properties)}function er(e,t){void 0===t&&(t={});var r=Number(e[0]),n=Number(e[1]),i=Number(e[2]),o=Number(e[3]);if(6===e.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[r,n];return c([[a,[i,n],[i,o],[r,o],a]],t.properties,{bbox:e,id:t.id})}function tr(e){return er(K(e))}function rr(e){var t=e[0],r=e[1],n=e[2],i=e[3];if(vt(e.slice(0,2),[n,r])>=vt(e.slice(0,2),[t,i])){var o=(r+i)/2;return[t,o-(n-t)/2,n,o+(n-t)/2]}var a=(t+n)/2;return[a-(i-r)/2,r,a+(i-r)/2,i]}function nr(e,t,r,n){void 0===n&&(n={});var i=Q(e),o=M(i[0]),a=M(i[1]),s=M(r),u=x(t,n.units),c=Math.asin(Math.sin(a)*Math.cos(u)+Math.cos(a)*Math.sin(u)*Math.cos(s));return l([k(o+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(a),Math.cos(u)-Math.sin(a)*Math.sin(c))),k(c)],n.properties)}function ir(e,t,r){void 0===r&&(r={});for(var n=r.steps||64,i=r.properties?r.properties:!Array.isArray(e)&&"Feature"===e.type&&e.properties?e.properties:{},o=[],a=0;a<n;a++)o.push(nr(e,t,-360*a/n,r).geometry.coordinates);return o.push(o[0]),c([o],i)}function or(e,t,r){if(void 0===r&&(r={}),!0===r.final)return function(e,t){var r=or(t,e);return(r+180)%360}(e,t);var n=Q(e),i=Q(t),o=M(n[0]),a=M(i[0]),s=M(n[1]),l=M(i[1]),u=Math.sin(a-o)*Math.cos(l),c=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(a-o);return k(Math.atan2(u,c))}function ar(e,t){void 0===t&&(t={});var r=K(e);return l([(r[0]+r[2])/2,(r[1]+r[3])/2],t.properties,t)}function sr(e,t){void 0===t&&(t={});var r=0,n=0,i=0;return O(e,function(e){r+=e[0],n+=e[1],i++},!0),l([r/i,n/i],t.properties)}function lr(e){var t=[];return"FeatureCollection"===e.type?A(e,function(e){O(e,function(r){t.push(l(r,e.properties))})}):O(e,function(r){t.push(l(r,e.properties))}),p(t)}var ur=fr,cr=fr;function fr(e,t,r){r=r||2;var n,i,o,a,s,l,u,c=t&&t.length,f=c?t[0]*r:e.length,h=hr(e,0,f,r,!0),d=[];if(!h)return d;if(c&&(h=function(e,t,r,n){var i,o,a,s=[];for(i=0,o=t.length;i<o;i++)(a=hr(e,t[i]*n,i<o-1?t[i+1]*n:e.length,n,!1))===a.next&&(a.steiner=!0),s.push(br(a));for(s.sort(_r),i=0;i<s.length;i++)Sr(s[i],r),r=dr(r,r.next);return r}(e,t,h,r)),e.length>80*r){n=o=e[0],i=a=e[1];for(var p=r;p<f;p+=r)(s=e[p])<n&&(n=s),(l=e[p+1])<i&&(i=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-n,a-i))?1/u:0}return pr(h,d,r,n,i,u),d}function hr(e,t,r,n,i){var o,a;if(i===Or(e,t,r,n)>0)for(o=t;o<r;o+=n)a=Pr(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=Pr(o,e[o],e[o+1],a);return a&&Er(a,a.next)&&(Cr(a),a=a.next),a}function dr(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!Er(n,n.next)&&0!==Mr(n.prev,n,n.next))n=n.next;else{if(Cr(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function pr(e,t,r,n,i,o,a){if(e){!a&&o&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=xr(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,o,a,s,l,u=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1)}(i)}(e,n,i,o);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,o?gr(e,n,i,o):yr(e))t.push(s.i/r),t.push(e.i/r),t.push(l.i/r),Cr(e),e=l.next,u=l.next;else if((e=l)===u){a?1===a?pr(e=vr(e,t,r),t,r,n,i,o,2):2===a&&mr(e,t,r,n,i,o):pr(dr(e),t,r,n,i,o,1);break}}}function yr(e){var t=e.prev,r=e,n=e.next;if(Mr(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(wr(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&Mr(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function gr(e,t,r,n){var i=e.prev,o=e,a=e.next;if(Mr(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=xr(s,l,t,r,n),h=xr(u,c,t,r,n),d=e.prevZ,p=e.nextZ;d&&d.z>=f&&p&&p.z<=h;){if(d!==e.prev&&d!==e.next&&wr(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Mr(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==e.prev&&p!==e.next&&wr(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Mr(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=f;){if(d!==e.prev&&d!==e.next&&wr(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Mr(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&wr(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Mr(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function vr(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!Er(i,o)&&Ir(i,n,n.next,o)&&Tr(i,o)&&Tr(o,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(o.i/r),Cr(n),Cr(n.next),n=e=o),n=n.next}while(n!==e);return n}function mr(e,t,r,n,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&kr(a,s)){var l=Lr(a,s);return a=dr(a,a.next),l=dr(l,l.next),pr(a,t,r,n,i,o),void pr(l,t,r,n,i,o)}s=s.next}a=a.next}while(a!==e)}function _r(e,t){return e.x-t.x}function Sr(e,t){if(t=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===a)return r.prev;var l,u=r,c=r.x,f=r.y,h=1/0;for(n=r.next;n!==u;)i>=n.x&&n.x>=c&&i!==n.x&&wr(o<f?i:a,o,c,f,o<f?a:i,o,n.x,n.y)&&((l=Math.abs(o-n.y)/(i-n.x))<h||l===h&&n.x>r.x)&&Tr(n,e)&&(r=n,h=l),n=n.next;return r}(e,t)){var r=Lr(t,e);dr(r,r.next)}}function xr(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function br(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function wr(e,t,r,n,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(n-s)-(r-a)*(t-s)>=0&&(r-a)*(o-s)-(i-a)*(n-s)>=0}function kr(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Ir(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&Tr(e,t)&&Tr(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function Mr(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Er(e,t){return e.x===t.x&&e.y===t.y}function Ir(e,t,r,n){return!!(Er(e,t)&&Er(r,n)||Er(e,n)&&Er(r,t))||Mr(e,t,r)>0!=Mr(e,t,n)>0&&Mr(r,n,e)>0!=Mr(r,n,t)>0}function Tr(e,t){return Mr(e.prev,e,e.next)<0?Mr(e,t,e.next)>=0&&Mr(e,e.prev,t)>=0:Mr(e,t,e.prev)<0||Mr(e,e.next,t)<0}function Lr(e,t){var r=new Nr(e.i,e.x,e.y),n=new Nr(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function Pr(e,t,r,n){var i=new Nr(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Cr(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Nr(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Or(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}function Rr(e){var t=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}(e),r=ur(t.vertices,t.holes,2),n=[],i=[];r.forEach(function(e,n){var o=r[n];i.push([t.vertices[2*o],t.vertices[2*o+1]])});for(var o=0;o<i.length;o+=3){var a=i.slice(o,o+3);a.push(i[o]),n.push(c([a]))}return n}function Vr(e,t){if(!e)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var r,n=1/0,i=0;return A(t,function(t,r){var o=vt(e,t);o<n&&(i=r,n=o)}),(r=bt(t.features[i])).properties.featureIndex=i,r.properties.distanceToPoint=n,r}function Gr(e){if(!e)throw new Error("geojson is required");var t=[];return q(e,function(e){!function(e,t){var r=[],n=e.geometry;if(null!==n){switch(n.type){case"Polygon":r=$(n);break;case"LineString":r=[$(n)]}r.forEach(function(r){(function(e,t){var r=[];return e.reduce(function(e,n){var i=h([e,n],t);return i.bbox=function(e,t){var r=e[0],n=e[1],i=t[0],o=t[1];return[r<i?r:i,n<o?n:o,r>i?r:i,n>o?n:o]}(e,n),r.push(i),n}),r})(r,e.properties).forEach(function(e){e.id=t.length,t.push(e)})})}}(e,t)}),p(t)}fr.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(Or(e,0,o,r));if(i)for(var s=0,l=t.length;s<l;s++){var u=t[s]*r,c=s<l-1?t[s+1]*r:e.length;a-=Math.abs(Or(e,u,c,r))}var f=0;for(s=0;s<n.length;s+=3){var h=n[s]*r,d=n[s+1]*r,p=n[s+2]*r;f+=Math.abs((e[h]-e[p])*(e[d+1]-e[h+1])-(e[h]-e[d])*(e[p+1]-e[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},fr.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r},ur.default=cr;var Ar=Fe(function(e,t){function r(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function n(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(e[0])||!d(e[1]))throw new Error("coordinates must contain numbers");return r({type:"Point",coordinates:e},t,n)}function i(e,t,n){void 0===n&&(n={});for(var i=0,o=e;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:e},t,n)}function o(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:e},t,n)}function a(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function s(e,t,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:e},t,n)}function l(e,t,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:e},t,n)}function u(e,t,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:e},t,n)}function c(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e*n}function f(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e/n}function h(e){return e%(2*Math.PI)*180/Math.PI}function d(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:1.0936*t.earthRadius},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:3.86e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=function(e,t,r){switch(e){case"Point":return n(t).geometry;case"LineString":return o(t).geometry;case"Polygon":return i(t).geometry;case"MultiPoint":return l(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return u(t).geometry;default:throw new Error(e+" is invalid")}},t.point=n,t.points=function(e,t,r){return void 0===r&&(r={}),a(e.map(function(e){return n(e,t)}),r)},t.polygon=i,t.polygons=function(e,t,r){return void 0===r&&(r={}),a(e.map(function(e){return i(e,t)}),r)},t.lineString=o,t.lineStrings=function(e,t,r){return void 0===r&&(r={}),a(e.map(function(e){return o(e,t)}),r)},t.featureCollection=a,t.multiLineString=s,t.multiPoint=l,t.multiPolygon=u,t.geometryCollection=function(e,t,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:e},t,n)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},t.radiansToLength=c,t.lengthToRadians=f,t.lengthToDegrees=function(e,t){return h(f(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=h,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return c(f(e,t),r)},t.convertArea=function(e,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var i=t.areaFactors[r];if(!i)throw new Error("invalid original units");var o=t.areaFactors[n];if(!o)throw new Error("invalid final units");return e/i*o},t.isNumber=d,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!d(e))throw new Error("bbox must only contain numbers")})},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}});function Fr(e,t,r){if(null!==e)for(var n,i,o,a,s,l,u,c,f=0,h=0,d=e.type,p="FeatureCollection"===d,y="Feature"===d,g=p?e.features.length:1,v=0;v<g;v++){s=(c=!!(u=p?e.features[v].geometry:y?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var m=0;m<s;m++){var _=0,S=0;if(null!==(a=c?u.geometries[m]:u)){l=a.coordinates;var x=a.type;switch(f=!r||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===t(l,h,v,_,S))return!1;h++,_++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===t(l[n],h,v,_,S))return!1;h++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-f;i++){if(!1===t(l[n][i],h,v,_,S))return!1;h++}"MultiLineString"===x&&_++,"Polygon"===x&&S++}"Polygon"===x&&_++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(S=0,i=0;i<l[n].length;i++){for(o=0;o<l[n][i].length-f;o++){if(!1===t(l[n][i][o],h,v,_,S))return!1;h++}S++}_++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===Fr(a.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Dr(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function jr(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function Br(e,t){var r,n,i,o,a,s,l,u,c,f,h=0,d="FeatureCollection"===e.type,p="Feature"===e.type,y=d?e.features.length:1;for(r=0;r<y;r++){for(s=d?e.features[r].geometry:p?e.geometry:e,u=d?e.features[r].properties:p?e.properties:{},c=d?e.features[r].bbox:p?e.bbox:void 0,f=d?e.features[r].id:p?e.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=l?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,h,u,c,f))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===t(o.geometries[n],h,u,c,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,h,u,c,f))return!1;h++}}function qr(e,t){Br(e,function(e,r,n,i,o){var a,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(Ar.feature(e,n,{bbox:i,id:o}),r,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var l=0;l<e.coordinates.length;l++){var u={type:a,coordinates:e.coordinates[l]};if(!1===t(Ar.feature(u,n),r,l))return!1}})}function Ur(e,t){qr(e,function(e,r,n){var i=0;if(e.geometry){var o=e.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var a,s=0,l=0,u=0;return!1!==Fr(e,function(o,c,f,h,d){if(void 0===a||r>s||h>l||d>u)return a=o,s=r,l=h,u=d,void(i=0);var p=Ar.lineString([a,o],e.properties);if(!1===t(p,r,n,d,i))return!1;i++,a=o})&&void 0}}})}function Jr(e,t){if(!e)throw new Error("geojson is required");qr(e,function(e,r,n){if(null!==e.geometry){var i=e.geometry.type,o=e.geometry.coordinates;switch(i){case"LineString":if(!1===t(e,r,n,0,0))return!1;break;case"Polygon":for(var a=0;a<o.length;a++)if(!1===t(Ar.lineString(o[a],e.properties),r,n,a))return!1}}})}var zr=Fr,Wr=jr,Hr=qr,Xr=Br,Yr=Jr,Zr=Dr,Kr=Ur,Qr=Object.defineProperty({coordAll:function(e){var t=[];return Fr(e,function(e){t.push(e)}),t},coordEach:zr,coordReduce:function(e,t,r,n){var i=r;return Fr(e,function(e,n,o,a,s){i=0===n&&void 0===r?e:t(i,e,n,o,a,s)},n),i},featureEach:Wr,featureReduce:function(e,t,r){var n=r;return jr(e,function(e,i){n=0===i&&void 0===r?e:t(n,e,i)}),n},findPoint:function(e,t){if(t=t||{},!Ar.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,a=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":return Ar.point(l,s,t);case"MultiPoint":return i<0&&(i=l.length+i),Ar.point(l[i],s,t);case"LineString":return a<0&&(a=l.length+a),Ar.point(l[a],s,t);case"Polygon":return o<0&&(o=l.length+o),a<0&&(a=l[o].length+a),Ar.point(l[o][a],s,t);case"MultiLineString":return i<0&&(i=l.length+i),a<0&&(a=l[i].length+a),Ar.point(l[i][a],s,t);case"MultiPolygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),a<0&&(a=l[i][o].length-a),Ar.point(l[i][o][a],s,t)}throw new Error("geojson is invalid")},findSegment:function(e,t){if(t=t||{},!Ar.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,a=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=l.length+a-1),Ar.lineString([l[a],l[a+1]],s,t);case"Polygon":return o<0&&(o=l.length+o),a<0&&(a=l[o].length+a-1),Ar.lineString([l[o][a],l[o][a+1]],s,t);case"MultiLineString":return i<0&&(i=l.length+i),a<0&&(a=l[i].length+a-1),Ar.lineString([l[i][a],l[i][a+1]],s,t);case"MultiPolygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),a<0&&(a=l[i][o].length-a-1),Ar.lineString([l[i][o][a],l[i][o][a+1]],s,t)}throw new Error("geojson is invalid")},flattenEach:Hr,flattenReduce:function(e,t,r){var n=r;return qr(e,function(e,i,o){n=0===i&&0===o&&void 0===r?e:t(n,e,i,o)}),n},geomEach:Xr,geomReduce:function(e,t,r){var n=r;return Br(e,function(e,i,o,a,s){n=0===i&&void 0===r?e:t(n,e,i,o,a,s)}),n},lineEach:Yr,lineReduce:function(e,t,r){var n=r;return Jr(e,function(e,i,o,a){n=0===i&&void 0===r?e:t(n,e,i,o,a)}),n},propEach:Zr,propReduce:function(e,t,r){var n=r;return Dr(e,function(e,i){n=0===i&&void 0===r?e:t(n,e,i)}),n},segmentEach:Kr,segmentReduce:function(e,t,r){var n=r,i=!1;return Ur(e,function(e,o,a,s,l){n=!1===i&&void 0===r?e:t(n,e,o,a,s,l),i=!0}),n}},"__esModule",{value:!0});function $r(e){var t=[1/0,1/0,-1/0,-1/0];return Qr.coordEach(e,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}$r.default=$r;var en=$r,tn=Object.defineProperty({default:en},"__esModule",{value:!0}).default,rn=Qr.featureEach,nn=(Qr.coordEach,Ar.polygon,Ar.featureCollection);function on(e){var t=we(e);return t.insert=function(e){if("Feature"!==e.type)throw new Error("invalid feature");return e.bbox=e.bbox?e.bbox:tn(e),we.prototype.insert.call(this,e)},t.load=function(e){var t=[];return Array.isArray(e)?e.forEach(function(e){if("Feature"!==e.type)throw new Error("invalid features");e.bbox=e.bbox?e.bbox:tn(e),t.push(e)}):rn(e,function(e){if("Feature"!==e.type)throw new Error("invalid features");e.bbox=e.bbox?e.bbox:tn(e),t.push(e)}),we.prototype.load.call(this,t)},t.remove=function(e,t){if("Feature"!==e.type)throw new Error("invalid feature");return e.bbox=e.bbox?e.bbox:tn(e),we.prototype.remove.call(this,e,t)},t.clear=function(){return we.prototype.clear.call(this)},t.search=function(e){var t=we.prototype.search.call(this,this.toBBox(e));return nn(t)},t.collides=function(e){return we.prototype.collides.call(this,this.toBBox(e))},t.all=function(){var e=we.prototype.all.call(this);return nn(e)},t.toJSON=function(){return we.prototype.toJSON.call(this)},t.fromJSON=function(e){return we.prototype.fromJSON.call(this,e)},t.toBBox=function(e){var t;if(e.bbox)t=e.bbox;else if(Array.isArray(e)&&4===e.length)t=e;else if(Array.isArray(e)&&6===e.length)t=[e[0],e[1],e[3],e[4]];else if("Feature"===e.type)t=tn(e);else{if("FeatureCollection"!==e.type)throw new Error("invalid geojson");t=tn(e)}return{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}},t}var an=on,sn=on;function ln(e,t){var r={},n=[];if("LineString"===e.type&&(e=a(e)),"LineString"===t.type&&(t=a(t)),"Feature"===e.type&&"Feature"===t.type&&null!==e.geometry&&null!==t.geometry&&"LineString"===e.geometry.type&&"LineString"===t.geometry.type&&2===e.geometry.coordinates.length&&2===t.geometry.coordinates.length){var i=un(e,t);return i&&n.push(i),p(n)}var o=an();return o.load(Gr(t)),A(Gr(e),function(e){A(o.search(e),function(t){var i=un(e,t);if(i){var o=$(i).join(",");r[o]||(r[o]=!0,n.push(i))}})}),p(n)}function un(e,t){var r=$(e),n=$(t);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=r[0][0],o=r[0][1],a=r[1][0],s=r[1][1],u=n[0][0],c=n[0][1],f=n[1][0],h=n[1][1],d=(h-c)*(a-i)-(f-u)*(s-o),p=(f-u)*(o-c)-(h-c)*(i-u),y=(a-i)*(o-c)-(s-o)*(i-u);if(0===d)return null;var g=p/d,v=y/d;return g>=0&&g<=1&&v>=0&&v<=1?l([i+g*(a-i),o+g*(s-o)]):null}function cn(e,t,r){void 0===r&&(r={});var n=l([1/0,1/0],{dist:1/0}),i=0;return q(e,function(e){for(var o=$(e),a=0;a<o.length-1;a++){var s=l(o[a]);s.properties.dist=vt(t,s,r);var u=l(o[a+1]);u.properties.dist=vt(t,u,r);var c=vt(s,u,r),f=Math.max(s.properties.dist,u.properties.dist),d=or(s,u),p=nr(t,f,d+90,r),y=nr(t,f,d-90,r),g=ln(h([p.geometry.coordinates,y.geometry.coordinates]),h([s.geometry.coordinates,u.geometry.coordinates])),v=null;g.features.length>0&&((v=g.features[0]).properties.dist=vt(t,v,r),v.properties.location=i+vt(s,v,r)),s.properties.dist<n.properties.dist&&((n=s).properties.index=a,n.properties.location=i),u.properties.dist<n.properties.dist&&((n=u).properties.index=a+1,n.properties.location=i+c),v&&v.properties.dist<n.properties.dist&&((n=v).properties.index=a),i+=c}}),n}function fn(e,t,n){void 0===n&&(n={});var i=Q(e),o=Q(t);return o[0]+=o[0]-i[0]>180?-360:i[0]-o[0]>180?360:0,E(function(e,t,n){var i=n=void 0===n?r:Number(n),o=e[1]*Math.PI/180,a=t[1]*Math.PI/180,s=a-o,l=Math.abs(t[0]-e[0])*Math.PI/180;l>Math.PI&&(l-=2*Math.PI);var u=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),c=Math.abs(u)>1e-11?s/u:Math.cos(o);return Math.sqrt(s*s+c*c*l*l)*i}(i,o),"meters",n.units)}function hn(e,t,r){if(void 0===r&&(r={}),r.method||(r.method="geodesic"),r.units||(r.units="kilometers"),!e)throw new Error("pt is required");if(Array.isArray(e)?e=l(e):"Point"===e.type?e=a(e):re(e,"Point","point"),!t)throw new Error("line is required");Array.isArray(t)?t=h(t):"LineString"===t.type?t=a(t):re(t,"LineString","line");var n=1/0,i=e.geometry.coordinates;return J(t,function(e){var t=e.geometry.coordinates[0],o=e.geometry.coordinates[1],a=function(e,t,r,n){var i=[r[0]-t[0],r[1]-t[1]],o=dn([e[0]-t[0],e[1]-t[1]],i);if(o<=0)return pn(e,t,{method:n.method,units:"degrees"});var a=dn(i,i);if(a<=o)return pn(e,r,{method:n.method,units:"degrees"});var s=o/a;return pn(e,[t[0]+s*i[0],t[1]+s*i[1]],{method:n.method,units:"degrees"})}(i,t,o,r);a<n&&(n=a)}),E(n,"degrees",r.units)}function dn(e,t){return e[0]*t[0]+e[1]*t[1]}function pn(e,t,r){return"planar"===r.method?fn(e,t,r):vt(e,t,r)}function yn(e,t,r,n,i,o,a,s){var l,u,c,f,h={x:null,y:null,onLine1:!1,onLine2:!1};return 0==(l=(s-o)*(r-e)-(a-i)*(n-t))?null!==h.x&&null!==h.y&&h:(f=(r-e)*(u=t-o)-(n-t)*(c=e-i),u=((a-i)*u-(s-o)*c)/l,c=f/l,h.x=e+u*(r-e),h.y=t+u*(n-t),u>=0&&u<=1&&(h.onLine1=!0),c>=0&&c<=1&&(h.onLine2=!0),!(!h.onLine1||!h.onLine2)&&[h.x,h.y])}function gn(e){for(var t=function(e){return"FeatureCollection"!==e.type?"Feature"!==e.type?p([a(e)]):p([e]):e}(e),r=ar(t),n=!1,i=0;!n&&i<t.features.length;){var o,s=t.features[i].geometry,u=!1;if("Point"===s.type)r.geometry.coordinates[0]===s.coordinates[0]&&r.geometry.coordinates[1]===s.coordinates[1]&&(n=!0);else if("MultiPoint"===s.type){var c=!1;for(o=0;!c&&o<s.coordinates.length;)r.geometry.coordinates[0]===s.coordinates[o][0]&&r.geometry.coordinates[1]===s.coordinates[o][1]&&(n=!0,c=!0),o++}else if("LineString"===s.type)for(o=0;!u&&o<s.coordinates.length-1;)vn(r.geometry.coordinates[0],r.geometry.coordinates[1],s.coordinates[o][0],s.coordinates[o][1],s.coordinates[o+1][0],s.coordinates[o+1][1])&&(u=!0,n=!0),o++;else if("MultiLineString"===s.type)for(var f=0;f<s.coordinates.length;){u=!1,o=0;for(var h=s.coordinates[f];!u&&o<h.length-1;)vn(r.geometry.coordinates[0],r.geometry.coordinates[1],h[o][0],h[o][1],h[o+1][0],h[o+1][1])&&(u=!0,n=!0),o++;f++}else"Polygon"!==s.type&&"MultiPolygon"!==s.type||pt(r,s)&&(n=!0);i++}if(n)return r;var d=p([]);for(i=0;i<t.features.length;i++)d.features=d.features.concat(lr(t.features[i]).features);return l(Vr(r,d).geometry.coordinates)}function vn(e,t,r,n,i,o){return Math.sqrt((i-r)*(i-r)+(o-n)*(o-n))===Math.sqrt((e-r)*(e-r)+(t-n)*(t-n))+Math.sqrt((i-e)*(i-e)+(o-t)*(o-t))}an.default=sn;var mn=6378137;function _n(e){return B(e,function(e,t){return e+function(e){var t,r=0;switch(e.type){case"Polygon":return Sn(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)r+=Sn(e.coordinates[t]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)},0)}function Sn(e){var t=0;if(e&&e.length>0){t+=Math.abs(xn(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(xn(e[r]))}return t}function xn(e){var t,r,n,i,o,a,s=0,l=e.length;if(l>2){for(a=0;a<l;a++)a===l-2?(n=l-2,i=l-1,o=0):a===l-1?(n=l-1,i=0,o=1):(n=a,i=a+1,o=a+2),t=e[n],r=e[i],s+=(bn(e[o][0])-bn(t[0]))*Math.sin(bn(r[1]));s=s*mn*mn/2}return s}function bn(e){return e*Math.PI/180}function wn(e,t){return void 0===t&&(t={}),z(e,function(e,r){var n=r.geometry.coordinates;return e+vt(n[0],n[1],t)},0)}function kn(e,t,r,n){if(!L(n=n||{}))throw new Error("options is invalid");var i,o=[];if("Feature"===e.type)i=e.geometry.coordinates;else{if("LineString"!==e.type)throw new Error("input must be a LineString Feature or Geometry");i=e.coordinates}for(var a,s,l,u=i.length,c=0,f=0;f<i.length&&!(t>=c&&f===i.length-1);f++){if(c>t&&0===o.length){if(!(a=t-c))return o.push(i[f]),h(o);s=or(i[f],i[f-1])-180,l=nr(i[f],a,s,n),o.push(l.geometry.coordinates)}if(c>=r)return(a=r-c)?(s=or(i[f],i[f-1])-180,l=nr(i[f],a,s,n),o.push(l.geometry.coordinates),h(o)):(o.push(i[f]),h(o));if(c>=t&&o.push(i[f]),f===i.length-1)return h(o);c+=vt(i[f],i[f+1],n)}if(c<t&&i.length===u)throw new Error("Start position is beyond line");var d=i[i.length-1];return h([d,d])}function Mn(e,t,r){void 0===r&&(r={});for(var n=Q(e),i=$(t),o=0;o<i.length-1;o++){var a=!1;if(r.ignoreEndVertices&&(0===o&&(a="start"),o===i.length-2&&(a="end"),0===o&&o+1===i.length-1&&(a="both")),En(i[o],i[o+1],n,a,void 0===r.epsilon?null:r.epsilon))return!0}return!1}function En(e,t,r,n,i){var o=r[0],a=r[1],s=e[0],l=e[1],u=t[0],c=t[1],f=u-s,h=c-l,d=(r[0]-s)*h-(r[1]-l)*f;if(null!==i){if(Math.abs(d)>i)return!1}else if(0!==d)return!1;return n?"start"===n?Math.abs(f)>=Math.abs(h)?f>0?s<o&&o<=u:u<=o&&o<s:h>0?l<a&&a<=c:c<=a&&a<l:"end"===n?Math.abs(f)>=Math.abs(h)?f>0?s<=o&&o<u:u<o&&o<=s:h>0?l<=a&&a<c:c<a&&a<=l:"both"===n&&(Math.abs(f)>=Math.abs(h)?f>0?s<o&&o<u:u<o&&o<s:h>0?l<a&&a<c:c<a&&a<l):Math.abs(f)>=Math.abs(h)?f>0?s<=o&&o<=u:u<=o&&o<=s:h>0?l<=a&&a<=c:c<=a&&a<=l}function In(e,t){var r=ie(e),n=ie(t),i=r.type,o=n.type;switch(i){case"Point":switch(o){case"MultiPoint":return function(e,t){var r,n=!1;for(r=0;r<t.coordinates.length;r++)if(Ln(t.coordinates[r],e.coordinates)){n=!0;break}return n}(r,n);case"LineString":return Mn(r,n,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return pt(r,n,{ignoreBoundary:!0});default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"MultiPoint":return function(e,t){for(var r=0;r<e.coordinates.length;r++){for(var n=!1,i=0;i<t.coordinates.length;i++)Ln(e.coordinates[r],t.coordinates[i])&&(n=!0);if(!n)return!1}return!0}(r,n);case"LineString":return function(e,t){for(var r=!1,n=0;n<e.coordinates.length;n++){if(!Mn(e.coordinates[n],t))return!1;r||(r=Mn(e.coordinates[n],t,{ignoreEndVertices:!0}))}return r}(r,n);case"Polygon":case"MultiPolygon":return function(e,t){for(var r=!0,n=!1,i=0;i<e.coordinates.length;i++){if(!(n=pt(e.coordinates[1],t))){r=!1;break}n=pt(e.coordinates[1],t,{ignoreBoundary:!0})}return r&&n}(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"LineString":return function(e,t){for(var r=0;r<e.coordinates.length;r++)if(!Mn(e.coordinates[r],t))return!1;return!0}(r,n);case"Polygon":case"MultiPolygon":return function(e,t){if(!Tn(K(t),K(e)))return!1;for(var r=!1,n=0;n<e.coordinates.length-1;n++){if(!pt(e.coordinates[n],t))return!1;r||(r=pt(e.coordinates[n],t,{ignoreBoundary:!0})),r||(r=pt(Pn(e.coordinates[n],e.coordinates[n+1]),t,{ignoreBoundary:!0}))}return r}(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Polygon":case"MultiPolygon":return function(e,t){var r=K(e);if(!Tn(K(t),r))return!1;for(var n=0;n<e.coordinates[0].length;n++)if(!pt(e.coordinates[0][n],t))return!1;return!0}(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function Tn(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function Ln(e,t){return e[0]===t[0]&&e[1]===t[1]}function Pn(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function Cn(e,t,r){void 0===r&&(r={}),r.mask&&!r.units&&(r.units="kilometers");for(var n=[],i=e[0],o=e[1],a=e[2],s=e[3],u=t/vt([i,o],[a,o],r)*(a-i),c=t/vt([i,o],[i,s],r)*(s-o),f=a-i,h=s-o,d=Math.floor(f/u),y=(h-Math.floor(h/c)*c)/2,g=i+(f-d*u)/2;g<=a;){for(var v=o+y;v<=s;){var m=l([g,v],r.properties);r.mask?In(m,r.mask)&&n.push(m):n.push(m),v+=c}g+=u}return p(n)}function Nn(e,t){void 0===t&&(t={});var r=t.precision,n=t.coordinates,i=t.mutate;if(r=null==r||isNaN(r)?6:r,n=null==n||isNaN(n)?3:n,!e)throw new Error("<geojson> is required");if("number"!=typeof r)throw new Error("<precision> must be a number");if("number"!=typeof n)throw new Error("<coordinates> must be a number");!1!==i&&void 0!==i||(e=JSON.parse(JSON.stringify(e)));var o=Math.pow(10,r);return O(e,function(e){!function(e,t,r){e.length>r&&e.splice(r,e.length);for(var n=0;n<e.length;n++)e[n]=Math.round(e[n]*t)/t}(e,o,n)}),e}function On(e){if(!e)throw new Error("geojson is required");var t=[];return q(e,function(e){t.push(e)}),p(t)}function Rn(e,t){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]instanceof Array&&t[r]instanceof Array){if(!Rn(e[r],t[r]))return!1}else if(e[r]!==t[r])return!1;return!0}var Vn=function(e,t,r,n,i){this.coord=e,this.param=t,this.ringAndEdgeIn=r,this.ringAndEdgeOut=n,this.nxtIsectAlongEdgeIn=i},Gn=function(e,t,r,n,i,o,a){this.coord=e,this.ringAndEdge1=t,this.ringAndEdge2=r,this.nxtIsectAlongRingAndEdge1=n,this.nxtIsectAlongRingAndEdge2=i,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=a};function An(e,t){if(void 0===t&&(t=!0),3!=e.length)throw new Error("This function requires an array of three points [x,y]");return(e[1][0]-e[0][0])*(e[2][1]-e[0][1])-(e[1][1]-e[0][1])*(e[2][0]-e[0][0])>=0==t}function Fn(e){for(var t=0,r=0;r<e.length-1;r++)e[r][0]<e[t][0]&&(t=r);if(An([e[jn(t-1,e.length-1)],e[t],e[jn(t+1,e.length-1)]],!0))var n=1;else n=-1;return n}function Dn(e,t){if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]instanceof Array&&t[r]instanceof Array){if(!Dn(e[r],t[r]))return!1}else if(e[r]!=t[r])return!1;return!0}function jn(e,t){return(e%t+t)%t}var Bn=Math.PI/180,qn=180/Math.PI,Un=function(e,t){this.lon=e,this.lat=t,this.x=Bn*e,this.y=Bn*t};Un.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Un.prototype.antipode=function(){var e=-1*this.lat,t=this.lon<0?180+this.lon:-1*(180-this.lon);return new Un(t,e)};var Jn=function(){this.coords=[],this.length=0};Jn.prototype.move_to=function(e){this.length++,this.coords.push(e)};var zn=function(e){this.properties=e||{},this.geometries=[]};zn.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var e=[],t=0;t<this.geometries.length;t++)e.push(this.geometries[t].coords);return{geometry:{type:"MultiLineString",coordinates:e},type:"Feature",properties:this.properties}},zn.prototype.wkt=function(){for(var e="",t="LINESTRING(",r=function(e){t+=e[0]+" "+e[1]+","},n=0;n<this.geometries.length;n++){if(0===this.geometries[n].coords.length)return"LINESTRING(empty)";this.geometries[n].coords.forEach(r),e+=t.substring(0,t.length-1)+")"}return e};var Wn=function(e,t,r){if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Un(e.x,e.y),this.end=new Un(t.x,t.y),this.properties=r||{};var n=this.start.x-this.end.x,i=this.start.y-this.end.y,o=Math.pow(Math.sin(i/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(n/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+e.view()+" and "+t.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+e+" and "+t)};function Hn(e,t){var r=[],n=an();return q(t,function(t){if(r.forEach(function(e,t){e.id=t}),r.length){var i=n.search(t);if(i.features.length){var o=Yn(t,i);r=r.filter(function(e){return e.id!==o.id}),n.remove(o),A(Xn(o,t),function(e){r.push(e),n.insert(e)})}}else(r=Xn(e,t).features).forEach(function(e){e.bbox||(e.bbox=rr(K(e)))}),n.load(p(r))}),p(r)}function Xn(e,t){var r=[],n=$(e)[0],i=$(e)[e.geometry.coordinates.length-1];if(Zn(n,Q(t))||Zn(i,Q(t)))return p([e]);var o=an(),a=Gr(e);o.load(a);var s=o.search(t);if(!s.features.length)return p([e]);var l=Yn(t,s),u=F(a,function(e,n,i){var o=$(n)[1],a=Q(t);return i===l.id?(e.push(a),r.push(h(e)),Zn(a,o)?[a]:[a,o]):(e.push(o),e)},[n]);return u.length>1&&r.push(h(u)),p(r)}function Yn(e,t){if(!t.features.length)throw new Error("lines must contain features");if(1===t.features.length)return t.features[0];var r,n=1/0;return A(t,function(t){var i=cn(t,e).properties.dist;i<n&&(r=t,n=i)}),r}function Zn(e,t){return e[0]===t[0]&&e[1]===t[1]}function Kn(e,t,r,n,i){void 0===i&&(i={});var o=i.steps||64,a=Qn(r),s=Qn(n),l=Array.isArray(e)||"Feature"!==e.type?{}:e.properties;if(a===s)return h(ir(e,t,i).geometry.coordinates[0],l);for(var u=a,c=a<s?s:s+360,f=u,d=[],p=0;f<c;)d.push(nr(e,t,f,i).geometry.coordinates),f=u+360*++p/o;return f>c&&d.push(nr(e,t,c,i).geometry.coordinates),h(d,l)}function Qn(e){var t=e%360;return t<0&&(t+=360),t}function $n(e,t){void 0===t&&(t={});var r=ie(e);switch(t.properties||"Feature"!==e.type||(t.properties=e.properties),r.type){case"Polygon":return ei(r,t);case"MultiPolygon":return function(e,t){void 0===t&&(t={});var r=ie(e).coordinates,n=t.properties?t.properties:"Feature"===e.type?e.properties:{},i=[];return r.forEach(function(e){i.push(ti(e,n))}),p(i)}(r,t);default:throw new Error("invalid poly")}}function ei(e,t){return void 0===t&&(t={}),ti(ie(e).coordinates,t.properties?t.properties:"Feature"===e.type?e.properties:{})}function ti(e,t){return e.length>1?y(e,t):h(e[0],t)}function ri(e,t){var r,n,i;void 0===t&&(t={});var o=t.properties,a=null===(r=t.autoComplete)||void 0===r||r,s=null===(n=t.orderCoords)||void 0===n||n;switch(null!==(i=t.mutate)&&void 0!==i&&i||(e=bt(e)),e.type){case"FeatureCollection":var l=[];return e.features.forEach(function(e){l.push($(ni(e,{},a,s)))}),v(l,o);default:return ni(e,o,a,s)}}function ni(e,t,r,n){t=t||("Feature"===e.type?e.properties:{});var i=ie(e),o=i.coordinates,a=i.type;if(!o.length)throw new Error("line must contain coordinates");switch(a){case"LineString":return r&&(o=ii(o)),c([o],t);case"MultiLineString":var s=[],l=0;return o.forEach(function(e){if(r&&(e=ii(e)),n){var t=function(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.abs(t-n)*Math.abs(r-i)}(K(h(e)));t>l?(s.unshift(e),l=t):s.push(e)}else s.push(e)}),c(s,t);default:throw new Error("geometry type "+a+" is not supported")}}function ii(e){var t=e[0],r=t[0],n=t[1],i=e[e.length-1],o=i[0],a=i[1];return r===o&&n===a||e.push(t),e}function oi(e,t){var r,n,i,o,a,s,l;for(n=1;n<=8;n*=2){for(r=[],o=!(si(i=e[e.length-1],t)&n),a=0;a<e.length;a++)(l=!(si(s=e[a],t)&n))!==o&&r.push(ai(i,s,n,t)),l&&r.push(s),i=s,o=l;if(!(e=r).length)break}return r}function ai(e,t,r,n){return 8&r?[e[0]+(t[0]-e[0])*(n[3]-e[1])/(t[1]-e[1]),n[3]]:4&r?[e[0]+(t[0]-e[0])*(n[1]-e[1])/(t[1]-e[1]),n[1]]:2&r?[n[2],e[1]+(t[1]-e[1])*(n[2]-e[0])/(t[0]-e[0])]:1&r?[n[0],e[1]+(t[1]-e[1])*(n[0]-e[0])/(t[0]-e[0])]:null}function si(e,t){var r=0;return e[0]<t[0]?r|=1:e[0]>t[2]&&(r|=2),e[1]<t[1]?r|=4:e[1]>t[3]&&(r|=8),r}function li(e,t){for(var r=[],n=0,i=e;n<i.length;n++){var o=oi(i[n],t);o.length>0&&(o[0][0]===o[o.length-1][0]&&o[0][1]===o[o.length-1][1]||o.push(o[0]),o.length>=4&&r.push(o))}return r}Wn.prototype.interpolate=function(e){var t=Math.sin((1-e)*this.g)/Math.sin(this.g),r=Math.sin(e*this.g)/Math.sin(this.g),n=t*Math.cos(this.start.y)*Math.cos(this.start.x)+r*Math.cos(this.end.y)*Math.cos(this.end.x),i=t*Math.cos(this.start.y)*Math.sin(this.start.x)+r*Math.cos(this.end.y)*Math.sin(this.end.x),o=t*Math.sin(this.start.y)+r*Math.sin(this.end.y),a=qn*Math.atan2(o,Math.sqrt(Math.pow(n,2)+Math.pow(i,2)));return[qn*Math.atan2(i,n),a]},Wn.prototype.Arc=function(e,t){var r=[];if(!e||e<=2)r.push([this.start.lon,this.start.lat]),r.push([this.end.lon,this.end.lat]);else for(var n=1/(e-1),i=0;i<e;++i){var o=n*i,a=this.interpolate(o);r.push(a)}for(var s=!1,l=0,u=t&&t.offset?t.offset:10,c=180-u,f=-180+u,h=360-u,d=1;d<r.length;++d){var p=r[d-1][0],y=r[d][0],g=Math.abs(y-p);g>h&&(y>c&&p<f||p>c&&y<f)?s=!0:g>l&&(l=g)}var v=[];if(s&&l<u){var m=[];v.push(m);for(var _=0;_<r.length;++_){var S=parseFloat(r[_][0]);if(_>0&&Math.abs(S-r[_-1][0])>h){var x=parseFloat(r[_-1][0]),b=parseFloat(r[_-1][1]),w=parseFloat(r[_][0]),k=parseFloat(r[_][1]);if(x>-180&&x<f&&180===w&&_+1<r.length&&r[_-1][0]>-180&&r[_-1][0]<f){m.push([-180,r[_][1]]),_++,m.push([r[_][0],r[_][1]]);continue}if(x>c&&x<180&&-180===w&&_+1<r.length&&r[_-1][0]>c&&r[_-1][0]<180){m.push([180,r[_][1]]),_++,m.push([r[_][0],r[_][1]]);continue}if(x<f&&w>c){var M=x;x=w,w=M;var E=b;b=k,k=E}if(x>c&&w<f&&(w+=360),x<=180&&w>=180&&x<w){var I=(180-x)/(w-x),T=I*k+(1-I)*b;m.push([r[_-1][0]>c?180:-180,T]),(m=[]).push([r[_-1][0]>c?-180:180,T]),v.push(m)}else m=[],v.push(m);m.push([S,r[_][1]])}else m.push([r[_][0],r[_][1]])}}else{var L=[];v.push(L);for(var P=0;P<r.length;++P)L.push([r[P][0],r[P][1]])}for(var C=new zn(this.properties),N=0;N<v.length;++N){var O=new Jn;C.geometries.push(O);for(var R=v[N],V=0;V<R.length;++V)O.move_to(R[V])}return C};var ui=Fe(function(e,t){function r(e){var t=[];for(var r in e)t.push(r);return t}(e.exports="function"==typeof Object.keys?Object.keys:r).shim=r}),ci=Fe(function(e,t){var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function n(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function i(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=r?n:i).supported=n,t.unsupported=i}),fi=Fe(function(e){var t=Array.prototype.slice,r=e.exports=function(e,o,a){return a||(a={}),e===o||(e instanceof Date&&o instanceof Date?e.getTime()===o.getTime():!e||!o||"object"!=typeof e&&"object"!=typeof o?a.strict?e===o:e==o:function(e,o,a){var s,l;if(n(e)||n(o))return!1;if(e.prototype!==o.prototype)return!1;if(ci(e))return!!ci(o)&&(e=t.call(e),o=t.call(o),r(e,o,a));if(i(e)){if(!i(o))return!1;if(e.length!==o.length)return!1;for(s=0;s<e.length;s++)if(e[s]!==o[s])return!1;return!0}try{var u=ui(e),c=ui(o)}catch(e){return!1}if(u.length!=c.length)return!1;for(u.sort(),c.sort(),s=u.length-1;s>=0;s--)if(u[s]!=c[s])return!1;for(s=u.length-1;s>=0;s--)if(l=u[s],!r(e[l],o[l],a))return!1;return typeof e==typeof o}(e,o,a))};function n(e){return null==e}function i(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length||"function"!=typeof e.copy||"function"!=typeof e.slice||e.length>0&&"number"!=typeof e[0])}});function hi(e,t,r){if(void 0===r&&(r={}),!L(r=r||{}))throw new Error("options is invalid");var n,i=r.tolerance||0,o=[],a=an(),s=Gr(e);return a.load(s),J(t,function(e){var t=!1;e&&(A(a.search(e),function(r){if(!1===t){var o=$(e).sort(),a=$(r).sort();fi(o,a)||(0===i?Mn(o[0],r)&&Mn(o[1],r):cn(r,o[0]).properties.dist<=i&&cn(r,o[1]).properties.dist<=i)?(t=!0,n=n?di(n,e):e):(0===i?Mn(a[0],e)&&Mn(a[1],e):cn(e,a[0]).properties.dist<=i&&cn(e,a[1]).properties.dist<=i)&&(n=n?di(n,r):r)}}),!1===t&&n&&(o.push(n),n=void 0))}),n&&o.push(n),p(o)}function di(e,t){var r=$(t),n=$(e),i=n[0],o=n[n.length-1],a=e.geometry.coordinates;return fi(r[0],i)?a.unshift(r[1]):fi(r[0],o)?a.push(r[1]):fi(r[1],i)?a.unshift(r[0]):fi(r[1],o)&&a.push(r[0]),e}function pi(e){var t=e%360;return t<0&&(t+=360),t}function yi(e,t,r){var n;return void 0===r&&(r={}),(n=r.final?gi(Q(t),Q(e)):gi(Q(e),Q(t)))>180?-(360-n):n}function gi(e,t){var r=M(e[1]),n=M(t[1]),i=M(t[0]-e[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);var o=Math.log(Math.tan(n/2+Math.PI/4)/Math.tan(r/2+Math.PI/4));return(k(Math.atan2(i,o))+360)%360}function vi(e,t,n,i){void 0===i&&(i={});var o=t<0,a=E(Math.abs(t),i.units,"meters");o&&(a=-Math.abs(a));var s=Q(e),u=function(e,t,n,i){var o=t/(i=void 0===i?r:Number(i)),a=e[0]*Math.PI/180,s=M(e[1]),l=M(n),u=o*Math.cos(l),c=s+u;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var f=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),h=Math.abs(f)>1e-11?u/f:Math.cos(s);return[(180*(a+o*Math.sin(l)/h)/Math.PI+540)%360-180,180*c/Math.PI]}(s,a,n);return u[0]+=u[0]-s[0]>180?-360:s[0]-u[0]>180?360:0,l(u,i.properties)}function mi(e,t,r,n,i,o){for(var a=0;a<e.length;a++){var s=e[a],l=e[a+1];a===e.length-1&&(l=e[0]),n=Si(s,l,t),r<=0&&n>0?Si(t,s,i)<0||(i=s):r>0&&n<=0&&(_i(t,s,o)||(o=s)),r=n}return[i,o]}function _i(e,t,r){return Si(e,t,r)>0}function Si(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1])}function xi(e){for(var t,r,n=$(e),i=0,o=1;o<n.length;)t=r||n[0],i+=((r=n[o])[0]-t[0])*(r[1]+t[1]),o++;return i>0}function bi(e,t){switch("Feature"===e.type?e.geometry.type:e.type){case"GeometryCollection":return j(e,function(e){bi(e,t)}),e;case"LineString":return wi($(e),t),e;case"Polygon":return ki($(e),t),e;case"MultiLineString":return $(e).forEach(function(e){wi(e,t)}),e;case"MultiPolygon":return $(e).forEach(function(e){ki(e,t)}),e;case"Point":case"MultiPoint":return e}}function wi(e,t){xi(e)===t&&e.reverse()}function ki(e,t){xi(e[0])!==t&&e[0].reverse();for(var r=1;r<e.length;r++)xi(e[r])===t&&e[r].reverse()}var Mi={successCallback:null,verbose:!1,polygons:!1},Ei={};function Ii(e,t,r,n){n=n||{};for(var i=Object.keys(Mi),o=0;o<i.length;o++){var a=i[o],s=n[a];s=null!=s?s:Mi[a],Ei[a]=s}Ei.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+t+":"+(t+r)+"]");var l,u=function(e,t,r){for(var n=e.length-1,i=e[0].length-1,o={rows:n,cols:i,cells:[]},a=t+Math.abs(r),s=0;s<n;++s){o.cells[s]=[];for(var l=0;l<i;++l){var u=0,c=e[s+1][l],f=e[s+1][l+1],h=e[s][l+1],d=e[s][l];if(!(isNaN(c)||isNaN(f)||isNaN(h)||isNaN(d))){u|=c<t?0:c>a?128:64,u|=f<t?0:f>a?32:16,u|=h<t?0:h>a?8:4;var p=+(u|=d<t?0:d>a?2:1),y=0;if(17===u||18===u||33===u||34===u||38===u||68===u||72===u||98===u||102===u||132===u||136===u||137===u||152===u||153===u){var g=(c+f+h+d)/4;y=g>a?2:g<t?0:1,34===u?1===y?u=35:0===y&&(u=136):136===u?1===y?(u=35,y=4):0===y&&(u=34):17===u?1===y?(u=155,y=4):0===y&&(u=153):68===u?1===y?(u=103,y=4):0===y&&(u=102):153===u?1===y&&(u=155):102===u?1===y&&(u=103):152===u?y<2&&(u=156,y=1):137===u?y<2&&(u=139,y=1):98===u?y<2&&(u=99,y=1):38===u?y<2&&(u=39,y=1):18===u?y>0?(u=156,y=4):u=152:33===u?y>0?(u=139,y=4):u=137:72===u?y>0?(u=99,y=4):u=98:132===u&&(y>0?(u=39,y=4):u=38)}if(0!=u&&170!=u){var v,m,_,S,x,b,w,k;v=m=_=S=x=b=w=k=.5;var M=[];1===u?(_=1-mo(t,h,d),k=1-mo(t,c,d),M.push(fo[u])):169===u?(_=mo(a,d,h),k=mo(a,d,c),M.push(fo[u])):4===u?(b=1-mo(t,f,h),S=mo(t,d,h),M.push(uo[u])):166===u?(b=mo(a,h,f),S=1-mo(a,h,d),M.push(uo[u])):16===u?(x=mo(t,h,f),m=mo(t,c,f),M.push(lo[u])):154===u?(x=1-mo(a,f,h),m=1-mo(a,f,c),M.push(lo[u])):64===u?(w=mo(t,d,c),v=1-mo(t,f,c),M.push(po[u])):106===u?(w=1-mo(a,c,d),v=mo(a,c,f),M.push(po[u])):168===u?(S=mo(a,d,h),_=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),M.push(co[u]),M.push(fo[u])):2===u?(S=1-mo(t,h,d),_=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),M.push(co[u]),M.push(fo[u])):162===u?(x=mo(a,h,f),b=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),M.push(co[u]),M.push(fo[u])):8===u?(x=1-mo(t,f,h),b=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),M.push(lo[u]),M.push(uo[u])):138===u?(x=1-mo(t,f,h),b=1-mo(a,f,h),v=1-mo(a,f,c),m=1-mo(t,f,c),M.push(lo[u]),M.push(uo[u])):32===u?(x=mo(a,h,f),b=mo(t,h,f),v=mo(t,c,f),m=mo(a,c,f),M.push(lo[u]),M.push(uo[u])):42===u?(k=1-mo(a,c,d),w=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f),M.push(ho[u]),M.push(po[u])):128===u&&(k=mo(t,d,c),w=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c),M.push(ho[u]),M.push(po[u])),5===u?(b=1-mo(t,f,h),k=1-mo(t,c,d),M.push(uo[u])):165===u?(b=mo(a,h,f),k=mo(a,d,c),M.push(uo[u])):20===u?(S=mo(t,d,h),m=mo(t,c,f),M.push(co[u])):150===u?(S=1-mo(a,h,d),m=1-mo(a,f,c),M.push(co[u])):80===u?(x=mo(t,h,f),w=mo(t,d,c),M.push(lo[u])):90===u?(x=1-mo(a,f,h),w=1-mo(a,c,d),M.push(lo[u])):65===u?(_=1-mo(t,h,d),v=1-mo(t,f,c),M.push(fo[u])):105===u?(_=mo(a,d,h),v=mo(a,c,f),M.push(fo[u])):160===u?(x=mo(a,h,f),b=mo(t,h,f),k=mo(t,d,c),w=mo(a,d,c),M.push(lo[u]),M.push(uo[u])):10===u?(x=1-mo(t,f,h),b=1-mo(a,f,h),k=1-mo(a,c,d),w=1-mo(t,c,d),M.push(lo[u]),M.push(uo[u])):130===u?(S=1-mo(t,h,d),_=1-mo(a,h,d),v=1-mo(a,f,c),m=1-mo(t,f,c),M.push(co[u]),M.push(fo[u])):40===u?(S=mo(a,d,h),_=mo(t,d,h),v=mo(t,c,f),m=mo(a,c,f),M.push(co[u]),M.push(fo[u])):101===u?(b=mo(a,h,f),v=mo(a,c,f),M.push(uo[u])):69===u?(b=1-mo(t,f,h),v=1-mo(t,f,c),M.push(uo[u])):149===u?(k=mo(a,d,c),m=1-mo(a,f,c),M.push(ho[u])):21===u?(k=1-mo(t,c,d),m=mo(t,c,f),M.push(ho[u])):86===u?(S=1-mo(a,h,d),w=1-mo(a,c,d),M.push(co[u])):84===u?(S=mo(t,d,h),w=mo(t,d,c),M.push(co[u])):89===u?(x=1-mo(a,f,h),_=mo(a,d,h),M.push(fo[u])):81===u?(x=mo(t,h,f),_=1-mo(t,h,d),M.push(fo[u])):96===u?(x=mo(a,h,f),b=mo(t,h,f),w=mo(t,d,c),v=mo(a,c,f),M.push(lo[u]),M.push(uo[u])):74===u?(x=1-mo(t,f,h),b=1-mo(a,f,h),w=1-mo(a,c,d),v=1-mo(t,f,c),M.push(lo[u]),M.push(uo[u])):24===u?(x=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),m=mo(t,c,f),M.push(lo[u]),M.push(fo[u])):146===u?(x=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),m=1-mo(a,f,c),M.push(lo[u]),M.push(fo[u])):6===u?(b=1-mo(t,f,h),S=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),M.push(uo[u]),M.push(co[u])):164===u?(b=mo(a,h,f),S=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),M.push(uo[u]),M.push(co[u])):129===u?(_=1-mo(t,h,d),k=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c),M.push(fo[u]),M.push(ho[u])):41===u?(_=mo(a,d,h),k=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f),M.push(fo[u]),M.push(ho[u])):66===u?(S=1-mo(t,h,d),_=1-mo(a,h,d),w=1-mo(a,c,d),v=1-mo(t,f,c),M.push(co[u]),M.push(fo[u])):104===u?(S=mo(a,d,h),_=mo(t,d,h),w=mo(t,d,c),v=mo(a,c,f),M.push(fo[u]),M.push(yo[u])):144===u?(x=mo(t,h,f),k=mo(t,d,c),w=mo(a,d,c),m=1-mo(a,f,c),M.push(lo[u]),M.push(po[u])):26===u?(x=1-mo(a,f,h),k=1-mo(a,c,d),w=1-mo(t,c,d),m=mo(t,c,f),M.push(lo[u]),M.push(po[u])):36===u?(b=mo(a,h,f),S=mo(t,d,h),v=mo(t,c,f),m=mo(a,c,f),M.push(uo[u]),M.push(co[u])):134===u?(b=1-mo(t,f,h),S=1-mo(a,h,d),v=1-mo(a,f,c),m=1-mo(t,f,c),M.push(uo[u]),M.push(co[u])):9===u?(x=1-mo(t,f,h),b=1-mo(a,f,h),_=mo(a,d,h),k=1-mo(t,c,d),M.push(lo[u]),M.push(uo[u])):161===u?(x=mo(a,h,f),b=mo(t,h,f),_=1-mo(t,h,d),k=mo(a,d,c),M.push(lo[u]),M.push(uo[u])):37===u?(b=mo(a,h,f),k=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f),M.push(uo[u]),M.push(ho[u])):133===u?(b=1-mo(t,f,h),k=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c),M.push(uo[u]),M.push(ho[u])):148===u?(S=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),m=1-mo(a,f,c),M.push(co[u]),M.push(po[u])):22===u?(S=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),m=mo(t,c,f),M.push(co[u]),M.push(po[u])):82===u?(x=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),w=1-mo(a,c,d),M.push(lo[u]),M.push(fo[u])):88===u?(x=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),w=mo(t,d,c),M.push(lo[u]),M.push(fo[u])):73===u?(x=1-mo(t,f,h),b=1-mo(a,f,h),_=mo(a,d,h),v=1-mo(t,f,c),M.push(lo[u]),M.push(uo[u])):97===u?(x=mo(a,h,f),b=mo(t,h,f),_=1-mo(t,h,d),v=mo(a,c,f),M.push(lo[u]),M.push(uo[u])):145===u?(x=mo(t,h,f),_=1-mo(t,h,d),k=mo(a,d,c),m=1-mo(a,f,c),M.push(lo[u]),M.push(ho[u])):25===u?(x=1-mo(a,f,h),_=mo(a,d,h),k=1-mo(t,c,d),m=mo(t,c,f),M.push(lo[u]),M.push(ho[u])):70===u?(b=1-mo(t,f,h),S=1-mo(a,h,d),w=1-mo(a,c,d),v=1-mo(t,f,c),M.push(uo[u]),M.push(co[u])):100===u?(b=mo(a,h,f),S=mo(t,d,h),w=mo(t,d,c),v=mo(a,c,f),M.push(uo[u]),M.push(co[u])):34===u?(0===y?(x=1-mo(t,f,h),b=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c)):(x=mo(a,h,f),b=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f)),M.push(lo[u]),M.push(uo[u]),M.push(ho[u]),M.push(po[u])):35===u?(4===y?(x=1-mo(t,f,h),b=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c)):(x=mo(a,h,f),b=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f)),M.push(lo[u]),M.push(uo[u]),M.push(fo[u]),M.push(po[u])):136===u?(0===y?(x=mo(a,h,f),b=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f)):(x=1-mo(t,f,h),b=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c)),M.push(lo[u]),M.push(uo[u]),M.push(ho[u]),M.push(po[u])):153===u?(0===y?(x=mo(t,h,f),_=1-mo(t,h,d),k=1-mo(t,c,d),m=mo(t,c,f)):(x=1-mo(a,f,h),_=mo(a,d,h),k=mo(a,d,c),m=1-mo(a,f,c)),M.push(lo[u]),M.push(fo[u])):102===u?(0===y?(b=1-mo(t,f,h),S=mo(t,d,h),w=mo(t,d,c),v=1-mo(t,f,c)):(b=mo(a,h,f),S=1-mo(a,h,d),w=1-mo(a,c,d),v=mo(a,c,f)),M.push(uo[u]),M.push(po[u])):155===u?(4===y?(x=mo(t,h,f),_=1-mo(t,h,d),k=1-mo(t,c,d),m=mo(t,c,f)):(x=1-mo(a,f,h),_=mo(a,d,h),k=mo(a,d,c),m=1-mo(a,f,c)),M.push(lo[u]),M.push(ho[u])):103===u?(4===y?(b=1-mo(t,f,h),S=mo(t,d,h),w=mo(t,d,c),v=1-mo(t,f,c)):(b=mo(a,h,f),S=1-mo(a,h,d),w=1-mo(a,c,d),v=mo(a,c,f)),M.push(uo[u]),M.push(co[u])):152===u?(0===y?(x=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),m=mo(t,c,f)):(x=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),m=1-mo(a,f,c)),M.push(lo[u]),M.push(co[u]),M.push(fo[u])):156===u?(4===y?(x=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),m=mo(t,c,f)):(x=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),m=1-mo(a,f,c)),M.push(lo[u]),M.push(fo[u]),M.push(po[u])):137===u?(0===y?(x=mo(a,h,f),b=mo(t,h,f),_=1-mo(t,h,d),k=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f)):(x=1-mo(t,f,h),b=1-mo(a,f,h),_=mo(a,d,h),k=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c)),M.push(lo[u]),M.push(uo[u]),M.push(fo[u])):139===u?(4===y?(x=mo(a,h,f),b=mo(t,h,f),_=1-mo(t,h,d),k=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f)):(x=1-mo(t,f,h),b=1-mo(a,f,h),_=mo(a,d,h),k=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c)),M.push(lo[u]),M.push(uo[u]),M.push(ho[u])):98===u?(0===y?(x=1-mo(t,f,h),b=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),w=mo(t,d,c),v=1-mo(t,f,c)):(x=mo(a,h,f),b=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),w=1-mo(a,c,d),v=mo(a,c,f)),M.push(lo[u]),M.push(uo[u]),M.push(po[u])):99===u?(4===y?(x=1-mo(t,f,h),b=1-mo(a,f,h),S=mo(a,d,h),_=mo(t,d,h),w=mo(t,d,c),v=1-mo(t,f,c)):(x=mo(a,h,f),b=mo(t,h,f),S=1-mo(t,h,d),_=1-mo(a,h,d),w=1-mo(a,c,d),v=mo(a,c,f)),M.push(lo[u]),M.push(uo[u]),M.push(fo[u])):38===u?(0===y?(b=1-mo(t,f,h),S=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c)):(b=mo(a,h,f),S=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f)),M.push(uo[u]),M.push(ho[u]),M.push(po[u])):39===u?(4===y?(b=1-mo(t,f,h),S=mo(t,d,h),k=mo(t,d,c),w=mo(a,d,c),v=1-mo(a,f,c),m=1-mo(t,f,c)):(b=mo(a,h,f),S=1-mo(a,h,d),k=1-mo(a,c,d),w=1-mo(t,c,d),v=mo(t,c,f),m=mo(a,c,f)),M.push(uo[u]),M.push(co[u]),M.push(po[u])):85===u&&(x=1,b=0,S=1,_=0,k=0,w=1,v=0,m=1),(v<0||v>1||m<0||m>1||x<0||x>1||S<0||S>1||k<0||k>1||w<0||w>1)&&console.log("MarchingSquaresJS-isoBands: "+u+" "+p+" "+c+","+f+","+h+","+d+" "+y+" "+v+" "+m+" "+x+" "+b+" "+S+" "+_+" "+k+" "+w),o.cells[s][l]={cval:u,cval_real:p,flipped:y,topleft:v,topright:m,righttop:x,rightbottom:b,bottomright:S,bottomleft:_,leftbottom:k,lefttop:w,edges:M}}}}}return o}(e,t,r);return Ei.polygons?(Ei.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),l=function(e){var t=[],r=0;return u.cells.forEach(function(e,n){e.forEach(function(e,i){if(void 0!==e){var o=vo[e.cval](e);"object"==typeof o&&_o(o)?"object"==typeof o[0]&&_o(o[0])?"object"==typeof o[0][0]&&_o(o[0][0])?o.forEach(function(e){e.forEach(function(e){e[0]+=i,e[1]+=n}),t[r++]=e}):(o.forEach(function(e){e[0]+=i,e[1]+=n}),t[r++]=o):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),t}()):(Ei.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),l=function(e){for(var t=[],r=e.rows,n=e.cols,i=[],o=0;o<r;o++)for(var a=0;a<n;a++)if(void 0!==e.cells[o][a]&&e.cells[o][a].edges.length>0){var s=xo(e.cells[o][a]),l=null,u=a,c=o;null!==s&&i.push([s.p[0]+u,s.p[1]+c]);do{if(null===(l=bo(e.cells[c][u],s.x,s.y,s.o)))break;if(i.push([l.p[0]+u,l.p[1]+c]),u+=l.x,s=l,(c+=l.y)<0||c>=r||u<0||u>=n||void 0===e.cells[c][u]){var f=So(e,u-=l.x,c-=l.y,l.x,l.y,l.o);if(null===f)break;f.path.forEach(function(e){i.push(e)}),u=f.i,c=f.j,s=f}}while(void 0!==e.cells[c][u]&&e.cells[c][u].edges.length>0);t.push(i),i=[],e.cells[o][a].edges.length>0&&a--}return t}(u)),"function"==typeof Ei.successCallback&&Ei.successCallback(l),l}var Ti=64,Li=16,Pi=[],Ci=[],Ni=[],Oi=[],Ri=[],Vi=[],Gi=[],Ai=[],Fi=[],Di=[],ji=[],Bi=[],qi=[],Ui=[],Ji=[],zi=[],Wi=[],Hi=[],Xi=[],Yi=[],Zi=[],Ki=[],Qi=[],$i=[];Gi[85]=Di[85]=-1,Ai[85]=ji[85]=0,Fi[85]=Bi[85]=1,Xi[85]=Ki[85]=1,Yi[85]=Qi[85]=0,Zi[85]=$i[85]=1,Pi[85]=Oi[85]=0,Ci[85]=Ri[85]=-1,Ni[85]=Ji[85]=0,zi[85]=qi[85]=0,Wi[85]=Ui[85]=1,Vi[85]=Hi[85]=1,Ki[1]=Ki[169]=0,Qi[1]=Qi[169]=-1,$i[1]=$i[169]=0,qi[1]=qi[169]=-1,Ui[1]=Ui[169]=0,Ji[1]=Ji[169]=0,Di[4]=Di[166]=0,ji[4]=ji[166]=-1,Bi[4]=Bi[166]=1,zi[4]=zi[166]=1,Wi[4]=Wi[166]=0,Hi[4]=Hi[166]=0,Gi[16]=Gi[154]=0,Ai[16]=Ai[154]=1,Fi[16]=Fi[154]=1,Oi[16]=Oi[154]=1,Ri[16]=Ri[154]=0,Vi[16]=Vi[154]=1,Xi[64]=Xi[106]=0,Yi[64]=Yi[106]=1,Zi[64]=Zi[106]=0,Pi[64]=Pi[106]=-1,Ci[64]=Ci[106]=0,Ni[64]=Ni[106]=1,Xi[2]=Xi[168]=0,Yi[2]=Yi[168]=-1,Zi[2]=Zi[168]=1,Ki[2]=Ki[168]=0,Qi[2]=Qi[168]=-1,$i[2]=$i[168]=0,qi[2]=qi[168]=-1,Ui[2]=Ui[168]=0,Ji[2]=Ji[168]=0,zi[2]=zi[168]=-1,Wi[2]=Wi[168]=0,Hi[2]=Hi[168]=1,Gi[8]=Gi[162]=0,Ai[8]=Ai[162]=-1,Fi[8]=Fi[162]=0,Di[8]=Di[162]=0,ji[8]=ji[162]=-1,Bi[8]=Bi[162]=1,qi[8]=qi[162]=1,Ui[8]=Ui[162]=0,Ji[8]=Ji[162]=1,zi[8]=zi[162]=1,Wi[8]=Wi[162]=0,Hi[8]=Hi[162]=0,Gi[32]=Gi[138]=0,Ai[32]=Ai[138]=1,Fi[32]=Fi[138]=1,Di[32]=Di[138]=0,ji[32]=ji[138]=1,Bi[32]=Bi[138]=0,Pi[32]=Pi[138]=1,Ci[32]=Ci[138]=0,Ni[32]=Ni[138]=0,Oi[32]=Oi[138]=1,Ri[32]=Ri[138]=0,Vi[32]=Vi[138]=1,Ki[128]=Ki[42]=0,Qi[128]=Qi[42]=1,$i[128]=$i[42]=1,Xi[128]=Xi[42]=0,Yi[128]=Yi[42]=1,Zi[128]=Zi[42]=0,Pi[128]=Pi[42]=-1,Ci[128]=Ci[42]=0,Ni[128]=Ni[42]=1,Oi[128]=Oi[42]=-1,Ri[128]=Ri[42]=0,Vi[128]=Vi[42]=0,Di[5]=Di[165]=-1,ji[5]=ji[165]=0,Bi[5]=Bi[165]=0,Ki[5]=Ki[165]=1,Qi[5]=Qi[165]=0,$i[5]=$i[165]=0,zi[20]=zi[150]=0,Wi[20]=Wi[150]=1,Hi[20]=Hi[150]=1,Oi[20]=Oi[150]=0,Ri[20]=Ri[150]=-1,Vi[20]=Vi[150]=1,Gi[80]=Gi[90]=-1,Ai[80]=Ai[90]=0,Fi[80]=Fi[90]=1,Xi[80]=Xi[90]=1,Yi[80]=Yi[90]=0,Zi[80]=Zi[90]=1,qi[65]=qi[105]=0,Ui[65]=Ui[105]=1,Ji[65]=Ji[105]=0,Pi[65]=Pi[105]=0,Ci[65]=Ci[105]=-1,Ni[65]=Ni[105]=0,Gi[160]=Gi[10]=-1,Ai[160]=Ai[10]=0,Fi[160]=Fi[10]=1,Di[160]=Di[10]=-1,ji[160]=ji[10]=0,Bi[160]=Bi[10]=0,Ki[160]=Ki[10]=1,Qi[160]=Qi[10]=0,$i[160]=$i[10]=0,Xi[160]=Xi[10]=1,Yi[160]=Yi[10]=0,Zi[160]=Zi[10]=1,zi[130]=zi[40]=0,Wi[130]=Wi[40]=1,Hi[130]=Hi[40]=1,qi[130]=qi[40]=0,Ui[130]=Ui[40]=1,Ji[130]=Ji[40]=0,Pi[130]=Pi[40]=0,Ci[130]=Ci[40]=-1,Ni[130]=Ni[40]=0,Oi[130]=Oi[40]=0,Ri[130]=Ri[40]=-1,Vi[130]=Vi[40]=1,Di[37]=Di[133]=0,ji[37]=ji[133]=1,Bi[37]=Bi[133]=1,Ki[37]=Ki[133]=0,Qi[37]=Qi[133]=1,$i[37]=$i[133]=0,Pi[37]=Pi[133]=-1,Ci[37]=Ci[133]=0,Ni[37]=Ni[133]=0,Oi[37]=Oi[133]=1,Ri[37]=Ri[133]=0,Vi[37]=Vi[133]=0,zi[148]=zi[22]=-1,Wi[148]=Wi[22]=0,Hi[148]=Hi[22]=0,Ki[148]=Ki[22]=0,Qi[148]=Qi[22]=-1,$i[148]=$i[22]=1,Xi[148]=Xi[22]=0,Yi[148]=Yi[22]=1,Zi[148]=Zi[22]=1,Oi[148]=Oi[22]=-1,Ri[148]=Ri[22]=0,Vi[148]=Vi[22]=1,Gi[82]=Gi[88]=0,Ai[82]=Ai[88]=-1,Fi[82]=Fi[88]=1,zi[82]=zi[88]=1,Wi[82]=Wi[88]=0,Hi[82]=Hi[88]=1,qi[82]=qi[88]=-1,Ui[82]=Ui[88]=0,Ji[82]=Ji[88]=1,Xi[82]=Xi[88]=0,Yi[82]=Yi[88]=-1,Zi[82]=Zi[88]=0,Gi[73]=Gi[97]=0,Ai[73]=Ai[97]=1,Fi[73]=Fi[97]=0,Di[73]=Di[97]=0,ji[73]=ji[97]=-1,Bi[73]=Bi[97]=0,qi[73]=qi[97]=1,Ui[73]=Ui[97]=0,Ji[73]=Ji[97]=0,Pi[73]=Pi[97]=1,Ci[73]=Ci[97]=0,Ni[73]=Ni[97]=1,Gi[145]=Gi[25]=0,Ai[145]=Ai[25]=-1,Fi[145]=Fi[25]=0,qi[145]=qi[25]=1,Ui[145]=Ui[25]=0,Ji[145]=Ji[25]=1,Ki[145]=Ki[25]=0,Qi[145]=Qi[25]=1,$i[145]=$i[25]=1,Oi[145]=Oi[25]=-1,Ri[145]=Ri[25]=0,Vi[145]=Vi[25]=0,Di[70]=Di[100]=0,ji[70]=ji[100]=1,Bi[70]=Bi[100]=0,zi[70]=zi[100]=-1,Wi[70]=Wi[100]=0,Hi[70]=Hi[100]=1,Xi[70]=Xi[100]=0,Yi[70]=Yi[100]=-1,Zi[70]=Zi[100]=1,Pi[70]=Pi[100]=1,Ci[70]=Ci[100]=0,Ni[70]=Ni[100]=0,Di[101]=Di[69]=0,ji[101]=ji[69]=1,Bi[101]=Bi[69]=0,Pi[101]=Pi[69]=1,Ci[101]=Ci[69]=0,Ni[101]=Ni[69]=0,Ki[149]=Ki[21]=0,Qi[149]=Qi[21]=1,$i[149]=$i[21]=1,Oi[149]=Oi[21]=-1,Ri[149]=Ri[21]=0,Vi[149]=Vi[21]=0,zi[86]=zi[84]=-1,Wi[86]=Wi[84]=0,Hi[86]=Hi[84]=1,Xi[86]=Xi[84]=0,Yi[86]=Yi[84]=-1,Zi[86]=Zi[84]=1,Gi[89]=Gi[81]=0,Ai[89]=Ai[81]=-1,Fi[89]=Fi[81]=0,qi[89]=qi[81]=1,Ui[89]=Ui[81]=0,Ji[89]=Ji[81]=1,Gi[96]=Gi[74]=0,Ai[96]=Ai[74]=1,Fi[96]=Fi[74]=0,Di[96]=Di[74]=-1,ji[96]=ji[74]=0,Bi[96]=Bi[74]=1,Xi[96]=Xi[74]=1,Yi[96]=Yi[74]=0,Zi[96]=Zi[74]=0,Pi[96]=Pi[74]=1,Ci[96]=Ci[74]=0,Ni[96]=Ni[74]=1,Gi[24]=Gi[146]=0,Ai[24]=Ai[146]=-1,Fi[24]=Fi[146]=1,zi[24]=zi[146]=1,Wi[24]=Wi[146]=0,Hi[24]=Hi[146]=1,qi[24]=qi[146]=0,Ui[24]=Ui[146]=1,Ji[24]=Ji[146]=1,Oi[24]=Oi[146]=0,Ri[24]=Ri[146]=-1,Vi[24]=Vi[146]=0,Di[6]=Di[164]=-1,ji[6]=ji[164]=0,Bi[6]=Bi[164]=1,zi[6]=zi[164]=-1,Wi[6]=Wi[164]=0,Hi[6]=Hi[164]=0,Ki[6]=Ki[164]=0,Qi[6]=Qi[164]=-1,$i[6]=$i[164]=1,Xi[6]=Xi[164]=1,Yi[6]=Yi[164]=0,Zi[6]=Zi[164]=0,qi[129]=qi[41]=0,Ui[129]=Ui[41]=1,Ji[129]=Ji[41]=1,Ki[129]=Ki[41]=0,Qi[129]=Qi[41]=1,$i[129]=$i[41]=0,Pi[129]=Pi[41]=-1,Ci[129]=Ci[41]=0,Ni[129]=Ni[41]=0,Oi[129]=Oi[41]=0,Ri[129]=Ri[41]=-1,Vi[129]=Vi[41]=0,zi[66]=zi[104]=0,Wi[66]=Wi[104]=1,Hi[66]=Hi[104]=0,qi[66]=qi[104]=-1,Ui[66]=Ui[104]=0,Ji[66]=Ji[104]=1,Xi[66]=Xi[104]=0,Yi[66]=Yi[104]=-1,Zi[66]=Zi[104]=0,Pi[66]=Pi[104]=0,Ci[66]=Ci[104]=-1,Ni[66]=Ni[104]=1,Gi[144]=Gi[26]=-1,Ai[144]=Ai[26]=0,Fi[144]=Fi[26]=0,Ki[144]=Ki[26]=1,Qi[144]=Qi[26]=0,$i[144]=$i[26]=1,Xi[144]=Xi[26]=0,Yi[144]=Yi[26]=1,Zi[144]=Zi[26]=1,Oi[144]=Oi[26]=-1,Ri[144]=Ri[26]=0,Vi[144]=Vi[26]=1,Di[36]=Di[134]=0,ji[36]=ji[134]=1,Bi[36]=Bi[134]=1,zi[36]=zi[134]=0,Wi[36]=Wi[134]=1,Hi[36]=Hi[134]=0,Pi[36]=Pi[134]=0,Ci[36]=Ci[134]=-1,Ni[36]=Ni[134]=1,Oi[36]=Oi[134]=1,Ri[36]=Ri[134]=0,Vi[36]=Vi[134]=0,Gi[9]=Gi[161]=-1,Ai[9]=Ai[161]=0,Fi[9]=Fi[161]=0,Di[9]=Di[161]=0,ji[9]=ji[161]=-1,Bi[9]=Bi[161]=0,qi[9]=qi[161]=1,Ui[9]=Ui[161]=0,Ji[9]=Ji[161]=0,Ki[9]=Ki[161]=1,Qi[9]=Qi[161]=0,$i[9]=$i[161]=1,Gi[136]=0,Ai[136]=1,Fi[136]=1,Di[136]=0,ji[136]=1,Bi[136]=0,zi[136]=-1,Wi[136]=0,Hi[136]=1,qi[136]=-1,Ui[136]=0,Ji[136]=0,Ki[136]=0,Qi[136]=-1,$i[136]=0,Xi[136]=0,Yi[136]=-1,Zi[136]=1,Pi[136]=1,Ci[136]=0,Ni[136]=0,Oi[136]=1,Ri[136]=0,Vi[136]=1,Gi[34]=0,Ai[34]=-1,Fi[34]=0,Di[34]=0,ji[34]=-1,Bi[34]=1,zi[34]=1,Wi[34]=0,Hi[34]=0,qi[34]=1,Ui[34]=0,Ji[34]=1,Ki[34]=0,Qi[34]=1,$i[34]=1,Xi[34]=0,Yi[34]=1,Zi[34]=0,Pi[34]=-1,Ci[34]=0,Ni[34]=1,Oi[34]=-1,Ri[34]=0,Vi[34]=0,Gi[35]=0,Ai[35]=1,Fi[35]=1,Di[35]=0,ji[35]=-1,Bi[35]=1,zi[35]=1,Wi[35]=0,Hi[35]=0,qi[35]=-1,Ui[35]=0,Ji[35]=0,Ki[35]=0,Qi[35]=-1,$i[35]=0,Xi[35]=0,Yi[35]=1,Zi[35]=0,Pi[35]=-1,Ci[35]=0,Ni[35]=1,Oi[35]=1,Ri[35]=0,Vi[35]=1,Gi[153]=0,Ai[153]=1,Fi[153]=1,qi[153]=-1,Ui[153]=0,Ji[153]=0,Ki[153]=0,Qi[153]=-1,$i[153]=0,Oi[153]=1,Ri[153]=0,Vi[153]=1,Di[102]=0,ji[102]=-1,Bi[102]=1,zi[102]=1,Wi[102]=0,Hi[102]=0,Xi[102]=0,Yi[102]=1,Zi[102]=0,Pi[102]=-1,Ci[102]=0,Ni[102]=1,Gi[155]=0,Ai[155]=-1,Fi[155]=0,qi[155]=1,Ui[155]=0,Ji[155]=1,Ki[155]=0,Qi[155]=1,$i[155]=1,Oi[155]=-1,Ri[155]=0,Vi[155]=0,Di[103]=0,ji[103]=1,Bi[103]=0,zi[103]=-1,Wi[103]=0,Hi[103]=1,Xi[103]=0,Yi[103]=-1,Zi[103]=1,Pi[103]=1,Ci[103]=0,Ni[103]=0,Gi[152]=0,Ai[152]=1,Fi[152]=1,zi[152]=-1,Wi[152]=0,Hi[152]=1,qi[152]=-1,Ui[152]=0,Ji[152]=0,Ki[152]=0,Qi[152]=-1,$i[152]=0,Xi[152]=0,Yi[152]=-1,Zi[152]=1,Oi[152]=1,Ri[152]=0,Vi[152]=1,Gi[156]=0,Ai[156]=-1,Fi[156]=1,zi[156]=1,Wi[156]=0,Hi[156]=1,qi[156]=-1,Ui[156]=0,Ji[156]=0,Ki[156]=0,Qi[156]=-1,$i[156]=0,Xi[156]=0,Yi[156]=1,Zi[156]=1,Oi[156]=-1,Ri[156]=0,Vi[156]=1,Gi[137]=0,Ai[137]=1,Fi[137]=1,Di[137]=0,ji[137]=1,Bi[137]=0,qi[137]=-1,Ui[137]=0,Ji[137]=0,Ki[137]=0,Qi[137]=-1,$i[137]=0,Pi[137]=1,Ci[137]=0,Ni[137]=0,Oi[137]=1,Ri[137]=0,Vi[137]=1,Gi[139]=0,Ai[139]=1,Fi[139]=1,Di[139]=0,ji[139]=-1,Bi[139]=0,qi[139]=1,Ui[139]=0,Ji[139]=0,Ki[139]=0,Qi[139]=1,$i[139]=0,Pi[139]=-1,Ci[139]=0,Ni[139]=0,Oi[139]=1,Ri[139]=0,Vi[139]=1,Gi[98]=0,Ai[98]=-1,Fi[98]=0,Di[98]=0,ji[98]=-1,Bi[98]=1,zi[98]=1,Wi[98]=0,Hi[98]=0,qi[98]=1,Ui[98]=0,Ji[98]=1,Xi[98]=0,Yi[98]=1,Zi[98]=0,Pi[98]=-1,Ci[98]=0,Ni[98]=1,Gi[99]=0,Ai[99]=1,Fi[99]=0,Di[99]=0,ji[99]=-1,Bi[99]=1,zi[99]=1,Wi[99]=0,Hi[99]=0,qi[99]=-1,Ui[99]=0,Ji[99]=1,Xi[99]=0,Yi[99]=-1,Zi[99]=0,Pi[99]=1,Ci[99]=0,Ni[99]=1,Di[38]=0,ji[38]=-1,Bi[38]=1,zi[38]=1,Wi[38]=0,Hi[38]=0,Ki[38]=0,Qi[38]=1,$i[38]=1,Xi[38]=0,Yi[38]=1,Zi[38]=0,Pi[38]=-1,Ci[38]=0,Ni[38]=1,Oi[38]=-1,Ri[38]=0,Vi[38]=0,Di[39]=0,ji[39]=1,Bi[39]=1,zi[39]=-1,Wi[39]=0,Hi[39]=0,Ki[39]=0,Qi[39]=-1,$i[39]=1,Xi[39]=0,Yi[39]=1,Zi[39]=0,Pi[39]=-1,Ci[39]=0,Ni[39]=1,Oi[39]=1,Ri[39]=0,Vi[39]=0;var eo=function(e){return[[e.bottomleft,0],[0,0],[0,e.leftbottom]]},to=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0]]},ro=function(e){return[[e.topright,1],[1,1],[1,e.righttop]]},no=function(e){return[[0,e.lefttop],[0,1],[e.topleft,1]]},io=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop]]},oo=function(e){return[[e.bottomright,0],[e.bottomleft,0],[1,e.righttop],[1,e.rightbottom]]},ao=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.topleft,1],[e.topright,1]]},so=function(e){return[[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},lo=[],uo=[],co=[],fo=[],ho=[],po=[],yo=[],go=[];fo[1]=ho[1]=18,fo[169]=ho[169]=18,co[4]=uo[4]=12,co[166]=uo[166]=12,lo[16]=go[16]=4,lo[154]=go[154]=4,po[64]=yo[64]=22,po[106]=yo[106]=22,co[2]=po[2]=17,fo[2]=ho[2]=18,co[168]=po[168]=17,fo[168]=ho[168]=18,lo[8]=fo[8]=9,uo[8]=co[8]=12,lo[162]=fo[162]=9,uo[162]=co[162]=12,lo[32]=go[32]=4,uo[32]=yo[32]=1,lo[138]=go[138]=4,uo[138]=yo[138]=1,ho[128]=go[128]=21,po[128]=yo[128]=22,ho[42]=go[42]=21,po[42]=yo[42]=22,uo[5]=ho[5]=14,uo[165]=ho[165]=14,co[20]=go[20]=6,co[150]=go[150]=6,lo[80]=po[80]=11,lo[90]=po[90]=11,fo[65]=yo[65]=3,fo[105]=yo[105]=3,lo[160]=po[160]=11,uo[160]=ho[160]=14,lo[10]=po[10]=11,uo[10]=ho[10]=14,co[130]=go[130]=6,fo[130]=yo[130]=3,co[40]=go[40]=6,fo[40]=yo[40]=3,uo[101]=yo[101]=1,uo[69]=yo[69]=1,ho[149]=go[149]=21,ho[21]=go[21]=21,co[86]=po[86]=17,co[84]=po[84]=17,lo[89]=fo[89]=9,lo[81]=fo[81]=9,lo[96]=yo[96]=0,uo[96]=po[96]=15,lo[74]=yo[74]=0,uo[74]=po[74]=15,lo[24]=co[24]=8,fo[24]=go[24]=7,lo[146]=co[146]=8,fo[146]=go[146]=7,uo[6]=po[6]=15,co[6]=ho[6]=16,uo[164]=po[164]=15,co[164]=ho[164]=16,fo[129]=go[129]=7,ho[129]=yo[129]=20,fo[41]=go[41]=7,ho[41]=yo[41]=20,co[66]=yo[66]=2,fo[66]=po[66]=19,co[104]=yo[104]=2,fo[104]=po[104]=19,lo[144]=ho[144]=10,po[144]=go[144]=23,lo[26]=ho[26]=10,po[26]=go[26]=23,uo[36]=go[36]=5,co[36]=yo[36]=2,uo[134]=go[134]=5,co[134]=yo[134]=2,lo[9]=ho[9]=10,uo[9]=fo[9]=13,lo[161]=ho[161]=10,uo[161]=fo[161]=13,uo[37]=go[37]=5,ho[37]=yo[37]=20,uo[133]=go[133]=5,ho[133]=yo[133]=20,co[148]=ho[148]=16,po[148]=go[148]=23,co[22]=ho[22]=16,po[22]=go[22]=23,lo[82]=co[82]=8,fo[82]=po[82]=19,lo[88]=co[88]=8,fo[88]=po[88]=19,lo[73]=yo[73]=0,uo[73]=fo[73]=13,lo[97]=yo[97]=0,uo[97]=fo[97]=13,lo[145]=fo[145]=9,ho[145]=go[145]=21,lo[25]=fo[25]=9,ho[25]=go[25]=21,uo[70]=yo[70]=1,co[70]=po[70]=17,uo[100]=yo[100]=1,co[100]=po[100]=17,lo[34]=fo[34]=9,uo[34]=co[34]=12,ho[34]=go[34]=21,po[34]=yo[34]=22,lo[136]=go[136]=4,uo[136]=yo[136]=1,co[136]=po[136]=17,fo[136]=ho[136]=18,lo[35]=go[35]=4,uo[35]=co[35]=12,fo[35]=ho[35]=18,po[35]=yo[35]=22,lo[153]=go[153]=4,fo[153]=ho[153]=18,uo[102]=co[102]=12,po[102]=yo[102]=22,lo[155]=fo[155]=9,ho[155]=go[155]=23,uo[103]=yo[103]=1,co[103]=po[103]=17,lo[152]=go[152]=4,co[152]=po[152]=17,fo[152]=ho[152]=18,lo[156]=co[156]=8,fo[156]=ho[156]=18,po[156]=go[156]=23,lo[137]=go[137]=4,uo[137]=yo[137]=1,fo[137]=ho[137]=18,lo[139]=go[139]=4,uo[139]=fo[139]=13,ho[139]=yo[139]=20,lo[98]=fo[98]=9,uo[98]=co[98]=12,po[98]=yo[98]=22,lo[99]=yo[99]=0,uo[99]=co[99]=12,fo[99]=po[99]=19,uo[38]=co[38]=12,ho[38]=go[38]=21,po[38]=yo[38]=22,uo[39]=go[39]=5,co[39]=ho[39]=16,po[39]=yo[39]=22;var vo=[];function mo(e,t,r){return(e-t)/(r-t)}function _o(e){return e.constructor.toString().indexOf("Array")>-1}function So(e,t,r,n,i,o){for(var a=e.cells[r][t],s=a.cval_real,l=t+n,u=r+i,c=[],f=!1;!f;){if(void 0===e.cells[u]||void 0===e.cells[u][l])if(u-=i,l-=n,s=(a=e.cells[u][l]).cval_real,-1===i)if(0===o)if(1&s)c.push([l,u]),n=-1,i=0,o=0;else{if(!(4&s)){c.push([l+a.bottomright,u]),n=0,i=1,o=1,f=!0;break}c.push([l+1,u]),n=1,i=0,o=0}else{if(!(1&s)){if(4&s){c.push([l+a.bottomright,u]),n=0,i=1,o=1,f=!0;break}c.push([l+a.bottomleft,u]),n=0,i=1,o=0,f=!0;break}c.push([l,u]),n=-1,i=0,o=0}else if(1===i)if(0===o){if(!(s&Li)){if(s&Ti){c.push([l+a.topleft,u+1]),n=0,i=-1,o=0,f=!0;break}c.push([l+a.topright,u+1]),n=0,i=-1,o=1,f=!0;break}c.push([l+1,u+1]),n=1,i=0,o=1}else c.push([l+1,u+1]),n=1,i=0,o=1;else if(-1===n)if(0===o){if(!(s&Ti)){if(1&s){c.push([l,u+a.leftbottom]),n=1,i=0,o=0,f=!0;break}c.push([l,u+a.lefttop]),n=1,i=0,o=1,f=!0;break}c.push([l,u+1]),n=0,i=1,o=0}else{if(!(s&Ti)){console.log("MarchingSquaresJS-isoBands: wtf");break}c.push([l,u+1]),n=0,i=1,o=0}else{if(1!==n){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===o){if(!(4&s)){c.push([l+1,u+a.rightbottom]),n=-1,i=0,o=0,f=!0;break}c.push([l+1,u]),n=0,i=-1,o=1}else{if(!(4&s)){if(s&Li){c.push([l+1,u+a.righttop]),n=-1,i=0,o=1;break}c.push([l+1,u+a.rightbottom]),n=-1,i=0,o=0,f=!0;break}c.push([l+1,u]),n=0,i=-1,o=1}}else if(s=(a=e.cells[u][l]).cval_real,-1===n)if(0===o)if(void 0!==e.cells[u-1]&&void 0!==e.cells[u-1][l])n=0,i=-1,o=1;else{if(!(1&s)){c.push([l+a.bottomright,u]),n=0,i=1,o=1,f=!0;break}c.push([l,u])}else{if(!(s&Ti)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+l+","+u);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===n){if(0===o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==e.cells[u+1]&&void 0!==e.cells[u+1][l])n=0,i=1,o=0;else{if(!(s&Li)){c.push([l+a.topleft,u+1]),n=0,i=-1,o=0,f=!0;break}c.push([l+1,u+1]),n=1,i=0,o=1}}else if(-1===i){if(1!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==e.cells[u][l+1])n=1,i=0,o=1;else{if(!(4&s)){c.push([l+1,u+a.righttop]),n=-1,i=0,o=1,f=!0;break}c.push([l+1,u]),n=0,i=-1,o=1}}else{if(1!==i){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==e.cells[u][l-1])n=-1,i=0,o=0;else{if(!(s&Ti)){c.push([l,u+a.leftbottom]),n=1,i=0,o=0,f=!0;break}c.push([l,u+1]),n=0,i=1,o=0}}if(u+=i,(l+=n)===t&&u===r)break}return{path:c,i:l,j:u,x:n,y:i,o:o}}function xo(e){if(e.edges.length>0){var t=e.edges[e.edges.length-1],r=e.cval_real;switch(t){case 0:return r&Li?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 1:return 4&r?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 2:return 4&r?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 3:return 1&r?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 4:return r&Li?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 5:return 4&r?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 6:return 4&r?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 7:return 1&r?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 8:return 4&r?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.righttop],x:-1,y:0,o:1};case 9:return 1&r?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 10:return 1&r?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.righttop],x:-1,y:0,o:1};case 11:return r&Ti?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 12:return 4&r?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 13:return 1&r?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 14:return 1&r?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 15:return r&Ti?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 16:return 4&r?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 17:return r&Ti?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 18:return 1&r?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 19:return r&Ti?{p:[e.bottomleft,0],x:0,y:1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 20:return r&Ti?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 21:return r&Li?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.topright,1],x:0,y:-1,o:1};case 22:return r&Ti?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 23:return r&Li?{p:[0,e.lefttop],x:1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e)}}return null}function bo(e,t,r,n){var i,o,a,s,l,u=e.cval;switch(t){case-1:switch(n){case 0:i=uo[u],a=Di[u],s=ji[u],l=Bi[u];break;default:i=lo[u],a=Gi[u],s=Ai[u],l=Fi[u]}break;case 1:switch(n){case 0:i=ho[u],a=Ki[u],s=Qi[u],l=$i[u];break;default:i=po[u],a=Xi[u],s=Yi[u],l=Zi[u]}break;default:switch(r){case-1:switch(n){case 0:i=yo[u],a=Pi[u],s=Ci[u],l=Ni[u];break;default:i=go[u],a=Oi[u],s=Ri[u],l=Vi[u]}break;case 1:switch(n){case 0:i=fo[u],a=qi[u],s=Ui[u],l=Ji[u];break;default:i=co[u],a=zi[u],s=Wi[u],l=Hi[u]}}}if(o=e.edges.indexOf(i),void 0===e.edges[o])return null;switch(function(e,t){delete e.edges[t];for(var r=t+1;r<e.edges.length;r++)e.edges[r-1]=e.edges[r];e.edges.pop()}(e,o),u=e.cval_real,i){case 0:u&Li?(t=e.topleft,r=1):(t=1,r=e.righttop);break;case 1:4&u?(t=1,r=e.rightbottom):(t=e.topleft,r=1);break;case 2:4&u?(t=e.topleft,r=1):(t=e.bottomright,r=0);break;case 3:1&u?(t=e.bottomleft,r=0):(t=e.topleft,r=1);break;case 4:u&Li?(t=e.topright,r=1):(t=1,r=e.righttop);break;case 5:4&u?(t=1,r=e.rightbottom):(t=e.topright,r=1);break;case 6:4&u?(t=e.topright,r=1):(t=e.bottomright,r=0);break;case 7:1&u?(t=e.bottomleft,r=0):(t=e.topright,r=1);break;case 8:4&u?(t=1,r=e.righttop):(t=e.bottomright,r=0);break;case 9:1&u?(t=e.bottomleft,r=0):(t=1,r=e.righttop);break;case 10:1&u?(t=1,r=e.righttop):(t=0,r=e.leftbottom);break;case 11:u&Ti?(t=0,r=e.lefttop):(t=1,r=e.righttop);break;case 12:4&u?(t=1,r=e.rightbottom):(t=e.bottomright,r=0);break;case 13:1&u?(t=e.bottomleft,r=0):(t=1,r=e.rightbottom);break;case 14:1&u?(t=1,r=e.rightbottom):(t=0,r=e.leftbottom);break;case 15:u&Ti?(t=0,r=e.lefttop):(t=1,r=e.rightbottom);break;case 16:4&u?(t=0,r=e.leftbottom):(t=e.bottomright,r=0);break;case 17:u&Ti?(t=0,r=e.lefttop):(t=e.bottomright,r=0);break;case 18:1&u?(t=e.bottomleft,r=0):(t=0,r=e.leftbottom);break;case 19:u&Ti?(t=0,r=e.lefttop):(t=e.bottomleft,r=0);break;case 20:u&Ti?(t=0,r=e.leftbottom):(t=e.topleft,r=1);break;case 21:u&Li?(t=e.topright,r=1):(t=0,r=e.leftbottom);break;case 22:u&Ti?(t=0,r=e.lefttop):(t=e.topleft,r=1);break;case 23:u&Li?(t=e.topright,r=1):(t=0,r=e.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e),null}return void 0!==t&&void 0!==r&&void 0!==a&&void 0!==s&&void 0!==l||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(e),console.log(t+" "+r+" "+a+" "+s+" "+l)),{p:[t,r],x:a,y:s,o:l}}function wo(e){var t=[],r=[];e.forEach(function(e){var n=_n(c([e]));r.push(n),t.push({ring:e,area:n})}),r.sort(function(e,t){return t-e});var n=[];return r.forEach(function(e){for(var r=0;r<t.length;r++)if(t[r].area===e){n.push(t[r].ring),t.splice(r,1);break}}),n}function ko(e){for(var t=e.map(function(e){return{lrCoordinates:e,grouped:!1}}),r=[];!Eo(t);)for(var n=0;n<t.length;n++)if(!t[n].grouped){var i=[];i.push(t[n].lrCoordinates),t[n].grouped=!0;for(var o=c([t[n].lrCoordinates]),a=n+1;a<t.length;a++)t[a].grouped||Mo(c([t[a].lrCoordinates]),o)&&(i.push(t[a].lrCoordinates),t[a].grouped=!0);r.push(i)}return r}function Mo(e,t){for(var r=lr(e),n=0;n<r.features.length;n++)if(!pt(r.features[n],t))return!1;return!0}function Eo(e){for(var t=0;t<e.length;t++)if(!1===e[t].grouped)return!1;return!0}function Io(e,t,r){if(!L(r=r||{}))throw new Error("options is invalid");var n=r.pivot,i=r.mutate;if(!e)throw new Error("geojson is required");if(null==t||isNaN(t))throw new Error("angle is required");return 0===t||(n||(n=sr(e)),!1!==i&&void 0!==i||(e=bt(e)),O(e,function(e){var r=yi(n,e)+t,i=fn(n,e),o=$(vi(n,i,r));e[0]=o[0],e[1]=o[1]})),e}function To(e,t,r){if(!L(r=r||{}))throw new Error("options is invalid");var n=r.origin,i=r.mutate;if(!e)throw new Error("geojson required");if("number"!=typeof t||0===t)throw new Error("invalid factor");var o=Array.isArray(n)||"object"==typeof n;return!0!==i&&(e=bt(e)),"FeatureCollection"!==e.type||o?Lo(e,t,n):(A(e,function(r,i){e.features[i]=Lo(r,t,n)}),e)}function Lo(e,t,r){var n="Point"===oe(e);return r=function(e,t){if(null==t&&(t="centroid"),Array.isArray(t)||"object"==typeof t)return Q(t);var r=e.bbox?e.bbox:K(e),n=r[0],i=r[1],o=r[2],a=r[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return l([n,i]);case"se":case"southeast":case"eastsouth":case"bottomright":return l([o,i]);case"nw":case"northwest":case"westnorth":case"topleft":return l([n,a]);case"ne":case"northeast":case"eastnorth":case"topright":return l([o,a]);case"center":return ar(e);case void 0:case null:case"centroid":return sr(e);default:throw new Error("invalid origin")}}(e,r),1===t||n||O(e,function(e){var n=fn(r,e),i=yi(r,e),o=$(vi(r,n*t,i));e[0]=o[0],e[1]=o[1],3===e.length&&(e[2]*=t)}),e}function Po(e){var t=e[0],r=e[1];return[r[0]-t[0],r[1]-t[1]]}function Co(e,t){return e[0]*t[1]-t[0]*e[1]}function No(e,t,r){var n=[],i=b(t,r),o=$(e),a=[];return o.forEach(function(e,t){if(t!==o.length-1){var r=(u=e,c=o[t+1],f=i,h=Math.sqrt((u[0]-c[0])*(u[0]-c[0])+(u[1]-c[1])*(u[1]-c[1])),d=u[0]+f*(c[1]-u[1])/h,p=c[0]+f*(c[1]-u[1])/h,[[d,u[1]+f*(u[0]-c[0])/h],[p,c[1]+f*(u[0]-c[0])/h]]);if(n.push(r),t>0){var s=n[t-1],l=function(e,t){return!function(e,t){return 0===Co(Po(e),Po(t))}(e,t)&&function(e,t){var r,n,i=e[0],o=Po(e),a=t[0],s=Po(t),l=Co(o,s);return function(e,t){return[e[0]+t[0],e[1]+t[1]]}(i,function(e,t){return[e*t[0],e*t[1]]}(Co((n=i,[(r=a)[0]-n[0],r[1]-n[1]]),s)/l,o))}(e,t)}(r,s);!1!==l&&(s[1]=l,r[0]=l),a.push(s[0]),t===o.length-2&&(a.push(r[0]),a.push(r[1]))}2===o.length&&(a.push(r[0]),a.push(r[1]))}var u,c,f,h,d,p}),h(a,e.properties)}function Oo(e,t,r){var n=t[0]-e[0],i=t[1]-e[1],o=r[0]-t[0];return function(e){return(e>0)-(e<0)||+e}(n*(r[1]-t[1])-o*i)}function Ro(e,t){return t.geometry.coordinates[0].every(function(t){return pt(l(t),e)})}vo[1]=vo[169]=eo,vo[4]=vo[166]=to,vo[16]=vo[154]=ro,vo[64]=vo[106]=no,vo[168]=vo[2]=io,vo[162]=vo[8]=oo,vo[138]=vo[32]=ao,vo[42]=vo[128]=so,vo[5]=vo[165]=function(e){return[[0,0],[0,e.leftbottom],[1,e.rightbottom],[1,0]]},vo[20]=vo[150]=function(e){return[[1,0],[e.bottomright,0],[e.topright,1],[1,1]]},vo[80]=vo[90]=function(e){return[[1,1],[1,e.righttop],[0,e.lefttop],[0,1]]},vo[65]=vo[105]=function(e){return[[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},vo[160]=vo[10]=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.leftbottom],[0,e.lefttop]]},vo[130]=vo[40]=function(e){return[[e.topleft,1],[e.topright,1],[e.bottomright,0],[e.bottomleft,0]]},vo[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},vo[101]=vo[69]=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,1],[e.topleft,1]]},vo[149]=vo[21]=function(e){return[[e.topright,1],[1,1],[1,0],[0,0],[0,e.leftbottom]]},vo[86]=vo[84]=function(e){return[[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[1,1]]},vo[89]=vo[81]=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,1]]},vo[96]=vo[74]=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.lefttop],[0,1],[e.topleft,1]]},vo[24]=vo[146]=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[e.topright,1]]},vo[6]=vo[164]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop]]},vo[129]=vo[41]=function(e){return[[e.topright,1],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1]]},vo[66]=vo[104]=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},vo[144]=vo[26]=function(e){return[[1,1],[1,e.righttop],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},vo[36]=vo[134]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[e.topleft,1],[e.topright,1]]},vo[9]=vo[161]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom]]},vo[37]=vo[133]=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},vo[148]=vo[22]=function(e){return[[1,1],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},vo[82]=vo[88]=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1]]},vo[73]=vo[97]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},vo[145]=vo[25]=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},vo[70]=vo[100]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},vo[34]=function(e){return[so(e),oo(e)]},vo[35]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},vo[136]=function(e){return[ao(e),io(e)]},vo[153]=function(e){return[ro(e),eo(e)]},vo[102]=function(e){return[to(e),no(e)]},vo[155]=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},vo[103]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},vo[152]=function(e){return[ro(e),io(e)]},vo[156]=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},vo[137]=function(e){return[ao(e),eo(e)]},vo[139]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},vo[98]=function(e){return[oo(e),no(e)]},vo[99]=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},vo[38]=function(e){return[to(e),so(e)]},vo[39]=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]};var Vo=function(){function e(t){this.id=e.buildId(t),this.coordinates=t,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return e.buildId=function(e){return e.join(",")},e.prototype.removeInnerEdge=function(e){this.innerEdges=this.innerEdges.filter(function(t){return t.from.id!==e.from.id})},e.prototype.removeOuterEdge=function(e){this.outerEdges=this.outerEdges.filter(function(t){return t.to.id!==e.to.id})},e.prototype.addOuterEdge=function(e){this.outerEdges.push(e),this.outerEdgesSorted=!1},e.prototype.sortOuterEdges=function(){var e=this;this.outerEdgesSorted||(this.outerEdges.sort(function(t,r){var n=t.to,i=r.to;if(n.coordinates[0]-e.coordinates[0]>=0&&i.coordinates[0]-e.coordinates[0]<0)return 1;if(n.coordinates[0]-e.coordinates[0]<0&&i.coordinates[0]-e.coordinates[0]>=0)return-1;if(n.coordinates[0]-e.coordinates[0]==0&&i.coordinates[0]-e.coordinates[0]==0)return n.coordinates[1]-e.coordinates[1]>=0||i.coordinates[1]-e.coordinates[1]>=0?n.coordinates[1]-i.coordinates[1]:i.coordinates[1]-n.coordinates[1];var o=Oo(e.coordinates,n.coordinates,i.coordinates);return o<0?1:o>0?-1:Math.pow(n.coordinates[0]-e.coordinates[0],2)+Math.pow(n.coordinates[1]-e.coordinates[1],2)-(Math.pow(i.coordinates[0]-e.coordinates[0],2)+Math.pow(i.coordinates[1]-e.coordinates[1],2))}),this.outerEdgesSorted=!0)},e.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},e.prototype.getOuterEdge=function(e){return this.sortOuterEdges(),this.outerEdges[e]},e.prototype.addInnerEdge=function(e){this.innerEdges.push(e)},e}(),Go=function(){function e(e,t){this.from=e,this.to=t,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return e.prototype.getSymetric=function(){return this.symetric||(this.symetric=new e(this.to,this.from),this.symetric.symetric=this),this.symetric},e.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},e.prototype.isEqual=function(e){return this.from.id===e.from.id&&this.to.id===e.to.id},e.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},e.prototype.toLineString=function(){return h([this.from.coordinates,this.to.coordinates])},e.prototype.compareTo=function(e){return Oo(e.from.coordinates,e.to.coordinates,this.to.coordinates)},e}(),Ao=function(){function e(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return e.prototype.push=function(e){this.edges.push(e),this.polygon=this.envelope=void 0},e.prototype.get=function(e){return this.edges[e]},Object.defineProperty(e.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){this.edges.forEach(e)},e.prototype.map=function(e){return this.edges.map(e)},e.prototype.some=function(e){return this.edges.some(e)},e.prototype.isValid=function(){return!0},e.prototype.isHole=function(){var e=this,t=this.edges.reduce(function(t,r,n){return r.from.coordinates[1]>e.edges[t].from.coordinates[1]&&(t=n),t},0),r=(0===t?this.length:t)-1,n=(t+1)%this.length,i=Oo(this.edges[r].from.coordinates,this.edges[t].from.coordinates,this.edges[n].from.coordinates);return 0===i?this.edges[r].from.coordinates[0]>this.edges[n].from.coordinates[0]:i>0},e.prototype.toMultiPoint=function(){return g(this.edges.map(function(e){return e.from.coordinates}))},e.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var e=this.edges.map(function(e){return e.from.coordinates});return e.push(this.edges[0].from.coordinates),this.polygon=c([e])},e.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=tr(this.toPolygon())},e.findEdgeRingContaining=function(e,t){var r,n,i=e.getEnvelope();return t.forEach(function(t){var o,a,s,u,c,f,h=t.getEnvelope();if(n&&(r=n.getEnvelope()),a=i,s=(o=h).geometry.coordinates[0].map(function(e){return e[0]}),u=o.geometry.coordinates[0].map(function(e){return e[1]}),c=a.geometry.coordinates[0].map(function(e){return e[0]}),f=a.geometry.coordinates[0].map(function(e){return e[1]}),(Math.max.apply(null,s)!==Math.max.apply(null,c)||Math.max.apply(null,u)!==Math.max.apply(null,f)||Math.min.apply(null,s)!==Math.min.apply(null,c)||Math.min.apply(null,u)!==Math.min.apply(null,f))&&Ro(h,i)){for(var d=void 0,p=function(e){t.some(function(t){return r=e,n=t.from.coordinates,r[0]===n[0]&&r[1]===n[1];var r,n})||(d=e)},y=0,g=e.map(function(e){return e.from.coordinates});y<g.length;y++)p(g[y]);d&&t.inside(l(d))&&(n&&!Ro(r,h)||(n=t))}}),n},e.prototype.inside=function(e){return pt(e,this.toPolygon())},e}(),Fo=function(){function e(){this.edges=[],this.nodes={}}return e.fromGeoJson=function(t){!function(e){if(!e)throw new Error("No geojson passed");if("FeatureCollection"!==e.type&&"GeometryCollection"!==e.type&&"MultiLineString"!==e.type&&"LineString"!==e.type&&"Feature"!==e.type)throw new Error("Invalid input type '"+e.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(t);var r=new e;return q(t,function(e){re(e,"LineString","Graph::fromGeoJson"),R(e,function(e,t){if(e){var n=r.getNode(e),i=r.getNode(t);r.addEdge(n,i)}return t})}),r},e.prototype.getNode=function(e){var t=Vo.buildId(e),r=this.nodes[t];return r||(r=this.nodes[t]=new Vo(e)),r},e.prototype.addEdge=function(e,t){var r=new Go(e,t),n=r.getSymetric();this.edges.push(r),this.edges.push(n)},e.prototype.deleteDangles=function(){var e=this;Object.keys(this.nodes).map(function(t){return e.nodes[t]}).forEach(function(t){return e._removeIfDangle(t)})},e.prototype._removeIfDangle=function(e){var t=this;if(e.innerEdges.length<=1){var r=e.getOuterEdges().map(function(e){return e.to});this.removeNode(e),r.forEach(function(e){return t._removeIfDangle(e)})}},e.prototype.deleteCutEdges=function(){var e=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(t){t.label===t.symetric.label&&(e.removeEdge(t.symetric),e.removeEdge(t))})},e.prototype._computeNextCWEdges=function(e){var t=this;void 0===e?Object.keys(this.nodes).forEach(function(e){return t._computeNextCWEdges(t.nodes[e])}):e.getOuterEdges().forEach(function(t,r){e.getOuterEdge((0===r?e.getOuterEdges().length:r)-1).symetric.next=t})},e.prototype._computeNextCCWEdges=function(e,t){for(var r,n,i=e.getOuterEdges(),o=i.length-1;o>=0;--o){var a=i[o],s=a.symetric,l=void 0,u=void 0;a.label===t&&(l=a),s.label===t&&(u=s),l&&u&&(u&&(n=u),l&&(n&&(n.next=l,n=void 0),r||(r=l)))}n&&(n.next=r)},e.prototype._findLabeledEdgeRings=function(){var e=[],t=0;return this.edges.forEach(function(r){if(!(r.label>=0)){e.push(r);var n=r;do{n.label=t,n=n.next}while(!r.isEqual(n));t++}}),e},e.prototype.getEdgeRings=function(){var e=this;this._computeNextCWEdges(),this.edges.forEach(function(e){e.label=void 0}),this._findLabeledEdgeRings().forEach(function(t){e._findIntersectionNodes(t).forEach(function(r){e._computeNextCCWEdges(r,t.label)})});var t=[];return this.edges.forEach(function(r){r.ring||t.push(e._findEdgeRing(r))}),t},e.prototype._findIntersectionNodes=function(e){var t=[],r=e,n=function(){var n=0;r.from.getOuterEdges().forEach(function(t){t.label===e.label&&++n}),n>1&&t.push(r.from),r=r.next};do{n()}while(!e.isEqual(r));return t},e.prototype._findEdgeRing=function(e){var t=e,r=new Ao;do{r.push(t),t.ring=r,t=t.next}while(!e.isEqual(t));return r},e.prototype.removeNode=function(e){var t=this;e.getOuterEdges().forEach(function(e){return t.removeEdge(e)}),e.innerEdges.forEach(function(e){return t.removeEdge(e)}),delete this.nodes[e.id]},e.prototype.removeEdge=function(e){this.edges=this.edges.filter(function(t){return!t.isEqual(e)}),e.deleteEdge()},e}();function Do(e,t){var r=!0;return q(e,function(e){q(t,function(t){if(!1===r)return!1;r=function(e,t){switch(e.type){case"Point":switch(t.type){case"Point":return r=e.coordinates,n=t.coordinates,!(r[0]===n[0]&&r[1]===n[1]);case"LineString":return!jo(t,e);case"Polygon":return!pt(e,t)}break;case"LineString":switch(t.type){case"Point":return!jo(e,t);case"LineString":return!function(e,t){return ln(e,t).features.length>0}(e,t);case"Polygon":return!Bo(t,e)}break;case"Polygon":switch(t.type){case"Point":return!pt(t,e);case"LineString":return!Bo(e,t);case"Polygon":return!function(e,t){for(var r=0,n=e.coordinates[0];r<n.length;r++)if(pt(n[r],t))return!0;for(var i=0,o=t.coordinates[0];i<o.length;i++)if(pt(o[i],e))return!0;return ln($n(e),$n(t)).features.length>0}(t,e)}}var r,n;return!1}(e.geometry,t.geometry)})}),r}function jo(e,t){for(var r=0;r<e.coordinates.length-1;r++)if(qo(e.coordinates[r],e.coordinates[r+1],t.coordinates))return!0;return!1}function Bo(e,t){for(var r=0,n=t.coordinates;r<n.length;r++)if(pt(n[r],e))return!0;return ln(t,$n(e)).features.length>0}function qo(e,t,r){var n=r[0]-e[0],i=r[1]-e[1],o=t[0]-e[0],a=t[1]-e[1];return 0==n*a-i*o&&(Math.abs(o)>=Math.abs(a)?o>0?e[0]<=r[0]&&r[0]<=t[0]:t[0]<=r[0]&&r[0]<=e[0]:a>0?e[1]<=r[1]&&r[1]<=t[1]:t[1]<=r[1]&&r[1]<=e[1])}function Uo(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function Jo(e,t){return e[0]===t[0]&&e[1]===t[1]}function zo(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function Wo(e,t){for(var r=!1,n=!1,i=e.coordinates.length,o=0;o<i&&!r&&!n;){for(var a=0;a<t.coordinates.length-1;a++){var s=!0;0!==a&&a!==t.coordinates.length-2||(s=!1),Yo(t.coordinates[a],t.coordinates[a+1],e.coordinates[o],s)?r=!0:n=!0}o++}return r&&n}function Ho(e,t){return ln(e,ei(t)).features.length>0}function Xo(e,t){for(var r=!1,n=!1,i=e.coordinates.length,o=0;o<i&&(!r||!n);o++)pt(l(e.coordinates[o]),t)?r=!0:n=!0;return n&&r}function Yo(e,t,r,n){var i=r[0]-e[0],o=r[1]-e[1],a=t[0]-e[0],s=t[1]-e[1];return 0==i*s-o*a&&(n?Math.abs(a)>=Math.abs(s)?a>0?e[0]<=r[0]&&r[0]<=t[0]:t[0]<=r[0]&&r[0]<=e[0]:s>0?e[1]<=r[1]&&r[1]<=t[1]:t[1]<=r[1]&&r[1]<=e[1]:Math.abs(a)>=Math.abs(s)?a>0?e[0]<r[0]&&r[0]<t[0]:t[0]<r[0]&&r[0]<e[0]:s>0?e[1]<r[1]&&r[1]<t[1]:t[1]<r[1]&&r[1]<e[1])}var Zo=function(e){this.precision=e&&e.precision?e.precision:17,this.direction=!(!e||!e.direction)&&e.direction,this.pseudoNode=!(!e||!e.pseudoNode)&&e.pseudoNode,this.objectComparator=e&&e.objectComparator?e.objectComparator:$o};function Ko(e){return e.coordinates.map(function(t){return{type:e.type.replace("Multi",""),coordinates:t}})}function Qo(e,t){return e.hasOwnProperty("coordinates")?e.coordinates.length===t.coordinates.length:e.length===t.length}function $o(e,t){return fi(e,t,{strict:!0})}Zo.prototype.compare=function(e,t){if(e.type!==t.type||!Qo(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates,0,!1);case"Polygon":return this.comparePolygon(e,t);case"Feature":return this.compareFeature(e,t);default:if(0===e.type.indexOf("Multi")){var r=this,n=Ko(e),i=Ko(t);return n.every(function(e){return this.some(function(t){return r.compare(e,t)})},i)}}return!1},Zo.prototype.compareCoord=function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r].toFixed(this.precision)!==t[r].toFixed(this.precision))return!1;return!0},Zo.prototype.compareLine=function(e,t,r,n){if(!Qo(e,t))return!1;var i=this.pseudoNode?e:this.removePseudo(e),o=this.pseudoNode?t:this.removePseudo(t);if(!n||this.compareCoord(i[0],o[0])||(o=this.fixStartIndex(o,i))){var a=this.compareCoord(i[r],o[r]);return this.direction||a?this.comparePath(i,o):!!this.compareCoord(i[r],o[o.length-(1+r)])&&this.comparePath(i.slice().reverse(),o)}},Zo.prototype.fixStartIndex=function(e,t){for(var r,n=-1,i=0;i<e.length;i++)if(this.compareCoord(e[i],t[0])){n=i;break}return n>=0&&(r=[].concat(e.slice(n,e.length),e.slice(1,n+1))),r},Zo.prototype.comparePath=function(e,t){var r=this;return e.every(function(e,t){return r.compareCoord(e,this[t])},t)},Zo.prototype.comparePolygon=function(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){var r=e.coordinates.slice(1,e.coordinates.length),n=t.coordinates.slice(1,t.coordinates.length),i=this;return r.every(function(e){return this.some(function(t){return i.compareLine(e,t,1,!0)})},n)}return!1},Zo.prototype.compareFeature=function(e,t){return!(e.id!==t.id||!this.objectComparator(e.properties,t.properties)||!this.compareBBox(e,t))&&this.compare(e.geometry,t.geometry)},Zo.prototype.compareBBox=function(e,t){return!!(!e.bbox&&!t.bbox||e.bbox&&t.bbox&&this.compareCoord(e.bbox,t.bbox))},Zo.prototype.removePseudo=function(e){return e};var ea=Zo;function ta(e,t){var r=!1;return q(e,function(e){q(t,function(t){if(!0===r)return!0;r=!Do(e.geometry,t.geometry)})}),r}var ra=Fe(function(e){function t(e,t,r,n){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(e,t,r,n)}t.prototype.run=function(e,t,r,n){this._init(e,t,r,n);for(var i=0;i<this._datasetLength;i++)if(1!==this._visited[i]){this._visited[i]=1;var o=this._regionQuery(i);if(o.length<this.minPts)this.noise.push(i);else{var a=this.clusters.length;this.clusters.push([]),this._addToCluster(i,a),this._expandCluster(a,o)}}return this.clusters},t.prototype._init=function(e,t,r,n){if(e){if(!(e instanceof Array))throw Error("Dataset must be of type array, "+typeof e+" given");this.dataset=e,this.clusters=[],this.noise=[],this._datasetLength=e.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}t&&(this.epsilon=t),r&&(this.minPts=r),n&&(this.distance=n)},t.prototype._expandCluster=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(1!==this._visited[n]){this._visited[n]=1;var i=this._regionQuery(n);i.length>=this.minPts&&(t=this._mergeArrays(t,i))}1!==this._assigned[n]&&this._addToCluster(n,e)}},t.prototype._addToCluster=function(e,t){this.clusters[t].push(e),this._assigned[e]=1},t.prototype._regionQuery=function(e){for(var t=[],r=0;r<this._datasetLength;r++)this.distance(this.dataset[e],this.dataset[r])<this.epsilon&&t.push(r);return t},t.prototype._mergeArrays=function(e,t){for(var r=t.length,n=0;n<r;n++){var i=t[n];e.indexOf(i)<0&&e.push(i)}return e},t.prototype._euclideanDistance=function(e,t){for(var r=0,n=Math.min(e.length,t.length);n--;)r+=(e[n]-t[n])*(e[n]-t[n]);return Math.sqrt(r)},e.exports&&(e.exports=t)}),na=Fe(function(e){function t(e,t,r){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(e,t,r)}t.prototype.init=function(e,t,r){this.assignments=[],this.centroids=[],void 0!==e&&(this.dataset=e),void 0!==t&&(this.k=t),void 0!==r&&(this.distance=r)},t.prototype.run=function(e,t){this.init(e,t);for(var r=this.dataset.length,n=0;n<this.k;n++)this.centroids[n]=this.randomCentroid();for(var i=!0;i;){i=this.assign();for(var o=0;o<this.k;o++){for(var a=new Array(c),s=0,l=0;l<c;l++)a[l]=0;for(var u=0;u<r;u++){var c=this.dataset[u].length;if(o===this.assignments[u]){for(l=0;l<c;l++)a[l]+=this.dataset[u][l];s++}}if(s>0){for(l=0;l<c;l++)a[l]/=s;this.centroids[o]=a}else this.centroids[o]=this.randomCentroid(),i=!0}}return this.getClusters()},t.prototype.randomCentroid=function(){var e,t,r=this.dataset.length-1;do{t=Math.round(Math.random()*r),e=this.dataset[t]}while(this.centroids.indexOf(e)>=0);return e},t.prototype.assign=function(){for(var e,t=!1,r=this.dataset.length,n=0;n<r;n++)(e=this.argmin(this.dataset[n],this.centroids,this.distance))!=this.assignments[n]&&(this.assignments[n]=e,t=!0);return t},t.prototype.getClusters=function(){for(var e,t=new Array(this.k),r=0;r<this.assignments.length;r++)void 0===t[e=this.assignments[r]]&&(t[e]=[]),t[e].push(r);return t},t.prototype.argmin=function(e,t,r){for(var n,i=Number.MAX_VALUE,o=0,a=t.length,s=0;s<a;s++)(n=r(e,t[s]))<i&&(i=n,o=s);return o},t.prototype.distance=function(e,t){for(var r=0,n=Math.min(e.length,t.length);n--;){var i=e[n]-t[n];r+=i*i}return Math.sqrt(r)},e.exports&&(e.exports=t)}),ia=Fe(function(e){function t(e,t,r){this._queue=[],this._priorities=[],this._sorting="desc",this._init(e,t,r)}t.prototype.insert=function(e,t){for(var r=this._queue.length,n=r;n--;){var i=this._priorities[n];"desc"===this._sorting?t>i&&(r=n):t<i&&(r=n)}this._insertAt(e,t,r)},t.prototype.remove=function(e){for(var t=this._queue.length;t--;)if(e===this._queue[t]){this._queue.splice(t,1),this._priorities.splice(t,1);break}},t.prototype.forEach=function(e){this._queue.forEach(e)},t.prototype.getElements=function(){return this._queue},t.prototype.getElementPriority=function(e){return this._priorities[e]},t.prototype.getPriorities=function(){return this._priorities},t.prototype.getElementsWithPriorities=function(){for(var e=[],t=0,r=this._queue.length;t<r;t++)e.push([this._queue[t],this._priorities[t]]);return e},t.prototype._init=function(e,t,r){if(e&&t){if(this._queue=[],this._priorities=[],e.length!==t.length)throw new Error("Arrays must have the same length");for(var n=0;n<e.length;n++)this.insert(e[n],t[n])}r&&(this._sorting=r)},t.prototype._insertAt=function(e,t,r){this._queue.length===r?(this._queue.push(e),this._priorities.push(t)):(this._queue.splice(r,0,e),this._priorities.splice(r,0,t))},e.exports&&(e.exports=t)}),oa=Fe(function(e){if(e.exports)var t=ia;function r(e,t,r,n){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(e,t,r,n)}r.prototype.run=function(e,r,n,i){this._init(e,r,n,i);for(var o=0,a=this.dataset.length;o<a;o++)if(1!==this._processed[o]){this._processed[o]=1,this.clusters.push([o]);var s=this.clusters.length-1;this._orderedList.push(o);var l=new t(null,null,"asc"),u=this._regionQuery(o);void 0!==this._distanceToCore(o)&&(this._updateQueue(o,u,l),this._expandCluster(s,l))}return this.clusters},r.prototype.getReachabilityPlot=function(){for(var e=[],t=0,r=this._orderedList.length;t<r;t++){var n=this._orderedList[t],i=this._reachability[n];e.push([n,i])}return e},r.prototype._init=function(e,t,r,n){if(e){if(!(e instanceof Array))throw Error("Dataset must be of type array, "+typeof e+" given");this.dataset=e,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}t&&(this.epsilon=t),r&&(this.minPts=r),n&&(this.distance=n)},r.prototype._updateQueue=function(e,t,r){var n=this;this._coreDistance=this._distanceToCore(e),t.forEach(function(t){if(void 0===n._processed[t]){var i=n.distance(n.dataset[e],n.dataset[t]),o=Math.max(n._coreDistance,i);void 0===n._reachability[t]?(n._reachability[t]=o,r.insert(t,o)):o<n._reachability[t]&&(n._reachability[t]=o,r.remove(t),r.insert(t,o))}})},r.prototype._expandCluster=function(e,t){for(var r=t.getElements(),n=0,i=r.length;n<i;n++){var o=r[n];if(void 0===this._processed[o]){var a=this._regionQuery(o);this._processed[o]=1,this.clusters[e].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,a,t),this._expandCluster(e,t))}}},r.prototype._distanceToCore=function(e){for(var t=this.epsilon,r=0;r<t;r++)if(this._regionQuery(e,r).length>=this.minPts)return r},r.prototype._regionQuery=function(e,t){t=t||this.epsilon;for(var r=[],n=0,i=this.dataset.length;n<i;n++)this.distance(this.dataset[e],this.dataset[n])<t&&r.push(n);return r},r.prototype._euclideanDistance=function(e,t){for(var r=0,n=Math.min(e.length,t.length);n--;)r+=(e[n]-t[n])*(e[n]-t[n]);return Math.sqrt(r)},e.exports&&(e.exports=r)}),aa=Fe(function(e){e.exports&&(e.exports={DBSCAN:ra,KMEANS:na,OPTICS:oa,PriorityQueue:ia})}),sa=function(e,t,r){for(var n=e.length,i=0,o=0;o<n;o++){var a=(e[o]||0)-(t[o]||0);i+=a*a}return r?Math.sqrt(i):i},la=sa,ua=function(e,t,r){var n=Math.abs(e-t);return r?n:n*n},ca=sa;function fa(e,t,r){r=r||[];for(var n=0;n<e;n++)r[n]=t;return r}function ha(e,t){return w(yi(e[0],e[1]))===w(yi(t[0],t[1]))}function da(e,t){if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error("Invalid GeoJSON object for "+t)}function pa(e){for(var t=e,r=[];t.parent;)r.unshift(t),t=t.parent;return r}var ya={search:function(e,t,r,n){e.cleanDirty();var i=(n=n||{}).heuristic||ya.heuristics.manhattan,o=n.closest||!1,a=new ma(function(e){return e.f}),s=t;for(t.h=i(t,r),a.push(t);a.size()>0;){var l=a.pop();if(l===r)return pa(l);l.closed=!0;for(var u=e.neighbors(l),c=0,f=u.length;c<f;++c){var h=u[c];if(!h.closed&&!h.isWall()){var d=l.g+h.getCost(l),p=h.visited;(!p||d<h.g)&&(h.visited=!0,h.parent=l,h.h=h.h||i(h,r),h.g=d,h.f=h.g+h.h,e.markDirty(h),o&&(h.h<s.h||h.h===s.h&&h.g<s.g)&&(s=h),p?a.rescoreElement(h):a.push(h))}}}return o?pa(s):[]},heuristics:{manhattan:function(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},diagonal:function(e,t){var r=Math.sqrt(2),n=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y);return 1*(n+i)+(r-2)*Math.min(n,i)}},cleanNode:function(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}};function ga(e,t){t=t||{},this.nodes=[],this.diagonal=!!t.diagonal,this.grid=[];for(var r=0;r<e.length;r++){this.grid[r]=[];for(var n=0,i=e[r];n<i.length;n++){var o=new va(r,n,i[n]);this.grid[r][n]=o,this.nodes.push(o)}}this.init()}function va(e,t,r){this.x=e,this.y=t,this.weight=r}function ma(e){this.content=[],this.scoreFunction=e}function _a(e,t){for(var r=0;r<t.features.length;r++)if(pt(e,t.features[r]))return!0;return!1}function Sa(e){return function(){return e}}function xa(e){return e[0]}function ba(e){return e[1]}function wa(){this._=null}function ka(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function Ma(e,t){var r=t,n=t.R,i=r.U;i?i.L===r?i.L=n:i.R=n:e._=n,n.U=i,r.U=n,r.R=n.L,r.R&&(r.R.U=r),n.L=r}function Ea(e,t){var r=t,n=t.L,i=r.U;i?i.L===r?i.L=n:i.R=n:e._=n,n.U=i,r.U=n,r.L=n.R,r.L&&(r.L.U=r),n.R=r}function Ia(e){for(;e.L;)e=e.L;return e}function Ta(e,t,r,n){var i=[null,null],o=Za.push(i)-1;return i.left=e,i.right=t,r&&Pa(i,e,t,r),n&&Pa(i,t,e,n),Xa[e.index].halfedges.push(o),Xa[t.index].halfedges.push(o),i}function La(e,t,r){var n=[t,r];return n.left=e,n}function Pa(e,t,r,n){e[0]||e[1]?e.left===r?e[1]=n:e[0]=n:(e[0]=n,e.left=t,e.right=r)}function Ca(e,t,r,n,i){var o,a=e[0],s=e[1],l=a[0],u=a[1],c=0,f=1,h=s[0]-l,d=s[1]-u;if(o=t-l,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<f&&(f=o)}else if(h>0){if(o>f)return;o>c&&(c=o)}if(o=n-l,h||!(o<0)){if(o/=h,h<0){if(o>f)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<f&&(f=o)}if(o=r-u,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<f&&(f=o)}else if(d>0){if(o>f)return;o>c&&(c=o)}if(o=i-u,d||!(o<0)){if(o/=d,d<0){if(o>f)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<f&&(f=o)}return!(c>0||f<1)||(c>0&&(e[0]=[l+c*h,u+c*d]),f<1&&(e[1]=[l+f*h,u+f*d]),!0)}}}}}function Na(e,t,r,n,i){var o=e[1];if(o)return!0;var a,s,l=e[0],u=e.left,c=e.right,f=u[0],h=u[1],d=c[0],p=c[1],y=(f+d)/2,g=(h+p)/2;if(p===h){if(y<t||y>=n)return;if(f>d){if(l){if(l[1]>=i)return}else l=[y,r];o=[y,i]}else{if(l){if(l[1]<r)return}else l=[y,i];o=[y,r]}}else if(s=g-(a=(f-d)/(p-h))*y,a<-1||a>1)if(f>d){if(l){if(l[1]>=i)return}else l=[(r-s)/a,r];o=[(i-s)/a,i]}else{if(l){if(l[1]<r)return}else l=[(i-s)/a,i];o=[(r-s)/a,r]}else if(h<p){if(l){if(l[0]>=n)return}else l=[t,a*t+s];o=[n,a*n+s]}else{if(l){if(l[0]<t)return}else l=[n,a*n+s];o=[t,a*t+s]}return e[0]=l,e[1]=o,!0}function Oa(e,t){var r=e.site,n=t.left,i=t.right;return r===i&&(i=n,n=r),i?Math.atan2(i[1]-n[1],i[0]-n[0]):(r===n?(n=t[1],i=t[0]):(n=t[0],i=t[1]),Math.atan2(n[0]-i[0],i[1]-n[1]))}function Ra(e,t){return t[+(t.left!==e.site)]}function Va(e,t){return t[+(t.left===e.site)]}ga.prototype.init=function(){this.dirtyNodes=[];for(var e=0;e<this.nodes.length;e++)ya.cleanNode(this.nodes[e])},ga.prototype.cleanDirty=function(){for(var e=0;e<this.dirtyNodes.length;e++)ya.cleanNode(this.dirtyNodes[e]);this.dirtyNodes=[]},ga.prototype.markDirty=function(e){this.dirtyNodes.push(e)},ga.prototype.neighbors=function(e){var t=[],r=e.x,n=e.y,i=this.grid;return i[r-1]&&i[r-1][n]&&t.push(i[r-1][n]),i[r+1]&&i[r+1][n]&&t.push(i[r+1][n]),i[r]&&i[r][n-1]&&t.push(i[r][n-1]),i[r]&&i[r][n+1]&&t.push(i[r][n+1]),this.diagonal&&(i[r-1]&&i[r-1][n-1]&&t.push(i[r-1][n-1]),i[r+1]&&i[r+1][n-1]&&t.push(i[r+1][n-1]),i[r-1]&&i[r-1][n+1]&&t.push(i[r-1][n+1]),i[r+1]&&i[r+1][n+1]&&t.push(i[r+1][n+1])),t},ga.prototype.toString=function(){for(var e,t,r,n,i=[],o=this.grid,a=0,s=o.length;a<s;a++){for(e=[],r=0,n=(t=o[a]).length;r<n;r++)e.push(t[r].weight);i.push(e.join(" "))}return i.join("\n")},va.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},va.prototype.getCost=function(e){return e&&e.x!==this.x&&e.y!==this.y?1.41421*this.weight:this.weight},va.prototype.isWall=function(){return 0===this.weight},ma.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},remove:function(e){var t=this.content.indexOf(e),r=this.content.pop();t!==this.content.length-1&&(this.content[t]=r,this.scoreFunction(r)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){for(var t=this.content[e];e>0;){var r=(e+1>>1)-1,n=this.content[r];if(!(this.scoreFunction(t)<this.scoreFunction(n)))break;this.content[r]=t,this.content[e]=n,e=r}},bubbleUp:function(e){for(var t=this.content.length,r=this.content[e],n=this.scoreFunction(r);;){var i,o=e+1<<1,a=o-1,s=null;if(a<t){var l=this.content[a];(i=this.scoreFunction(l))<n&&(s=a)}if(o<t){var u=this.content[o];this.scoreFunction(u)<(null===s?n:i)&&(s=o)}if(null===s)break;this.content[e]=this.content[s],this.content[s]=r,e=s}}},wa.prototype={constructor:wa,insert:function(e,t){var r,n,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;r=e}else this._?(e=Ia(this._),t.P=null,t.N=e,e.P=e.L=t,r=e):(t.P=t.N=null,this._=t,r=null);for(t.L=t.R=null,t.U=r,t.C=!0,e=t;r&&r.C;)r===(n=r.U).L?(i=n.R)&&i.C?(r.C=i.C=!1,n.C=!0,e=n):(e===r.R&&(Ma(this,r),r=(e=r).U),r.C=!1,n.C=!0,Ea(this,n)):(i=n.L)&&i.C?(r.C=i.C=!1,n.C=!0,e=n):(e===r.L&&(Ea(this,r),r=(e=r).U),r.C=!1,n.C=!0,Ma(this,n)),r=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,r,n,i=e.U,o=e.L,a=e.R;if(r=o?a?Ia(a):o:a,i?i.L===e?i.L=r:i.R=r:this._=r,o&&a?(n=r.C,r.C=e.C,r.L=o,o.U=r,r!==a?(i=r.U,r.U=e.U,e=r.R,i.L=e,r.R=a,a.U=r):(r.U=i,i=r,e=r.R)):(n=e.C,e=r),e&&(e.U=i),!n)if(e&&e.C)e.C=!1;else{do{if(e===this._)break;if(e===i.L){if((t=i.R).C&&(t.C=!1,i.C=!0,Ma(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,Ea(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,Ma(this,i),e=this._;break}}else if((t=i.L).C&&(t.C=!1,i.C=!0,Ea(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,Ma(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,Ea(this,i),e=this._;break}t.C=!0,e=i,i=i.U}while(!e.C);e&&(e.C=!1)}}};var Ga,Aa=[];function Fa(e){var t=e.P,r=e.N;if(t&&r){var n=t.site,i=e.site,o=r.site;if(n!==o){var a=i[0],s=i[1],l=n[0]-a,u=n[1]-s,c=o[0]-a,f=o[1]-s,h=2*(l*f-u*c);if(!(h>=-Qa)){var d=l*l+u*u,p=c*c+f*f,y=(f*d-u*p)/h,g=(l*p-c*d)/h,v=Aa.pop()||new function(){ka(this),this.x=this.y=this.arc=this.site=this.cy=null};v.arc=e,v.site=i,v.x=y+a,v.y=(v.cy=g+s)+Math.sqrt(y*y+g*g),e.circle=v;for(var m=null,_=Ya._;_;)if(v.y<_.y||v.y===_.y&&v.x<=_.x){if(!_.L){m=_.P;break}_=_.L}else{if(!_.R){m=_;break}_=_.R}Ya.insert(m,v),m||(Ga=v)}}}}function Da(e){var t=e.circle;t&&(t.P||(Ga=t.N),Ya.remove(t),Aa.push(t),ka(t),e.circle=null)}var ja=[];function Ba(e){var t=ja.pop()||new function(){ka(this),this.edge=this.site=this.circle=null};return t.site=e,t}function qa(e){Da(e),Ha.remove(e),ja.push(e),ka(e)}function Ua(e){var t=e.circle,r=t.x,n=t.cy,i=[r,n],o=e.P,a=e.N,s=[e];qa(e);for(var l=o;l.circle&&Math.abs(r-l.circle.x)<Ka&&Math.abs(n-l.circle.cy)<Ka;)o=l.P,s.unshift(l),qa(l),l=o;s.unshift(l),Da(l);for(var u=a;u.circle&&Math.abs(r-u.circle.x)<Ka&&Math.abs(n-u.circle.cy)<Ka;)a=u.N,s.push(u),qa(u),u=a;s.push(u),Da(u);var c,f=s.length;for(c=1;c<f;++c)u=s[c],l=s[c-1],Pa(u.edge,l.site,u.site,i);l=s[0],(u=s[f-1]).edge=Ta(l.site,u.site,null,i),Fa(l),Fa(u)}function Ja(e){for(var t,r,n,i,o=e[0],a=e[1],s=Ha._;s;)if((n=za(s,a)-o)>Ka)s=s.L;else{if(!((i=o-Wa(s,a))>Ka)){n>-Ka?(t=s.P,r=s):i>-Ka?(t=s,r=s.N):t=r=s;break}if(!s.R){t=s;break}s=s.R}!function(e){Xa[e.index]={site:e,halfedges:[]}}(e);var l=Ba(e);if(Ha.insert(t,l),t||r){if(t===r)return Da(t),r=Ba(t.site),Ha.insert(l,r),l.edge=r.edge=Ta(t.site,l.site),Fa(t),void Fa(r);if(r){Da(t),Da(r);var u=t.site,c=u[0],f=u[1],h=e[0]-c,d=e[1]-f,p=r.site,y=p[0]-c,g=p[1]-f,v=2*(h*g-d*y),m=h*h+d*d,_=y*y+g*g,S=[(g*m-d*_)/v+c,(h*_-y*m)/v+f];Pa(r.edge,u,p,S),l.edge=Ta(u,e,null,S),r.edge=Ta(e,p,null,S),Fa(t),Fa(r)}else l.edge=Ta(t.site,l.site)}}function za(e,t){var r=e.site,n=r[0],i=r[1],o=i-t;if(!o)return n;var a=e.P;if(!a)return-1/0;var s=(r=a.site)[0],l=r[1],u=l-t;if(!u)return s;var c=s-n,f=1/o-1/u,h=c/u;return f?(-h+Math.sqrt(h*h-2*f*(c*c/(-2*u)-l+u/2+i-o/2)))/f+n:(n+s)/2}function Wa(e,t){var r=e.N;if(r)return za(r,t);var n=e.site;return n[1]===t?n[0]:1/0}var Ha,Xa,Ya,Za,Ka=1e-6,Qa=1e-12;function $a(e,t){return t[1]-e[1]||t[0]-e[0]}function es(e,t){var r,n,i,o=e.sort($a).pop();for(Za=[],Xa=new Array(e.length),Ha=new wa,Ya=new wa;;)if(i=Ga,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===r&&o[1]===n||(Ja(o),r=o[0],n=o[1]),o=e.pop();else{if(!i)break;Ua(i.arc)}if(function(){for(var e,t,r,n,i=0,o=Xa.length;i<o;++i)if((e=Xa[i])&&(n=(t=e.halfedges).length)){var a=new Array(n),s=new Array(n);for(r=0;r<n;++r)a[r]=r,s[r]=Oa(e,Za[t[r]]);for(a.sort(function(e,t){return s[t]-s[e]}),r=0;r<n;++r)s[r]=t[a[r]];for(r=0;r<n;++r)t[r]=s[r]}}(),t){var a=+t[0][0],s=+t[0][1],l=+t[1][0],u=+t[1][1];!function(e,t,r,n){for(var i,o=Za.length;o--;)Na(i=Za[o],e,t,r,n)&&Ca(i,e,t,r,n)&&(Math.abs(i[0][0]-i[1][0])>Ka||Math.abs(i[0][1]-i[1][1])>Ka)||delete Za[o]}(a,s,l,u),function(e,t,r,n){var i,o,a,s,l,u,c,f,h,d,p,y,g=Xa.length,v=!0;for(i=0;i<g;++i)if(o=Xa[i]){for(a=o.site,s=(l=o.halfedges).length;s--;)Za[l[s]]||l.splice(s,1);for(s=0,u=l.length;s<u;)p=(d=Va(o,Za[l[s]]))[0],y=d[1],f=(c=Ra(o,Za[l[++s%u]]))[0],h=c[1],(Math.abs(p-f)>Ka||Math.abs(y-h)>Ka)&&(l.splice(s,0,Za.push(La(a,d,Math.abs(p-e)<Ka&&n-y>Ka?[e,Math.abs(f-e)<Ka?h:n]:Math.abs(y-n)<Ka&&r-p>Ka?[Math.abs(h-n)<Ka?f:r,n]:Math.abs(p-r)<Ka&&y-t>Ka?[r,Math.abs(f-r)<Ka?h:t]:Math.abs(y-t)<Ka&&p-e>Ka?[Math.abs(h-t)<Ka?f:e,t]:null))-1),++u);u&&(v=!1)}if(v){var m,_,S,x=1/0;for(i=0,v=null;i<g;++i)(o=Xa[i])&&(S=(m=(a=o.site)[0]-e)*m+(_=a[1]-t)*_)<x&&(x=S,v=o);if(v){var b=[e,t],w=[e,n],k=[r,n],M=[r,t];v.halfedges.push(Za.push(La(a=v.site,b,w))-1,Za.push(La(a,w,k))-1,Za.push(La(a,k,M))-1,Za.push(La(a,M,b))-1)}}for(i=0;i<g;++i)(o=Xa[i])&&(o.halfedges.length||delete Xa[i])}(a,s,l,u)}this.edges=Za,this.cells=Xa,Ha=Ya=Za=Xa=null}function ts(e){return(e=e.slice()).push(e[0]),c([e])}function rs(e,t,r,n){var i=(n=n||{}).steps||64,o=n.units||"kilometers",a=n.angle||0,s=n.pivot||e,l=n.properties||e.properties||{};if(!e)throw new Error("center is required");if(!t)throw new Error("xSemiAxis is required");if(!r)throw new Error("ySemiAxis is required");if(!L(n))throw new Error("options must be an object");if(!T(i))throw new Error("steps must be a number");if(!T(a))throw new Error("angle must be a number");var u=Q(e);if("degrees"===o)var f=M(a);else t=vi(e,t,90,{units:o}),r=vi(e,r,0,{units:o}),t=Q(t)[0]-u[0],r=Q(r)[1]-u[1];for(var h=[],d=0;d<i;d+=1){var p=-360*d/i,y=t*r/Math.sqrt(Math.pow(r,2)+Math.pow(t,2)*Math.pow(ns(p),2)),g=t*r/Math.sqrt(Math.pow(t,2)+Math.pow(r,2)/Math.pow(ns(p),2));if(p<-90&&p>=-270&&(y=-y),p<-180&&p>=-360&&(g=-g),"degrees"===o){var v=y*Math.cos(f)+g*Math.sin(f),m=g*Math.cos(f)-y*Math.sin(f);y=v,g=m}h.push([y+u[0],g+u[1]])}return h.push(h[0]),"degrees"===o?c([h],l):Io(c([h],l),a,{pivot:s})}function ns(e){var t=e*Math.PI/180;return Math.tan(t)}function is(e,t){void 0===t&&(t={});var r=0,n=0,i=0;return j(e,function(e,o,a){var s=t.weight?null==a?void 0:a[t.weight]:void 0;if(!T(s=null==s?1:s))throw new Error("weight value must be a number for feature index "+o);(s=Number(s))>0&&O(e,function(e){r+=e[0]*s,n+=e[1]*s,i+=s})}),l([r/i,n/i],t.properties,t)}function os(e,t){return{x:e[0]-t[0],y:e[1]-t[1]}}function as(e,t){var r=0,n=0;O(e,function(i,o,a,s,l){l>r&&(r=l,n=o,t.push([]));var u=o-n,c=e.coordinates[l][u+1],f=i[0],h=i[1],d=c[0],p=c[1];t[l].push([.75*f+.25*d,.75*h+.25*p]),t[l].push([.25*f+.75*d,.25*h+.75*p])},!0),t.forEach(function(e){e.push(e[0])})}function ss(e,t){var r=0,n=0,i=0;O(e,function(o,a,s,l,u){l>i&&(i=l,n=a,t.push([[]])),u>r&&(r=u,n=a,t[l].push([]));var c=a-n,f=e.coordinates[l][u][c+1],h=o[0],d=o[1],p=f[0],y=f[1];t[l][u].push([.75*h+.25*p,.75*d+.25*y]),t[l][u].push([.25*h+.75*p,.25*d+.75*y])},!0),t.forEach(function(e){e.forEach(function(e){e.push(e[0])})})}function ls(e,t,r){void 0===r&&(r=2);var n=Q(e),i=Q(t),o=n[0]-i[0],a=n[1]-i[1];return 1===r?Math.abs(o)+Math.abs(a):Math.pow(Math.pow(o,r)+Math.pow(a,r),1/r)}function us(e,t){var r=(t=t||{}).threshold||1e4,n=t.p||2,i=t.binary||!1,o=t.alpha||-1,a=t.standardization||!1,s=[];A(e,function(e){s.push(sr(e))});for(var l=[],u=0;u<s.length;u++)l[u]=[];for(u=0;u<s.length;u++)for(var c=u;c<s.length;c++){u===c&&(l[u][c]=0);var f=ls(s[u],s[c],n);l[u][c]=f,l[c][u]=f}for(u=0;u<s.length;u++)for(c=0;c<s.length;c++)0!==(f=l[u][c])&&(l[u][c]=i?f<=r?1:0:f<=r?Math.pow(f,o):0);if(a)for(u=0;u<s.length;u++){var h=l[u].reduce(function(e,t){return e+t},0);for(c=0;c<s.length;c++)l[u][c]=l[u][c]/h}return l}function cs(e){for(var t=0,r=0,n=e;r<n.length;r++)t+=n[r];return t/e.length}function fs(e,t){return void 0===t&&(t={}),ds(e,"mercator",t)}function hs(e,t){return void 0===t&&(t={}),ds(e,"wgs84",t)}function ds(e,t,r){void 0===r&&(r={});var n=(r=r||{}).mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&T(e[0])?e="mercator"===t?ps(e):ys(e):(!0!==n&&(e=bt(e)),O(e,function(e){var r="mercator"===t?ps(e):ys(e);e[0]=r[0],e[1]=r[1]})),e}function ps(e){var t=Math.PI/180,r=6378137,n=20037508.342789244,i=[r*(Math.abs(e[0])<=180?e[0]:e[0]-360*function(e){return e<0?-1:e>0?1:0}(e[0]))*t,r*Math.log(Math.tan(.25*Math.PI+.5*e[1]*t))];return i[0]>n&&(i[0]=n),i[0]<-n&&(i[0]=-n),i[1]>n&&(i[1]=n),i[1]<-n&&(i[1]=-n),i}function ys(e){var t=180/Math.PI,r=6378137;return[e[0]*t/r,(.5*Math.PI-2*Math.atan(Math.exp(-e[1]/r)))*t]}es.prototype={constructor:es,polygons:function(){var e=this.edges;return this.cells.map(function(t){var r=t.halfedges.map(function(r){return Ra(t,e[r])});return r.data=t.site.data,r})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(r,n){if(o=(i=r.halfedges).length)for(var i,o,a,s,l,u,c=r.site,f=-1,h=t[i[o-1]],d=h.left===c?h.right:h.left;++f<o;)a=d,d=(h=t[i[f]]).left===c?h.right:h.left,a&&d&&n<a.index&&n<d.index&&(l=a,u=d,((s=c)[0]-u[0])*(l[1]-s[1])-(s[0]-l[0])*(u[1]-s[1])<0)&&e.push([c.data,a.data,d.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,r){for(var n,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var l=e-i.site[0],u=t-i.site[1],c=l*l+u*u;do{i=o.cells[n=a],a=null,i.halfedges.forEach(function(r){var n=o.edges[r],s=n.left;if(s!==i.site&&s||(s=n.right)){var l=e-s[0],u=t-s[1],f=l*l+u*u;f<c&&(c=f,a=s.index)}})}while(null!==a);return o._found=n,null==r||c<=r*r?i.site:null}};var gs=Object.freeze({__proto__:null,toMercator:fs,toWgs84:hs}),vs=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n};function ms(e){return Array.isArray(e)?ws(e):e&&e.bbox?ws(e.bbox):[360*bs(),180*bs()]}function _s(e,t){void 0===t&&(t={}),null==e&&(e=1);for(var r=[],n=0;n<e;n++)r.push(l(ms(t.bbox)));return p(r)}function Ss(e,t){void 0===t&&(t={}),null==e&&(e=1),T(t.num_vertices)&&void 0!==t.num_vertices||(t.num_vertices=10),T(t.max_radial_length)&&void 0!==t.max_radial_length||(t.max_radial_length=10);for(var r=[],n=function(e){var n,i=[],o=vs(Array(t.num_vertices+1)).map(Math.random);o.forEach(function(e,t,r){r[t]=t>0?e+r[t-1]:e}),o.forEach(function(e){e=2*e*Math.PI/o[o.length-1];var r=Math.random();i.push([r*(t.max_radial_length||10)*Math.sin(e),r*(t.max_radial_length||10)*Math.cos(e)])}),i[i.length-1]=i[0],i=i.map((n=ms(t.bbox),function(e){return[e[0]+n[0],e[1]+n[1]]})),r.push(c([i]))},i=0;i<e;i++)n();return p(r)}function xs(e,t){if(void 0===t&&(t={}),!L(t=t||{}))throw new Error("options is invalid");var r=t.bbox,n=t.num_vertices,i=t.max_length,o=t.max_rotation;null==e&&(e=1),(!T(n)||void 0===n||n<2)&&(n=10),T(i)&&void 0!==i||(i=1e-4),T(o)&&void 0!==o||(o=Math.PI/8);for(var a=[],s=0;s<e;s++){for(var l=[ms(r)],u=0;u<n-1;u++){var c=(0===u?2*Math.random()*Math.PI:Math.tan((l[u][1]-l[u-1][1])/(l[u][0]-l[u-1][0])))+(Math.random()-.5)*o*2,f=Math.random()*i;l.push([l[u][0]+f*Math.cos(c),l[u][1]+f*Math.sin(c)])}a.push(h(l))}return p(a)}function bs(){return Math.random()-.5}function ws(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}var ks=Object.freeze({__proto__:null,randomPosition:ms,randomPoint:_s,randomPolygon:Ss,randomLineString:xs});function Ms(e,t){if(!e)throw new Error("geojson is required");if("FeatureCollection"!==e.type)throw new Error("geojson must be a FeatureCollection");if(null==t)throw new Error("filter is required");var r=[];return A(e,function(e){Ls(e.properties,t)&&r.push(e)}),p(r)}function Es(e,t,r){if(!e)throw new Error("geojson is required");if("FeatureCollection"!==e.type)throw new Error("geojson must be a FeatureCollection");if(null==t)throw new Error("property is required");for(var n=Ts(e,t),i=Object.keys(n),o=0;o<i.length;o++){for(var a=i[o],s=n[a],l=[],u=0;u<s.length;u++)l.push(e.features[s[u]]);r(p(l),a,o)}}function Is(e,t,r,n){var i=n;return Es(e,t,function(e,t,o){i=0===o&&void 0===n?e:r(i,e,t,o)}),i}function Ts(e,t){var r={};return A(e,function(e,n){var i=e.properties||{};if(Object.prototype.hasOwnProperty.call(i,String(t))){var o=i[t];Object.prototype.hasOwnProperty.call(r,o)?r[o].push(n):r[o]=[n]}}),r}function Ls(e,t){if(void 0===e)return!1;var r=typeof t;if("number"===r||"string"===r)return Object.prototype.hasOwnProperty.call(e,t);if(Array.isArray(t)){for(var n=0;n<t.length;n++)if(!Ls(e,t[n]))return!1;return!0}return Ps(e,t)}function Ps(e,t){for(var r=Object.keys(t),n=0;n<r.length;n++){var i=r[n];if(e[i]!==t[i])return!1}return!0}function Cs(e,t){if(!t)return{};if(!t.length)return{};for(var r={},n=0;n<t.length;n++){var i=t[n];Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r}var Ns=Object.freeze({__proto__:null,getCluster:Ms,clusterEach:Es,clusterReduce:Is,createBins:Ts,applyFilter:Ls,propertiesContainsFilter:Ps,filterProperties:Cs}),Os=function(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null
/**
     * splaytree v3.1.0
     * Fast Splay tree for Node and browser
     *
     * @author Alexander Milevski <info@w8r.name>
     * @license MIT
     * @preserve
     */};function Rs(e,t){return e>t?1:e<t?-1:0}function Vs(e,t,r){for(var n=new Os(null,null),i=n,o=n;;){var a=r(e,t.key);if(a<0){if(null===t.left)break;if(r(e,t.left.key)<0){var s=t.left;if(t.left=s.right,s.right=t,null===(t=s).left)break}o.left=t,o=t,t=t.left}else{if(!(a>0))break;if(null===t.right)break;if(r(e,t.right.key)>0&&(s=t.right,t.right=s.left,s.left=t,null===(t=s).right))break;i.right=t,i=t,t=t.right}}return i.right=t.left,o.left=t.right,t.left=n.right,t.right=n.left,t}function Gs(e,t,r,n){var i=new Os(e,t);if(null===r)return i.left=i.right=null,i;var o=n(e,(r=Vs(e,r,n)).key);return o<0?(i.left=r.left,i.right=r,r.left=null):o>=0&&(i.right=r.right,i.left=r,r.right=null),i}function As(e,t,r){var n=null,i=null;if(t){var o=r((t=Vs(e,t,r)).key,e);0===o?(n=t.left,i=t.right):o<0?(i=t.right,t.right=null,n=t):(n=t.left,t.left=null,i=t)}return{left:n,right:i}}var Fs=function(){function e(e){void 0===e&&(e=Rs),this._root=null,this._size=0,this._comparator=e}return e.prototype.insert=function(e,t){return this._size++,this._root=Gs(e,t,this._root,this._comparator)},e.prototype.add=function(e,t){var r=new Os(e,t);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var n=this._comparator,i=Vs(e,this._root,n),o=n(e,i.key);return 0===o?this._root=i:(o<0?(r.left=i.left,r.right=i,i.left=null):o>0&&(r.right=i.right,r.left=i,i.right=null),this._size++,this._root=r),this._root},e.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},e.prototype._remove=function(e,t,r){var n;return null===t?null:0===r(e,(t=Vs(e,t,r)).key)?(null===t.left?n=t.right:(n=Vs(e,t.left,r)).right=t.right,this._size--,n):t},e.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Vs(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},e.prototype.findStatic=function(e){for(var t=this._root,r=this._comparator;t;){var n=r(e,t.key);if(0===n)return t;t=n<0?t.left:t.right}return null},e.prototype.find=function(e){return this._root&&(this._root=Vs(e,this._root,this._comparator),0!==this._comparator(e,this._root.key))?null:this._root},e.prototype.contains=function(e){for(var t=this._root,r=this._comparator;t;){var n=r(e,t.key);if(0===n)return!0;t=n<0?t.left:t.right}return!1},e.prototype.forEach=function(e,t){for(var r=this._root,n=[],i=!1;!i;)null!==r?(n.push(r),r=r.left):0!==n.length?(r=n.pop(),e.call(t,r),r=r.right):i=!0;return this},e.prototype.range=function(e,t,r,n){for(var i=[],o=this._comparator,a=this._root;0!==i.length||a;)if(a)i.push(a),a=a.left;else{if(o((a=i.pop()).key,t)>0)break;if(o(a.key,e)>=0&&r.call(n,a))return this;a=a.right}return this},e.prototype.keys=function(){var e=[];return this.forEach(function(t){var r=t.key;return e.push(r)}),e},e.prototype.values=function(){var e=[];return this.forEach(function(t){var r=t.data;return e.push(r)}),e},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.left;)e=e.left;return e},e.prototype.maxNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.right;)e=e.right;return e},e.prototype.at=function(e){for(var t=this._root,r=!1,n=0,i=[];!r;)if(t)i.push(t),t=t.left;else if(i.length>0){if(t=i.pop(),n===e)return t;n++,t=t.right}else r=!0;return null},e.prototype.next=function(e){var t=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var n=this._comparator;t;){var i=n(e.key,t.key);if(0===i)break;i<0?(r=t,t=t.left):t=t.right}return r},e.prototype.prev=function(e){var t=this._root,r=null;if(null!==e.left){for(r=e.left;r.right;)r=r.right;return r}for(var n=this._comparator;t;){var i=n(e.key,t.key);if(0===i)break;i<0?t=t.left:(r=t,t=t.right)}return r},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return function(e){for(var t=e,r=[],n=!1,i=new Os(null,null),o=i;!n;)t?(r.push(t),t=t.left):r.length>0?t=(t=o=o.next=r.pop()).right:n=!0;return o.next=null,i.next}(this._root)},e.prototype.load=function(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=!1);var n=e.length,i=this._comparator;if(r&&function e(t,r,n,i,o){if(!(n>=i)){for(var a=t[n+i>>1],s=n-1,l=i+1;;){do{s++}while(o(t[s],a)<0);do{l--}while(o(t[l],a)>0);if(s>=l)break;var u=t[s];t[s]=t[l],t[l]=u,u=r[s],r[s]=r[l],r[l]=u}e(t,r,n,l,o),e(t,r,l+1,i,o)}}(e,t,0,n-1,i),null===this._root)this._root=function e(t,r,n,i){var o=i-n;if(o>0){var a=n+Math.floor(o/2),s=t[a],l=r[a],u=new Os(s,l);return u.left=e(t,r,n,a),u.right=e(t,r,a+1,i),u}return null}(e,t,0,n),this._size=n;else{var o=function(e,t,r){for(var n=new Os(null,null),i=n,o=e,a=t;null!==o&&null!==a;)r(o.key,a.key)<0?(i.next=o,o=o.next):(i.next=a,a=a.next),i=i.next;return null!==o?i.next=o:null!==a&&(i.next=a),n.next}(this.toList(),function(e,t){for(var r=new Os(null,null),n=r,i=0;i<e.length;i++)n=n.next=new Os(e[i],t[i]);return n.next=null,r.next}(e,t),i);n=this._size+n,this._root=function e(t,r,n){var i=n-r;if(i>0){var o=r+Math.floor(i/2),a=e(t,r,o),s=t.head;return s.left=a,t.head=t.head.next,s.right=e(t,o+1,n),s}return null}({head:o},0,n)}return this},e.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){void 0===e&&(e=function(e){return String(e.key)});var t=[];return function e(t,r,n,i,o){if(t){i(r+(n?"└── ":"├── ")+o(t)+"\n");var a=r+(n?"    ":"│   ");t.left&&e(t.left,a,!1,i,o),t.right&&e(t.right,a,!0,i,o)}}(this._root,"",!0,function(e){return t.push(e)},e),t.join("")},e.prototype.update=function(e,t,r){var n=this._comparator,i=As(e,this._root,n),o=i.left,a=i.right;n(e,t)<0?a=Gs(t,r,a,n):o=Gs(t,r,o,n),this._root=function(e,t,r){return null===t?e:(null===e||((t=Vs(e.key,t,r)).left=e),t)}(o,a,n)},e.prototype.split=function(e){return As(e,this._root,this._comparator)},e}();function Ds(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function js(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Bs(e,t,r){return t&&js(e.prototype,t),r&&js(e,r),e}var qs=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},Us=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var r=e.ll.x<t.ll.x?t.ll.x:e.ll.x,n=e.ur.x<t.ur.x?e.ur.x:t.ur.x;return{ll:{x:r,y:e.ll.y<t.ll.y?t.ll.y:e.ll.y},ur:{x:n,y:e.ur.y<t.ur.y?e.ur.y:t.ur.y}}},Js=Number.EPSILON;void 0===Js&&(Js=Math.pow(2,-52));var zs=Js*Js,Ws=function(e,t){if(-Js<e&&e<Js&&-Js<t&&t<Js)return 0;var r=e-t;return r*r<zs*e*t?0:e<t?-1:1},Hs=function(){function e(){Ds(this,e),this.reset()}return Bs(e,[{key:"reset",value:function(){this.xRounder=new Xs,this.yRounder=new Xs}},{key:"round",value:function(e,t){return{x:this.xRounder.round(e),y:this.yRounder.round(t)}}}]),e}(),Xs=function(){function e(){Ds(this,e),this.tree=new Fs,this.round(0)}return Bs(e,[{key:"round",value:function(e){var t=this.tree.add(e),r=this.tree.prev(t);if(null!==r&&0===Ws(t.key,r.key))return this.tree.remove(e),r.key;var n=this.tree.next(t);return null!==n&&0===Ws(t.key,n.key)?(this.tree.remove(e),n.key):e}}]),e}(),Ys=new Hs,Zs=function(e,t){return e.x*t.y-e.y*t.x},Ks=function(e,t){return e.x*t.x+e.y*t.y},Qs=function(e,t,r){var n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y},o=Zs(n,i);return Ws(o,0)},$s=function(e){return Math.sqrt(Ks(e,e))},el=function(e,t,r){return 0===t.y?null:{x:e.x+t.x/t.y*(r-e.y),y:r}},tl=function(e,t,r){return 0===t.x?null:{x:r,y:e.y+t.y/t.x*(r-e.x)}},rl=function(){function e(t,r){Ds(this,e),void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=r}return Bs(e,null,[{key:"compare",value:function(t,r){var n=e.comparePoints(t.point,r.point);return 0!==n?n:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:il.compare(t.segment,r.segment))}},{key:"comparePoints",value:function(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}}]),Bs(e,[{key:"link",value:function(e){if(e.point===this.point)throw new Error("Tried to link already linked events");for(var t=e.point.events,r=0,n=t.length;r<n;r++){var i=t[r];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var e=this.point.events.length,t=0;t<e;t++){var r=this.point.events[t];if(void 0===r.segment.consumedBy)for(var n=t+1;n<e;n++){var i=this.point.events[n];void 0===i.consumedBy&&r.otherSE.point.events===i.otherSE.point.events&&r.segment.consume(i.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var e=[],t=0,r=this.point.events.length;t<r;t++){var n=this.point.events[t];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&e.push(n)}return e}},{key:"getLeftmostComparator",value:function(e){var t=this,r=new Map,n=function(n){var i,o,a,s,l,u=n.otherSE;r.set(n,{sine:(i=t.point,o=e.point,a=u.point,s={x:o.x-i.x,y:o.y-i.y},l={x:a.x-i.x,y:a.y-i.y},Zs(l,s)/$s(l)/$s(s)),cosine:function(e,t,r){var n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y};return Ks(i,n)/$s(i)/$s(n)}(t.point,e.point,u.point)})};return function(e,t){r.has(e)||n(e),r.has(t)||n(t);var i=r.get(e),o=i.sine,a=i.cosine,s=r.get(t),l=s.sine,u=s.cosine;return o>=0&&l>=0?a<u?1:a>u?-1:0:o<0&&l<0?a<u?-1:a>u?1:0:l<o?-1:l>o?1:0}}}]),e}(),nl=0,il=function(){function e(t,r,n,i){Ds(this,e),this.id=++nl,this.leftSE=t,t.segment=this,t.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=t,this.rings=n,this.windings=i}return Bs(e,null,[{key:"compare",value:function(e,t){var r=e.leftSE.point.x,n=t.leftSE.point.x,i=e.rightSE.point.x,o=t.rightSE.point.x;if(o<r)return 1;if(i<n)return-1;var a=e.leftSE.point.y,s=t.leftSE.point.y,l=e.rightSE.point.y,u=t.rightSE.point.y;if(r<n){if(s<a&&s<l)return 1;if(s>a&&s>l)return-1;var c=e.comparePoint(t.leftSE.point);if(c<0)return 1;if(c>0)return-1;var f=t.comparePoint(e.rightSE.point);return 0!==f?f:-1}if(r>n){if(a<s&&a<u)return-1;if(a>s&&a>u)return 1;var h=t.comparePoint(e.leftSE.point);if(0!==h)return h;var d=e.comparePoint(t.rightSE.point);return d<0?1:d>0?-1:1}if(a<s)return-1;if(a>s)return 1;if(i<o){var p=t.comparePoint(e.rightSE.point);if(0!==p)return p}if(i>o){var y=e.comparePoint(t.rightSE.point);if(y<0)return 1;if(y>0)return-1}if(i!==o){var g=l-a,v=i-r,m=u-s,_=o-n;if(g>v&&m<_)return 1;if(g<v&&m>_)return-1}return i>o?1:i<o||l<u?-1:l>u?1:e.id<t.id?-1:e.id>t.id?1:0}}]),Bs(e,[{key:"replaceRightSE",value:function(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<t?e:t},ur:{x:this.rightSE.point.x,y:e>t?e:t}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}},{key:"comparePoint",value:function(e){if(this.isAnEndpoint(e))return 0;var t=this.leftSE.point,r=this.rightSE.point,n=this.vector();if(t.x===r.x)return e.x===t.x?0:e.x<t.x?1:-1;var i=(e.y-t.y)/n.y,o=t.x+i*n.x;if(e.x===o)return 0;var a=(e.x-t.x)/n.x,s=t.y+a*n.y;return e.y===s?0:e.y<s?-1:1}},{key:"getIntersection",value:function(e){var t=this.bbox(),r=e.bbox(),n=Us(t,r);if(null===n)return null;var i=this.leftSE.point,o=this.rightSE.point,a=e.leftSE.point,s=e.rightSE.point,l=qs(t,a)&&0===this.comparePoint(a),u=qs(r,i)&&0===e.comparePoint(i),c=qs(t,s)&&0===this.comparePoint(s),f=qs(r,o)&&0===e.comparePoint(o);if(u&&l)return f&&!c?o:!f&&c?s:null;if(u)return c&&i.x===s.x&&i.y===s.y?null:i;if(l)return f&&o.x===a.x&&o.y===a.y?null:a;if(f&&c)return null;if(f)return o;if(c)return s;var h=function(e,t,r,n){if(0===t.x)return tl(r,n,e.x);if(0===n.x)return tl(e,t,r.x);if(0===t.y)return el(r,n,e.y);if(0===n.y)return el(e,t,r.y);var i=Zs(t,n);if(0==i)return null;var o={x:r.x-e.x,y:r.y-e.y},a=Zs(o,t)/i,s=Zs(o,n)/i;return{x:(e.x+s*t.x+(r.x+a*n.x))/2,y:(e.y+s*t.y+(r.y+a*n.y))/2}}(i,this.vector(),a,e.vector());return null===h?null:qs(n,h)?Ys.round(h.x,h.y):null}},{key:"split",value:function(t){var r=[],n=void 0!==t.events,i=new rl(t,!0),o=new rl(t,!1),a=this.rightSE;this.replaceRightSE(o),r.push(o),r.push(i);var s=new e(i,a,this.rings.slice(),this.windings.slice());return rl.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),rl.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(i.checkForConsuming(),o.checkForConsuming()),r}},{key:"swapEvents",value:function(){var e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var t=0,r=this.windings.length;t<r;t++)this.windings[t]*=-1}},{key:"consume",value:function(t){for(var r=this,n=t;r.consumedBy;)r=r.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var i=e.compare(r,n);if(0!==i){if(i>0){var o=r;r=n,n=o}if(r.prev===n){var a=r;r=n,n=a}for(var s=0,l=n.rings.length;s<l;s++){var u=n.rings[s],c=n.windings[s],f=r.rings.indexOf(u);-1===f?(r.rings.push(u),r.windings.push(c)):r.windings[f]+=c}n.rings=null,n.windings=null,n.consumedBy=r,n.leftSE.consumedBy=r.leftSE,n.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};for(var t=this._afterState.rings,r=this._afterState.windings,n=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var a=this.rings[i],s=this.windings[i],l=t.indexOf(a);-1===l?(t.push(a),r.push(s)):r[l]+=s}for(var u=[],c=[],f=0,h=t.length;f<h;f++)if(0!==r[f]){var d=t[f],p=d.poly;if(-1===c.indexOf(p))if(d.isExterior)u.push(p);else{-1===c.indexOf(p)&&c.push(p);var y=u.indexOf(d.poly);-1!==y&&u.splice(y,1)}}for(var g=0,v=u.length;g<v;g++){var m=u[g].multiPoly;-1===n.indexOf(m)&&n.push(m)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(pl.type){case"union":var r=0===e.length,n=0===t.length;this._isInResult=r!==n;break;case"intersection":var i,o;e.length<t.length?(i=e.length,o=t.length):(i=t.length,o=e.length),this._isInResult=o===pl.numMultiPolys&&i<o;break;case"xor":var a=Math.abs(e.length-t.length);this._isInResult=a%2==1;break;case"difference":var s=function(e){return 1===e.length&&e[0].isSubject};this._isInResult=s(e)!==s(t);break;default:throw new Error("Unrecognized operation type found ".concat(pl.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,r,n){var i,o,a,s=rl.comparePoints(t,r);if(s<0)i=t,o=r,a=1;else{if(!(s>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));i=r,o=t,a=-1}return new e(new rl(i,!0),new rl(o,!1),[n],[a])}}]),e}(),ol=function(){function e(t,r,n){if(Ds(this,e),!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=n,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=Ys.round(t[0][0],t[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var o=i,a=1,s=t.length;a<s;a++){if("number"!=typeof t[a][0]||"number"!=typeof t[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var l=Ys.round(t[a][0],t[a][1]);l.x===o.x&&l.y===o.y||(this.segments.push(il.fromRing(o,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),o=l)}i.x===o.x&&i.y===o.y||this.segments.push(il.fromRing(o,i,this))}return Bs(e,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,r=this.segments.length;t<r;t++){var n=this.segments[t];e.push(n.leftSE),e.push(n.rightSE)}return e}}]),e}(),al=function(){function e(t,r){if(Ds(this,e),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ol(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,i=t.length;n<i;n++){var o=new ol(t[n],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=r}return Bs(e,[{key:"getSweepEvents",value:function(){for(var e=this.exteriorRing.getSweepEvents(),t=0,r=this.interiorRings.length;t<r;t++)for(var n=this.interiorRings[t].getSweepEvents(),i=0,o=n.length;i<o;i++)e.push(n[i]);return e}}]),e}(),sl=function(){function e(t,r){if(Ds(this,e),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(e){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var n=0,i=t.length;n<i;n++){var o=new al(t[n],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=r}return Bs(e,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,r=this.polys.length;t<r;t++)for(var n=this.polys[t].getSweepEvents(),i=0,o=n.length;i<o;i++)e.push(n[i]);return e}}]),e}(),ll=function(){function e(t){Ds(this,e),this.events=t;for(var r=0,n=t.length;r<n;r++)t[r].segment.ringOut=this;this.poly=null}return Bs(e,null,[{key:"factory",value:function(t){for(var r=[],n=0,i=t.length;n<i;n++){var o=t[n];if(o.isInResult()&&!o.ringOut){for(var a=null,s=o.leftSE,l=o.rightSE,u=[s],c=s.point,f=[];a=s,s=l,u.push(s),s.point!==c;)for(;;){var h=s.getAvailableLinkedEvents();if(0===h.length){var d=u[0].point,p=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(p.x,", ").concat(p.y,"]."))}if(1===h.length){l=h[0].otherSE;break}for(var y=null,g=0,v=f.length;g<v;g++)if(f[g].point===s.point){y=g;break}if(null===y){f.push({index:u.length,point:s.point});var m=s.getLeftmostComparator(a);l=h.sort(m)[0].otherSE;break}var _=f.splice(y)[0],S=u.splice(_.index);S.unshift(S[0].otherSE),r.push(new e(S.reverse()))}r.push(new e(u))}}return r}}]),Bs(e,[{key:"getGeom",value:function(){for(var e=this.events[0].point,t=[e],r=1,n=this.events.length-1;r<n;r++){var i=this.events[r].point,o=this.events[r+1].point;0!==Qs(i,e,o)&&(t.push(i),e=i)}if(1===t.length)return null;var a=t[0],s=t[1];0===Qs(a,e,s)&&t.shift(),t.push(t[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:t.length-1,c=this.isExteriorRing()?t.length:-1,f=[],h=u;h!=c;h+=l)f.push([t[h].x,t[h].y]);return f}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var e=this.enclosingRing();this._isExteriorRing=!e||!e.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var e=this.events[0],t=1,r=this.events.length;t<r;t++){var n=this.events[t];rl.compare(e,n)>0&&(e=n)}for(var i=e.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();o=(i=o.prevInResult())?i.prevInResult():null}}}]),e}(),ul=function(){function e(t){Ds(this,e),this.exteriorRing=t,t.poly=this,this.interiorRings=[]}return Bs(e,[{key:"addInterior",value:function(e){this.interiorRings.push(e),e.poly=this}},{key:"getGeom",value:function(){var e=[this.exteriorRing.getGeom()];if(null===e[0])return null;for(var t=0,r=this.interiorRings.length;t<r;t++){var n=this.interiorRings[t].getGeom();null!==n&&e.push(n)}return e}}]),e}(),cl=function(){function e(t){Ds(this,e),this.rings=t,this.polys=this._composePolys(t)}return Bs(e,[{key:"getGeom",value:function(){for(var e=[],t=0,r=this.polys.length;t<r;t++){var n=this.polys[t].getGeom();null!==n&&e.push(n)}return e}},{key:"_composePolys",value:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];if(!i.poly)if(i.isExteriorRing())t.push(new ul(i));else{var o=i.enclosingRing();o.poly||t.push(new ul(o)),o.poly.addInterior(i)}}return t}}]),e}(),fl=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:il.compare;Ds(this,e),this.queue=t,this.tree=new Fs(r),this.segments=[]}return Bs(e,[{key:"process",value:function(e){var t=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(t),r;var n=e.isLeft?this.tree.insert(t):this.tree.find(t);if(!n)throw new Error("Unable to find segment #".concat(t.id," ")+"[".concat(t.leftSE.point.x,", ").concat(t.leftSE.point.y,"] -> ")+"[".concat(t.rightSE.point.x,", ").concat(t.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=n,o=n,a=void 0,s=void 0;void 0===a;)null===(i=this.tree.prev(i))?a=null:void 0===i.key.consumedBy&&(a=i.key);for(;void 0===s;)null===(o=this.tree.next(o))?s=null:void 0===o.key.consumedBy&&(s=o.key);if(e.isLeft){var l=null;if(a){var u=a.getIntersection(t);if(null!==u&&(t.isAnEndpoint(u)||(l=u),!a.isAnEndpoint(u)))for(var c=this._splitSafely(a,u),f=0,h=c.length;f<h;f++)r.push(c[f])}var d=null;if(s){var p=s.getIntersection(t);if(null!==p&&(t.isAnEndpoint(p)||(d=p),!s.isAnEndpoint(p)))for(var y=this._splitSafely(s,p),g=0,v=y.length;g<v;g++)r.push(y[g])}if(null!==l||null!==d){var m;m=null===l?d:null===d?l:rl.comparePoints(l,d)<=0?l:d,this.queue.remove(t.rightSE),r.push(t.rightSE);for(var _=t.split(m),S=0,x=_.length;S<x;S++)r.push(_[S])}r.length>0?(this.tree.remove(t),r.push(e)):(this.segments.push(t),t.prev=a)}else{if(a&&s){var b=a.getIntersection(s);if(null!==b){if(!a.isAnEndpoint(b))for(var w=this._splitSafely(a,b),k=0,M=w.length;k<M;k++)r.push(w[k]);if(!s.isAnEndpoint(b))for(var E=this._splitSafely(s,b),I=0,T=E.length;I<T;I++)r.push(E[I])}}this.tree.remove(t)}return r}},{key:"_splitSafely",value:function(e,t){this.tree.remove(e);var r=e.rightSE;this.queue.remove(r);var n=e.split(t);return n.push(r),void 0===e.consumedBy&&this.tree.insert(e),n}}]),e}(),hl=void 0!==e&&Object({NODE_ENV:void 0}).POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,dl=void 0!==e&&Object({NODE_ENV:void 0}).POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,pl=new(function(){function e(){Ds(this,e)}return Bs(e,[{key:"run",value:function(e,t,r){pl.type=e,Ys.reset();for(var n=[new sl(t,!0)],i=0,o=r.length;i<o;i++)n.push(new sl(r[i],!1));if(pl.numMultiPolys=n.length,"difference"===pl.type)for(var a=n[0],s=1;s<n.length;)null!==Us(n[s].bbox,a.bbox)?s++:n.splice(s,1);if("intersection"===pl.type)for(var l=0,u=n.length;l<u;l++)for(var c=n[l],f=l+1,h=n.length;f<h;f++)if(null===Us(c.bbox,n[f].bbox))return[];for(var d=new Fs(rl.compare),p=0,y=n.length;p<y;p++)for(var g=n[p].getSweepEvents(),v=0,m=g.length;v<m;v++)if(d.insert(g[v]),d.size>hl)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var _=new fl(d),S=d.size,x=d.pop();x;){var b=x.key;if(d.size===S){var w=b.segment;throw new Error("Unable to pop() ".concat(b.isLeft?"left":"right"," SweepEvent ")+"[".concat(b.point.x,", ").concat(b.point.y,"] from segment #").concat(w.id," ")+"[".concat(w.leftSE.point.x,", ").concat(w.leftSE.point.y,"] -> ")+"[".concat(w.rightSE.point.x,", ").concat(w.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(d.size>hl)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(_.segments.length>dl)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var k=_.process(b),M=0,E=k.length;M<E;M++){var I=k[M];void 0===I.consumedBy&&d.insert(I)}S=d.size,x=d.pop()}Ys.reset();var T=ll.factory(_.segments);return new cl(T).getGeom()}}]),e}()),yl={union:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return pl.run("union",e,r)},intersection:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return pl.run("intersection",e,r)},xor:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return pl.run("xor",e,r)},difference:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return pl.run("difference",e,r)}};"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(e){if(null==this)throw new TypeError(this+" is not an object");var t=Object(this),r=Math.max(Math.min(t.length,9007199254740991),0)||0,n=1 in arguments&&parseInt(Number(arguments[1]),10)||0;n=n<0?Math.max(r+n,0):Math.min(n,r);var i=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:r;for(i=i<0?Math.max(r+arguments[2],0):Math.min(i,r);n<i;)t[n]=e,++n;return t},writable:!0}),Number.isFinite=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(e){return e!=e},Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var gl=function(){};gl.prototype.interfaces_=function(){return[]},gl.prototype.getClass=function(){return gl},gl.prototype.equalsWithTolerance=function(e,t,r){return Math.abs(e-t)<=r};var vl=function(e){function t(t){e.call(this,t),this.name="IllegalArgumentException",this.message=t,this.stack=(new e).stack}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),ml=function(){},_l={MAX_VALUE:{configurable:!0}};ml.isNaN=function(e){return Number.isNaN(e)},ml.doubleToLongBits=function(e){return e},ml.longBitsToDouble=function(e){return e},ml.isInfinite=function(e){return!Number.isFinite(e)},_l.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(ml,_l);var Sl=function(){},xl=function(){},bl=function(){};function wl(){}var kl=function e(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Ml={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};kl.prototype.setOrdinate=function(e,t){switch(e){case kl.X:this.x=t;break;case kl.Y:this.y=t;break;case kl.Z:this.z=t;break;default:throw new vl("Invalid ordinate index: "+e)}},kl.prototype.equals2D=function(){if(1===arguments.length){var e=arguments[0];return this.x===e.x&&this.y===e.y}if(2===arguments.length){var t=arguments[0],r=arguments[1];return!!gl.equalsWithTolerance(this.x,t.x,r)&&!!gl.equalsWithTolerance(this.y,t.y,r)}},kl.prototype.getOrdinate=function(e){switch(e){case kl.X:return this.x;case kl.Y:return this.y;case kl.Z:return this.z}throw new vl("Invalid ordinate index: "+e)},kl.prototype.equals3D=function(e){return this.x===e.x&&this.y===e.y&&(this.z===e.z||ml.isNaN(this.z))&&ml.isNaN(e.z)},kl.prototype.equals=function(e){return e instanceof kl&&this.equals2D(e)},kl.prototype.equalInZ=function(e,t){return gl.equalsWithTolerance(this.z,e.z,t)},kl.prototype.compareTo=function(e){var t=e;return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0},kl.prototype.clone=function(){},kl.prototype.copy=function(){return new kl(this)},kl.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},kl.prototype.distance3D=function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return Math.sqrt(t*t+r*r+n*n)},kl.prototype.distance=function(e){var t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)},kl.prototype.hashCode=function(){var e=17;return 37*(e=37*e+kl.hashCode(this.x))+kl.hashCode(this.y)},kl.prototype.setCoordinate=function(e){this.x=e.x,this.y=e.y,this.z=e.z},kl.prototype.interfaces_=function(){return[Sl,xl,wl]},kl.prototype.getClass=function(){return kl},kl.hashCode=function(){if(1===arguments.length){var e=arguments[0],t=ml.doubleToLongBits(e);return Math.trunc((t^t)>>>32)}},Ml.DimensionalComparator.get=function(){return El},Ml.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},Ml.NULL_ORDINATE.get=function(){return ml.NaN},Ml.X.get=function(){return 0},Ml.Y.get=function(){return 1},Ml.Z.get=function(){return 2},Object.defineProperties(kl,Ml);var El=function(e){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(2!==t&&3!==t)throw new vl("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}};El.prototype.compare=function(e,t){var r=e,n=t,i=El.compare(r.x,n.x);if(0!==i)return i;var o=El.compare(r.y,n.y);return 0!==o?o:this._dimensionsToTest<=2?0:El.compare(r.z,n.z)},El.prototype.interfaces_=function(){return[bl]},El.prototype.getClass=function(){return El},El.compare=function(e,t){return e<t?-1:e>t?1:ml.isNaN(e)?ml.isNaN(t)?0:-1:ml.isNaN(t)?1:0};var Il=function(){};Il.prototype.create=function(){},Il.prototype.interfaces_=function(){return[]},Il.prototype.getClass=function(){return Il};var Tl=function(){},Ll={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};Tl.prototype.interfaces_=function(){return[]},Tl.prototype.getClass=function(){return Tl},Tl.toLocationSymbol=function(e){switch(e){case Tl.EXTERIOR:return"e";case Tl.BOUNDARY:return"b";case Tl.INTERIOR:return"i";case Tl.NONE:return"-"}throw new vl("Unknown location value: "+e)},Ll.INTERIOR.get=function(){return 0},Ll.BOUNDARY.get=function(){return 1},Ll.EXTERIOR.get=function(){return 2},Ll.NONE.get=function(){return-1},Object.defineProperties(Tl,Ll);var Pl=function(e,t){return e.interfaces_&&e.interfaces_().indexOf(t)>-1},Cl=function(){},Nl={LOG_10:{configurable:!0}};Cl.prototype.interfaces_=function(){return[]},Cl.prototype.getClass=function(){return Cl},Cl.log10=function(e){var t=Math.log(e);return ml.isInfinite(t)||ml.isNaN(t)?t:t/Cl.LOG_10},Cl.min=function(e,t,r,n){var i=e;return t<i&&(i=t),r<i&&(i=r),n<i&&(i=n),i},Cl.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],t=arguments[1],r=arguments[2];return e<t?t:e>r?r:e}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var n=arguments[0],i=arguments[1],o=arguments[2];return n<i?i:n>o?o:n}},Cl.wrap=function(e,t){return e<0?t- -e%t:e%t},Cl.max=function(){if(3===arguments.length){var e=arguments[0],t=arguments[1],r=arguments[2],n=e;return t>n&&(n=t),r>n&&(n=r),n}if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],l=i;return o>l&&(l=o),a>l&&(l=a),s>l&&(l=s),l}},Cl.average=function(e,t){return(e+t)/2},Nl.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Cl,Nl);var Ol=function(e){this.str=e};Ol.prototype.append=function(e){this.str+=e},Ol.prototype.setCharAt=function(e,t){this.str=this.str.substr(0,e)+t+this.str.substr(e+1)},Ol.prototype.toString=function(e){return this.str};var Rl=function(e){this.value=e};Rl.prototype.intValue=function(){return this.value},Rl.prototype.compareTo=function(e){return this.value<e?-1:this.value>e?1:0},Rl.isNaN=function(e){return Number.isNaN(e)};var Vl=function(){};Vl.isWhitespace=function(e){return e<=32&&e>=0||127===e},Vl.toUpperCase=function(e){return e.toUpperCase()};var Gl=function e(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof e){var r=arguments[0];this.init(r)}else if("string"==typeof arguments[0]){var n=arguments[0];e.call(this,e.parse(n))}}else if(2===arguments.length){var i=arguments[0],o=arguments[1];this.init(i,o)}},Al={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Gl.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo},Gl.prototype.extractSignificantDigits=function(e,t){var r=this.abs(),n=Gl.magnitude(r._hi),i=Gl.TEN.pow(n);(r=r.divide(i)).gt(Gl.TEN)?(r=r.divide(Gl.TEN),n+=1):r.lt(Gl.ONE)&&(r=r.multiply(Gl.TEN),n-=1);for(var o=n+1,a=new Ol,s=Gl.MAX_PRINT_DIGITS-1,l=0;l<=s;l++){e&&l===o&&a.append(".");var u=Math.trunc(r._hi);if(u<0)break;var c=!1,f=0;u>9?(c=!0,f="9"):f="0"+u,a.append(f),r=r.subtract(Gl.valueOf(u)).multiply(Gl.TEN),c&&r.selfAdd(Gl.TEN);var h=!0,d=Gl.magnitude(r._hi);if(d<0&&Math.abs(d)>=s-l&&(h=!1),!h)break}return t[0]=n,a.toString()},Gl.prototype.sqr=function(){return this.multiply(this)},Gl.prototype.doubleValue=function(){return this._hi+this._lo},Gl.prototype.subtract=function(){if(arguments[0]instanceof Gl){var e=arguments[0];return this.add(e.negate())}if("number"==typeof arguments[0]){var t=arguments[0];return this.add(-t)}},Gl.prototype.equals=function(){if(1===arguments.length){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}},Gl.prototype.isZero=function(){return 0===this._hi&&0===this._lo},Gl.prototype.selfSubtract=function(){if(arguments[0]instanceof Gl){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}if("number"==typeof arguments[0]){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}},Gl.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},Gl.prototype.min=function(e){return this.le(e)?this:e},Gl.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof Gl){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if("number"==typeof arguments[0]){var t=arguments[0];return this.selfDivide(t,0)}}else if(2===arguments.length){var r,n,i,o,a=arguments[0],s=arguments[1],l=null,u=null,c=null,f=null;return i=this._hi/a,f=(l=(c=Gl.SPLIT*i)-(l=c-i))*(u=(f=Gl.SPLIT*a)-(u=f-a))-(o=i*a)+l*(n=a-u)+(r=i-l)*u+r*n,f=i+(c=(this._hi-o-f+this._lo-i*s)/a),this._hi=f,this._lo=i-f+c,this}},Gl.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},Gl.prototype.divide=function(){if(arguments[0]instanceof Gl){var e,t,r,n,i=arguments[0],o=null,a=null,s=null,l=null;e=(r=this._hi/i._hi)-(o=(s=Gl.SPLIT*r)-(o=s-r)),l=o*(a=(l=Gl.SPLIT*i._hi)-(a=l-i._hi))-(n=r*i._hi)+o*(t=i._hi-a)+e*a+e*t;var u=l=r+(s=(this._hi-n-l+this._lo-r*i._lo)/i._hi);return new Gl(u,r-l+s)}if("number"==typeof arguments[0]){var c=arguments[0];return ml.isNaN(c)?Gl.createNaN():Gl.copy(this).selfDivide(c,0)}},Gl.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo},Gl.prototype.pow=function(e){if(0===e)return Gl.valueOf(1);var t=new Gl(this),r=Gl.valueOf(1),n=Math.abs(e);if(n>1)for(;n>0;)n%2==1&&r.selfMultiply(t),(n/=2)>0&&(t=t.sqr());else r=t;return e<0?r.reciprocal():r},Gl.prototype.ceil=function(){if(this.isNaN())return Gl.NaN;var e=Math.ceil(this._hi),t=0;return e===this._hi&&(t=Math.ceil(this._lo)),new Gl(e,t)},Gl.prototype.compareTo=function(e){var t=e;return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0},Gl.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},Gl.prototype.setValue=function(){if(arguments[0]instanceof Gl){var e=arguments[0];return this.init(e),this}if("number"==typeof arguments[0]){var t=arguments[0];return this.init(t),this}},Gl.prototype.max=function(e){return this.ge(e)?this:e},Gl.prototype.sqrt=function(){if(this.isZero())return Gl.valueOf(0);if(this.isNegative())return Gl.NaN;var e=1/Math.sqrt(this._hi),t=this._hi*e,r=Gl.valueOf(t),n=this.subtract(r.sqr())._hi*(.5*e);return r.add(n)},Gl.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof Gl){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if("number"==typeof arguments[0]){var t,r,n,i,o,a=arguments[0],s=null;return s=(n=this._hi+a)-(i=n-this._hi),r=(o=(s=a-i+(this._hi-s))+this._lo)+(n-(t=n+o)),this._hi=t+r,this._lo=r+(t-this._hi),this}}else if(2===arguments.length){var l,u,c,f,h=arguments[0],d=arguments[1],p=null,y=null,g=null;c=this._hi+h,u=this._lo+d,y=c-(g=c-this._hi),p=u-(f=u-this._lo);var v=(l=c+(g=(y=h-g+(this._hi-y))+u))+(g=(p=d-f+(this._lo-p))+(g+(c-l))),m=g+(l-v);return this._hi=v,this._lo=m,this}},Gl.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof Gl){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if("number"==typeof arguments[0]){var t=arguments[0];return this.selfMultiply(t,0)}}else if(2===arguments.length){var r,n,i=arguments[0],o=arguments[1],a=null,s=null,l=null,u=null;a=(l=Gl.SPLIT*this._hi)-this._hi,u=Gl.SPLIT*i,a=l-a,r=this._hi-a,s=u-i;var c=(l=this._hi*i)+(u=a*(s=u-s)-l+a*(n=i-s)+r*s+r*n+(this._hi*o+this._lo*i)),f=u+(a=l-c);return this._hi=c,this._lo=f,this}},Gl.prototype.selfSqr=function(){return this.selfMultiply(this)},Gl.prototype.floor=function(){if(this.isNaN())return Gl.NaN;var e=Math.floor(this._hi),t=0;return e===this._hi&&(t=Math.floor(this._lo)),new Gl(e,t)},Gl.prototype.negate=function(){return this.isNaN()?this:new Gl(-this._hi,-this._lo)},Gl.prototype.clone=function(){},Gl.prototype.multiply=function(){if(arguments[0]instanceof Gl){var e=arguments[0];return e.isNaN()?Gl.createNaN():Gl.copy(this).selfMultiply(e)}if("number"==typeof arguments[0]){var t=arguments[0];return ml.isNaN(t)?Gl.createNaN():Gl.copy(this).selfMultiply(t,0)}},Gl.prototype.isNaN=function(){return ml.isNaN(this._hi)},Gl.prototype.intValue=function(){return Math.trunc(this._hi)},Gl.prototype.toString=function(){var e=Gl.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()},Gl.prototype.toStandardNotation=function(){var e=this.getSpecialNumberString();if(null!==e)return e;var t=new Array(1).fill(null),r=this.extractSignificantDigits(!0,t),n=t[0]+1,i=r;if("."===r.charAt(0))i="0"+r;else if(n<0)i="0."+Gl.stringOfChar("0",-n)+r;else if(-1===r.indexOf(".")){var o=n-r.length;i=r+Gl.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+i:i},Gl.prototype.reciprocal=function(){var e,t,r,n,i=null,o=null,a=null,s=null;e=(r=1/this._hi)-(i=(a=Gl.SPLIT*r)-(i=a-r)),o=(s=Gl.SPLIT*this._hi)-this._hi;var l=r+(a=(1-(n=r*this._hi)-(s=i*(o=s-o)-n+i*(t=this._hi-o)+e*o+e*t)-r*this._lo)/this._hi);return new Gl(l,r-l+a)},Gl.prototype.toSciNotation=function(){if(this.isZero())return Gl.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(null!==e)return e;var t=new Array(1).fill(null),r=this.extractSignificantDigits(!1,t),n=Gl.SCI_NOT_EXPONENT_CHAR+t[0];if("0"===r.charAt(0))throw new Error("Found leading zero: "+r);var i="";r.length>1&&(i=r.substring(1));var o=r.charAt(0)+"."+i;return this.isNegative()?"-"+o+n:o+n},Gl.prototype.abs=function(){return this.isNaN()?Gl.NaN:this.isNegative()?this.negate():new Gl(this)},Gl.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},Gl.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo},Gl.prototype.add=function(){if(arguments[0]instanceof Gl){var e=arguments[0];return Gl.copy(this).selfAdd(e)}if("number"==typeof arguments[0]){var t=arguments[0];return Gl.copy(this).selfAdd(t)}},Gl.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof Gl){var t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(2===arguments.length){var r=arguments[0],n=arguments[1];this._hi=r,this._lo=n}},Gl.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo},Gl.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},Gl.prototype.trunc=function(){return this.isNaN()?Gl.NaN:this.isPositive()?this.floor():this.ceil()},Gl.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},Gl.prototype.interfaces_=function(){return[wl,Sl,xl]},Gl.prototype.getClass=function(){return Gl},Gl.sqr=function(e){return Gl.valueOf(e).selfMultiply(e)},Gl.valueOf=function(){if("string"==typeof arguments[0]){var e=arguments[0];return Gl.parse(e)}if("number"==typeof arguments[0]){var t=arguments[0];return new Gl(t)}},Gl.sqrt=function(e){return Gl.valueOf(e).sqrt()},Gl.parse=function(e){for(var t=0,r=e.length;Vl.isWhitespace(e.charAt(t));)t++;var n=!1;if(t<r){var i=e.charAt(t);"-"!==i&&"+"!==i||(t++,"-"===i&&(n=!0))}for(var o=new Gl,a=0,s=0,l=0;!(t>=r);){var u=e.charAt(t);if(t++,Vl.isDigit(u)){var c=u-"0";o.selfMultiply(Gl.TEN),o.selfAdd(c),a++}else{if("."!==u){if("e"===u||"E"===u){var f=e.substring(t);try{l=Rl.parseInt(f)}catch(t){throw t instanceof Error?new Error("Invalid exponent "+f+" in string "+e):t}break}throw new Error("Unexpected character '"+u+"' at position "+t+" in string "+e)}s=a}}var h=o,d=a-s-l;if(0===d)h=o;else if(d>0){var p=Gl.TEN.pow(d);h=o.divide(p)}else if(d<0){var y=Gl.TEN.pow(-d);h=o.multiply(y)}return n?h.negate():h},Gl.createNaN=function(){return new Gl(ml.NaN,ml.NaN)},Gl.copy=function(e){return new Gl(e)},Gl.magnitude=function(e){var t=Math.abs(e),r=Math.log(t)/Math.log(10),n=Math.trunc(Math.floor(r));return 10*Math.pow(10,n)<=t&&(n+=1),n},Gl.stringOfChar=function(e,t){for(var r=new Ol,n=0;n<t;n++)r.append(e);return r.toString()},Al.PI.get=function(){return new Gl(3.141592653589793,1.2246467991473532e-16)},Al.TWO_PI.get=function(){return new Gl(6.283185307179586,2.4492935982947064e-16)},Al.PI_2.get=function(){return new Gl(1.5707963267948966,6.123233995736766e-17)},Al.E.get=function(){return new Gl(2.718281828459045,1.4456468917292502e-16)},Al.NaN.get=function(){return new Gl(ml.NaN,ml.NaN)},Al.EPS.get=function(){return 1.23259516440783e-32},Al.SPLIT.get=function(){return 134217729},Al.MAX_PRINT_DIGITS.get=function(){return 32},Al.TEN.get=function(){return Gl.valueOf(10)},Al.ONE.get=function(){return Gl.valueOf(1)},Al.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Al.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(Gl,Al);var Fl=function(){},Dl={DP_SAFE_EPSILON:{configurable:!0}};Fl.prototype.interfaces_=function(){return[]},Fl.prototype.getClass=function(){return Fl},Fl.orientationIndex=function(e,t,r){var n=Fl.orientationIndexFilter(e,t,r);if(n<=1)return n;var i=Gl.valueOf(t.x).selfAdd(-e.x),o=Gl.valueOf(t.y).selfAdd(-e.y),a=Gl.valueOf(r.x).selfAdd(-t.x),s=Gl.valueOf(r.y).selfAdd(-t.y);return i.selfMultiply(s).selfSubtract(o.selfMultiply(a)).signum()},Fl.signOfDet2x2=function(e,t,r,n){return e.multiply(n).selfSubtract(t.multiply(r)).signum()},Fl.intersection=function(e,t,r,n){var i=Gl.valueOf(n.y).selfSubtract(r.y).selfMultiply(Gl.valueOf(t.x).selfSubtract(e.x)),o=Gl.valueOf(n.x).selfSubtract(r.x).selfMultiply(Gl.valueOf(t.y).selfSubtract(e.y)),a=i.subtract(o),s=Gl.valueOf(n.x).selfSubtract(r.x).selfMultiply(Gl.valueOf(e.y).selfSubtract(r.y)),l=Gl.valueOf(n.y).selfSubtract(r.y).selfMultiply(Gl.valueOf(e.x).selfSubtract(r.x)),u=s.subtract(l).selfDivide(a).doubleValue(),c=Gl.valueOf(e.x).selfAdd(Gl.valueOf(t.x).selfSubtract(e.x).selfMultiply(u)).doubleValue(),f=Gl.valueOf(t.x).selfSubtract(e.x).selfMultiply(Gl.valueOf(e.y).selfSubtract(r.y)),h=Gl.valueOf(t.y).selfSubtract(e.y).selfMultiply(Gl.valueOf(e.x).selfSubtract(r.x)),d=f.subtract(h).selfDivide(a).doubleValue(),p=Gl.valueOf(r.y).selfAdd(Gl.valueOf(n.y).selfSubtract(r.y).selfMultiply(d)).doubleValue();return new kl(c,p)},Fl.orientationIndexFilter=function(e,t,r){var n=null,i=(e.x-r.x)*(t.y-r.y),o=(e.y-r.y)*(t.x-r.x),a=i-o;if(i>0){if(o<=0)return Fl.signum(a);n=i+o}else{if(!(i<0))return Fl.signum(a);if(o>=0)return Fl.signum(a);n=-i-o}var s=Fl.DP_SAFE_EPSILON*n;return a>=s||-a>=s?Fl.signum(a):2},Fl.signum=function(e){return e>0?1:e<0?-1:0},Dl.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(Fl,Dl);var jl=function(){},Bl={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Bl.X.get=function(){return 0},Bl.Y.get=function(){return 1},Bl.Z.get=function(){return 2},Bl.M.get=function(){return 3},jl.prototype.setOrdinate=function(e,t,r){},jl.prototype.size=function(){},jl.prototype.getOrdinate=function(e,t){},jl.prototype.getCoordinate=function(){},jl.prototype.getCoordinateCopy=function(e){},jl.prototype.getDimension=function(){},jl.prototype.getX=function(e){},jl.prototype.clone=function(){},jl.prototype.expandEnvelope=function(e){},jl.prototype.copy=function(){},jl.prototype.getY=function(e){},jl.prototype.toCoordinateArray=function(){},jl.prototype.interfaces_=function(){return[xl]},jl.prototype.getClass=function(){return jl},Object.defineProperties(jl,Bl);var ql=function(){},Ul=function(e){function t(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ql),Jl=function(){};Jl.arraycopy=function(e,t,r,n,i){for(var o=0,a=t;a<t+i;a++)r[n+o]=e[a],o++},Jl.getProperty=function(e){return{"line.separator":"\n"}[e]};var zl=function e(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var r=arguments[0],n=arguments[1];this.x=r,this.y=n,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var i=arguments[0],o=arguments[1];this.x=i.y*o.w-o.y*i.w,this.y=o.x*i.w-i.x*o.w,this.w=i.x*o.y-o.x*i.y}else if(arguments[0]instanceof kl&&arguments[1]instanceof kl){var a=arguments[0],s=arguments[1];this.x=a.y-s.y,this.y=s.x-a.x,this.w=a.x*s.y-s.x*a.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var f=arguments[0],h=arguments[1],d=arguments[2],p=arguments[3],y=f.y-h.y,g=h.x-f.x,v=f.x*h.y-h.x*f.y,m=d.y-p.y,_=p.x-d.x,S=d.x*p.y-p.x*d.y;this.x=g*S-_*v,this.y=m*v-y*S,this.w=y*_-m*g}};zl.prototype.getY=function(){var e=this.y/this.w;if(ml.isNaN(e)||ml.isInfinite(e))throw new Ul;return e},zl.prototype.getX=function(){var e=this.x/this.w;if(ml.isNaN(e)||ml.isInfinite(e))throw new Ul;return e},zl.prototype.getCoordinate=function(){var e=new kl;return e.x=this.getX(),e.y=this.getY(),e},zl.prototype.interfaces_=function(){return[]},zl.prototype.getClass=function(){return zl},zl.intersection=function(e,t,r,n){var i=e.y-t.y,o=t.x-e.x,a=e.x*t.y-t.x*e.y,s=r.y-n.y,l=n.x-r.x,u=r.x*n.y-n.x*r.y,c=i*l-s*o,f=(o*u-l*a)/c,h=(s*a-i*u)/c;if(ml.isNaN(f)||ml.isInfinite(f)||ml.isNaN(h)||ml.isInfinite(h))throw new Ul;return new kl(f,h)};var Wl=function e(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof kl){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var r=arguments[0];this.init(r)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2],l=arguments[3];this.init(o,a,s,l)}},Hl={serialVersionUID:{configurable:!0}};Wl.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Wl.prototype.equals=function(e){if(!(e instanceof Wl))return!1;var t=e;return this.isNull()?t.isNull():this._maxx===t.getMaxX()&&this._maxy===t.getMaxY()&&this._minx===t.getMinX()&&this._miny===t.getMinY()},Wl.prototype.intersection=function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new Wl;var t=this._minx>e._minx?this._minx:e._minx,r=this._miny>e._miny?this._miny:e._miny,n=this._maxx<e._maxx?this._maxx:e._maxx,i=this._maxy<e._maxy?this._maxy:e._maxy;return new Wl(t,n,r,i)},Wl.prototype.isNull=function(){return this._maxx<this._minx},Wl.prototype.getMaxX=function(){return this._maxx},Wl.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof kl){var e=arguments[0];return this.covers(e.x,e.y)}if(arguments[0]instanceof Wl){var t=arguments[0];return!this.isNull()&&!t.isNull()&&t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(2===arguments.length){var r=arguments[0],n=arguments[1];return!this.isNull()&&r>=this._minx&&r<=this._maxx&&n>=this._miny&&n<=this._maxy}},Wl.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Wl){var e=arguments[0];return!this.isNull()&&!e.isNull()&&!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}if(arguments[0]instanceof kl){var t=arguments[0];return this.intersects(t.x,t.y)}}else if(2===arguments.length){var r=arguments[0],n=arguments[1];return!this.isNull()&&!(r>this._maxx||r<this._minx||n>this._maxy||n<this._miny)}},Wl.prototype.getMinY=function(){return this._miny},Wl.prototype.getMinX=function(){return this._minx},Wl.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof kl){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof Wl){var t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(2===arguments.length){var r=arguments[0],n=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=n,this._maxy=n):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),n<this._miny&&(this._miny=n),n>this._maxy&&(this._maxy=n))}},Wl.prototype.minExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e<t?e:t},Wl.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Wl.prototype.compareTo=function(e){var t=e;return this.isNull()?t.isNull()?0:-1:t.isNull()?1:this._minx<t._minx?-1:this._minx>t._minx?1:this._miny<t._miny?-1:this._miny>t._miny?1:this._maxx<t._maxx?-1:this._maxx>t._maxx?1:this._maxy<t._maxy?-1:this._maxy>t._maxy?1:0},Wl.prototype.translate=function(e,t){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+t,this.getMaxY()+t)},Wl.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Wl.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Wl.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Wl.prototype.maxExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e>t?e:t},Wl.prototype.expandBy=function(){if(1===arguments.length){var e=arguments[0];this.expandBy(e,e)}else if(2===arguments.length){var t=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Wl.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof Wl){var e=arguments[0];return this.covers(e)}if(arguments[0]instanceof kl){var t=arguments[0];return this.covers(t)}}else if(2===arguments.length){var r=arguments[0],n=arguments[1];return this.covers(r,n)}},Wl.prototype.centre=function(){return this.isNull()?null:new kl((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Wl.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof kl){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof Wl){var t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(2===arguments.length){var r=arguments[0],n=arguments[1];this.init(r.x,n.x,r.y,n.y)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];i<o?(this._minx=i,this._maxx=o):(this._minx=o,this._maxx=i),a<s?(this._miny=a,this._maxy=s):(this._miny=s,this._maxy=a)}},Wl.prototype.getMaxY=function(){return this._maxy},Wl.prototype.distance=function(e){if(this.intersects(e))return 0;var t=0;this._maxx<e._minx?t=e._minx-this._maxx:this._minx>e._maxx&&(t=this._minx-e._maxx);var r=0;return this._maxy<e._miny?r=e._miny-this._maxy:this._miny>e._maxy&&(r=this._miny-e._maxy),0===t?r:0===r?t:Math.sqrt(t*t+r*r)},Wl.prototype.hashCode=function(){var e=17;return 37*(e=37*(e=37*(e=37*e+kl.hashCode(this._minx))+kl.hashCode(this._maxx))+kl.hashCode(this._miny))+kl.hashCode(this._maxy)},Wl.prototype.interfaces_=function(){return[Sl,wl]},Wl.prototype.getClass=function(){return Wl},Wl.intersects=function(){if(3===arguments.length){var e=arguments[0],t=arguments[1],r=arguments[2];return r.x>=(e.x<t.x?e.x:t.x)&&r.x<=(e.x>t.x?e.x:t.x)&&r.y>=(e.y<t.y?e.y:t.y)&&r.y<=(e.y>t.y?e.y:t.y)}if(4===arguments.length){var n=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3],s=Math.min(o.x,a.x),l=Math.max(o.x,a.x),u=Math.min(n.x,i.x),c=Math.max(n.x,i.x);return!(u>l||c<s||(s=Math.min(o.y,a.y),l=Math.max(o.y,a.y),u=Math.min(n.y,i.y),c=Math.max(n.y,i.y),u>l||c<s))}},Hl.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Wl,Hl);var Xl={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Yl=function(e){this.geometryFactory=e||new Lc};Yl.prototype.read=function(e){var t,r,n;e=e.replace(/[\n\r]/g," ");var i=Xl.typeStr.exec(e);if(-1!==e.search("EMPTY")&&((i=Xl.emptyTypeStr.exec(e))[2]=void 0),i&&(r=i[1].toLowerCase(),n=i[2],Kl[r]&&(t=Kl[r].apply(this,[n]))),void 0===t)throw new Error("Could not parse WKT "+e);return t},Yl.prototype.write=function(e){return this.extractGeometry(e)},Yl.prototype.extractGeometry=function(e){var t=e.getGeometryType().toLowerCase();if(!Zl[t])return null;var r=t.toUpperCase();return e.isEmpty()?r+" EMPTY":r+"("+Zl[t].apply(this,[e])+")"};var Zl={coordinate:function(e){return e.x+" "+e.y},point:function(e){return Zl.coordinate.call(this,e._coordinates._coordinates[0])},multipoint:function(e){for(var t=[],r=0,n=e._geometries.length;r<n;++r)t.push("("+Zl.point.apply(this,[e._geometries[r]])+")");return t.join(",")},linestring:function(e){for(var t=[],r=0,n=e._points._coordinates.length;r<n;++r)t.push(Zl.coordinate.apply(this,[e._points._coordinates[r]]));return t.join(",")},linearring:function(e){for(var t=[],r=0,n=e._points._coordinates.length;r<n;++r)t.push(Zl.coordinate.apply(this,[e._points._coordinates[r]]));return t.join(",")},multilinestring:function(e){for(var t=[],r=0,n=e._geometries.length;r<n;++r)t.push("("+Zl.linestring.apply(this,[e._geometries[r]])+")");return t.join(",")},polygon:function(e){var t=[];t.push("("+Zl.linestring.apply(this,[e._shell])+")");for(var r=0,n=e._holes.length;r<n;++r)t.push("("+Zl.linestring.apply(this,[e._holes[r]])+")");return t.join(",")},multipolygon:function(e){for(var t=[],r=0,n=e._geometries.length;r<n;++r)t.push("("+Zl.polygon.apply(this,[e._geometries[r]])+")");return t.join(",")},geometrycollection:function(e){for(var t=[],r=0,n=e._geometries.length;r<n;++r)t.push(this.extractGeometry(e._geometries[r]));return t.join(",")}},Kl={point:function(e){if(void 0===e)return this.geometryFactory.createPoint();var t=e.trim().split(Xl.spaces);return this.geometryFactory.createPoint(new kl(Number.parseFloat(t[0]),Number.parseFloat(t[1])))},multipoint:function(e){var t;if(void 0===e)return this.geometryFactory.createMultiPoint();for(var r=e.trim().split(","),n=[],i=0,o=r.length;i<o;++i)t=r[i].replace(Xl.trimParens,"$1"),n.push(Kl.point.apply(this,[t]));return this.geometryFactory.createMultiPoint(n)},linestring:function(e){if(void 0===e)return this.geometryFactory.createLineString();for(var t,r=e.trim().split(","),n=[],i=0,o=r.length;i<o;++i)t=r[i].trim().split(Xl.spaces),n.push(new kl(Number.parseFloat(t[0]),Number.parseFloat(t[1])));return this.geometryFactory.createLineString(n)},linearring:function(e){if(void 0===e)return this.geometryFactory.createLinearRing();for(var t,r=e.trim().split(","),n=[],i=0,o=r.length;i<o;++i)t=r[i].trim().split(Xl.spaces),n.push(new kl(Number.parseFloat(t[0]),Number.parseFloat(t[1])));return this.geometryFactory.createLinearRing(n)},multilinestring:function(e){var t;if(void 0===e)return this.geometryFactory.createMultiLineString();for(var r=e.trim().split(Xl.parenComma),n=[],i=0,o=r.length;i<o;++i)t=r[i].replace(Xl.trimParens,"$1"),n.push(Kl.linestring.apply(this,[t]));return this.geometryFactory.createMultiLineString(n)},polygon:function(e){var t,r,n;if(void 0===e)return this.geometryFactory.createPolygon();for(var i,o=e.trim().split(Xl.parenComma),a=[],s=0,l=o.length;s<l;++s)t=o[s].replace(Xl.trimParens,"$1"),r=Kl.linestring.apply(this,[t]),n=this.geometryFactory.createLinearRing(r._points),0===s?i=n:a.push(n);return this.geometryFactory.createPolygon(i,a)},multipolygon:function(e){var t;if(void 0===e)return this.geometryFactory.createMultiPolygon();for(var r=e.trim().split(Xl.doubleParenComma),n=[],i=0,o=r.length;i<o;++i)t=r[i].replace(Xl.trimParens,"$1"),n.push(Kl.polygon.apply(this,[t]));return this.geometryFactory.createMultiPolygon(n)},geometrycollection:function(e){if(void 0===e)return this.geometryFactory.createGeometryCollection();for(var t=(e=e.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),r=[],n=0,i=t.length;n<i;++n)r.push(this.read(t[n]));return this.geometryFactory.createGeometryCollection(r)}},Ql=function(e){this.parser=new Yl(e)};Ql.prototype.write=function(e){return this.parser.write(e)},Ql.toLineString=function(e,t){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+t.x+" "+t.y+" )"};var $l=function(e){function t(t){e.call(this,t),this.name="RuntimeException",this.message=t,this.stack=(new e).stack}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),eu=function(e){function t(){if(e.call(this),0===arguments.length)e.call(this);else if(1===arguments.length){var t=arguments[0];e.call(this,t)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}($l),tu=function(){};tu.prototype.interfaces_=function(){return[]},tu.prototype.getClass=function(){return tu},tu.shouldNeverReachHere=function(){if(0===arguments.length)tu.shouldNeverReachHere(null);else if(1===arguments.length){var e=arguments[0];throw new eu("Should never reach here"+(null!==e?": "+e:""))}},tu.isTrue=function(){var e;if(1===arguments.length)tu.isTrue(arguments[0],null);else if(2===arguments.length&&(e=arguments[1],!arguments[0]))throw null===e?new eu:new eu(e)},tu.equals=function(){var e,t,r;if(2===arguments.length)tu.equals(e=arguments[0],t=arguments[1],null);else if(3===arguments.length&&(e=arguments[0],r=arguments[2],!(t=arguments[1]).equals(e)))throw new eu("Expected "+e+" but encountered "+t+(null!==r?": "+r:""))};var ru=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new kl,this._intPt[1]=new kl,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},nu={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};ru.prototype.getIndexAlongSegment=function(e,t){return this.computeIntLineIndex(),this._intLineIndex[e][t]},ru.prototype.getTopologySummary=function(){var e=new Ol;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()},ru.prototype.computeIntersection=function(e,t,r,n){this._inputLines[0][0]=e,this._inputLines[0][1]=t,this._inputLines[1][0]=r,this._inputLines[1][1]=n,this._result=this.computeIntersect(e,t,r,n)},ru.prototype.getIntersectionNum=function(){return this._result},ru.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var e=arguments[0];this.getEdgeDistance(e,0)>this.getEdgeDistance(e,1)?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}},ru.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},ru.prototype.setPrecisionModel=function(e){this._precisionModel=e},ru.prototype.isInteriorIntersection=function(){var e=this;if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],r=0;r<this._result;r++)if(!e._intPt[r].equals2D(e._inputLines[t][0])&&!e._intPt[r].equals2D(e._inputLines[t][1]))return!0;return!1}},ru.prototype.getIntersection=function(e){return this._intPt[e]},ru.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},ru.prototype.hasIntersection=function(){return this._result!==ru.NO_INTERSECTION},ru.prototype.getEdgeDistance=function(e,t){return ru.computeEdgeDistance(this._intPt[t],this._inputLines[e][0],this._inputLines[e][1])},ru.prototype.isCollinear=function(){return this._result===ru.COLLINEAR_INTERSECTION},ru.prototype.toString=function(){return Ql.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Ql.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},ru.prototype.getEndpoint=function(e,t){return this._inputLines[e][t]},ru.prototype.isIntersection=function(e){for(var t=0;t<this._result;t++)if(this._intPt[t].equals2D(e))return!0;return!1},ru.prototype.getIntersectionAlongSegment=function(e,t){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][t]]},ru.prototype.interfaces_=function(){return[]},ru.prototype.getClass=function(){return ru},ru.computeEdgeDistance=function(e,t,r){var n=Math.abs(r.x-t.x),i=Math.abs(r.y-t.y),o=-1;if(e.equals(t))o=0;else if(e.equals(r))o=n>i?n:i;else{var a=Math.abs(e.x-t.x),s=Math.abs(e.y-t.y);0!==(o=n>i?a:s)||e.equals(t)||(o=Math.max(a,s))}return tu.isTrue(!(0===o&&!e.equals(t)),"Bad distance calculation"),o},ru.nonRobustComputeEdgeDistance=function(e,t,r){var n=e.x-t.x,i=e.y-t.y,o=Math.sqrt(n*n+i*i);return tu.isTrue(!(0===o&&!e.equals(t)),"Invalid distance calculation"),o},nu.DONT_INTERSECT.get=function(){return 0},nu.DO_INTERSECT.get=function(){return 1},nu.COLLINEAR.get=function(){return 2},nu.NO_INTERSECTION.get=function(){return 0},nu.POINT_INTERSECTION.get=function(){return 1},nu.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(ru,nu);var iu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isInSegmentEnvelopes=function(e){var t=new Wl(this._inputLines[0][0],this._inputLines[0][1]),r=new Wl(this._inputLines[1][0],this._inputLines[1][1]);return t.contains(e)&&r.contains(e)},t.prototype.computeIntersection=function(){if(3!==arguments.length)return e.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],r=arguments[1],n=arguments[2];if(this._isProper=!1,Wl.intersects(r,n,t)&&0===su.orientationIndex(r,n,t)&&0===su.orientationIndex(n,r,t))return this._isProper=!0,(t.equals(r)||t.equals(n))&&(this._isProper=!1),this._result=e.POINT_INTERSECTION,null;this._result=e.NO_INTERSECTION},t.prototype.normalizeToMinimum=function(e,t,r,n,i){i.x=this.smallestInAbsValue(e.x,t.x,r.x,n.x),i.y=this.smallestInAbsValue(e.y,t.y,r.y,n.y),e.x-=i.x,e.y-=i.y,t.x-=i.x,t.y-=i.y,r.x-=i.x,r.y-=i.y,n.x-=i.x,n.y-=i.y},t.prototype.safeHCoordinateIntersection=function(e,r,n,i){var o=null;try{o=zl.intersection(e,r,n,i)}catch(a){if(!(a instanceof Ul))throw a;o=t.nearestEndpoint(e,r,n,i)}return o},t.prototype.intersection=function(e,r,n,i){var o=this.intersectionWithNormalization(e,r,n,i);return this.isInSegmentEnvelopes(o)||(o=new kl(t.nearestEndpoint(e,r,n,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},t.prototype.smallestInAbsValue=function(e,t,r,n){var i=e,o=Math.abs(i);return Math.abs(t)<o&&(i=t,o=Math.abs(t)),Math.abs(r)<o&&(i=r,o=Math.abs(r)),Math.abs(n)<o&&(i=n),i},t.prototype.checkDD=function(e,t,r,n,i){var o=Fl.intersection(e,t,r,n),a=this.isInSegmentEnvelopes(o);Jl.out.println("DD in env = "+a+"  --------------------- "+o),i.distance(o)>1e-4&&Jl.out.println("Distance = "+i.distance(o))},t.prototype.intersectionWithNormalization=function(e,t,r,n){var i=new kl(e),o=new kl(t),a=new kl(r),s=new kl(n),l=new kl;this.normalizeToEnvCentre(i,o,a,s,l);var u=this.safeHCoordinateIntersection(i,o,a,s);return u.x+=l.x,u.y+=l.y,u},t.prototype.computeCollinearIntersection=function(t,r,n,i){var o=Wl.intersects(t,r,n),a=Wl.intersects(t,r,i),s=Wl.intersects(n,i,t),l=Wl.intersects(n,i,r);return o&&a?(this._intPt[0]=n,this._intPt[1]=i,e.COLLINEAR_INTERSECTION):s&&l?(this._intPt[0]=t,this._intPt[1]=r,e.COLLINEAR_INTERSECTION):o&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||a||l?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):o&&l?(this._intPt[0]=n,this._intPt[1]=r,!n.equals(r)||a||s?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):a&&s?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||o||l?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):a&&l?(this._intPt[0]=i,this._intPt[1]=r,!i.equals(r)||o||s?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):e.NO_INTERSECTION},t.prototype.normalizeToEnvCentre=function(e,t,r,n,i){var o=e.x<t.x?e.x:t.x,a=e.y<t.y?e.y:t.y,s=e.x>t.x?e.x:t.x,l=e.y>t.y?e.y:t.y,u=r.x<n.x?r.x:n.x,c=r.y<n.y?r.y:n.y,f=r.x>n.x?r.x:n.x,h=r.y>n.y?r.y:n.y,d=((o>u?o:u)+(s<f?s:f))/2,p=((a>c?a:c)+(l<h?l:h))/2;i.x=d,i.y=p,e.x-=i.x,e.y-=i.y,t.x-=i.x,t.y-=i.y,r.x-=i.x,r.y-=i.y,n.x-=i.x,n.y-=i.y},t.prototype.computeIntersect=function(t,r,n,i){if(this._isProper=!1,!Wl.intersects(t,r,n,i))return e.NO_INTERSECTION;var o=su.orientationIndex(t,r,n),a=su.orientationIndex(t,r,i);if(o>0&&a>0||o<0&&a<0)return e.NO_INTERSECTION;var s=su.orientationIndex(n,i,t),l=su.orientationIndex(n,i,r);return s>0&&l>0||s<0&&l<0?e.NO_INTERSECTION:0===o&&0===a&&0===s&&0===l?this.computeCollinearIntersection(t,r,n,i):(0===o||0===a||0===s||0===l?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:r.equals2D(n)||r.equals2D(i)?this._intPt[0]=r:0===o?this._intPt[0]=new kl(n):0===a?this._intPt[0]=new kl(i):0===s?this._intPt[0]=new kl(t):0===l&&(this._intPt[0]=new kl(r))):(this._isProper=!0,this._intPt[0]=this.intersection(t,r,n,i)),e.POINT_INTERSECTION)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.nearestEndpoint=function(e,t,r,n){var i=e,o=su.distancePointLine(e,r,n),a=su.distancePointLine(t,r,n);return a<o&&(o=a,i=t),(a=su.distancePointLine(r,e,t))<o&&(o=a,i=r),(a=su.distancePointLine(n,e,t))<o&&(o=a,i=n),i},t}(ru),ou=function(){};ou.prototype.interfaces_=function(){return[]},ou.prototype.getClass=function(){return ou},ou.orientationIndex=function(e,t,r){var n=t.x-e.x,i=t.y-e.y,o=r.x-t.x,a=r.y-t.y;return ou.signOfDet2x2(n,i,o,a)},ou.signOfDet2x2=function(e,t,r,n){var i=null,o=null,a=null;if(i=1,0===e||0===n)return 0===t||0===r?0:t>0?r>0?-i:i:r>0?i:-i;if(0===t||0===r)return n>0?e>0?i:-i:e>0?-i:i;if(t>0?n>0?t<=n||(i=-i,o=e,e=r,r=o,o=t,t=n,n=o):t<=-n?(i=-i,r=-r,n=-n):(o=e,e=-r,r=o,o=t,t=-n,n=o):n>0?-t<=n?(i=-i,e=-e,t=-t):(o=-e,e=r,r=o,o=-t,t=n,n=o):t>=n?(e=-e,t=-t,r=-r,n=-n):(i=-i,o=-e,e=-r,r=o,o=-t,t=-n,n=o),e>0){if(!(r>0))return i;if(!(e<=r))return i}else{if(r>0)return-i;if(!(e>=r))return-i;i=-i,e=-e,r=-r}for(;;){if((n-=(a=Math.floor(r/e))*t)<0)return-i;if(n>t)return i;if(e>(r-=a*e)+r){if(t<n+n)return i}else{if(t>n+n)return-i;r=e-r,n=t-n,i=-i}if(0===n)return 0===r?0:-i;if(0===r)return i;if((t-=(a=Math.floor(e/r))*n)<0)return i;if(t>n)return-i;if(r>(e-=a*r)+e){if(n<t+t)return-i}else{if(n>t+t)return i;e=r-e,t=n-t,i=-i}if(0===t)return 0===e?0:i;if(0===e)return-i}};var au=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=arguments[0];this._p=e};au.prototype.countSegment=function(e,t){if(e.x<this._p.x&&t.x<this._p.x)return null;if(this._p.x===t.x&&this._p.y===t.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&t.y===this._p.y){var r=e.x,n=t.x;return r>n&&(r=t.x,n=e.x),this._p.x>=r&&this._p.x<=n&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&t.y<=this._p.y||t.y>this._p.y&&e.y<=this._p.y){var i=e.x-this._p.x,o=e.y-this._p.y,a=t.x-this._p.x,s=t.y-this._p.y,l=ou.signOfDet2x2(i,o,a,s);if(0===l)return this._isPointOnSegment=!0,null;s<o&&(l=-l),l>0&&this._crossingCount++}},au.prototype.isPointInPolygon=function(){return this.getLocation()!==Tl.EXTERIOR},au.prototype.getLocation=function(){return this._isPointOnSegment?Tl.BOUNDARY:this._crossingCount%2==1?Tl.INTERIOR:Tl.EXTERIOR},au.prototype.isOnSegment=function(){return this._isPointOnSegment},au.prototype.interfaces_=function(){return[]},au.prototype.getClass=function(){return au},au.locatePointInRing=function(){if(arguments[0]instanceof kl&&Pl(arguments[1],jl)){for(var e=arguments[0],t=arguments[1],r=new au(e),n=new kl,i=new kl,o=1;o<t.size();o++)if(t.getCoordinate(o,n),t.getCoordinate(o-1,i),r.countSegment(n,i),r.isOnSegment())return r.getLocation();return r.getLocation()}if(arguments[0]instanceof kl&&arguments[1]instanceof Array){for(var a=arguments[0],s=arguments[1],l=new au(a),u=1;u<s.length;u++){var c=s[u],f=s[u-1];if(l.countSegment(c,f),l.isOnSegment())return l.getLocation()}return l.getLocation()}};var su=function(){},lu={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};su.prototype.interfaces_=function(){return[]},su.prototype.getClass=function(){return su},su.orientationIndex=function(e,t,r){return Fl.orientationIndex(e,t,r)},su.signedArea=function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var t=0,r=e[0].x,n=1;n<e.length-1;n++){var i=e[n].x-r,o=e[n+1].y;t+=i*(e[n-1].y-o)}return t/2}if(Pl(arguments[0],jl)){var a=arguments[0],s=a.size();if(s<3)return 0;var l=new kl,u=new kl,c=new kl;a.getCoordinate(0,u),a.getCoordinate(1,c);var f=u.x;c.x-=f;for(var h=0,d=1;d<s-1;d++)l.y=u.y,u.x=c.x,u.y=c.y,a.getCoordinate(d+1,c),c.x-=f,h+=u.x*(l.y-c.y);return h/2}},su.distanceLineLine=function(e,t,r,n){if(e.equals(t))return su.distancePointLine(e,r,n);if(r.equals(n))return su.distancePointLine(n,e,t);var i=!1;if(Wl.intersects(e,t,r,n)){var o=(t.x-e.x)*(n.y-r.y)-(t.y-e.y)*(n.x-r.x);if(0===o)i=!0;else{var a=(e.y-r.y)*(n.x-r.x)-(e.x-r.x)*(n.y-r.y),s=((e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y))/o,l=a/o;(l<0||l>1||s<0||s>1)&&(i=!0)}}else i=!0;return i?Cl.min(su.distancePointLine(e,r,n),su.distancePointLine(t,r,n),su.distancePointLine(r,e,t),su.distancePointLine(n,e,t)):0},su.isPointInRing=function(e,t){return su.locatePointInRing(e,t)!==Tl.EXTERIOR},su.computeLength=function(e){var t=e.size();if(t<=1)return 0;var r=0,n=new kl;e.getCoordinate(0,n);for(var i=n.x,o=n.y,a=1;a<t;a++){e.getCoordinate(a,n);var s=n.x,l=n.y,u=s-i,c=l-o;r+=Math.sqrt(u*u+c*c),i=s,o=l}return r},su.isCCW=function(e){var t=e.length-1;if(t<3)throw new vl("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=e[0],n=0,i=1;i<=t;i++){var o=e[i];o.y>r.y&&(r=o,n=i)}var a=n;do{(a-=1)<0&&(a=t)}while(e[a].equals2D(r)&&a!==n);var s=n;do{s=(s+1)%t}while(e[s].equals2D(r)&&s!==n);var l=e[a],u=e[s];if(l.equals2D(r)||u.equals2D(r)||l.equals2D(u))return!1;var c=su.computeOrientation(l,r,u);return 0===c?l.x>u.x:c>0},su.locatePointInRing=function(e,t){return au.locatePointInRing(e,t)},su.distancePointLinePerpendicular=function(e,t,r){var n=(r.x-t.x)*(r.x-t.x)+(r.y-t.y)*(r.y-t.y),i=((t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y))/n;return Math.abs(i)*Math.sqrt(n)},su.computeOrientation=function(e,t,r){return su.orientationIndex(e,t,r)},su.distancePointLine=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];if(0===t.length)throw new vl("Line array must contain at least one vertex");for(var r=e.distance(t[0]),n=0;n<t.length-1;n++){var i=su.distancePointLine(e,t[n],t[n+1]);i<r&&(r=i)}return r}if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];if(a.x===s.x&&a.y===s.y)return o.distance(a);var l=(s.x-a.x)*(s.x-a.x)+(s.y-a.y)*(s.y-a.y),u=((o.x-a.x)*(s.x-a.x)+(o.y-a.y)*(s.y-a.y))/l;if(u<=0)return o.distance(a);if(u>=1)return o.distance(s);var c=((a.y-o.y)*(s.x-a.x)-(a.x-o.x)*(s.y-a.y))/l;return Math.abs(c)*Math.sqrt(l)}},su.isOnLine=function(e,t){for(var r=new iu,n=1;n<t.length;n++){var i=t[n-1],o=t[n];if(r.computeIntersection(e,i,o),r.hasIntersection())return!0}return!1},lu.CLOCKWISE.get=function(){return-1},lu.RIGHT.get=function(){return su.CLOCKWISE},lu.COUNTERCLOCKWISE.get=function(){return 1},lu.LEFT.get=function(){return su.COUNTERCLOCKWISE},lu.COLLINEAR.get=function(){return 0},lu.STRAIGHT.get=function(){return su.COLLINEAR},Object.defineProperties(su,lu);var uu=function(){};uu.prototype.filter=function(e){},uu.prototype.interfaces_=function(){return[]},uu.prototype.getClass=function(){return uu};var cu=function(){var e=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()},fu={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};cu.prototype.isGeometryCollection=function(){return this.getSortIndex()===cu.SORTINDEX_GEOMETRYCOLLECTION},cu.prototype.getFactory=function(){return this._factory},cu.prototype.getGeometryN=function(e){return this},cu.prototype.getArea=function(){return 0},cu.prototype.isRectangle=function(){return!1},cu.prototype.equals=function(){if(arguments[0]instanceof cu){var e=arguments[0];return null!==e&&this.equalsTopo(e)}if(arguments[0]instanceof Object){var t=arguments[0];if(!(t instanceof cu))return!1;var r=t;return this.equalsExact(r)}},cu.prototype.equalsExact=function(e){return this===e||this.equalsExact(e,0)},cu.prototype.geometryChanged=function(){this.apply(cu.geometryChangedFilter)},cu.prototype.geometryChangedAction=function(){this._envelope=null},cu.prototype.equalsNorm=function(e){return null!==e&&this.norm().equalsExact(e.norm())},cu.prototype.getLength=function(){return 0},cu.prototype.getNumGeometries=function(){return 1},cu.prototype.compareTo=function(){if(1===arguments.length){var e=arguments[0],t=e;return this.getSortIndex()!==t.getSortIndex()?this.getSortIndex()-t.getSortIndex():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){var r=arguments[0],n=arguments[1];return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,n)}},cu.prototype.getUserData=function(){return this._userData},cu.prototype.getSRID=function(){return this._SRID},cu.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},cu.prototype.checkNotGeometryCollection=function(e){if(e.getSortIndex()===cu.SORTINDEX_GEOMETRYCOLLECTION)throw new vl("This method does not support GeometryCollection arguments")},cu.prototype.equal=function(e,t,r){return 0===r?e.equals(t):e.distance(t)<=r},cu.prototype.norm=function(){var e=this.copy();return e.normalize(),e},cu.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},cu.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Wl(this._envelope)},cu.prototype.setSRID=function(e){this._SRID=e},cu.prototype.setUserData=function(e){this._userData=e},cu.prototype.compare=function(e,t){for(var r=e.iterator(),n=t.iterator();r.hasNext()&&n.hasNext();){var i=r.next(),o=n.next(),a=i.compareTo(o);if(0!==a)return a}return r.hasNext()?1:n.hasNext()?-1:0},cu.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},cu.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===cu.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===cu.SORTINDEX_MULTIPOINT||this.getSortIndex()===cu.SORTINDEX_MULTILINESTRING||this.getSortIndex()===cu.SORTINDEX_MULTIPOLYGON},cu.prototype.interfaces_=function(){return[xl,Sl,wl]},cu.prototype.getClass=function(){return cu},cu.hasNonEmptyElements=function(e){for(var t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1},cu.hasNullElements=function(e){for(var t=0;t<e.length;t++)if(null===e[t])return!0;return!1},fu.serialVersionUID.get=function(){return 0x799ea46522854c00},fu.SORTINDEX_POINT.get=function(){return 0},fu.SORTINDEX_MULTIPOINT.get=function(){return 1},fu.SORTINDEX_LINESTRING.get=function(){return 2},fu.SORTINDEX_LINEARRING.get=function(){return 3},fu.SORTINDEX_MULTILINESTRING.get=function(){return 4},fu.SORTINDEX_POLYGON.get=function(){return 5},fu.SORTINDEX_MULTIPOLYGON.get=function(){return 6},fu.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},fu.geometryChangedFilter.get=function(){return hu},Object.defineProperties(cu,fu);var hu=function(){};hu.interfaces_=function(){return[uu]},hu.filter=function(e){e.geometryChangedAction()};var du=function(){};du.prototype.filter=function(e){},du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du};var pu=function(){},yu={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};pu.prototype.isInBoundary=function(e){},pu.prototype.interfaces_=function(){return[]},pu.prototype.getClass=function(){return pu},yu.Mod2BoundaryNodeRule.get=function(){return gu},yu.EndPointBoundaryNodeRule.get=function(){return vu},yu.MultiValentEndPointBoundaryNodeRule.get=function(){return mu},yu.MonoValentEndPointBoundaryNodeRule.get=function(){return _u},yu.MOD2_BOUNDARY_RULE.get=function(){return new gu},yu.ENDPOINT_BOUNDARY_RULE.get=function(){return new vu},yu.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new mu},yu.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new _u},yu.OGC_SFS_BOUNDARY_RULE.get=function(){return pu.MOD2_BOUNDARY_RULE},Object.defineProperties(pu,yu);var gu=function(){};gu.prototype.isInBoundary=function(e){return e%2==1},gu.prototype.interfaces_=function(){return[pu]},gu.prototype.getClass=function(){return gu};var vu=function(){};vu.prototype.isInBoundary=function(e){return e>0},vu.prototype.interfaces_=function(){return[pu]},vu.prototype.getClass=function(){return vu};var mu=function(){};mu.prototype.isInBoundary=function(e){return e>1},mu.prototype.interfaces_=function(){return[pu]},mu.prototype.getClass=function(){return mu};var _u=function(){};_u.prototype.isInBoundary=function(e){return 1===e},_u.prototype.interfaces_=function(){return[pu]},_u.prototype.getClass=function(){return _u};var Su=function(){};function xu(e){this.message=e||""}Su.prototype.add=function(){},Su.prototype.addAll=function(){},Su.prototype.isEmpty=function(){},Su.prototype.iterator=function(){},Su.prototype.size=function(){},Su.prototype.toArray=function(){},Su.prototype.remove=function(){},xu.prototype=new Error,xu.prototype.name="IndexOutOfBoundsException";var bu=function(){};bu.prototype.hasNext=function(){},bu.prototype.next=function(){},bu.prototype.remove=function(){};var wu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(){},t.prototype.set=function(){},t.prototype.isEmpty=function(){},t}(Su);function ku(e){this.message=e||""}ku.prototype=new Error,ku.prototype.name="NoSuchElementException";var Mu=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof Su&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.ensureCapacity=function(){},t.prototype.interfaces_=function(){return[e,Su]},t.prototype.add=function(e){return 1===arguments.length?this.array_.push(e):this.array_.splice(arguments[0],arguments[1]),!0},t.prototype.clear=function(){this.array_=[]},t.prototype.addAll=function(e){for(var t=e.iterator();t.hasNext();)this.add(t.next());return!0},t.prototype.set=function(e,t){var r=this.array_[e];return this.array_[e]=t,r},t.prototype.iterator=function(){return new Eu(this)},t.prototype.get=function(e){if(e<0||e>=this.size())throw new xu;return this.array_[e]},t.prototype.isEmpty=function(){return 0===this.array_.length},t.prototype.size=function(){return this.array_.length},t.prototype.toArray=function(){for(var e=[],t=0,r=this.array_.length;t<r;t++)e.push(this.array_[t]);return e},t.prototype.remove=function(e){for(var t=!1,r=0,n=this.array_.length;r<n;r++)if(this.array_[r]===e){this.array_.splice(r,1),t=!0;break}return t},t}(wu),Eu=function(e){function t(t){e.call(this),this.arrayList_=t,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new ku;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(e){return this.arrayList_.set(this.position_-1,e)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}(bu),Iu=function(e){function t(){if(e.call(this),0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var r=arguments[0],n=arguments[1];this.ensureCapacity(r.length),this.add(r,n)}}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={coordArrayType:{configurable:!0}};return r.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(e){return this.get(e)},t.prototype.addAll=function(){if(2===arguments.length){for(var t=arguments[0],r=arguments[1],n=!1,i=t.iterator();i.hasNext();)this.add(i.next(),r),n=!0;return n}return e.prototype.addAll.apply(this,arguments)},t.prototype.clone=function(){for(var t=e.prototype.clone.call(this),r=0;r<this.size();r++)t.add(r,this.get(r).copy());return t},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){var t=this;if(1===arguments.length){var r=arguments[0];e.prototype.add.call(this,r)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return this.add(n,i,!0),!0}if(arguments[0]instanceof kl&&"boolean"==typeof arguments[1]){var o=arguments[0];if(!arguments[1]&&this.size()>=1)if(this.get(this.size()-1).equals2D(o))return null;e.prototype.add.call(this,o)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var a=arguments[0],s=arguments[1];return this.add(a,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var l=arguments[0],u=arguments[1];if(arguments[2])for(var c=0;c<l.length;c++)t.add(l[c],u);else for(var f=l.length-1;f>=0;f--)t.add(l[f],u);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof kl){var h=arguments[0],d=arguments[1];if(!arguments[2]){var p=this.size();if(p>0){if(h>0)if(this.get(h-1).equals2D(d))return null;if(h<p)if(this.get(h).equals2D(d))return null}}e.prototype.add.call(this,h,d)}}else if(4===arguments.length){var y=arguments[0],g=arguments[1],v=arguments[2],m=arguments[3],_=1;v>m&&(_=-1);for(var S=v;S!==m;S+=_)t.add(y[S],g);return!0}},t.prototype.closeRing=function(){this.size()>0&&this.add(new kl(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,r),t}(Mu),Tu=function(){},Lu={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Lu.ForwardComparator.get=function(){return Pu},Lu.BidirectionalComparator.get=function(){return Cu},Lu.coordArrayType.get=function(){return new Array(0).fill(null)},Tu.prototype.interfaces_=function(){return[]},Tu.prototype.getClass=function(){return Tu},Tu.isRing=function(e){return!(e.length<4||!e[0].equals2D(e[e.length-1]))},Tu.ptNotInList=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(Tu.indexOf(n,t)<0)return n}return null},Tu.scroll=function(e,t){var r=Tu.indexOf(t,e);if(r<0)return null;var n=new Array(e.length).fill(null);Jl.arraycopy(e,r,n,0,e.length-r),Jl.arraycopy(e,0,n,e.length-r,r),Jl.arraycopy(n,0,e,0,e.length)},Tu.equals=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];if(e===t)return!0;if(null===e||null===t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].equals(t[r]))return!1;return!0}if(3===arguments.length){var n=arguments[0],i=arguments[1],o=arguments[2];if(n===i)return!0;if(null===n||null===i)return!1;if(n.length!==i.length)return!1;for(var a=0;a<n.length;a++)if(0!==o.compare(n[a],i[a]))return!1;return!0}},Tu.intersection=function(e,t){for(var r=new Iu,n=0;n<e.length;n++)t.intersects(e[n])&&r.add(e[n],!0);return r.toCoordinateArray()},Tu.hasRepeatedPoints=function(e){for(var t=1;t<e.length;t++)if(e[t-1].equals(e[t]))return!0;return!1},Tu.removeRepeatedPoints=function(e){return Tu.hasRepeatedPoints(e)?new Iu(e,!1).toCoordinateArray():e},Tu.reverse=function(e){for(var t=e.length-1,r=Math.trunc(t/2),n=0;n<=r;n++){var i=e[n];e[n]=e[t-n],e[t-n]=i}},Tu.removeNull=function(e){for(var t=0,r=0;r<e.length;r++)null!==e[r]&&t++;var n=new Array(t).fill(null);if(0===t)return n;for(var i=0,o=0;o<e.length;o++)null!==e[o]&&(n[i++]=e[o]);return n},Tu.copyDeep=function(){if(1===arguments.length){for(var e=arguments[0],t=new Array(e.length).fill(null),r=0;r<e.length;r++)t[r]=new kl(e[r]);return t}if(5===arguments.length)for(var n=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3],s=arguments[4],l=0;l<s;l++)o[a+l]=new kl(n[i+l])},Tu.isEqualReversed=function(e,t){for(var r=0;r<e.length;r++){var n=e[r],i=t[e.length-r-1];if(0!==n.compareTo(i))return!1}return!0},Tu.envelope=function(e){for(var t=new Wl,r=0;r<e.length;r++)t.expandToInclude(e[r]);return t},Tu.toCoordinateArray=function(e){return e.toArray(Tu.coordArrayType)},Tu.atLeastNCoordinatesOrNothing=function(e,t){return t.length>=e?t:[]},Tu.indexOf=function(e,t){for(var r=0;r<t.length;r++)if(e.equals(t[r]))return r;return-1},Tu.increasingDirection=function(e){for(var t=0;t<Math.trunc(e.length/2);t++){var r=e.length-1-t,n=e[t].compareTo(e[r]);if(0!==n)return n}return 1},Tu.compare=function(e,t){for(var r=0;r<e.length&&r<t.length;){var n=e[r].compareTo(t[r]);if(0!==n)return n;r++}return r<t.length?-1:r<e.length?1:0},Tu.minCoordinate=function(e){for(var t=null,r=0;r<e.length;r++)(null===t||t.compareTo(e[r])>0)&&(t=e[r]);return t},Tu.extract=function(e,t,r){t=Cl.clamp(t,0,e.length);var n=(r=Cl.clamp(r,-1,e.length))-t+1;r<0&&(n=0),t>=e.length&&(n=0),r<t&&(n=0);var i=new Array(n).fill(null);if(0===n)return i;for(var o=0,a=t;a<=r;a++)i[o++]=e[a];return i},Object.defineProperties(Tu,Lu);var Pu=function(){};Pu.prototype.compare=function(e,t){return Tu.compare(e,t)},Pu.prototype.interfaces_=function(){return[bl]},Pu.prototype.getClass=function(){return Pu};var Cu=function(){};Cu.prototype.compare=function(e,t){var r=e,n=t;if(r.length<n.length)return-1;if(r.length>n.length)return 1;if(0===r.length)return 0;var i=Tu.compare(r,n);return Tu.isEqualReversed(r,n)?0:i},Cu.prototype.OLDcompare=function(e,t){var r=e,n=t;if(r.length<n.length)return-1;if(r.length>n.length)return 1;if(0===r.length)return 0;for(var i=Tu.increasingDirection(r),o=Tu.increasingDirection(n),a=i>0?0:r.length-1,s=o>0?0:r.length-1,l=0;l<r.length;l++){var u=r[a].compareTo(n[s]);if(0!==u)return u;a+=i,s+=o}return 0},Cu.prototype.interfaces_=function(){return[bl]},Cu.prototype.getClass=function(){return Cu};var Nu=function(){};Nu.prototype.get=function(){},Nu.prototype.put=function(){},Nu.prototype.size=function(){},Nu.prototype.values=function(){},Nu.prototype.entrySet=function(){};var Ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Nu);function Ru(e){this.message=e||""}function Vu(){}Ru.prototype=new Error,Ru.prototype.name="OperationNotSupported",Vu.prototype=new Su,Vu.prototype.contains=function(){};var Gu=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof Su&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contains=function(e){for(var t=0,r=this.array_.length;t<r;t++)if(this.array_[t]===e)return!0;return!1},t.prototype.add=function(e){return!this.contains(e)&&(this.array_.push(e),!0)},t.prototype.addAll=function(e){for(var t=e.iterator();t.hasNext();)this.add(t.next());return!0},t.prototype.remove=function(e){throw new Error},t.prototype.size=function(){return this.array_.length},t.prototype.isEmpty=function(){return 0===this.array_.length},t.prototype.toArray=function(){for(var e=[],t=0,r=this.array_.length;t<r;t++)e.push(this.array_[t]);return e},t.prototype.iterator=function(){return new Au(this)},t}(Vu),Au=function(e){function t(t){e.call(this),this.hashSet_=t,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new ku;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new Ru},t}(bu);function Fu(e){return null===e?0:e.color}function Du(e){return null===e?null:e.parent}function ju(e,t){null!==e&&(e.color=t)}function Bu(e){return null===e?null:e.left}function qu(e){return null===e?null:e.right}function Uu(){this.root_=null,this.size_=0}Uu.prototype=new Ou,Uu.prototype.get=function(e){for(var t=this.root_;null!==t;){var r=e.compareTo(t.key);if(r<0)t=t.left;else{if(!(r>0))return t.value;t=t.right}}return null},Uu.prototype.put=function(e,t){if(null===this.root_)return this.root_={key:e,value:t,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var r,n,i=this.root_;do{if(r=i,(n=e.compareTo(i.key))<0)i=i.left;else{if(!(n>0)){var o=i.value;return i.value=t,o}i=i.right}}while(null!==i);var a={key:e,left:null,right:null,value:t,parent:r,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return n<0?r.left=a:r.right=a,this.fixAfterInsertion(a),this.size_++,null},Uu.prototype.fixAfterInsertion=function(e){var t=this;for(e.color=1;null!=e&&e!==this.root_&&1===e.parent.color;)if(Du(e)===Bu(Du(Du(e)))){var r=qu(Du(Du(e)));1===Fu(r)?(ju(Du(e),0),ju(r,0),ju(Du(Du(e)),1),e=Du(Du(e))):(e===qu(Du(e))&&(e=Du(e),t.rotateLeft(e)),ju(Du(e),0),ju(Du(Du(e)),1),t.rotateRight(Du(Du(e))))}else{var n=Bu(Du(Du(e)));1===Fu(n)?(ju(Du(e),0),ju(n,0),ju(Du(Du(e)),1),e=Du(Du(e))):(e===Bu(Du(e))&&(e=Du(e),t.rotateRight(e)),ju(Du(e),0),ju(Du(Du(e)),1),t.rotateLeft(Du(Du(e))))}this.root_.color=0},Uu.prototype.values=function(){var e=new Mu,t=this.getFirstEntry();if(null!==t)for(e.add(t.value);null!==(t=Uu.successor(t));)e.add(t.value);return e},Uu.prototype.entrySet=function(){var e=new Gu,t=this.getFirstEntry();if(null!==t)for(e.add(t);null!==(t=Uu.successor(t));)e.add(t);return e},Uu.prototype.rotateLeft=function(e){if(null!=e){var t=e.right;e.right=t.left,null!=t.left&&(t.left.parent=e),t.parent=e.parent,null===e.parent?this.root_=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}},Uu.prototype.rotateRight=function(e){if(null!=e){var t=e.left;e.left=t.right,null!=t.right&&(t.right.parent=e),t.parent=e.parent,null===e.parent?this.root_=t:e.parent.right===e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}},Uu.prototype.getFirstEntry=function(){var e=this.root_;if(null!=e)for(;null!=e.left;)e=e.left;return e},Uu.successor=function(e){if(null===e)return null;if(null!==e.right){for(var t=e.right;null!==t.left;)t=t.left;return t}for(var r=e.parent,n=e;null!==r&&n===r.right;)n=r,r=r.parent;return r},Uu.prototype.size=function(){return this.size_};var Ju=function(){};function zu(){}function Wu(){this.array_=[],arguments[0]instanceof Su&&this.addAll(arguments[0])}Ju.prototype.interfaces_=function(){return[]},Ju.prototype.getClass=function(){return Ju},zu.prototype=new Vu,Wu.prototype=new zu,Wu.prototype.contains=function(e){for(var t=0,r=this.array_.length;t<r;t++)if(0===this.array_[t].compareTo(e))return!0;return!1},Wu.prototype.add=function(e){if(this.contains(e))return!1;for(var t=0,r=this.array_.length;t<r;t++)if(1===this.array_[t].compareTo(e))return this.array_.splice(t,0,e),!0;return this.array_.push(e),!0},Wu.prototype.addAll=function(e){for(var t=e.iterator();t.hasNext();)this.add(t.next());return!0},Wu.prototype.remove=function(e){throw new Ru},Wu.prototype.size=function(){return this.array_.length},Wu.prototype.isEmpty=function(){return 0===this.array_.length},Wu.prototype.toArray=function(){for(var e=[],t=0,r=this.array_.length;t<r;t++)e.push(this.array_[t]);return e},Wu.prototype.iterator=function(){return new Hu(this)};var Hu=function(e){this.treeSet_=e,this.position_=0};Hu.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new ku;return this.treeSet_.array_[this.position_++]},Hu.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Hu.prototype.remove=function(){throw new Ru};var Xu=function(){};Xu.sort=function(){var e,t,r,n,i=arguments[0];if(1===arguments.length)n=function(e,t){return e.compareTo(t)},i.sort(n);else if(2===arguments.length)r=arguments[1],n=function(e,t){return r.compare(e,t)},i.sort(n);else if(3===arguments.length){(t=i.slice(arguments[1],arguments[2])).sort();var o=i.slice(0,arguments[1]).concat(t,i.slice(arguments[2],i.length));for(i.splice(0,i.length),e=0;e<o.length;e++)i.push(o[e])}else if(4===arguments.length)for(t=i.slice(arguments[1],arguments[2]),r=arguments[3],n=function(e,t){return r.compare(e,t)},t.sort(n),o=i.slice(0,arguments[1]).concat(t,i.slice(arguments[2],i.length)),i.splice(0,i.length),e=0;e<o.length;e++)i.push(o[e])},Xu.asList=function(e){for(var t=new Mu,r=0,n=e.length;r<n;r++)t.add(e[r]);return t};var Yu=function(){},Zu={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Zu.P.get=function(){return 0},Zu.L.get=function(){return 1},Zu.A.get=function(){return 2},Zu.FALSE.get=function(){return-1},Zu.TRUE.get=function(){return-2},Zu.DONTCARE.get=function(){return-3},Zu.SYM_FALSE.get=function(){return"F"},Zu.SYM_TRUE.get=function(){return"T"},Zu.SYM_DONTCARE.get=function(){return"*"},Zu.SYM_P.get=function(){return"0"},Zu.SYM_L.get=function(){return"1"},Zu.SYM_A.get=function(){return"2"},Yu.prototype.interfaces_=function(){return[]},Yu.prototype.getClass=function(){return Yu},Yu.toDimensionSymbol=function(e){switch(e){case Yu.FALSE:return Yu.SYM_FALSE;case Yu.TRUE:return Yu.SYM_TRUE;case Yu.DONTCARE:return Yu.SYM_DONTCARE;case Yu.P:return Yu.SYM_P;case Yu.L:return Yu.SYM_L;case Yu.A:return Yu.SYM_A}throw new vl("Unknown dimension value: "+e)},Yu.toDimensionValue=function(e){switch(Vl.toUpperCase(e)){case Yu.SYM_FALSE:return Yu.FALSE;case Yu.SYM_TRUE:return Yu.TRUE;case Yu.SYM_DONTCARE:return Yu.DONTCARE;case Yu.SYM_P:return Yu.P;case Yu.SYM_L:return Yu.L;case Yu.SYM_A:return Yu.A}throw new vl("Unknown dimension symbol: "+e)},Object.defineProperties(Yu,Zu);var Ku=function(){};Ku.prototype.filter=function(e){},Ku.prototype.interfaces_=function(){return[]},Ku.prototype.getClass=function(){return Ku};var Qu=function(){};Qu.prototype.filter=function(e,t){},Qu.prototype.isDone=function(){},Qu.prototype.isGeometryChanged=function(){},Qu.prototype.interfaces_=function(){return[]},Qu.prototype.getClass=function(){return Qu};var $u=function(e){function t(t,r){if(e.call(this,r),this._geometries=t||[],e.hasNullElements(this._geometries))throw new vl("geometries must not contain null elements")}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){for(var e=new Wl,t=0;t<this._geometries.length;t++)e.expandToInclude(this._geometries[t].getEnvelopeInternal());return e},t.prototype.getGeometryN=function(e){return this._geometries[e]},t.prototype.getSortIndex=function(){return e.SORTINDEX_GEOMETRYCOLLECTION},t.prototype.getCoordinates=function(){for(var e=new Array(this.getNumPoints()).fill(null),t=-1,r=0;r<this._geometries.length;r++)for(var n=this._geometries[r].getCoordinates(),i=0;i<n.length;i++)e[++t]=n[i];return e},t.prototype.getArea=function(){for(var e=0,t=0;t<this._geometries.length;t++)e+=this._geometries[t].getArea();return e},t.prototype.equalsExact=function(){if(2===arguments.length){var t=arguments[0],r=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._geometries.length!==n._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!this._geometries[i].equalsExact(n._geometries[i],r))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var e=0;e<this._geometries.length;e++)this._geometries[e].normalize();Xu.sort(this._geometries)},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},t.prototype.getBoundaryDimension=function(){for(var e=Yu.FALSE,t=0;t<this._geometries.length;t++)e=Math.max(e,this._geometries[t].getBoundaryDimension());return e},t.prototype.getDimension=function(){for(var e=Yu.FALSE,t=0;t<this._geometries.length;t++)e=Math.max(e,this._geometries[t].getDimension());return e},t.prototype.getLength=function(){for(var e=0,t=0;t<this._geometries.length;t++)e+=this._geometries[t].getLength();return e},t.prototype.getNumPoints=function(){for(var e=0,t=0;t<this._geometries.length;t++)e+=this._geometries[t].getNumPoints();return e},t.prototype.getNumGeometries=function(){return this._geometries.length},t.prototype.reverse=function(){for(var e=this._geometries.length,t=new Array(e).fill(null),r=0;r<this._geometries.length;r++)t[r]=this._geometries[r].reverse();return this.getFactory().createGeometryCollection(t)},t.prototype.compareToSameClass=function(){if(1===arguments.length){var e=arguments[0],t=new Wu(Xu.asList(this._geometries)),r=new Wu(Xu.asList(e._geometries));return this.compare(t,r)}if(2===arguments.length){for(var n=arguments[0],i=arguments[1],o=n,a=this.getNumGeometries(),s=o.getNumGeometries(),l=0;l<a&&l<s;){var u=this.getGeometryN(l),c=o.getGeometryN(l),f=u.compareToSameClass(c,i);if(0!==f)return f;l++}return l<a?1:l<s?-1:0}},t.prototype.apply=function(){var e=this;if(Pl(arguments[0],du))for(var t=arguments[0],r=0;r<this._geometries.length;r++)e._geometries[r].apply(t);else if(Pl(arguments[0],Qu)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(e._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(Pl(arguments[0],Ku)){var o=arguments[0];o.filter(this);for(var a=0;a<this._geometries.length;a++)e._geometries[a].apply(o)}else if(Pl(arguments[0],uu)){var s=arguments[0];s.filter(this);for(var l=0;l<this._geometries.length;l++)e._geometries[l].apply(s)}},t.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),tu.shouldNeverReachHere(),null},t.prototype.clone=function(){var t=e.prototype.clone.call(this);t._geometries=new Array(this._geometries.length).fill(null);for(var r=0;r<this._geometries.length;r++)t._geometries[r]=this._geometries[r].clone();return t},t.prototype.getGeometryType=function(){return"GeometryCollection"},t.prototype.copy=function(){for(var e=new Array(this._geometries.length).fill(null),r=0;r<e.length;r++)e[r]=this._geometries[r].copy();return new t(e,this._factory)},t.prototype.isEmpty=function(){for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isEmpty())return!1;return!0},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},r.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(t,r),t}(cu),ec=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return cu.SORTINDEX_MULTILINESTRING},t.prototype.equalsExact=function(){if(2===arguments.length){var t=arguments[0],r=arguments[1];return!!this.isEquivalentClass(t)&&e.prototype.equalsExact.call(this,t,r)}return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?Yu.FALSE:0},t.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isClosed())return!1;return!0},t.prototype.getDimension=function(){return 1},t.prototype.reverse=function(){for(var e=this._geometries.length,t=new Array(e).fill(null),r=0;r<this._geometries.length;r++)t[e-1-r]=this._geometries[r].reverse();return this.getFactory().createMultiLineString(t)},t.prototype.getBoundary=function(){return new tc(this).getBoundary()},t.prototype.getGeometryType=function(){return"MultiLineString"},t.prototype.copy=function(){for(var e=new Array(this._geometries.length).fill(null),r=0;r<e.length;r++)e[r]=this._geometries[r].copy();return new t(e,this._factory)},t.prototype.interfaces_=function(){return[Ju]},t.prototype.getClass=function(){return t},r.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(t,r),t}($u),tc=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var e=arguments[0],t=pu.MOD2_BOUNDARY_RULE;this._geom=e,this._geomFact=e.getFactory(),this._bnRule=t}else if(2===arguments.length){var r=arguments[0],n=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=n}};tc.prototype.boundaryMultiLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var t=this.computeBoundaryCoordinates(e);return 1===t.length?this._geomFact.createPoint(t[0]):this._geomFact.createMultiPointFromCoords(t)},tc.prototype.getBoundary=function(){return this._geom instanceof sc?this.boundaryLineString(this._geom):this._geom instanceof ec?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},tc.prototype.boundaryLineString=function(e){return this._geom.isEmpty()?this.getEmptyMultiPoint():e.isClosed()?this._bnRule.isInBoundary(2)?e.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([e.getStartPoint(),e.getEndPoint()])},tc.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},tc.prototype.computeBoundaryCoordinates=function(e){var t=this,r=new Mu;this._endpointMap=new Uu;for(var n=0;n<e.getNumGeometries();n++){var i=e.getGeometryN(n);0!==i.getNumPoints()&&(t.addEndpoint(i.getCoordinateN(0)),t.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var o=this._endpointMap.entrySet().iterator();o.hasNext();){var a=o.next(),s=a.getValue().count;t._bnRule.isInBoundary(s)&&r.add(a.getKey())}return Tu.toCoordinateArray(r)},tc.prototype.addEndpoint=function(e){var t=this._endpointMap.get(e);null===t&&(t=new rc,this._endpointMap.put(e,t)),t.count++},tc.prototype.interfaces_=function(){return[]},tc.prototype.getClass=function(){return tc},tc.getBoundary=function(){if(1===arguments.length){var e=arguments[0];return new tc(e).getBoundary()}if(2===arguments.length){var t=arguments[0],r=arguments[1];return new tc(t,r).getBoundary()}};var rc=function(){this.count=null};function nc(){}rc.prototype.interfaces_=function(){return[]},rc.prototype.getClass=function(){return rc};var ic=function(){},oc={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};ic.prototype.interfaces_=function(){return[]},ic.prototype.getClass=function(){return ic},ic.chars=function(e,t){for(var r=new Array(t).fill(null),n=0;n<t;n++)r[n]=e;return String(r)},ic.getStackTrace=function(){if(1===arguments.length){var e=arguments[0],t=new function(){},r=new function(){}(t);return e.printStackTrace(r),t.toString()}if(2===arguments.length){for(var n=arguments[0],i=arguments[1],o="",a=new function(){}(new function(){}(ic.getStackTrace(n))),s=0;s<i;s++)try{o+=a.readLine()+ic.NEWLINE}catch(e){if(!(e instanceof nc))throw e;tu.shouldNeverReachHere()}return o}},ic.split=function(e,t){for(var r=t.length,n=new Mu,i=""+e,o=i.indexOf(t);o>=0;){var a=i.substring(0,o);n.add(a),o=(i=i.substring(o+r)).indexOf(t)}i.length>0&&n.add(i);for(var s=new Array(n.size()).fill(null),l=0;l<s.length;l++)s[l]=n.get(l);return s},ic.toString=function(){if(1===arguments.length){var e=arguments[0];return ic.SIMPLE_ORDINATE_FORMAT.format(e)}},ic.spaces=function(e){return ic.chars(" ",e)},oc.NEWLINE.get=function(){return Jl.getProperty("line.separator")},oc.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(ic,oc);var ac=function(){};ac.prototype.interfaces_=function(){return[]},ac.prototype.getClass=function(){return ac},ac.copyCoord=function(e,t,r,n){for(var i=Math.min(e.getDimension(),r.getDimension()),o=0;o<i;o++)r.setOrdinate(n,o,e.getOrdinate(t,o))},ac.isRing=function(e){var t=e.size();return 0===t||!(t<=3)&&e.getOrdinate(0,jl.X)===e.getOrdinate(t-1,jl.X)&&e.getOrdinate(0,jl.Y)===e.getOrdinate(t-1,jl.Y)},ac.isEqual=function(e,t){var r=e.size();if(r!==t.size())return!1;for(var n=Math.min(e.getDimension(),t.getDimension()),i=0;i<r;i++)for(var o=0;o<n;o++){var a=e.getOrdinate(i,o),s=t.getOrdinate(i,o);if(!(e.getOrdinate(i,o)===t.getOrdinate(i,o)||ml.isNaN(a)&&ml.isNaN(s)))return!1}return!0},ac.extend=function(e,t,r){var n=e.create(r,t.getDimension()),i=t.size();if(ac.copy(t,0,n,0,i),i>0)for(var o=i;o<r;o++)ac.copy(t,i-1,n,o,1);return n},ac.reverse=function(e){for(var t=e.size()-1,r=Math.trunc(t/2),n=0;n<=r;n++)ac.swap(e,n,t-n)},ac.swap=function(e,t,r){if(t===r)return null;for(var n=0;n<e.getDimension();n++){var i=e.getOrdinate(t,n);e.setOrdinate(t,n,e.getOrdinate(r,n)),e.setOrdinate(r,n,i)}},ac.copy=function(e,t,r,n,i){for(var o=0;o<i;o++)ac.copyCoord(e,t+o,r,n+o)},ac.toString=function(){if(1===arguments.length){var e=arguments[0],t=e.size();if(0===t)return"()";var r=e.getDimension(),n=new Ol;n.append("(");for(var i=0;i<t;i++){i>0&&n.append(" ");for(var o=0;o<r;o++)o>0&&n.append(","),n.append(ic.toString(e.getOrdinate(i,o)))}return n.append(")"),n.toString()}},ac.ensureValidRing=function(e,t){var r=t.size();return 0===r?t:r<=3?ac.createClosedRing(e,t,4):t.getOrdinate(0,jl.X)===t.getOrdinate(r-1,jl.X)&&t.getOrdinate(0,jl.Y)===t.getOrdinate(r-1,jl.Y)?t:ac.createClosedRing(e,t,r+1)},ac.createClosedRing=function(e,t,r){var n=e.create(r,t.getDimension()),i=t.size();ac.copy(t,0,n,0,i);for(var o=i;o<r;o++)ac.copy(t,0,n,o,1);return n};var sc=function(e){function t(t,r){e.call(this,r),this._points=null,this.init(t)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Wl:this._points.expandEnvelope(new Wl)},t.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},t.prototype.getSortIndex=function(){return e.SORTINDEX_LINESTRING},t.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},t.prototype.equalsExact=function(){if(2===arguments.length){var t=arguments[0],r=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._points.size()!==n._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!this.equal(this._points.getCoordinate(i),n._points.getCoordinate(i),r))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var e=this,t=0;t<Math.trunc(this._points.size()/2);t++){var r=e._points.size()-1-t;if(!e._points.getCoordinate(t).equals(e._points.getCoordinate(r)))return e._points.getCoordinate(t).compareTo(e._points.getCoordinate(r))>0&&ac.reverse(e._points),null}},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?Yu.FALSE:0},t.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},t.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},t.prototype.getDimension=function(){return 1},t.prototype.getLength=function(){return su.computeLength(this._points)},t.prototype.getNumPoints=function(){return this._points.size()},t.prototype.reverse=function(){var e=this._points.copy();return ac.reverse(e),this.getFactory().createLineString(e)},t.prototype.compareToSameClass=function(){if(1===arguments.length){for(var e=arguments[0],t=0,r=0;t<this._points.size()&&r<e._points.size();){var n=this._points.getCoordinate(t).compareTo(e._points.getCoordinate(r));if(0!==n)return n;t++,r++}return t<this._points.size()?1:r<e._points.size()?-1:0}if(2===arguments.length){var i=arguments[0];return arguments[1].compare(this._points,i._points)}},t.prototype.apply=function(){if(Pl(arguments[0],du))for(var e=arguments[0],t=0;t<this._points.size();t++)e.filter(this._points.getCoordinate(t));else if(Pl(arguments[0],Qu)){var r=arguments[0];if(0===this._points.size())return null;for(var n=0;n<this._points.size()&&(r.filter(this._points,n),!r.isDone());n++);r.isGeometryChanged()&&this.geometryChanged()}else if(Pl(arguments[0],Ku)){arguments[0].filter(this)}else if(Pl(arguments[0],uu)){arguments[0].filter(this)}},t.prototype.getBoundary=function(){return new tc(this).getBoundary()},t.prototype.isEquivalentClass=function(e){return e instanceof t},t.prototype.clone=function(){var t=e.prototype.clone.call(this);return t._points=this._points.clone(),t},t.prototype.getCoordinateN=function(e){return this._points.getCoordinate(e)},t.prototype.getGeometryType=function(){return"LineString"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._points},t.prototype.isEmpty=function(){return 0===this._points.size()},t.prototype.init=function(e){if(null===e&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),1===e.size())throw new vl("Invalid number of points in LineString (found "+e.size()+" - must be 0 or >= 2)");this._points=e},t.prototype.isCoordinate=function(e){for(var t=0;t<this._points.size();t++)if(this._points.getCoordinate(t).equals(e))return!0;return!1},t.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},t.prototype.getPointN=function(e){return this.getFactory().createPoint(this._points.getCoordinate(e))},t.prototype.interfaces_=function(){return[Ju]},t.prototype.getClass=function(){return t},r.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(t,r),t}(cu),lc=function(){};lc.prototype.interfaces_=function(){return[]},lc.prototype.getClass=function(){return lc};var uc=function(e){function t(t,r){e.call(this,r),this._coordinates=t||null,this.init(this._coordinates)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Wl;var e=new Wl;return e.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),e},t.prototype.getSortIndex=function(){return e.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(2===arguments.length){var t=arguments[0],r=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),r))}return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return Yu.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(1===arguments.length){var e=arguments[0];return this.getCoordinate().compareTo(e.getCoordinate())}if(2===arguments.length){var t=arguments[0];return arguments[1].compare(this._coordinates,t._coordinates)}},t.prototype.apply=function(){if(Pl(arguments[0],du)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.getCoordinate())}else if(Pl(arguments[0],Qu)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else if(Pl(arguments[0],Ku)){arguments[0].filter(this)}else if(Pl(arguments[0],uu)){arguments[0].filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var t=e.prototype.clone.call(this);return t._coordinates=this._coordinates.clone(),t},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return 0===this._coordinates.size()},t.prototype.init=function(e){null===e&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),tu.isTrue(e.size()<=1),this._coordinates=e},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[lc]},t.prototype.getClass=function(){return t},r.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(t,r),t}(cu),cc=function(){};cc.prototype.interfaces_=function(){return[]},cc.prototype.getClass=function(){return cc};var fc=function(e){function t(t,r,n){if(e.call(this,n),this._shell=null,this._holes=null,null===t&&(t=this.getFactory().createLinearRing()),null===r&&(r=[]),e.hasNullElements(r))throw new vl("holes must not contain null elements");if(t.isEmpty()&&e.hasNonEmptyElements(r))throw new vl("shell is empty but holes are not");this._shell=t,this._holes=r}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},t.prototype.getSortIndex=function(){return e.SORTINDEX_POLYGON},t.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var e=new Array(this.getNumPoints()).fill(null),t=-1,r=this._shell.getCoordinates(),n=0;n<r.length;n++)e[++t]=r[n];for(var i=0;i<this._holes.length;i++)for(var o=this._holes[i].getCoordinates(),a=0;a<o.length;a++)e[++t]=o[a];return e},t.prototype.getArea=function(){var e=0;e+=Math.abs(su.signedArea(this._shell.getCoordinateSequence()));for(var t=0;t<this._holes.length;t++)e-=Math.abs(su.signedArea(this._holes[t].getCoordinateSequence()));return e},t.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var e=this._shell.getCoordinateSequence(),t=this.getEnvelopeInternal(),r=0;r<5;r++){var n=e.getX(r);if(n!==t.getMinX()&&n!==t.getMaxX())return!1;var i=e.getY(r);if(i!==t.getMinY()&&i!==t.getMaxY())return!1}for(var o=e.getX(0),a=e.getY(0),s=1;s<=4;s++){var l=e.getX(s),u=e.getY(s);if(l!==o==(u!==a))return!1;o=l,a=u}return!0},t.prototype.equalsExact=function(){if(2===arguments.length){var t=arguments[0],r=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,i=this._shell,o=n._shell;if(!i.equalsExact(o,r))return!1;if(this._holes.length!==n._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!this._holes[a].equalsExact(n._holes[a],r))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var e=0;e<this._holes.length;e++)this.normalize(this._holes[e],!1);Xu.sort(this._holes)}else if(2===arguments.length){var t=arguments[0],r=arguments[1];if(t.isEmpty())return null;var n=new Array(t.getCoordinates().length-1).fill(null);Jl.arraycopy(t.getCoordinates(),0,n,0,n.length);var i=Tu.minCoordinate(t.getCoordinates());Tu.scroll(n,i),Jl.arraycopy(n,0,t.getCoordinates(),0,n.length),t.getCoordinates()[n.length]=n[0],su.isCCW(t.getCoordinates())===r&&Tu.reverse(t.getCoordinates())}},t.prototype.getCoordinate=function(){return this._shell.getCoordinate()},t.prototype.getNumInteriorRing=function(){return this._holes.length},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.getLength=function(){var e=0;e+=this._shell.getLength();for(var t=0;t<this._holes.length;t++)e+=this._holes[t].getLength();return e},t.prototype.getNumPoints=function(){for(var e=this._shell.getNumPoints(),t=0;t<this._holes.length;t++)e+=this._holes[t].getNumPoints();return e},t.prototype.reverse=function(){var e=this.copy();e._shell=this._shell.copy().reverse(),e._holes=new Array(this._holes.length).fill(null);for(var t=0;t<this._holes.length;t++)e._holes[t]=this._holes[t].copy().reverse();return e},t.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},t.prototype.compareToSameClass=function(){if(1===arguments.length){var e=arguments[0],t=this._shell,r=e._shell;return t.compareToSameClass(r)}if(2===arguments.length){var n=arguments[0],i=arguments[1],o=n,a=this._shell,s=o._shell,l=a.compareToSameClass(s,i);if(0!==l)return l;for(var u=this.getNumInteriorRing(),c=o.getNumInteriorRing(),f=0;f<u&&f<c;){var h=this.getInteriorRingN(f),d=o.getInteriorRingN(f),p=h.compareToSameClass(d,i);if(0!==p)return p;f++}return f<u?1:f<c?-1:0}},t.prototype.apply=function(e){var t=this;if(Pl(e,du)){this._shell.apply(e);for(var r=0;r<this._holes.length;r++)t._holes[r].apply(e)}else if(Pl(e,Qu)){if(this._shell.apply(e),!e.isDone())for(var n=0;n<this._holes.length&&(t._holes[n].apply(e),!e.isDone());n++);e.isGeometryChanged()&&this.geometryChanged()}else if(Pl(e,Ku))e.filter(this);else if(Pl(e,uu)){e.filter(this),this._shell.apply(e);for(var i=0;i<this._holes.length;i++)t._holes[i].apply(e)}},t.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var e=new Array(this._holes.length+1).fill(null);e[0]=this._shell;for(var t=0;t<this._holes.length;t++)e[t+1]=this._holes[t];return e.length<=1?this.getFactory().createLinearRing(e[0].getCoordinateSequence()):this.getFactory().createMultiLineString(e)},t.prototype.clone=function(){var t=e.prototype.clone.call(this);t._shell=this._shell.clone(),t._holes=new Array(this._holes.length).fill(null);for(var r=0;r<this._holes.length;r++)t._holes[r]=this._holes[r].clone();return t},t.prototype.getGeometryType=function(){return"Polygon"},t.prototype.copy=function(){for(var e=this._shell.copy(),r=new Array(this._holes.length).fill(null),n=0;n<r.length;n++)r[n]=this._holes[n].copy();return new t(e,r,this._factory)},t.prototype.getExteriorRing=function(){return this._shell},t.prototype.isEmpty=function(){return this._shell.isEmpty()},t.prototype.getInteriorRingN=function(e){return this._holes[e]},t.prototype.interfaces_=function(){return[cc]},t.prototype.getClass=function(){return t},r.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(t,r),t}(cu),hc=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return cu.SORTINDEX_MULTIPOINT},t.prototype.isValid=function(){return!0},t.prototype.equalsExact=function(){if(2===arguments.length){var t=arguments[0],r=arguments[1];return!!this.isEquivalentClass(t)&&e.prototype.equalsExact.call(this,t,r)}return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._geometries[t].getCoordinate()}return e.prototype.getCoordinate.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return Yu.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.getGeometryType=function(){return"MultiPoint"},t.prototype.copy=function(){for(var e=new Array(this._geometries.length).fill(null),r=0;r<e.length;r++)e[r]=this._geometries[r].copy();return new t(e,this._factory)},t.prototype.interfaces_=function(){return[lc]},t.prototype.getClass=function(){return t},r.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(t,r),t}($u),dc=function(e){function t(t,r){t instanceof kl&&r instanceof Lc&&(t=r.getCoordinateSequenceFactory().create(t)),e.call(this,t,r),this.validateConstruction()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return cu.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return Yu.FALSE},t.prototype.isClosed=function(){return!!this.isEmpty()||e.prototype.isClosed.call(this)},t.prototype.reverse=function(){var e=this._points.copy();return ac.reverse(e),this.getFactory().createLinearRing(e)},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!e.prototype.isClosed.call(this))throw new vl("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new vl("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},r.MINIMUM_VALID_SIZE.get=function(){return 4},r.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,r),t}(sc),pc=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return cu.SORTINDEX_MULTIPOLYGON},t.prototype.equalsExact=function(){if(2===arguments.length){var t=arguments[0],r=arguments[1];return!!this.isEquivalentClass(t)&&e.prototype.equalsExact.call(this,t,r)}return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.reverse=function(){for(var e=this._geometries.length,t=new Array(e).fill(null),r=0;r<this._geometries.length;r++)t[r]=this._geometries[r].reverse();return this.getFactory().createMultiPolygon(t)},t.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var e=new Mu,t=0;t<this._geometries.length;t++)for(var r=this._geometries[t].getBoundary(),n=0;n<r.getNumGeometries();n++)e.add(r.getGeometryN(n));var i=new Array(e.size()).fill(null);return this.getFactory().createMultiLineString(e.toArray(i))},t.prototype.getGeometryType=function(){return"MultiPolygon"},t.prototype.copy=function(){for(var e=new Array(this._geometries.length).fill(null),r=0;r<e.length;r++)e[r]=this._geometries[r].copy();return new t(e,this._factory)},t.prototype.interfaces_=function(){return[cc]},t.prototype.getClass=function(){return t},r.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(t,r),t}($u),yc=function(e){this._factory=e||null,this._isUserDataCopied=!1},gc={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};yc.prototype.setCopyUserData=function(e){this._isUserDataCopied=e},yc.prototype.edit=function(e,t){if(null===e)return null;var r=this.editInternal(e,t);return this._isUserDataCopied&&r.setUserData(e.getUserData()),r},yc.prototype.editInternal=function(e,t){return null===this._factory&&(this._factory=e.getFactory()),e instanceof $u?this.editGeometryCollection(e,t):e instanceof fc?this.editPolygon(e,t):e instanceof uc||e instanceof sc?t.edit(e,this._factory):(tu.shouldNeverReachHere("Unsupported Geometry class: "+e.getClass().getName()),null)},yc.prototype.editGeometryCollection=function(e,t){for(var r=t.edit(e,this._factory),n=new Mu,i=0;i<r.getNumGeometries();i++){var o=this.edit(r.getGeometryN(i),t);null===o||o.isEmpty()||n.add(o)}return r.getClass()===hc?this._factory.createMultiPoint(n.toArray([])):r.getClass()===ec?this._factory.createMultiLineString(n.toArray([])):r.getClass()===pc?this._factory.createMultiPolygon(n.toArray([])):this._factory.createGeometryCollection(n.toArray([]))},yc.prototype.editPolygon=function(e,t){var r=t.edit(e,this._factory);if(null===r&&(r=this._factory.createPolygon(null)),r.isEmpty())return r;var n=this.edit(r.getExteriorRing(),t);if(null===n||n.isEmpty())return this._factory.createPolygon();for(var i=new Mu,o=0;o<r.getNumInteriorRing();o++){var a=this.edit(r.getInteriorRingN(o),t);null===a||a.isEmpty()||i.add(a)}return this._factory.createPolygon(n,i.toArray([]))},yc.prototype.interfaces_=function(){return[]},yc.prototype.getClass=function(){return yc},yc.GeometryEditorOperation=function(){},gc.NoOpGeometryOperation.get=function(){return vc},gc.CoordinateOperation.get=function(){return mc},gc.CoordinateSequenceOperation.get=function(){return _c},Object.defineProperties(yc,gc);var vc=function(){};vc.prototype.edit=function(e,t){return e},vc.prototype.interfaces_=function(){return[yc.GeometryEditorOperation]},vc.prototype.getClass=function(){return vc};var mc=function(){};mc.prototype.edit=function(e,t){var r=this.editCoordinates(e.getCoordinates(),e);return null===r?e:e instanceof dc?t.createLinearRing(r):e instanceof sc?t.createLineString(r):e instanceof uc?r.length>0?t.createPoint(r[0]):t.createPoint():e},mc.prototype.interfaces_=function(){return[yc.GeometryEditorOperation]},mc.prototype.getClass=function(){return mc};var _c=function(){};_c.prototype.edit=function(e,t){return e instanceof dc?t.createLinearRing(this.edit(e.getCoordinateSequence(),e)):e instanceof sc?t.createLineString(this.edit(e.getCoordinateSequence(),e)):e instanceof uc?t.createPoint(this.edit(e.getCoordinateSequence(),e)):e},_c.prototype.interfaces_=function(){return[yc.GeometryEditorOperation]},_c.prototype.getClass=function(){return _c};var Sc=function(){var e=this;if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var r=0;r<t;r++)e._coordinates[r]=new kl}else if(Pl(arguments[0],jl)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var i=0;i<this._coordinates.length;i++)e._coordinates[i]=n.getCoordinateCopy(i)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var o=arguments[0],a=arguments[1];this._coordinates=o,this._dimension=a,null===o&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],l=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=l;for(var u=0;u<s;u++)e._coordinates[u]=new kl}},xc={serialVersionUID:{configurable:!0}};Sc.prototype.setOrdinate=function(e,t,r){switch(t){case jl.X:this._coordinates[e].x=r;break;case jl.Y:this._coordinates[e].y=r;break;case jl.Z:this._coordinates[e].z=r;break;default:throw new vl("invalid ordinateIndex")}},Sc.prototype.size=function(){return this._coordinates.length},Sc.prototype.getOrdinate=function(e,t){switch(t){case jl.X:return this._coordinates[e].x;case jl.Y:return this._coordinates[e].y;case jl.Z:return this._coordinates[e].z}return ml.NaN},Sc.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._coordinates[e]}if(2===arguments.length){var t=arguments[0],r=arguments[1];r.x=this._coordinates[t].x,r.y=this._coordinates[t].y,r.z=this._coordinates[t].z}},Sc.prototype.getCoordinateCopy=function(e){return new kl(this._coordinates[e])},Sc.prototype.getDimension=function(){return this._dimension},Sc.prototype.getX=function(e){return this._coordinates[e].x},Sc.prototype.clone=function(){for(var e=new Array(this.size()).fill(null),t=0;t<this._coordinates.length;t++)e[t]=this._coordinates[t].clone();return new Sc(e,this._dimension)},Sc.prototype.expandEnvelope=function(e){for(var t=0;t<this._coordinates.length;t++)e.expandToInclude(this._coordinates[t]);return e},Sc.prototype.copy=function(){for(var e=new Array(this.size()).fill(null),t=0;t<this._coordinates.length;t++)e[t]=this._coordinates[t].copy();return new Sc(e,this._dimension)},Sc.prototype.toString=function(){if(this._coordinates.length>0){var e=new Ol(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var t=1;t<this._coordinates.length;t++)e.append(", "),e.append(this._coordinates[t]);return e.append(")"),e.toString()}return"()"},Sc.prototype.getY=function(e){return this._coordinates[e].y},Sc.prototype.toCoordinateArray=function(){return this._coordinates},Sc.prototype.interfaces_=function(){return[jl,wl]},Sc.prototype.getClass=function(){return Sc},xc.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Sc,xc);var bc=function(){},wc={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};bc.prototype.readResolve=function(){return bc.instance()},bc.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return new Sc(e)}if(Pl(arguments[0],jl)){var t=arguments[0];return new Sc(t)}}else if(2===arguments.length){var r=arguments[0],n=arguments[1];return n>3&&(n=3),n<2?new Sc(r):new Sc(r,n)}},bc.prototype.interfaces_=function(){return[Il,wl]},bc.prototype.getClass=function(){return bc},bc.instance=function(){return bc.instanceObject},wc.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},wc.instanceObject.get=function(){return new bc},Object.defineProperties(bc,wc);var kc=function(e){function t(){e.call(this),this.map_=new Map}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return this.map_.get(e)||null},t.prototype.put=function(e,t){return this.map_.set(e,t),t},t.prototype.values=function(){for(var e=new Mu,t=this.map_.values(),r=t.next();!r.done;)e.add(r.value),r=t.next();return e},t.prototype.entrySet=function(){var e=new Gu;return this.map_.entries().forEach(function(t){return e.add(t)}),e},t.prototype.size=function(){return this.map_.size()},t}(Nu),Mc=function e(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=e.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Ic){var t=arguments[0];this._modelType=t,t===e.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var r=arguments[0];this._modelType=e.FIXED,this.setScale(r)}else if(arguments[0]instanceof e){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}},Ec={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Mc.prototype.equals=function(e){if(!(e instanceof Mc))return!1;var t=e;return this._modelType===t._modelType&&this._scale===t._scale},Mc.prototype.compareTo=function(e){var t=e,r=this.getMaximumSignificantDigits(),n=t.getMaximumSignificantDigits();return new Rl(r).compareTo(new Rl(n))},Mc.prototype.getScale=function(){return this._scale},Mc.prototype.isFloating=function(){return this._modelType===Mc.FLOATING||this._modelType===Mc.FLOATING_SINGLE},Mc.prototype.getType=function(){return this._modelType},Mc.prototype.toString=function(){var e="UNKNOWN";return this._modelType===Mc.FLOATING?e="Floating":this._modelType===Mc.FLOATING_SINGLE?e="Floating-Single":this._modelType===Mc.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e},Mc.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var e=arguments[0];return ml.isNaN(e)?e:this._modelType===Mc.FLOATING_SINGLE?e:this._modelType===Mc.FIXED?Math.round(e*this._scale)/this._scale:e}if(arguments[0]instanceof kl){var t=arguments[0];if(this._modelType===Mc.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}},Mc.prototype.getMaximumSignificantDigits=function(){var e=16;return this._modelType===Mc.FLOATING?e=16:this._modelType===Mc.FLOATING_SINGLE?e=6:this._modelType===Mc.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e},Mc.prototype.setScale=function(e){this._scale=Math.abs(e)},Mc.prototype.interfaces_=function(){return[wl,Sl]},Mc.prototype.getClass=function(){return Mc},Mc.mostPrecise=function(e,t){return e.compareTo(t)>=0?e:t},Ec.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Ec.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Mc,Ec);var Ic=function e(t){this._name=t||null,e.nameToTypeMap.put(t,this)},Tc={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Ic.prototype.readResolve=function(){return Ic.nameToTypeMap.get(this._name)},Ic.prototype.toString=function(){return this._name},Ic.prototype.interfaces_=function(){return[wl]},Ic.prototype.getClass=function(){return Ic},Tc.serialVersionUID.get=function(){return-552860263173159e4},Tc.nameToTypeMap.get=function(){return new kc},Object.defineProperties(Ic,Tc),Mc.Type=Ic,Mc.FIXED=new Ic("FIXED"),Mc.FLOATING=new Ic("FLOATING"),Mc.FLOATING_SINGLE=new Ic("FLOATING SINGLE");var Lc=function e(){this._precisionModel=new Mc,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Pl(arguments[0],Il)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Mc&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Pc={serialVersionUID:{configurable:!0}};Lc.prototype.toGeometry=function(e){return e.isNull()?this.createPoint(null):e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new kl(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new kl(e.getMinX(),e.getMinY()),new kl(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new kl(e.getMinX(),e.getMinY()),new kl(e.getMinX(),e.getMaxY()),new kl(e.getMaxX(),e.getMaxY()),new kl(e.getMaxX(),e.getMinY()),new kl(e.getMinX(),e.getMinY())]),null)},Lc.prototype.createLineString=function(e){return e?e instanceof Array?new sc(this.getCoordinateSequenceFactory().create(e),this):Pl(e,jl)?new sc(e,this):void 0:new sc(this.getCoordinateSequenceFactory().create([]),this)},Lc.prototype.createMultiLineString=function(){if(0===arguments.length)return new ec(null,this);if(1===arguments.length){var e=arguments[0];return new ec(e,this)}},Lc.prototype.buildGeometry=function(e){for(var t=null,r=!1,n=!1,i=e.iterator();i.hasNext();){var o=i.next(),a=o.getClass();null===t&&(t=a),a!==t&&(r=!0),o.isGeometryCollectionOrDerived()&&(n=!0)}if(null===t)return this.createGeometryCollection();if(r||n)return this.createGeometryCollection(Lc.toGeometryArray(e));var s=e.iterator().next();if(e.size()>1){if(s instanceof fc)return this.createMultiPolygon(Lc.toPolygonArray(e));if(s instanceof sc)return this.createMultiLineString(Lc.toLineStringArray(e));if(s instanceof uc)return this.createMultiPoint(Lc.toPointArray(e));tu.shouldNeverReachHere("Unhandled class: "+s.getClass().getName())}return s},Lc.prototype.createMultiPointFromCoords=function(e){return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)},Lc.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof kl){var e=arguments[0];return this.createPoint(null!==e?this.getCoordinateSequenceFactory().create([e]):null)}if(Pl(arguments[0],jl)){var t=arguments[0];return new uc(t,this)}}},Lc.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Lc.prototype.createPolygon=function(){if(0===arguments.length)return new fc(null,null,this);if(1===arguments.length){if(Pl(arguments[0],jl)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Array){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof dc){var r=arguments[0];return this.createPolygon(r,null)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return new fc(n,i,this)}},Lc.prototype.getSRID=function(){return this._SRID},Lc.prototype.createGeometryCollection=function(){if(0===arguments.length)return new $u(null,this);if(1===arguments.length){var e=arguments[0];return new $u(e,this)}},Lc.prototype.createGeometry=function(e){return new yc(this).edit(e,{edit:function(){if(2===arguments.length){var e=arguments[0];return this._coordinateSequenceFactory.create(e)}}})},Lc.prototype.getPrecisionModel=function(){return this._precisionModel},Lc.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(Pl(arguments[0],jl)){var t=arguments[0];return new dc(t,this)}}},Lc.prototype.createMultiPolygon=function(){if(0===arguments.length)return new pc(null,this);if(1===arguments.length){var e=arguments[0];return new pc(e,this)}},Lc.prototype.createMultiPoint=function(){if(0===arguments.length)return new hc(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return new hc(e,this)}if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(Pl(arguments[0],jl)){var r=arguments[0];if(null===r)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(r.size()).fill(null),i=0;i<r.size();i++){var o=this.getCoordinateSequenceFactory().create(1,r.getDimension());ac.copy(r,i,o,0,1),n[i]=this.createPoint(o)}return this.createMultiPoint(n)}}},Lc.prototype.interfaces_=function(){return[wl]},Lc.prototype.getClass=function(){return Lc},Lc.toMultiPolygonArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)},Lc.toGeometryArray=function(e){if(null===e)return null;var t=new Array(e.size()).fill(null);return e.toArray(t)},Lc.getDefaultCoordinateSequenceFactory=function(){return bc.instance()},Lc.toMultiLineStringArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)},Lc.toLineStringArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)},Lc.toMultiPointArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)},Lc.toLinearRingArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)},Lc.toPointArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)},Lc.toPolygonArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)},Lc.createPointFromInternalCoord=function(e,t){return t.getPrecisionModel().makePrecise(e),t.getFactory().createPoint(e)},Pc.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(Lc,Pc);var Cc=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Nc=function(e){this.geometryFactory=e||new Lc};Nc.prototype.read=function(e){var t,r=(t="string"==typeof e?JSON.parse(e):e).type;if(!Oc[r])throw new Error("Unknown GeoJSON type: "+t.type);return-1!==Cc.indexOf(r)?Oc[r].apply(this,[t.coordinates]):"GeometryCollection"===r?Oc[r].apply(this,[t.geometries]):Oc[r].apply(this,[t])},Nc.prototype.write=function(e){var t=e.getGeometryType();if(!Rc[t])throw new Error("Geometry is not supported");return Rc[t].apply(this,[e])};var Oc={Feature:function(e){var t={};for(var r in e)t[r]=e[r];if(e.geometry){var n=e.geometry.type;if(!Oc[n])throw new Error("Unknown GeoJSON type: "+e.type);t.geometry=this.read(e.geometry)}return e.bbox&&(t.bbox=Oc.bbox.apply(this,[e.bbox])),t},FeatureCollection:function(e){var t={};if(e.features){t.features=[];for(var r=0;r<e.features.length;++r)t.features.push(this.read(e.features[r]))}return e.bbox&&(t.bbox=this.parse.bbox.apply(this,[e.bbox])),t},coordinates:function(e){for(var t=[],r=0;r<e.length;++r){var n=e[r];t.push(new kl(n[0],n[1]))}return t},bbox:function(e){return this.geometryFactory.createLinearRing([new kl(e[0],e[1]),new kl(e[2],e[1]),new kl(e[2],e[3]),new kl(e[0],e[3]),new kl(e[0],e[1])])},Point:function(e){var t=new kl(e[0],e[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(e){for(var t=[],r=0;r<e.length;++r)t.push(Oc.Point.apply(this,[e[r]]));return this.geometryFactory.createMultiPoint(t)},LineString:function(e){var t=Oc.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(t)},MultiLineString:function(e){for(var t=[],r=0;r<e.length;++r)t.push(Oc.LineString.apply(this,[e[r]]));return this.geometryFactory.createMultiLineString(t)},Polygon:function(e){for(var t=Oc.coordinates.apply(this,[e[0]]),r=this.geometryFactory.createLinearRing(t),n=[],i=1;i<e.length;++i){var o=e[i],a=Oc.coordinates.apply(this,[o]),s=this.geometryFactory.createLinearRing(a);n.push(s)}return this.geometryFactory.createPolygon(r,n)},MultiPolygon:function(e){for(var t=[],r=0;r<e.length;++r){var n=e[r];t.push(Oc.Polygon.apply(this,[n]))}return this.geometryFactory.createMultiPolygon(t)},GeometryCollection:function(e){for(var t=[],r=0;r<e.length;++r){var n=e[r];t.push(this.read(n))}return this.geometryFactory.createGeometryCollection(t)}},Rc={coordinate:function(e){return[e.x,e.y]},Point:function(e){return{type:"Point",coordinates:Rc.coordinate.apply(this,[e.getCoordinate()])}},MultiPoint:function(e){for(var t=[],r=0;r<e._geometries.length;++r){var n=e._geometries[r],i=Rc.Point.apply(this,[n]);t.push(i.coordinates)}return{type:"MultiPoint",coordinates:t}},LineString:function(e){for(var t=[],r=e.getCoordinates(),n=0;n<r.length;++n){var i=r[n];t.push(Rc.coordinate.apply(this,[i]))}return{type:"LineString",coordinates:t}},MultiLineString:function(e){for(var t=[],r=0;r<e._geometries.length;++r){var n=e._geometries[r],i=Rc.LineString.apply(this,[n]);t.push(i.coordinates)}return{type:"MultiLineString",coordinates:t}},Polygon:function(e){var t=[],r=Rc.LineString.apply(this,[e._shell]);t.push(r.coordinates);for(var n=0;n<e._holes.length;++n){var i=e._holes[n],o=Rc.LineString.apply(this,[i]);t.push(o.coordinates)}return{type:"Polygon",coordinates:t}},MultiPolygon:function(e){for(var t=[],r=0;r<e._geometries.length;++r){var n=e._geometries[r],i=Rc.Polygon.apply(this,[n]);t.push(i.coordinates)}return{type:"MultiPolygon",coordinates:t}},GeometryCollection:function(e){for(var t=[],r=0;r<e._geometries.length;++r){var n=e._geometries[r],i=n.getGeometryType();t.push(Rc[i].apply(this,[n]))}return{type:"GeometryCollection",geometries:t}}},Vc=function(e){this.geometryFactory=e||new Lc,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Nc(this.geometryFactory)};Vc.prototype.read=function(e){var t=this.parser.read(e);return this.precisionModel.getType()===Mc.FIXED&&this.reducePrecision(t),t},Vc.prototype.reducePrecision=function(e){var t,r;if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e.points)for(t=0,r=e.points.length;t<r;t++)this.precisionModel.makePrecise(e.points[t]);else if(e.geometries)for(t=0,r=e.geometries.length;t<r;t++)this.reducePrecision(e.geometries[t])};var Gc=function(){this.parser=new Nc(this.geometryFactory)};Gc.prototype.write=function(e){return this.parser.write(e)};var Ac=function(){},Fc={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};function Dc(e){this.message=e||""}function jc(){this.array_=[]}Ac.prototype.interfaces_=function(){return[]},Ac.prototype.getClass=function(){return Ac},Ac.opposite=function(e){return e===Ac.LEFT?Ac.RIGHT:e===Ac.RIGHT?Ac.LEFT:e},Fc.ON.get=function(){return 0},Fc.LEFT.get=function(){return 1},Fc.RIGHT.get=function(){return 2},Object.defineProperties(Ac,Fc),Dc.prototype=new Error,Dc.prototype.name="EmptyStackException",jc.prototype=new wu,jc.prototype.add=function(e){return this.array_.push(e),!0},jc.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]},jc.prototype.push=function(e){return this.array_.push(e),e},jc.prototype.pop=function(e){if(0===this.array_.length)throw new Dc;return this.array_.pop()},jc.prototype.peek=function(){if(0===this.array_.length)throw new Dc;return this.array_[this.array_.length-1]},jc.prototype.empty=function(){return 0===this.array_.length},jc.prototype.isEmpty=function(){return this.empty()},jc.prototype.search=function(e){return this.array_.indexOf(e)},jc.prototype.size=function(){return this.array_.length},jc.prototype.toArray=function(){for(var e=[],t=0,r=this.array_.length;t<r;t++)e.push(this.array_[t]);return e};var Bc=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Bc.prototype.getCoordinate=function(){return this._minCoord},Bc.prototype.getRightmostSide=function(e,t){var r=this.getRightmostSideOfSegment(e,t);return r<0&&(r=this.getRightmostSideOfSegment(e,t-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),r},Bc.prototype.findRightmostEdgeAtVertex=function(){var e=this._minDe.getEdge().getCoordinates();tu.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var t=e[this._minIndex-1],r=e[this._minIndex+1],n=su.computeOrientation(this._minCoord,r,t),i=!1;(t.y<this._minCoord.y&&r.y<this._minCoord.y&&n===su.COUNTERCLOCKWISE||t.y>this._minCoord.y&&r.y>this._minCoord.y&&n===su.CLOCKWISE)&&(i=!0),i&&(this._minIndex=this._minIndex-1)},Bc.prototype.getRightmostSideOfSegment=function(e,t){var r=e.getEdge().getCoordinates();if(t<0||t+1>=r.length)return-1;if(r[t].y===r[t+1].y)return-1;var n=Ac.LEFT;return r[t].y<r[t+1].y&&(n=Ac.RIGHT),n},Bc.prototype.getEdge=function(){return this._orientedDe},Bc.prototype.checkForRightmostCoordinate=function(e){for(var t=this,r=e.getEdge().getCoordinates(),n=0;n<r.length-1;n++)(null===t._minCoord||r[n].x>t._minCoord.x)&&(t._minDe=e,t._minIndex=n,t._minCoord=r[n])},Bc.prototype.findRightmostEdgeAtNode=function(){var e=this._minDe.getNode().getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Bc.prototype.findEdge=function(e){for(var t=e.iterator();t.hasNext();){var r=t.next();r.isForward()&&this.checkForRightmostCoordinate(r)}tu.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Ac.LEFT&&(this._orientedDe=this._minDe.getSym())},Bc.prototype.interfaces_=function(){return[]},Bc.prototype.getClass=function(){return Bc};var qc=function(e){function t(r,n){e.call(this,t.msgWithCoord(r,n)),this.pt=n?new kl(n):null,this.name="TopologyException"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getCoordinate=function(){return this.pt},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.msgWithCoord=function(e,t){return t?e:e+" [ "+t+" ]"},t}($l),Uc=function(){this.array_=[]};Uc.prototype.addLast=function(e){this.array_.push(e)},Uc.prototype.removeFirst=function(){return this.array_.shift()},Uc.prototype.isEmpty=function(){return 0===this.array_.length};var Jc=function(){this._finder=null,this._dirEdgeList=new Mu,this._nodes=new Mu,this._rightMostCoord=null,this._env=null,this._finder=new Bc};Jc.prototype.clearVisitedEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();)e.next().setVisited(!1)},Jc.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Jc.prototype.computeNodeDepth=function(e){for(var t=null,r=e.getEdges().iterator();r.hasNext();){var n=r.next();if(n.isVisited()||n.getSym().isVisited()){t=n;break}}if(null===t)throw new qc("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(t);for(var i=e.getEdges().iterator();i.hasNext();){var o=i.next();o.setVisited(!0),this.copySymDepths(o)}},Jc.prototype.computeDepth=function(e){this.clearVisitedEdges();var t=this._finder.getEdge();t.setEdgeDepths(Ac.RIGHT,e),this.copySymDepths(t),this.computeDepths(t)},Jc.prototype.create=function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Jc.prototype.findResultEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var t=e.next();t.getDepth(Ac.RIGHT)>=1&&t.getDepth(Ac.LEFT)<=0&&!t.isInteriorAreaEdge()&&t.setInResult(!0)}},Jc.prototype.computeDepths=function(e){var t=new Gu,r=new Uc,n=e.getNode();for(r.addLast(n),t.add(n),e.setVisited(!0);!r.isEmpty();){var i=r.removeFirst();t.add(i),this.computeNodeDepth(i);for(var o=i.getEdges().iterator();o.hasNext();){var a=o.next().getSym();if(!a.isVisited()){var s=a.getNode();t.contains(s)||(r.addLast(s),t.add(s))}}}},Jc.prototype.compareTo=function(e){var t=e;return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0},Jc.prototype.getEnvelope=function(){if(null===this._env){for(var e=new Wl,t=this._dirEdgeList.iterator();t.hasNext();)for(var r=t.next().getEdge().getCoordinates(),n=0;n<r.length-1;n++)e.expandToInclude(r[n]);this._env=e}return this._env},Jc.prototype.addReachable=function(e){var t=new jc;for(t.add(e);!t.empty();){var r=t.pop();this.add(r,t)}},Jc.prototype.copySymDepths=function(e){var t=e.getSym();t.setDepth(Ac.LEFT,e.getDepth(Ac.RIGHT)),t.setDepth(Ac.RIGHT,e.getDepth(Ac.LEFT))},Jc.prototype.add=function(e,t){e.setVisited(!0),this._nodes.add(e);for(var r=e.getEdges().iterator();r.hasNext();){var n=r.next();this._dirEdgeList.add(n);var i=n.getSym().getNode();i.isVisited()||t.push(i)}},Jc.prototype.getNodes=function(){return this._nodes},Jc.prototype.getDirectedEdges=function(){return this._dirEdgeList},Jc.prototype.interfaces_=function(){return[Sl]},Jc.prototype.getClass=function(){return Jc};var zc=function e(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[Ac.ON]=r}else if(arguments[0]instanceof e){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}}else if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];this.init(3),this.location[Ac.ON]=o,this.location[Ac.LEFT]=a,this.location[Ac.RIGHT]=s}};zc.prototype.setAllLocations=function(e){for(var t=0;t<this.location.length;t++)this.location[t]=e},zc.prototype.isNull=function(){for(var e=0;e<this.location.length;e++)if(this.location[e]!==Tl.NONE)return!1;return!0},zc.prototype.setAllLocationsIfNull=function(e){for(var t=0;t<this.location.length;t++)this.location[t]===Tl.NONE&&(this.location[t]=e)},zc.prototype.isLine=function(){return 1===this.location.length},zc.prototype.merge=function(e){if(e.location.length>this.location.length){var t=new Array(3).fill(null);t[Ac.ON]=this.location[Ac.ON],t[Ac.LEFT]=Tl.NONE,t[Ac.RIGHT]=Tl.NONE,this.location=t}for(var r=0;r<this.location.length;r++)this.location[r]===Tl.NONE&&r<e.location.length&&(this.location[r]=e.location[r])},zc.prototype.getLocations=function(){return this.location},zc.prototype.flip=function(){if(this.location.length<=1)return null;var e=this.location[Ac.LEFT];this.location[Ac.LEFT]=this.location[Ac.RIGHT],this.location[Ac.RIGHT]=e},zc.prototype.toString=function(){var e=new Ol;return this.location.length>1&&e.append(Tl.toLocationSymbol(this.location[Ac.LEFT])),e.append(Tl.toLocationSymbol(this.location[Ac.ON])),this.location.length>1&&e.append(Tl.toLocationSymbol(this.location[Ac.RIGHT])),e.toString()},zc.prototype.setLocations=function(e,t,r){this.location[Ac.ON]=e,this.location[Ac.LEFT]=t,this.location[Ac.RIGHT]=r},zc.prototype.get=function(e){return e<this.location.length?this.location[e]:Tl.NONE},zc.prototype.isArea=function(){return this.location.length>1},zc.prototype.isAnyNull=function(){for(var e=0;e<this.location.length;e++)if(this.location[e]===Tl.NONE)return!0;return!1},zc.prototype.setLocation=function(){if(1===arguments.length){var e=arguments[0];this.setLocation(Ac.ON,e)}else if(2===arguments.length){var t=arguments[0],r=arguments[1];this.location[t]=r}},zc.prototype.init=function(e){this.location=new Array(e).fill(null),this.setAllLocations(Tl.NONE)},zc.prototype.isEqualOnSide=function(e,t){return this.location[t]===e.location[t]},zc.prototype.allPositionsEqual=function(e){for(var t=0;t<this.location.length;t++)if(this.location[t]!==e)return!1;return!0},zc.prototype.interfaces_=function(){return[]},zc.prototype.getClass=function(){return zc};var Wc=function e(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new zc(t),this.elt[1]=new zc(t)}else if(arguments[0]instanceof e){var r=arguments[0];this.elt[0]=new zc(r.elt[0]),this.elt[1]=new zc(r.elt[1])}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.elt[0]=new zc(Tl.NONE),this.elt[1]=new zc(Tl.NONE),this.elt[n].setLocation(i)}else if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];this.elt[0]=new zc(o,a,s),this.elt[1]=new zc(o,a,s)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],f=arguments[3];this.elt[0]=new zc(Tl.NONE,Tl.NONE,Tl.NONE),this.elt[1]=new zc(Tl.NONE,Tl.NONE,Tl.NONE),this.elt[l].setLocations(u,c,f)}};Wc.prototype.getGeometryCount=function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e},Wc.prototype.setAllLocations=function(e,t){this.elt[e].setAllLocations(t)},Wc.prototype.isNull=function(e){return this.elt[e].isNull()},Wc.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(2===arguments.length){var t=arguments[0],r=arguments[1];this.elt[t].setAllLocationsIfNull(r)}},Wc.prototype.isLine=function(e){return this.elt[e].isLine()},Wc.prototype.merge=function(e){for(var t=this,r=0;r<2;r++)null===t.elt[r]&&null!==e.elt[r]?t.elt[r]=new zc(e.elt[r]):t.elt[r].merge(e.elt[r])},Wc.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Wc.prototype.getLocation=function(){if(1===arguments.length){var e=arguments[0];return this.elt[e].get(Ac.ON)}if(2===arguments.length){var t=arguments[0],r=arguments[1];return this.elt[t].get(r)}},Wc.prototype.toString=function(){var e=new Ol;return null!==this.elt[0]&&(e.append("A:"),e.append(this.elt[0].toString())),null!==this.elt[1]&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()},Wc.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var e=arguments[0];return this.elt[e].isArea()}},Wc.prototype.isAnyNull=function(e){return this.elt[e].isAnyNull()},Wc.prototype.setLocation=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];this.elt[e].setLocation(Ac.ON,t)}else if(3===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[2];this.elt[r].setLocation(n,i)}},Wc.prototype.isEqualOnSide=function(e,t){return this.elt[0].isEqualOnSide(e.elt[0],t)&&this.elt[1].isEqualOnSide(e.elt[1],t)},Wc.prototype.allPositionsEqual=function(e,t){return this.elt[e].allPositionsEqual(t)},Wc.prototype.toLine=function(e){this.elt[e].isArea()&&(this.elt[e]=new zc(this.elt[e].location[0]))},Wc.prototype.interfaces_=function(){return[]},Wc.prototype.getClass=function(){return Wc},Wc.toLineLabel=function(e){for(var t=new Wc(Tl.NONE),r=0;r<2;r++)t.setLocation(r,e.getLocation(r));return t};var Hc=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Mu,this._pts=new Mu,this._label=new Wc(Tl.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Mu,this._geometryFactory=null;var e=arguments[0],t=arguments[1];this._geometryFactory=t,this.computePoints(e),this.computeRing()};Hc.prototype.computeRing=function(){if(null!==this._ring)return null;for(var e=new Array(this._pts.size()).fill(null),t=0;t<this._pts.size();t++)e[t]=this._pts.get(t);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=su.isCCW(this._ring.getCoordinates())},Hc.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Hc.prototype.computePoints=function(e){var t=this;this._startDe=e;var r=e,n=!0;do{if(null===r)throw new qc("Found null DirectedEdge");if(r.getEdgeRing()===t)throw new qc("Directed Edge visited twice during ring-building at "+r.getCoordinate());t._edges.add(r);var i=r.getLabel();tu.isTrue(i.isArea()),t.mergeLabel(i),t.addPoints(r.getEdge(),r.isForward(),n),n=!1,t.setEdgeRing(r,t),r=t.getNext(r)}while(r!==this._startDe)},Hc.prototype.getLinearRing=function(){return this._ring},Hc.prototype.getCoordinate=function(e){return this._pts.get(e)},Hc.prototype.computeMaxNodeDegree=function(){var e=this;this._maxNodeDegree=0;var t=this._startDe;do{var r=t.getNode().getEdges().getOutgoingDegree(e);r>e._maxNodeDegree&&(e._maxNodeDegree=r),t=e.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Hc.prototype.addPoints=function(e,t,r){var n=e.getCoordinates();if(t){var i=1;r&&(i=0);for(var o=i;o<n.length;o++)this._pts.add(n[o])}else{var a=n.length-2;r&&(a=n.length-1);for(var s=a;s>=0;s--)this._pts.add(n[s])}},Hc.prototype.isHole=function(){return this._isHole},Hc.prototype.setInResult=function(){var e=this._startDe;do{e.getEdge().setInResult(!0),e=e.getNext()}while(e!==this._startDe)},Hc.prototype.containsPoint=function(e){var t=this.getLinearRing();if(!t.getEnvelopeInternal().contains(e))return!1;if(!su.isPointInRing(e,t.getCoordinates()))return!1;for(var r=this._holes.iterator();r.hasNext();)if(r.next().containsPoint(e))return!1;return!0},Hc.prototype.addHole=function(e){this._holes.add(e)},Hc.prototype.isShell=function(){return null===this._shell},Hc.prototype.getLabel=function(){return this._label},Hc.prototype.getEdges=function(){return this._edges},Hc.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Hc.prototype.getShell=function(){return this._shell},Hc.prototype.mergeLabel=function(){if(1===arguments.length){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(2===arguments.length){var t=arguments[0],r=arguments[1],n=t.getLocation(r,Ac.RIGHT);if(n===Tl.NONE)return null;if(this._label.getLocation(r)===Tl.NONE)return this._label.setLocation(r,n),null}},Hc.prototype.setShell=function(e){this._shell=e,null!==e&&e.addHole(this)},Hc.prototype.toPolygon=function(e){for(var t=new Array(this._holes.size()).fill(null),r=0;r<this._holes.size();r++)t[r]=this._holes.get(r).getLinearRing();return e.createPolygon(this.getLinearRing(),t)},Hc.prototype.interfaces_=function(){return[]},Hc.prototype.getClass=function(){return Hc};var Xc=function(e){function t(){var t=arguments[0],r=arguments[1];e.call(this,t,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setEdgeRing=function(e,t){e.setMinEdgeRing(t)},t.prototype.getNext=function(e){return e.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Hc),Yc=function(e){function t(){var t=arguments[0],r=arguments[1];e.call(this,t,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildMinimalRings=function(){var e=new Mu,t=this._startDe;do{if(null===t.getMinEdgeRing()){var r=new Xc(t,this._geometryFactory);e.add(r)}t=t.getNext()}while(t!==this._startDe);return e},t.prototype.setEdgeRing=function(e,t){e.setEdgeRing(t)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var e=this._startDe;do{e.getNode().getEdges().linkMinimalDirectedEdges(this),e=e.getNext()}while(e!==this._startDe)},t.prototype.getNext=function(e){return e.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Hc),Zc=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this._label=e}};Zc.prototype.setVisited=function(e){this._isVisited=e},Zc.prototype.setInResult=function(e){this._isInResult=e},Zc.prototype.isCovered=function(){return this._isCovered},Zc.prototype.isCoveredSet=function(){return this._isCoveredSet},Zc.prototype.setLabel=function(e){this._label=e},Zc.prototype.getLabel=function(){return this._label},Zc.prototype.setCovered=function(e){this._isCovered=e,this._isCoveredSet=!0},Zc.prototype.updateIM=function(e){tu.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)},Zc.prototype.isInResult=function(){return this._isInResult},Zc.prototype.isVisited=function(){return this._isVisited},Zc.prototype.interfaces_=function(){return[]},Zc.prototype.getClass=function(){return Zc};var Kc=function(e){function t(){e.call(this),this._coord=null,this._edges=null;var t=arguments[0],r=arguments[1];this._coord=t,this._edges=r,this._label=new Wc(0,Tl.NONE)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isIncidentEdgeInResult=function(){for(var e=this.getEdges().getEdges().iterator();e.hasNext();)if(e.next().getEdge().isInResult())return!0;return!1},t.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},t.prototype.getCoordinate=function(){return this._coord},t.prototype.print=function(e){e.println("node "+this._coord+" lbl: "+this._label)},t.prototype.computeIM=function(e){},t.prototype.computeMergedLocation=function(e,t){var r=Tl.NONE;if(r=this._label.getLocation(t),!e.isNull(t)){var n=e.getLocation(t);r!==Tl.BOUNDARY&&(r=n)}return r},t.prototype.setLabel=function(){if(2!==arguments.length)return e.prototype.setLabel.apply(this,arguments);var t=arguments[0],r=arguments[1];null===this._label?this._label=new Wc(t,r):this._label.setLocation(t,r)},t.prototype.getEdges=function(){return this._edges},t.prototype.mergeLabel=function(){var e=this;if(arguments[0]instanceof t){var r=arguments[0];this.mergeLabel(r._label)}else if(arguments[0]instanceof Wc)for(var n=arguments[0],i=0;i<2;i++){var o=e.computeMergedLocation(n,i);e._label.getLocation(i)===Tl.NONE&&e._label.setLocation(i,o)}},t.prototype.add=function(e){this._edges.insert(e),e.setNode(this)},t.prototype.setLabelBoundary=function(e){if(null===this._label)return null;var t=Tl.NONE;null!==this._label&&(t=this._label.getLocation(e));var r=null;switch(t){case Tl.BOUNDARY:r=Tl.INTERIOR;break;case Tl.INTERIOR:default:r=Tl.BOUNDARY}this._label.setLocation(e,r)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Zc),Qc=function(){this.nodeMap=new Uu,this.nodeFact=null;var e=arguments[0];this.nodeFact=e};Qc.prototype.find=function(e){return this.nodeMap.get(e)},Qc.prototype.addNode=function(){if(arguments[0]instanceof kl){var e=arguments[0],t=this.nodeMap.get(e);return null===t&&(t=this.nodeFact.createNode(e),this.nodeMap.put(e,t)),t}if(arguments[0]instanceof Kc){var r=arguments[0],n=this.nodeMap.get(r.getCoordinate());return null===n?(this.nodeMap.put(r.getCoordinate(),r),r):(n.mergeLabel(r),n)}},Qc.prototype.print=function(e){for(var t=this.iterator();t.hasNext();)t.next().print(e)},Qc.prototype.iterator=function(){return this.nodeMap.values().iterator()},Qc.prototype.values=function(){return this.nodeMap.values()},Qc.prototype.getBoundaryNodes=function(e){for(var t=new Mu,r=this.iterator();r.hasNext();){var n=r.next();n.getLabel().getLocation(e)===Tl.BOUNDARY&&t.add(n)}return t},Qc.prototype.add=function(e){var t=e.getCoordinate();this.addNode(t).add(e)},Qc.prototype.interfaces_=function(){return[]},Qc.prototype.getClass=function(){return Qc};var $c=function(){},ef={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};$c.prototype.interfaces_=function(){return[]},$c.prototype.getClass=function(){return $c},$c.isNorthern=function(e){return e===$c.NE||e===$c.NW},$c.isOpposite=function(e,t){return e!==t&&2==(e-t+4)%4},$c.commonHalfPlane=function(e,t){if(e===t)return e;if(2==(e-t+4)%4)return-1;var r=e<t?e:t;return 0===r&&3===(e>t?e:t)?3:r},$c.isInHalfPlane=function(e,t){return t===$c.SE?e===$c.SE||e===$c.SW:e===t||e===t+1},$c.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],t=arguments[1];if(0===e&&0===t)throw new vl("Cannot compute the quadrant for point ( "+e+", "+t+" )");return e>=0?t>=0?$c.NE:$c.SE:t>=0?$c.NW:$c.SW}if(arguments[0]instanceof kl&&arguments[1]instanceof kl){var r=arguments[0],n=arguments[1];if(n.x===r.x&&n.y===r.y)throw new vl("Cannot compute the quadrant for two identical points "+r);return n.x>=r.x?n.y>=r.y?$c.NE:$c.SE:n.y>=r.y?$c.NW:$c.SW}},ef.NE.get=function(){return 0},ef.NW.get=function(){return 1},ef.SW.get=function(){return 2},ef.SE.get=function(){return 3},Object.defineProperties($c,ef);var tf=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var e=arguments[0];this._edge=e}else if(3===arguments.length){var t=arguments[0],r=arguments[1],n=arguments[2];this._edge=t,this.init(r,n),this._label=null}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this._edge=i,this.init(o,a),this._label=s}};tf.prototype.compareDirection=function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:su.computeOrientation(e._p0,e._p1,this._p1)},tf.prototype.getDy=function(){return this._dy},tf.prototype.getCoordinate=function(){return this._p0},tf.prototype.setNode=function(e){this._node=e},tf.prototype.print=function(e){var t=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),n=r.lastIndexOf("."),i=r.substring(n+1);e.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label)},tf.prototype.compareTo=function(e){var t=e;return this.compareDirection(t)},tf.prototype.getDirectedCoordinate=function(){return this._p1},tf.prototype.getDx=function(){return this._dx},tf.prototype.getLabel=function(){return this._label},tf.prototype.getEdge=function(){return this._edge},tf.prototype.getQuadrant=function(){return this._quadrant},tf.prototype.getNode=function(){return this._node},tf.prototype.toString=function(){var e=Math.atan2(this._dy,this._dx),t=this.getClass().getName(),r=t.lastIndexOf(".");return"  "+t.substring(r+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label},tf.prototype.computeLabel=function(e){},tf.prototype.init=function(e,t){this._p0=e,this._p1=t,this._dx=t.x-e.x,this._dy=t.y-e.y,this._quadrant=$c.quadrant(this._dx,this._dy),tu.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},tf.prototype.interfaces_=function(){return[Sl]},tf.prototype.getClass=function(){return tf};var rf=function(e){function t(){var t=arguments[0],r=arguments[1];if(e.call(this,t),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(e){return this._depth[e]},t.prototype.setVisited=function(e){this._isVisited=e},t.prototype.computeDirectedLabel=function(){this._label=new Wc(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(e,t){if(-999!==this._depth[e]&&this._depth[e]!==t)throw new qc("assigned depths do not match",this.getCoordinate());this._depth[e]=t},t.prototype.isInteriorAreaEdge=function(){for(var e=this,t=!0,r=0;r<2;r++)e._label.isArea(r)&&e._label.getLocation(r,Ac.LEFT)===Tl.INTERIOR&&e._label.getLocation(r,Ac.RIGHT)===Tl.INTERIOR||(t=!1);return t},t.prototype.setNextMin=function(e){this._nextMin=e},t.prototype.print=function(t){e.prototype.print.call(this,t),t.print(" "+this._depth[Ac.LEFT]+"/"+this._depth[Ac.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},t.prototype.setMinEdgeRing=function(e){this._minEdgeRing=e},t.prototype.isLineEdge=function(){var e=this._label.isLine(0)||this._label.isLine(1),t=!this._label.isArea(0)||this._label.allPositionsEqual(0,Tl.EXTERIOR),r=!this._label.isArea(1)||this._label.allPositionsEqual(1,Tl.EXTERIOR);return e&&t&&r},t.prototype.setEdgeRing=function(e){this._edgeRing=e},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var e=this._edge.getDepthDelta();return this._isForward||(e=-e),e},t.prototype.setInResult=function(e){this._isInResult=e},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(e){this.print(e),e.print(" "),this._isForward?this._edge.print(e):this._edge.printReverse(e)},t.prototype.setSym=function(e){this._sym=e},t.prototype.setVisitedEdge=function(e){this.setVisited(e),this._sym.setVisited(e)},t.prototype.setEdgeDepths=function(e,t){var r=this.getEdge().getDepthDelta();this._isForward||(r=-r);var n=1;e===Ac.LEFT&&(n=-1);var i=Ac.opposite(e),o=t+r*n;this.setDepth(e,t),this.setDepth(i,o)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(e){this._next=e},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(e,t){return e===Tl.EXTERIOR&&t===Tl.INTERIOR?1:e===Tl.INTERIOR&&t===Tl.EXTERIOR?-1:0},t}(tf),nf=function(){};nf.prototype.createNode=function(e){return new Kc(e,null)},nf.prototype.interfaces_=function(){return[]},nf.prototype.getClass=function(){return nf};var of=function(){if(this._edges=new Mu,this._nodes=null,this._edgeEndList=new Mu,0===arguments.length)this._nodes=new Qc(new nf);else if(1===arguments.length){var e=arguments[0];this._nodes=new Qc(e)}};of.prototype.printEdges=function(e){e.println("Edges:");for(var t=0;t<this._edges.size();t++){e.println("edge "+t+":");var r=this._edges.get(t);r.print(e),r.eiList.print(e)}},of.prototype.find=function(e){return this._nodes.find(e)},of.prototype.addNode=function(){if(arguments[0]instanceof Kc){var e=arguments[0];return this._nodes.addNode(e)}if(arguments[0]instanceof kl){var t=arguments[0];return this._nodes.addNode(t)}},of.prototype.getNodeIterator=function(){return this._nodes.iterator()},of.prototype.linkResultDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()},of.prototype.debugPrintln=function(e){Jl.out.println(e)},of.prototype.isBoundaryNode=function(e,t){var r=this._nodes.find(t);if(null===r)return!1;var n=r.getLabel();return null!==n&&n.getLocation(e)===Tl.BOUNDARY},of.prototype.linkAllDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkAllDirectedEdges()},of.prototype.matchInSameDirection=function(e,t,r,n){return!!e.equals(r)&&su.computeOrientation(e,t,n)===su.COLLINEAR&&$c.quadrant(e,t)===$c.quadrant(r,n)},of.prototype.getEdgeEnds=function(){return this._edgeEndList},of.prototype.debugPrint=function(e){Jl.out.print(e)},of.prototype.getEdgeIterator=function(){return this._edges.iterator()},of.prototype.findEdgeInSameDirection=function(e,t){for(var r=this,n=0;n<this._edges.size();n++){var i=r._edges.get(n),o=i.getCoordinates();if(r.matchInSameDirection(e,t,o[0],o[1]))return i;if(r.matchInSameDirection(e,t,o[o.length-1],o[o.length-2]))return i}return null},of.prototype.insertEdge=function(e){this._edges.add(e)},of.prototype.findEdgeEnd=function(e){for(var t=this.getEdgeEnds().iterator();t.hasNext();){var r=t.next();if(r.getEdge()===e)return r}return null},of.prototype.addEdges=function(e){for(var t=this,r=e.iterator();r.hasNext();){var n=r.next();t._edges.add(n);var i=new rf(n,!0),o=new rf(n,!1);i.setSym(o),o.setSym(i),t.add(i),t.add(o)}},of.prototype.add=function(e){this._nodes.add(e),this._edgeEndList.add(e)},of.prototype.getNodes=function(){return this._nodes.values()},of.prototype.findEdge=function(e,t){for(var r=0;r<this._edges.size();r++){var n=this._edges.get(r),i=n.getCoordinates();if(e.equals(i[0])&&t.equals(i[1]))return n}return null},of.prototype.interfaces_=function(){return[]},of.prototype.getClass=function(){return of},of.linkResultDirectedEdges=function(e){for(var t=e.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()};var af=function(){this._geometryFactory=null,this._shellList=new Mu;var e=arguments[0];this._geometryFactory=e};af.prototype.sortShellsAndHoles=function(e,t,r){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()?r.add(i):t.add(i)}},af.prototype.computePolygons=function(e){for(var t=new Mu,r=e.iterator();r.hasNext();){var n=r.next().toPolygon(this._geometryFactory);t.add(n)}return t},af.prototype.placeFreeHoles=function(e,t){for(var r=t.iterator();r.hasNext();){var n=r.next();if(null===n.getShell()){var i=this.findEdgeRingContaining(n,e);if(null===i)throw new qc("unable to assign hole to a shell",n.getCoordinate(0));n.setShell(i)}}},af.prototype.buildMinimalEdgeRings=function(e,t,r){for(var n=new Mu,i=e.iterator();i.hasNext();){var o=i.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var a=o.buildMinimalRings(),s=this.findShell(a);null!==s?(this.placePolygonHoles(s,a),t.add(s)):r.addAll(a)}else n.add(o)}return n},af.prototype.containsPoint=function(e){for(var t=this._shellList.iterator();t.hasNext();)if(t.next().containsPoint(e))return!0;return!1},af.prototype.buildMaximalEdgeRings=function(e){for(var t=new Mu,r=e.iterator();r.hasNext();){var n=r.next();if(n.isInResult()&&n.getLabel().isArea()&&null===n.getEdgeRing()){var i=new Yc(n,this._geometryFactory);t.add(i),i.setInResult()}}return t},af.prototype.placePolygonHoles=function(e,t){for(var r=t.iterator();r.hasNext();){var n=r.next();n.isHole()&&n.setShell(e)}},af.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},af.prototype.findEdgeRingContaining=function(e,t){for(var r=e.getLinearRing(),n=r.getEnvelopeInternal(),i=r.getCoordinateN(0),o=null,a=null,s=t.iterator();s.hasNext();){var l=s.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==o&&(a=o.getLinearRing().getEnvelopeInternal());var f=!1;c.contains(n)&&su.isPointInRing(i,u.getCoordinates())&&(f=!0),f&&(null===o||a.contains(c))&&(o=l)}return o},af.prototype.findShell=function(e){for(var t=0,r=null,n=e.iterator();n.hasNext();){var i=n.next();i.isHole()||(r=i,t++)}return tu.isTrue(t<=1,"found two shells in MinimalEdgeRing list"),r},af.prototype.add=function(){if(1===arguments.length){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(2===arguments.length){var t=arguments[0],r=arguments[1];of.linkResultDirectedEdges(r);var n=this.buildMaximalEdgeRings(t),i=new Mu,o=this.buildMinimalEdgeRings(n,this._shellList,i);this.sortShellsAndHoles(o,this._shellList,i),this.placeFreeHoles(this._shellList,i)}},af.prototype.interfaces_=function(){return[]},af.prototype.getClass=function(){return af};var sf=function(){};sf.prototype.getBounds=function(){},sf.prototype.interfaces_=function(){return[]},sf.prototype.getClass=function(){return sf};var lf=function(){this._bounds=null,this._item=null;var e=arguments[0],t=arguments[1];this._bounds=e,this._item=t};lf.prototype.getItem=function(){return this._item},lf.prototype.getBounds=function(){return this._bounds},lf.prototype.interfaces_=function(){return[sf,wl]},lf.prototype.getClass=function(){return lf};var uf=function(){this._size=null,this._items=null,this._size=0,this._items=new Mu,this._items.add(null)};uf.prototype.poll=function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e},uf.prototype.size=function(){return this._size},uf.prototype.reorder=function(e){for(var t=this,r=null,n=this._items.get(e);2*e<=this._size&&((r=2*e)!==t._size&&t._items.get(r+1).compareTo(t._items.get(r))<0&&r++,t._items.get(r).compareTo(n)<0);e=r)t._items.set(e,t._items.get(r));this._items.set(e,n)},uf.prototype.clear=function(){this._size=0,this._items.clear()},uf.prototype.isEmpty=function(){return 0===this._size},uf.prototype.add=function(e){this._items.add(null),this._size+=1;var t=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(t/2)))<0;t/=2)this._items.set(t,this._items.get(Math.trunc(t/2)));this._items.set(t,e)},uf.prototype.interfaces_=function(){return[]},uf.prototype.getClass=function(){return uf};var cf=function(){};cf.prototype.visitItem=function(e){},cf.prototype.interfaces_=function(){return[]},cf.prototype.getClass=function(){return cf};var ff=function(){};ff.prototype.insert=function(e,t){},ff.prototype.remove=function(e,t){},ff.prototype.query=function(){},ff.prototype.interfaces_=function(){return[]},ff.prototype.getClass=function(){return ff};var hf=function(){if(this._childBoundables=new Mu,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this._level=e}},df={serialVersionUID:{configurable:!0}};hf.prototype.getLevel=function(){return this._level},hf.prototype.size=function(){return this._childBoundables.size()},hf.prototype.getChildBoundables=function(){return this._childBoundables},hf.prototype.addChildBoundable=function(e){tu.isTrue(null===this._bounds),this._childBoundables.add(e)},hf.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},hf.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},hf.prototype.interfaces_=function(){return[sf,wl]},hf.prototype.getClass=function(){return hf},df.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(hf,df);var pf=function(){};pf.reverseOrder=function(){return{compare:function(e,t){return t.compareTo(e)}}},pf.min=function(e){return pf.sort(e),e.get(0)},pf.sort=function(e,t){var r=e.toArray();t?Xu.sort(r,t):Xu.sort(r);for(var n=e.iterator(),i=0,o=r.length;i<o;i++)n.next(),n.set(r[i])},pf.singletonList=function(e){var t=new Mu;return t.add(e),t};var yf=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var e=arguments[0],t=arguments[1],r=arguments[2];this._boundable1=e,this._boundable2=t,this._itemDistance=r,this._distance=this.distance()};yf.prototype.expandToQueue=function(e,t){var r=yf.isComposite(this._boundable1),n=yf.isComposite(this._boundable2);if(r&&n)return yf.area(this._boundable1)>yf.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,e,t),null):(this.expand(this._boundable2,this._boundable1,e,t),null);if(r)return this.expand(this._boundable1,this._boundable2,e,t),null;if(n)return this.expand(this._boundable2,this._boundable1,e,t),null;throw new vl("neither boundable is composite")},yf.prototype.isLeaves=function(){return!(yf.isComposite(this._boundable1)||yf.isComposite(this._boundable2))},yf.prototype.compareTo=function(e){var t=e;return this._distance<t._distance?-1:this._distance>t._distance?1:0},yf.prototype.expand=function(e,t,r,n){for(var i=e.getChildBoundables().iterator();i.hasNext();){var o=i.next(),a=new yf(o,t,this._itemDistance);a.getDistance()<n&&r.add(a)}},yf.prototype.getBoundable=function(e){return 0===e?this._boundable1:this._boundable2},yf.prototype.getDistance=function(){return this._distance},yf.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},yf.prototype.interfaces_=function(){return[Sl]},yf.prototype.getClass=function(){return yf},yf.area=function(e){return e.getBounds().getArea()},yf.isComposite=function(e){return e instanceof hf};var gf=function e(){if(this._root=null,this._built=!1,this._itemBoundables=new Mu,this._nodeCapacity=null,0===arguments.length){var t=e.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(1===arguments.length){var r=arguments[0];tu.isTrue(r>1,"Node capacity must be greater than 1"),this._nodeCapacity=r}},vf={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};gf.prototype.getNodeCapacity=function(){return this._nodeCapacity},gf.prototype.lastNode=function(e){return e.get(e.size()-1)},gf.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var e=0,t=arguments[0].getChildBoundables().iterator();t.hasNext();){var r=t.next();r instanceof hf?e+=this.size(r):r instanceof lf&&(e+=1)}return e}},gf.prototype.removeItem=function(e,t){for(var r=null,n=e.getChildBoundables().iterator();n.hasNext();){var i=n.next();i instanceof lf&&i.getItem()===t&&(r=i)}return null!==r&&(e.getChildBoundables().remove(r),!0)},gf.prototype.itemsTree=function(){if(0===arguments.length){this.build();var e=this.itemsTree(this._root);return null===e?new Mu:e}if(1===arguments.length){for(var t=arguments[0],r=new Mu,n=t.getChildBoundables().iterator();n.hasNext();){var i=n.next();if(i instanceof hf){var o=this.itemsTree(i);null!==o&&r.add(o)}else i instanceof lf?r.add(i.getItem()):tu.shouldNeverReachHere()}return r.size()<=0?null:r}},gf.prototype.insert=function(e,t){tu.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new lf(e,t))},gf.prototype.boundablesAtLevel=function(){if(1===arguments.length){var e=arguments[0],t=new Mu;return this.boundablesAtLevel(e,this._root,t),t}if(3===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[2];if(tu.isTrue(r>-2),n.getLevel()===r)return i.add(n),null;for(var o=n.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof hf?this.boundablesAtLevel(r,a,i):(tu.isTrue(a instanceof lf),-1===r&&i.add(a))}return null}},gf.prototype.query=function(){var e=this;if(1===arguments.length){var t=arguments[0];this.build();var r=new Mu;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,r),r}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(Pl(arguments[2],cf)&&arguments[0]instanceof Object&&arguments[1]instanceof hf)for(var o=arguments[0],a=arguments[1],s=arguments[2],l=a.getChildBoundables(),u=0;u<l.size();u++){var c=l.get(u);e.getIntersectsOp().intersects(c.getBounds(),o)&&(c instanceof hf?e.query(o,c,s):c instanceof lf?s.visitItem(c.getItem()):tu.shouldNeverReachHere())}else if(Pl(arguments[2],wu)&&arguments[0]instanceof Object&&arguments[1]instanceof hf)for(var f=arguments[0],h=arguments[1],d=arguments[2],p=h.getChildBoundables(),y=0;y<p.size();y++){var g=p.get(y);e.getIntersectsOp().intersects(g.getBounds(),f)&&(g instanceof hf?e.query(f,g,d):g instanceof lf?d.add(g.getItem()):tu.shouldNeverReachHere())}},gf.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},gf.prototype.getRoot=function(){return this.build(),this._root},gf.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,t)}if(3===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[2],o=this.removeItem(n,i);if(o)return!0;for(var a=null,s=n.getChildBoundables().iterator();s.hasNext();){var l=s.next();if(this.getIntersectsOp().intersects(l.getBounds(),r)&&l instanceof hf&&(o=this.remove(r,l,i))){a=l;break}}return null!==a&&a.getChildBoundables().isEmpty()&&n.getChildBoundables().remove(a),o}},gf.prototype.createHigherLevels=function(e,t){tu.isTrue(!e.isEmpty());var r=this.createParentBoundables(e,t+1);return 1===r.size()?r.get(0):this.createHigherLevels(r,t+1)},gf.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var e=0,t=arguments[0].getChildBoundables().iterator();t.hasNext();){var r=t.next();if(r instanceof hf){var n=this.depth(r);n>e&&(e=n)}}return e+1}},gf.prototype.createParentBoundables=function(e,t){var r=this;tu.isTrue(!e.isEmpty());var n=new Mu;n.add(this.createNode(t));var i=new Mu(e);pf.sort(i,this.getComparator());for(var o=i.iterator();o.hasNext();){var a=o.next();r.lastNode(n).getChildBoundables().size()===r.getNodeCapacity()&&n.add(r.createNode(t)),r.lastNode(n).addChildBoundable(a)}return n},gf.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},gf.prototype.interfaces_=function(){return[wl]},gf.prototype.getClass=function(){return gf},gf.compareDoubles=function(e,t){return e>t?1:e<t?-1:0},vf.IntersectsOp.get=function(){return mf},vf.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},vf.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(gf,vf);var mf=function(){},_f=function(){};_f.prototype.distance=function(e,t){},_f.prototype.interfaces_=function(){return[]},_f.prototype.getClass=function(){return _f};var Sf=function(e){function t(r){r=r||t.DEFAULT_NODE_CAPACITY,e.call(this,r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return t.prototype.createParentBoundablesFromVerticalSlices=function(e,t){tu.isTrue(e.length>0);for(var r=new Mu,n=0;n<e.length;n++)r.addAll(this.createParentBoundablesFromVerticalSlice(e[n],t));return r},t.prototype.createNode=function(e){return new xf(e)},t.prototype.size=function(){return 0===arguments.length?e.prototype.size.call(this):e.prototype.size.apply(this,arguments)},t.prototype.insert=function(){if(2!==arguments.length)return e.prototype.insert.apply(this,arguments);var t=arguments[0],r=arguments[1];if(t.isNull())return null;e.prototype.insert.call(this,t,r)},t.prototype.getIntersectsOp=function(){return t.intersectsOp},t.prototype.verticalSlices=function(e,t){for(var r=Math.trunc(Math.ceil(e.size()/t)),n=new Array(t).fill(null),i=e.iterator(),o=0;o<t;o++){n[o]=new Mu;for(var a=0;i.hasNext()&&a<r;){var s=i.next();n[o].add(s),a++}}return n},t.prototype.query=function(){if(1===arguments.length){var t=arguments[0];return e.prototype.query.call(this,t)}if(2===arguments.length){var r=arguments[0],n=arguments[1];e.prototype.query.call(this,r,n)}else if(3===arguments.length)if(Pl(arguments[2],cf)&&arguments[0]instanceof Object&&arguments[1]instanceof hf){var i=arguments[0],o=arguments[1],a=arguments[2];e.prototype.query.call(this,i,o,a)}else if(Pl(arguments[2],wu)&&arguments[0]instanceof Object&&arguments[1]instanceof hf){var s=arguments[0],l=arguments[1],u=arguments[2];e.prototype.query.call(this,s,l,u)}},t.prototype.getComparator=function(){return t.yComparator},t.prototype.createParentBoundablesFromVerticalSlice=function(t,r){return e.prototype.createParentBoundables.call(this,t,r)},t.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],r=arguments[1];return e.prototype.remove.call(this,t,r)}return e.prototype.remove.apply(this,arguments)},t.prototype.depth=function(){return 0===arguments.length?e.prototype.depth.call(this):e.prototype.depth.apply(this,arguments)},t.prototype.createParentBoundables=function(e,r){tu.isTrue(!e.isEmpty());var n=Math.trunc(Math.ceil(e.size()/this.getNodeCapacity())),i=new Mu(e);pf.sort(i,t.xComparator);var o=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(o,r)},t.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Pl(arguments[0],_f)){var e=arguments[0],r=new yf(this.getRoot(),this.getRoot(),e);return this.nearestNeighbour(r)}if(arguments[0]instanceof yf){var n=arguments[0];return this.nearestNeighbour(n,ml.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof t&&Pl(arguments[1],_f)){var i=arguments[0],o=arguments[1],a=new yf(this.getRoot(),i.getRoot(),o);return this.nearestNeighbour(a)}if(arguments[0]instanceof yf&&"number"==typeof arguments[1]){var s=arguments[0],l=arguments[1],u=null,c=new uf;for(c.add(s);!c.isEmpty()&&l>0;){var f=c.poll(),h=f.getDistance();if(h>=l)break;f.isLeaves()?(l=h,u=f):f.expandToQueue(c,l)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var d=arguments[0],p=arguments[1],y=arguments[2],g=new lf(d,p),v=new yf(this.getRoot(),g,y);return this.nearestNeighbour(v)[0]}},t.prototype.interfaces_=function(){return[ff,wl]},t.prototype.getClass=function(){return t},t.centreX=function(e){return t.avg(e.getMinX(),e.getMaxX())},t.avg=function(e,t){return(e+t)/2},t.centreY=function(e){return t.avg(e.getMinY(),e.getMaxY())},r.STRtreeNode.get=function(){return xf},r.serialVersionUID.get=function(){return 0x39920f7d5f261e0},r.xComparator.get=function(){return{interfaces_:function(){return[bl]},compare:function(r,n){return e.compareDoubles(t.centreX(r.getBounds()),t.centreX(n.getBounds()))}}},r.yComparator.get=function(){return{interfaces_:function(){return[bl]},compare:function(r,n){return e.compareDoubles(t.centreY(r.getBounds()),t.centreY(n.getBounds()))}}},r.intersectsOp.get=function(){return{interfaces_:function(){return[e.IntersectsOp]},intersects:function(e,t){return e.intersects(t)}}},r.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(t,r),t}(gf),xf=function(e){function t(){var t=arguments[0];e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.computeBounds=function(){for(var e=null,t=this.getChildBoundables().iterator();t.hasNext();){var r=t.next();null===e?e=new Wl(r.getBounds()):e.expandToInclude(r.getBounds())}return e},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(hf),bf=function(){};bf.prototype.interfaces_=function(){return[]},bf.prototype.getClass=function(){return bf},bf.relativeSign=function(e,t){return e<t?-1:e>t?1:0},bf.compare=function(e,t,r){if(t.equals2D(r))return 0;var n=bf.relativeSign(t.x,r.x),i=bf.relativeSign(t.y,r.y);switch(e){case 0:return bf.compareValue(n,i);case 1:return bf.compareValue(i,n);case 2:return bf.compareValue(i,-n);case 3:return bf.compareValue(-n,i);case 4:return bf.compareValue(-n,-i);case 5:return bf.compareValue(-i,-n);case 6:return bf.compareValue(-i,n);case 7:return bf.compareValue(n,-i)}return tu.shouldNeverReachHere("invalid octant value"),0},bf.compareValue=function(e,t){return e<0?-1:e>0?1:t<0?-1:t>0?1:0};var wf=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],t=arguments[1],r=arguments[2],n=arguments[3];this._segString=e,this.coord=new kl(t),this.segmentIndex=r,this._segmentOctant=n,this._isInterior=!t.equals2D(e.getCoordinate(r))};wf.prototype.getCoordinate=function(){return this.coord},wf.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)},wf.prototype.compareTo=function(e){var t=e;return this.segmentIndex<t.segmentIndex?-1:this.segmentIndex>t.segmentIndex?1:this.coord.equals2D(t.coord)?0:bf.compare(this._segmentOctant,this.coord,t.coord)},wf.prototype.isEndPoint=function(e){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===e},wf.prototype.isInterior=function(){return this._isInterior},wf.prototype.interfaces_=function(){return[Sl]},wf.prototype.getClass=function(){return wf};var kf=function(){this._nodeMap=new Uu,this._edge=null;var e=arguments[0];this._edge=e};kf.prototype.getSplitCoordinates=function(){var e=new Iu;this.addEndpoints();for(var t=this.iterator(),r=t.next();t.hasNext();){var n=t.next();this.addEdgeCoordinates(r,n,e),r=n}return e.toCoordinateArray()},kf.prototype.addCollapsedNodes=function(){var e=new Mu;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var t=e.iterator();t.hasNext();){var r=t.next().intValue();this.add(this._edge.getCoordinate(r),r)}},kf.prototype.print=function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(e)},kf.prototype.findCollapsesFromExistingVertices=function(e){for(var t=0;t<this._edge.size()-2;t++){var r=this._edge.getCoordinate(t),n=this._edge.getCoordinate(t+2);r.equals2D(n)&&e.add(new Rl(t+1))}},kf.prototype.addEdgeCoordinates=function(e,t,r){var n=this._edge.getCoordinate(t.segmentIndex),i=t.isInterior()||!t.coord.equals2D(n);r.add(new kl(e.coord),!1);for(var o=e.segmentIndex+1;o<=t.segmentIndex;o++)r.add(this._edge.getCoordinate(o));i&&r.add(new kl(t.coord))},kf.prototype.iterator=function(){return this._nodeMap.values().iterator()},kf.prototype.addSplitEdges=function(e){this.addEndpoints(),this.addCollapsedNodes();for(var t=this.iterator(),r=t.next();t.hasNext();){var n=t.next(),i=this.createSplitEdge(r,n);e.add(i),r=n}},kf.prototype.findCollapseIndex=function(e,t,r){if(!e.coord.equals2D(t.coord))return!1;var n=t.segmentIndex-e.segmentIndex;return t.isInterior()||n--,1===n&&(r[0]=e.segmentIndex+1,!0)},kf.prototype.findCollapsesFromInsertedNodes=function(e){for(var t=new Array(1).fill(null),r=this.iterator(),n=r.next();r.hasNext();){var i=r.next();this.findCollapseIndex(n,i,t)&&e.add(new Rl(t[0])),n=i}},kf.prototype.getEdge=function(){return this._edge},kf.prototype.addEndpoints=function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)},kf.prototype.createSplitEdge=function(e,t){var r=t.segmentIndex-e.segmentIndex+2,n=this._edge.getCoordinate(t.segmentIndex),i=t.isInterior()||!t.coord.equals2D(n);i||r--;var o=new Array(r).fill(null),a=0;o[a++]=new kl(e.coord);for(var s=e.segmentIndex+1;s<=t.segmentIndex;s++)o[a++]=this._edge.getCoordinate(s);return i&&(o[a]=new kl(t.coord)),new Tf(o,this._edge.getData())},kf.prototype.add=function(e,t){var r=new wf(this._edge,e,t,this._edge.getSegmentOctant(t)),n=this._nodeMap.get(r);return null!==n?(tu.isTrue(n.coord.equals2D(e),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(r,r),r)},kf.prototype.checkSplitEdgesCorrectness=function(e){var t=this._edge.getCoordinates(),r=e.get(0).getCoordinate(0);if(!r.equals2D(t[0]))throw new $l("bad split edge start point at "+r);var n=e.get(e.size()-1).getCoordinates(),i=n[n.length-1];if(!i.equals2D(t[t.length-1]))throw new $l("bad split edge end point at "+i)},kf.prototype.interfaces_=function(){return[]},kf.prototype.getClass=function(){return kf};var Mf=function(){};Mf.prototype.interfaces_=function(){return[]},Mf.prototype.getClass=function(){return Mf},Mf.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],t=arguments[1];if(0===e&&0===t)throw new vl("Cannot compute the octant for point ( "+e+", "+t+" )");var r=Math.abs(e),n=Math.abs(t);return e>=0?t>=0?r>=n?0:1:r>=n?7:6:t>=0?r>=n?3:2:r>=n?4:5}if(arguments[0]instanceof kl&&arguments[1]instanceof kl){var i=arguments[0],o=arguments[1],a=o.x-i.x,s=o.y-i.y;if(0===a&&0===s)throw new vl("Cannot compute the octant for two identical points "+i);return Mf.octant(a,s)}};var Ef=function(){};Ef.prototype.getCoordinates=function(){},Ef.prototype.size=function(){},Ef.prototype.getCoordinate=function(e){},Ef.prototype.isClosed=function(){},Ef.prototype.setData=function(e){},Ef.prototype.getData=function(){},Ef.prototype.interfaces_=function(){return[]},Ef.prototype.getClass=function(){return Ef};var If=function(){};If.prototype.addIntersection=function(e,t){},If.prototype.interfaces_=function(){return[Ef]},If.prototype.getClass=function(){return If};var Tf=function(){this._nodeList=new kf(this),this._pts=null,this._data=null;var e=arguments[0],t=arguments[1];this._pts=e,this._data=t};Tf.prototype.getCoordinates=function(){return this._pts},Tf.prototype.size=function(){return this._pts.length},Tf.prototype.getCoordinate=function(e){return this._pts[e]},Tf.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Tf.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))},Tf.prototype.setData=function(e){this._data=e},Tf.prototype.safeOctant=function(e,t){return e.equals2D(t)?0:Mf.octant(e,t)},Tf.prototype.getData=function(){return this._data},Tf.prototype.addIntersection=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];this.addIntersectionNode(e,t)}else if(4===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[3],o=new kl(r.getIntersection(i));this.addIntersection(o,n)}},Tf.prototype.toString=function(){return Ql.toLineString(new Sc(this._pts))},Tf.prototype.getNodeList=function(){return this._nodeList},Tf.prototype.addIntersectionNode=function(e,t){var r=t,n=r+1;if(n<this._pts.length){var i=this._pts[n];e.equals2D(i)&&(r=n)}return this._nodeList.add(e,r)},Tf.prototype.addIntersections=function(e,t,r){for(var n=0;n<e.getIntersectionNum();n++)this.addIntersection(e,t,r,n)},Tf.prototype.interfaces_=function(){return[If]},Tf.prototype.getClass=function(){return Tf},Tf.getNodedSubstrings=function(){if(1===arguments.length){var e=arguments[0],t=new Mu;return Tf.getNodedSubstrings(e,t),t}if(2===arguments.length)for(var r=arguments[0],n=arguments[1],i=r.iterator();i.hasNext();){i.next().getNodeList().addSplitEdges(n)}};var Lf=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new kl,this.p1=new kl;else if(1===arguments.length){var e=arguments[0];this.p0=new kl(e.p0),this.p1=new kl(e.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var t=arguments[0],r=arguments[1],n=arguments[2],i=arguments[3];this.p0=new kl(t,r),this.p1=new kl(n,i)}},Pf={serialVersionUID:{configurable:!0}};Lf.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Lf.prototype.orientationIndex=function(){if(arguments[0]instanceof Lf){var e=arguments[0],t=su.orientationIndex(this.p0,this.p1,e.p0),r=su.orientationIndex(this.p0,this.p1,e.p1);return t>=0&&r>=0||t<=0&&r<=0?Math.max(t,r):0}if(arguments[0]instanceof kl){var n=arguments[0];return su.orientationIndex(this.p0,this.p1,n)}},Lf.prototype.toGeometry=function(e){return e.createLineString([this.p0,this.p1])},Lf.prototype.isVertical=function(){return this.p0.x===this.p1.x},Lf.prototype.equals=function(e){if(!(e instanceof Lf))return!1;var t=e;return this.p0.equals(t.p0)&&this.p1.equals(t.p1)},Lf.prototype.intersection=function(e){var t=new iu;return t.computeIntersection(this.p0,this.p1,e.p0,e.p1),t.hasIntersection()?t.getIntersection(0):null},Lf.prototype.project=function(){if(arguments[0]instanceof kl){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new kl(e);var t=this.projectionFactor(e),r=new kl;return r.x=this.p0.x+t*(this.p1.x-this.p0.x),r.y=this.p0.y+t*(this.p1.y-this.p0.y),r}if(arguments[0]instanceof Lf){var n=arguments[0],i=this.projectionFactor(n.p0),o=this.projectionFactor(n.p1);if(i>=1&&o>=1)return null;if(i<=0&&o<=0)return null;var a=this.project(n.p0);i<0&&(a=this.p0),i>1&&(a=this.p1);var s=this.project(n.p1);return o<0&&(s=this.p0),o>1&&(s=this.p1),new Lf(a,s)}},Lf.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Lf.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Lf.prototype.getCoordinate=function(e){return 0===e?this.p0:this.p1},Lf.prototype.distancePerpendicular=function(e){return su.distancePointLinePerpendicular(e,this.p0,this.p1)},Lf.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Lf.prototype.midPoint=function(){return Lf.midPoint(this.p0,this.p1)},Lf.prototype.projectionFactor=function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var t=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,n=t*t+r*r;return n<=0?ml.NaN:((e.x-this.p0.x)*t+(e.y-this.p0.y)*r)/n},Lf.prototype.closestPoints=function(e){var t=this.intersection(e);if(null!==t)return[t,t];var r=new Array(2).fill(null),n=ml.MAX_VALUE,i=null,o=this.closestPoint(e.p0);n=o.distance(e.p0),r[0]=o,r[1]=e.p0;var a=this.closestPoint(e.p1);(i=a.distance(e.p1))<n&&(n=i,r[0]=a,r[1]=e.p1);var s=e.closestPoint(this.p0);(i=s.distance(this.p0))<n&&(n=i,r[0]=this.p0,r[1]=s);var l=e.closestPoint(this.p1);return(i=l.distance(this.p1))<n&&(n=i,r[0]=this.p1,r[1]=l),r},Lf.prototype.closestPoint=function(e){var t=this.projectionFactor(e);return t>0&&t<1?this.project(e):this.p0.distance(e)<this.p1.distance(e)?this.p0:this.p1},Lf.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Lf.prototype.getLength=function(){return this.p0.distance(this.p1)},Lf.prototype.compareTo=function(e){var t=e,r=this.p0.compareTo(t.p0);return 0!==r?r:this.p1.compareTo(t.p1)},Lf.prototype.reverse=function(){var e=this.p0;this.p0=this.p1,this.p1=e},Lf.prototype.equalsTopo=function(e){return this.p0.equals(e.p0)&&(this.p1.equals(e.p1)||this.p0.equals(e.p1))&&this.p1.equals(e.p0)},Lf.prototype.lineIntersection=function(e){try{return zl.intersection(this.p0,this.p1,e.p0,e.p1)}catch(e){if(!(e instanceof Ul))throw e}return null},Lf.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Lf.prototype.pointAlongOffset=function(e,t){var r=this.p0.x+e*(this.p1.x-this.p0.x),n=this.p0.y+e*(this.p1.y-this.p0.y),i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,a=Math.sqrt(i*i+o*o),s=0,l=0;if(0!==t){if(a<=0)throw new Error("Cannot compute offset from zero-length line segment");s=t*i/a,l=t*o/a}return new kl(r-l,n+s)},Lf.prototype.setCoordinates=function(){if(1===arguments.length){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(2===arguments.length){var t=arguments[0],r=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=r.x,this.p1.y=r.y}},Lf.prototype.segmentFraction=function(e){var t=this.projectionFactor(e);return t<0?t=0:(t>1||ml.isNaN(t))&&(t=1),t},Lf.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Lf.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Lf.prototype.distance=function(){if(arguments[0]instanceof Lf){var e=arguments[0];return su.distanceLineLine(this.p0,this.p1,e.p0,e.p1)}if(arguments[0]instanceof kl){var t=arguments[0];return su.distancePointLine(t,this.p0,this.p1)}},Lf.prototype.pointAlong=function(e){var t=new kl;return t.x=this.p0.x+e*(this.p1.x-this.p0.x),t.y=this.p0.y+e*(this.p1.y-this.p0.y),t},Lf.prototype.hashCode=function(){var e=ml.doubleToLongBits(this.p0.x);e^=31*ml.doubleToLongBits(this.p0.y);var t=Math.trunc(e)^Math.trunc(e>>32),r=ml.doubleToLongBits(this.p1.x);return r^=31*ml.doubleToLongBits(this.p1.y),t^Math.trunc(r)^Math.trunc(r>>32)},Lf.prototype.interfaces_=function(){return[Sl,wl]},Lf.prototype.getClass=function(){return Lf},Lf.midPoint=function(e,t){return new kl((e.x+t.x)/2,(e.y+t.y)/2)},Pf.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Lf,Pf);var Cf=function(){this.tempEnv1=new Wl,this.tempEnv2=new Wl,this._overlapSeg1=new Lf,this._overlapSeg2=new Lf};Cf.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var e=arguments[0],t=arguments[1],r=arguments[2],n=arguments[3];e.getLineSegment(t,this._overlapSeg1),r.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Cf.prototype.interfaces_=function(){return[]},Cf.prototype.getClass=function(){return Cf};var Nf=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var e=arguments[0],t=arguments[1],r=arguments[2],n=arguments[3];this._pts=e,this._start=t,this._end=r,this._context=n};Nf.prototype.getLineSegment=function(e,t){t.p0=this._pts[e],t.p1=this._pts[e+1]},Nf.prototype.computeSelect=function(e,t,r,n){var i=this._pts[t],o=this._pts[r];if(n.tempEnv1.init(i,o),r-t==1)return n.select(this,t),null;if(!e.intersects(n.tempEnv1))return null;var a=Math.trunc((t+r)/2);t<a&&this.computeSelect(e,t,a,n),a<r&&this.computeSelect(e,a,r,n)},Nf.prototype.getCoordinates=function(){for(var e=new Array(this._end-this._start+1).fill(null),t=0,r=this._start;r<=this._end;r++)e[t++]=this._pts[r];return e},Nf.prototype.computeOverlaps=function(e,t){this.computeOverlapsInternal(this._start,this._end,e,e._start,e._end,t)},Nf.prototype.setId=function(e){this._id=e},Nf.prototype.select=function(e,t){this.computeSelect(e,this._start,this._end,t)},Nf.prototype.getEnvelope=function(){if(null===this._env){var e=this._pts[this._start],t=this._pts[this._end];this._env=new Wl(e,t)}return this._env},Nf.prototype.getEndIndex=function(){return this._end},Nf.prototype.getStartIndex=function(){return this._start},Nf.prototype.getContext=function(){return this._context},Nf.prototype.getId=function(){return this._id},Nf.prototype.computeOverlapsInternal=function(e,t,r,n,i,o){var a=this._pts[e],s=this._pts[t],l=r._pts[n],u=r._pts[i];if(t-e==1&&i-n==1)return o.overlap(this,e,r,n),null;if(o.tempEnv1.init(a,s),o.tempEnv2.init(l,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((e+t)/2),f=Math.trunc((n+i)/2);e<c&&(n<f&&this.computeOverlapsInternal(e,c,r,n,f,o),f<i&&this.computeOverlapsInternal(e,c,r,f,i,o)),c<t&&(n<f&&this.computeOverlapsInternal(c,t,r,n,f,o),f<i&&this.computeOverlapsInternal(c,t,r,f,i,o))},Nf.prototype.interfaces_=function(){return[]},Nf.prototype.getClass=function(){return Nf};var Of=function(){};Of.prototype.interfaces_=function(){return[]},Of.prototype.getClass=function(){return Of},Of.getChainStartIndices=function(e){var t=0,r=new Mu;r.add(new Rl(t));do{var n=Of.findChainEnd(e,t);r.add(new Rl(n)),t=n}while(t<e.length-1);return Of.toIntArray(r)},Of.findChainEnd=function(e,t){for(var r=t;r<e.length-1&&e[r].equals2D(e[r+1]);)r++;if(r>=e.length-1)return e.length-1;for(var n=$c.quadrant(e[r],e[r+1]),i=t+1;i<e.length&&(e[i-1].equals2D(e[i])||$c.quadrant(e[i-1],e[i])===n);)i++;return i-1},Of.getChains=function(){if(1===arguments.length){var e=arguments[0];return Of.getChains(e,null)}if(2===arguments.length){for(var t=arguments[0],r=arguments[1],n=new Mu,i=Of.getChainStartIndices(t),o=0;o<i.length-1;o++){var a=new Nf(t,i[o],i[o+1],r);n.add(a)}return n}},Of.toIntArray=function(e){for(var t=new Array(e.size()).fill(null),r=0;r<t.length;r++)t[r]=e.get(r).intValue();return t};var Rf=function(){};Rf.prototype.computeNodes=function(e){},Rf.prototype.getNodedSubstrings=function(){},Rf.prototype.interfaces_=function(){return[]},Rf.prototype.getClass=function(){return Rf};var Vf=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setSegmentIntersector(e)}};Vf.prototype.setSegmentIntersector=function(e){this._segInt=e},Vf.prototype.interfaces_=function(){return[Rf]},Vf.prototype.getClass=function(){return Vf};var Gf=function(e){function t(t){t?e.call(this,t):e.call(this),this._monoChains=new Mu,this._index=new Sf,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={SegmentOverlapAction:{configurable:!0}};return t.prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return Tf.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(e){for(var t=this,r=Of.getChains(e.getCoordinates(),e).iterator();r.hasNext();){var n=r.next();n.setId(t._idCounter++),t._index.insert(n.getEnvelope(),n),t._monoChains.add(n)}},t.prototype.computeNodes=function(e){this._nodedSegStrings=e;for(var t=e.iterator();t.hasNext();)this.add(t.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var e=this,t=new Af(this._segInt),r=this._monoChains.iterator();r.hasNext();)for(var n=r.next(),i=e._index.query(n.getEnvelope()).iterator();i.hasNext();){var o=i.next();if(o.getId()>n.getId()&&(n.computeOverlaps(o,t),e._nOverlaps++),e._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},r.SegmentOverlapAction.get=function(){return Af},Object.defineProperties(t,r),t}(Vf),Af=function(e){function t(){e.call(this),this._si=null;var t=arguments[0];this._si=t}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.overlap=function(){if(4!==arguments.length)return e.prototype.overlap.apply(this,arguments);var t=arguments[0],r=arguments[1],n=arguments[2],i=arguments[3],o=t.getContext(),a=n.getContext();this._si.processIntersections(o,r,a,i)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Cf),Ff=function e(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var r=arguments[0],n=arguments[1];this.setQuadrantSegments(r),this.setEndCapStyle(n)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(o),this.setJoinStyle(a),this.setMitreLimit(s)}},Df={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Ff.prototype.getEndCapStyle=function(){return this._endCapStyle},Ff.prototype.isSingleSided=function(){return this._isSingleSided},Ff.prototype.setQuadrantSegments=function(e){this._quadrantSegments=e,0===this._quadrantSegments&&(this._joinStyle=Ff.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Ff.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==Ff.JOIN_ROUND&&(this._quadrantSegments=Ff.DEFAULT_QUADRANT_SEGMENTS)},Ff.prototype.getJoinStyle=function(){return this._joinStyle},Ff.prototype.setJoinStyle=function(e){this._joinStyle=e},Ff.prototype.setSimplifyFactor=function(e){this._simplifyFactor=e<0?0:e},Ff.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Ff.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Ff.prototype.setEndCapStyle=function(e){this._endCapStyle=e},Ff.prototype.getMitreLimit=function(){return this._mitreLimit},Ff.prototype.setMitreLimit=function(e){this._mitreLimit=e},Ff.prototype.setSingleSided=function(e){this._isSingleSided=e},Ff.prototype.interfaces_=function(){return[]},Ff.prototype.getClass=function(){return Ff},Ff.bufferDistanceError=function(e){var t=Math.PI/2/e;return 1-Math.cos(t/2)},Df.CAP_ROUND.get=function(){return 1},Df.CAP_FLAT.get=function(){return 2},Df.CAP_SQUARE.get=function(){return 3},Df.JOIN_ROUND.get=function(){return 1},Df.JOIN_MITRE.get=function(){return 2},Df.JOIN_BEVEL.get=function(){return 3},Df.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Df.DEFAULT_MITRE_LIMIT.get=function(){return 5},Df.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(Ff,Df);var jf=function(e){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=su.COUNTERCLOCKWISE,this._inputLine=e||null},Bf={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};jf.prototype.isDeletable=function(e,t,r,n){var i=this._inputLine[e],o=this._inputLine[t],a=this._inputLine[r];return!!this.isConcave(i,o,a)&&!!this.isShallow(i,o,a,n)&&this.isShallowSampled(i,o,e,r,n)},jf.prototype.deleteShallowConcavities=function(){for(var e=this,t=1,r=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(r),i=!1;n<this._inputLine.length;){var o=!1;e.isDeletable(t,r,n,e._distanceTol)&&(e._isDeleted[r]=jf.DELETE,o=!0,i=!0),t=o?n:r,r=e.findNextNonDeletedIndex(t),n=e.findNextNonDeletedIndex(r)}return i},jf.prototype.isShallowConcavity=function(e,t,r,n){return su.computeOrientation(e,t,r)===this._angleOrientation&&su.distancePointLine(t,e,r)<n},jf.prototype.isShallowSampled=function(e,t,r,n,i){var o=Math.trunc((n-r)/jf.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var a=r;a<n;a+=o)if(!this.isShallow(e,t,this._inputLine[a],i))return!1;return!0},jf.prototype.isConcave=function(e,t,r){return su.computeOrientation(e,t,r)===this._angleOrientation},jf.prototype.simplify=function(e){this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=su.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var t=!1;do{t=this.deleteShallowConcavities()}while(t);return this.collapseLine()},jf.prototype.findNextNonDeletedIndex=function(e){for(var t=e+1;t<this._inputLine.length&&this._isDeleted[t]===jf.DELETE;)t++;return t},jf.prototype.isShallow=function(e,t,r,n){return su.distancePointLine(t,e,r)<n},jf.prototype.collapseLine=function(){for(var e=new Iu,t=0;t<this._inputLine.length;t++)this._isDeleted[t]!==jf.DELETE&&e.add(this._inputLine[t]);return e.toCoordinateArray()},jf.prototype.interfaces_=function(){return[]},jf.prototype.getClass=function(){return jf},jf.simplify=function(e,t){return new jf(e).simplify(t)},Bf.INIT.get=function(){return 0},Bf.DELETE.get=function(){return 1},Bf.KEEP.get=function(){return 1},Bf.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(jf,Bf);var qf=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Mu},Uf={COORDINATE_ARRAY_TYPE:{configurable:!0}};qf.prototype.getCoordinates=function(){return this._ptList.toArray(qf.COORDINATE_ARRAY_TYPE)},qf.prototype.setPrecisionModel=function(e){this._precisionModel=e},qf.prototype.addPt=function(e){var t=new kl(e);if(this._precisionModel.makePrecise(t),this.isRedundant(t))return null;this._ptList.add(t)},qf.prototype.revere=function(){},qf.prototype.addPts=function(e,t){if(t)for(var r=0;r<e.length;r++)this.addPt(e[r]);else for(var n=e.length-1;n>=0;n--)this.addPt(e[n])},qf.prototype.isRedundant=function(e){if(this._ptList.size()<1)return!1;var t=this._ptList.get(this._ptList.size()-1);return e.distance(t)<this._minimimVertexDistance},qf.prototype.toString=function(){return(new Lc).createLineString(this.getCoordinates()).toString()},qf.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var e=new kl(this._ptList.get(0)),t=this._ptList.get(this._ptList.size()-1);if(e.equals(t))return null;this._ptList.add(e)},qf.prototype.setMinimumVertexDistance=function(e){this._minimimVertexDistance=e},qf.prototype.interfaces_=function(){return[]},qf.prototype.getClass=function(){return qf},Uf.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(qf,Uf);var Jf=function(){},zf={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Jf.prototype.interfaces_=function(){return[]},Jf.prototype.getClass=function(){return Jf},Jf.toDegrees=function(e){return 180*e/Math.PI},Jf.normalize=function(e){for(;e>Math.PI;)e-=Jf.PI_TIMES_2;for(;e<=-Math.PI;)e+=Jf.PI_TIMES_2;return e},Jf.angle=function(){if(1===arguments.length){var e=arguments[0];return Math.atan2(e.y,e.x)}if(2===arguments.length){var t=arguments[0],r=arguments[1],n=r.x-t.x,i=r.y-t.y;return Math.atan2(i,n)}},Jf.isAcute=function(e,t,r){var n=e.x-t.x,i=e.y-t.y;return n*(r.x-t.x)+i*(r.y-t.y)>0},Jf.isObtuse=function(e,t,r){var n=e.x-t.x,i=e.y-t.y;return n*(r.x-t.x)+i*(r.y-t.y)<0},Jf.interiorAngle=function(e,t,r){var n=Jf.angle(t,e),i=Jf.angle(t,r);return Math.abs(i-n)},Jf.normalizePositive=function(e){if(e<0){for(;e<0;)e+=Jf.PI_TIMES_2;e>=Jf.PI_TIMES_2&&(e=0)}else{for(;e>=Jf.PI_TIMES_2;)e-=Jf.PI_TIMES_2;e<0&&(e=0)}return e},Jf.angleBetween=function(e,t,r){var n=Jf.angle(t,e),i=Jf.angle(t,r);return Jf.diff(n,i)},Jf.diff=function(e,t){var r=null;return(r=e<t?t-e:e-t)>Math.PI&&(r=2*Math.PI-r),r},Jf.toRadians=function(e){return e*Math.PI/180},Jf.getTurn=function(e,t){var r=Math.sin(t-e);return r>0?Jf.COUNTERCLOCKWISE:r<0?Jf.CLOCKWISE:Jf.NONE},Jf.angleBetweenOriented=function(e,t,r){var n=Jf.angle(t,e),i=Jf.angle(t,r)-n;return i<=-Math.PI?i+Jf.PI_TIMES_2:i>Math.PI?i-Jf.PI_TIMES_2:i},zf.PI_TIMES_2.get=function(){return 2*Math.PI},zf.PI_OVER_2.get=function(){return Math.PI/2},zf.PI_OVER_4.get=function(){return Math.PI/4},zf.COUNTERCLOCKWISE.get=function(){return su.COUNTERCLOCKWISE},zf.CLOCKWISE.get=function(){return su.CLOCKWISE},zf.NONE.get=function(){return su.COLLINEAR},Object.defineProperties(Jf,zf);var Wf=function e(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Lf,this._seg1=new Lf,this._offset0=new Lf,this._offset1=new Lf,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],r=arguments[1],n=arguments[2];this._precisionModel=t,this._bufParams=r,this._li=new iu,this._filletAngleQuantum=Math.PI/2/r.getQuadrantSegments(),r.getQuadrantSegments()>=8&&r.getJoinStyle()===Ff.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)},Hf={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Wf.prototype.addNextSegment=function(e,t){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=su.computeOrientation(this._s0,this._s1,this._s2),n=r===su.CLOCKWISE&&this._side===Ac.LEFT||r===su.COUNTERCLOCKWISE&&this._side===Ac.RIGHT;0===r?this.addCollinear(t):n?this.addOutsideTurn(r,t):this.addInsideTurn(r,t)},Wf.prototype.addLineEndCap=function(e,t){var r=new Lf(e,t),n=new Lf;this.computeOffsetSegment(r,Ac.LEFT,this._distance,n);var i=new Lf;this.computeOffsetSegment(r,Ac.RIGHT,this._distance,i);var o=t.x-e.x,a=t.y-e.y,s=Math.atan2(a,o);switch(this._bufParams.getEndCapStyle()){case Ff.CAP_ROUND:this._segList.addPt(n.p1),this.addFilletArc(t,s+Math.PI/2,s-Math.PI/2,su.CLOCKWISE,this._distance),this._segList.addPt(i.p1);break;case Ff.CAP_FLAT:this._segList.addPt(n.p1),this._segList.addPt(i.p1);break;case Ff.CAP_SQUARE:var l=new kl;l.x=Math.abs(this._distance)*Math.cos(s),l.y=Math.abs(this._distance)*Math.sin(s);var u=new kl(n.p1.x+l.x,n.p1.y+l.y),c=new kl(i.p1.x+l.x,i.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},Wf.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Wf.prototype.addMitreJoin=function(e,t,r,n){var i=!0,o=null;try{o=zl.intersection(t.p0,t.p1,r.p0,r.p1),(n<=0?1:o.distance(e)/Math.abs(n))>this._bufParams.getMitreLimit()&&(i=!1)}catch(e){if(!(e instanceof Ul))throw e;o=new kl(0,0),i=!1}i?this._segList.addPt(o):this.addLimitedMitreJoin(t,r,n,this._bufParams.getMitreLimit())},Wf.prototype.addFilletCorner=function(e,t,r,n,i){var o=t.x-e.x,a=t.y-e.y,s=Math.atan2(a,o),l=r.x-e.x,u=r.y-e.y,c=Math.atan2(u,l);n===su.CLOCKWISE?s<=c&&(s+=2*Math.PI):s>=c&&(s-=2*Math.PI),this._segList.addPt(t),this.addFilletArc(e,s,c,n,i),this._segList.addPt(r)},Wf.prototype.addOutsideTurn=function(e,t){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Wf.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Ff.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Ff.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(t&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))},Wf.prototype.createSquare=function(e){this._segList.addPt(new kl(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new kl(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new kl(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new kl(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()},Wf.prototype.addSegments=function(e,t){this._segList.addPts(e,t)},Wf.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Wf.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Wf.prototype.initSideSegments=function(e,t,r){this._s1=e,this._s2=t,this._side=r,this._seg1.setCoordinates(e,t),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)},Wf.prototype.addLimitedMitreJoin=function(e,t,r,n){var i=this._seg0.p1,o=Jf.angle(i,this._seg0.p0),a=Jf.angleBetweenOriented(this._seg0.p0,i,this._seg1.p1)/2,s=Jf.normalize(o+a),l=Jf.normalize(s+Math.PI),u=n*r,c=r-u*Math.abs(Math.sin(a)),f=i.x+u*Math.cos(l),h=i.y+u*Math.sin(l),d=new kl(f,h),p=new Lf(i,d),y=p.pointAlongOffset(1,c),g=p.pointAlongOffset(1,-c);this._side===Ac.LEFT?(this._segList.addPt(y),this._segList.addPt(g)):(this._segList.addPt(g),this._segList.addPt(y))},Wf.prototype.computeOffsetSegment=function(e,t,r,n){var i=t===Ac.LEFT?1:-1,o=e.p1.x-e.p0.x,a=e.p1.y-e.p0.y,s=Math.sqrt(o*o+a*a),l=i*r*o/s,u=i*r*a/s;n.p0.x=e.p0.x-u,n.p0.y=e.p0.y+l,n.p1.x=e.p1.x-u,n.p1.y=e.p1.y+l},Wf.prototype.addFilletArc=function(e,t,r,n,i){var o=n===su.CLOCKWISE?-1:1,a=Math.abs(t-r),s=Math.trunc(a/this._filletAngleQuantum+.5);if(s<1)return null;for(var l=a/s,u=0,c=new kl;u<a;){var f=t+o*u;c.x=e.x+i*Math.cos(f),c.y=e.y+i*Math.sin(f),this._segList.addPt(c),u+=l}},Wf.prototype.addInsideTurn=function(e,t){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Wf.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new kl((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var n=new kl((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Wf.prototype.createCircle=function(e){var t=new kl(e.x+this._distance,e.y);this._segList.addPt(t),this.addFilletArc(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Wf.prototype.addBevelJoin=function(e,t){this._segList.addPt(e.p1),this._segList.addPt(t.p0)},Wf.prototype.init=function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new qf,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*Wf.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Wf.prototype.addCollinear=function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Ff.JOIN_BEVEL||this._bufParams.getJoinStyle()===Ff.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,su.CLOCKWISE,this._distance))},Wf.prototype.closeRing=function(){this._segList.closeRing()},Wf.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Wf.prototype.interfaces_=function(){return[]},Wf.prototype.getClass=function(){return Wf},Hf.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Hf.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Hf.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Hf.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Wf,Hf);var Xf=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var e=arguments[0],t=arguments[1];this._precisionModel=e,this._bufParams=t};Xf.prototype.getOffsetCurve=function(e,t){if(this._distance=t,0===t)return null;var r=t<0,n=Math.abs(t),i=this.getSegGen(n);e.length<=1?this.computePointCurve(e[0],i):this.computeOffsetCurve(e,r,i);var o=i.getCoordinates();return r&&Tu.reverse(o),o},Xf.prototype.computeSingleSidedBufferCurve=function(e,t,r){var n=this.simplifyTolerance(this._distance);if(t){r.addSegments(e,!0);var i=jf.simplify(e,-n),o=i.length-1;r.initSideSegments(i[o],i[o-1],Ac.LEFT),r.addFirstSegment();for(var a=o-2;a>=0;a--)r.addNextSegment(i[a],!0)}else{r.addSegments(e,!1);var s=jf.simplify(e,n),l=s.length-1;r.initSideSegments(s[0],s[1],Ac.LEFT),r.addFirstSegment();for(var u=2;u<=l;u++)r.addNextSegment(s[u],!0)}r.addLastSegment(),r.closeRing()},Xf.prototype.computeRingBufferCurve=function(e,t,r){var n=this.simplifyTolerance(this._distance);t===Ac.RIGHT&&(n=-n);var i=jf.simplify(e,n),o=i.length-1;r.initSideSegments(i[o-1],i[0],t);for(var a=1;a<=o;a++){var s=1!==a;r.addNextSegment(i[a],s)}r.closeRing()},Xf.prototype.computeLineBufferCurve=function(e,t){var r=this.simplifyTolerance(this._distance),n=jf.simplify(e,r),i=n.length-1;t.initSideSegments(n[0],n[1],Ac.LEFT);for(var o=2;o<=i;o++)t.addNextSegment(n[o],!0);t.addLastSegment(),t.addLineEndCap(n[i-1],n[i]);var a=jf.simplify(e,-r),s=a.length-1;t.initSideSegments(a[s],a[s-1],Ac.LEFT);for(var l=s-2;l>=0;l--)t.addNextSegment(a[l],!0);t.addLastSegment(),t.addLineEndCap(a[1],a[0]),t.closeRing()},Xf.prototype.computePointCurve=function(e,t){switch(this._bufParams.getEndCapStyle()){case Ff.CAP_ROUND:t.createCircle(e);break;case Ff.CAP_SQUARE:t.createSquare(e)}},Xf.prototype.getLineCurve=function(e,t){if(this._distance=t,t<0&&!this._bufParams.isSingleSided())return null;if(0===t)return null;var r=Math.abs(t),n=this.getSegGen(r);if(e.length<=1)this.computePointCurve(e[0],n);else if(this._bufParams.isSingleSided()){var i=t<0;this.computeSingleSidedBufferCurve(e,i,n)}else this.computeLineBufferCurve(e,n);return n.getCoordinates()},Xf.prototype.getBufferParameters=function(){return this._bufParams},Xf.prototype.simplifyTolerance=function(e){return e*this._bufParams.getSimplifyFactor()},Xf.prototype.getRingCurve=function(e,t,r){if(this._distance=r,e.length<=2)return this.getLineCurve(e,r);if(0===r)return Xf.copyCoordinates(e);var n=this.getSegGen(r);return this.computeRingBufferCurve(e,t,n),n.getCoordinates()},Xf.prototype.computeOffsetCurve=function(e,t,r){var n=this.simplifyTolerance(this._distance);if(t){var i=jf.simplify(e,-n),o=i.length-1;r.initSideSegments(i[o],i[o-1],Ac.LEFT),r.addFirstSegment();for(var a=o-2;a>=0;a--)r.addNextSegment(i[a],!0)}else{var s=jf.simplify(e,n),l=s.length-1;r.initSideSegments(s[0],s[1],Ac.LEFT),r.addFirstSegment();for(var u=2;u<=l;u++)r.addNextSegment(s[u],!0)}r.addLastSegment()},Xf.prototype.getSegGen=function(e){return new Wf(this._precisionModel,this._bufParams,e)},Xf.prototype.interfaces_=function(){return[]},Xf.prototype.getClass=function(){return Xf},Xf.copyCoordinates=function(e){for(var t=new Array(e.length).fill(null),r=0;r<t.length;r++)t[r]=new kl(e[r]);return t};var Yf=function(){this._subgraphs=null,this._seg=new Lf,this._cga=new su;var e=arguments[0];this._subgraphs=e},Zf={DepthSegment:{configurable:!0}};Yf.prototype.findStabbedSegments=function(){var e=this;if(1===arguments.length){for(var t=arguments[0],r=new Mu,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),o=i.getEnvelope();t.y<o.getMinY()||t.y>o.getMaxY()||e.findStabbedSegments(t,i.getDirectedEdges(),r)}return r}if(3===arguments.length)if(Pl(arguments[2],wu)&&arguments[0]instanceof kl&&arguments[1]instanceof rf)for(var a=arguments[0],s=arguments[1],l=arguments[2],u=s.getEdge().getCoordinates(),c=0;c<u.length-1;c++){if(e._seg.p0=u[c],e._seg.p1=u[c+1],e._seg.p0.y>e._seg.p1.y&&e._seg.reverse(),!(Math.max(e._seg.p0.x,e._seg.p1.x)<a.x||e._seg.isHorizontal()||a.y<e._seg.p0.y||a.y>e._seg.p1.y||su.computeOrientation(e._seg.p0,e._seg.p1,a)===su.RIGHT)){var f=s.getDepth(Ac.LEFT);e._seg.p0.equals(u[c])||(f=s.getDepth(Ac.RIGHT));var h=new Kf(e._seg,f);l.add(h)}}else if(Pl(arguments[2],wu)&&arguments[0]instanceof kl&&Pl(arguments[1],wu))for(var d=arguments[0],p=arguments[1],y=arguments[2],g=p.iterator();g.hasNext();){var v=g.next();v.isForward()&&e.findStabbedSegments(d,v,y)}},Yf.prototype.getDepth=function(e){var t=this.findStabbedSegments(e);return 0===t.size()?0:pf.min(t)._leftDepth},Yf.prototype.interfaces_=function(){return[]},Yf.prototype.getClass=function(){return Yf},Zf.DepthSegment.get=function(){return Kf},Object.defineProperties(Yf,Zf);var Kf=function(){this._upwardSeg=null,this._leftDepth=null;var e=arguments[0],t=arguments[1];this._upwardSeg=new Lf(e),this._leftDepth=t};Kf.prototype.compareTo=function(e){var t=e;if(this._upwardSeg.minX()>=t._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=t._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(t._upwardSeg);return 0!==r||0!=(r=-1*t._upwardSeg.orientationIndex(this._upwardSeg))?r:this._upwardSeg.compareTo(t._upwardSeg)},Kf.prototype.compareX=function(e,t){var r=e.p0.compareTo(t.p0);return 0!==r?r:e.p1.compareTo(t.p1)},Kf.prototype.toString=function(){return this._upwardSeg.toString()},Kf.prototype.interfaces_=function(){return[Sl]},Kf.prototype.getClass=function(){return Kf};var Qf=function(e,t,r){this.p0=e||null,this.p1=t||null,this.p2=r||null};Qf.prototype.area=function(){return Qf.area(this.p0,this.p1,this.p2)},Qf.prototype.signedArea=function(){return Qf.signedArea(this.p0,this.p1,this.p2)},Qf.prototype.interpolateZ=function(e){if(null===e)throw new vl("Supplied point is null.");return Qf.interpolateZ(e,this.p0,this.p1,this.p2)},Qf.prototype.longestSideLength=function(){return Qf.longestSideLength(this.p0,this.p1,this.p2)},Qf.prototype.isAcute=function(){return Qf.isAcute(this.p0,this.p1,this.p2)},Qf.prototype.circumcentre=function(){return Qf.circumcentre(this.p0,this.p1,this.p2)},Qf.prototype.area3D=function(){return Qf.area3D(this.p0,this.p1,this.p2)},Qf.prototype.centroid=function(){return Qf.centroid(this.p0,this.p1,this.p2)},Qf.prototype.inCentre=function(){return Qf.inCentre(this.p0,this.p1,this.p2)},Qf.prototype.interfaces_=function(){return[]},Qf.prototype.getClass=function(){return Qf},Qf.area=function(e,t,r){return Math.abs(((r.x-e.x)*(t.y-e.y)-(t.x-e.x)*(r.y-e.y))/2)},Qf.signedArea=function(e,t,r){return((r.x-e.x)*(t.y-e.y)-(t.x-e.x)*(r.y-e.y))/2},Qf.det=function(e,t,r,n){return e*n-t*r},Qf.interpolateZ=function(e,t,r,n){var i=t.x,o=t.y,a=r.x-i,s=n.x-i,l=r.y-o,u=n.y-o,c=a*u-s*l,f=e.x-i,h=e.y-o,d=(u*f-s*h)/c,p=(-l*f+a*h)/c;return t.z+d*(r.z-t.z)+p*(n.z-t.z)},Qf.longestSideLength=function(e,t,r){var n=e.distance(t),i=t.distance(r),o=r.distance(e),a=n;return i>a&&(a=i),o>a&&(a=o),a},Qf.isAcute=function(e,t,r){return!!Jf.isAcute(e,t,r)&&!!Jf.isAcute(t,r,e)&&!!Jf.isAcute(r,e,t)},Qf.circumcentre=function(e,t,r){var n=r.x,i=r.y,o=e.x-n,a=e.y-i,s=t.x-n,l=t.y-i,u=2*Qf.det(o,a,s,l),c=Qf.det(a,o*o+a*a,l,s*s+l*l),f=Qf.det(o,o*o+a*a,s,s*s+l*l);return new kl(n-c/u,i+f/u)},Qf.perpendicularBisector=function(e,t){var r=t.x-e.x,n=t.y-e.y,i=new zl(e.x+r/2,e.y+n/2,1),o=new zl(e.x-n+r/2,e.y+r+n/2,1);return new zl(i,o)},Qf.angleBisector=function(e,t,r){var n=t.distance(e),i=n/(n+t.distance(r)),o=r.x-e.x,a=r.y-e.y;return new kl(e.x+i*o,e.y+i*a)},Qf.area3D=function(e,t,r){var n=t.x-e.x,i=t.y-e.y,o=t.z-e.z,a=r.x-e.x,s=r.y-e.y,l=r.z-e.z,u=i*l-o*s,c=o*a-n*l,f=n*s-i*a,h=u*u+c*c+f*f;return Math.sqrt(h)/2},Qf.centroid=function(e,t,r){var n=(e.x+t.x+r.x)/3,i=(e.y+t.y+r.y)/3;return new kl(n,i)},Qf.inCentre=function(e,t,r){var n=t.distance(r),i=e.distance(r),o=e.distance(t),a=n+i+o,s=(n*e.x+i*t.x+o*r.x)/a,l=(n*e.y+i*t.y+o*r.y)/a;return new kl(s,l)};var $f=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Mu;var e=arguments[0],t=arguments[1],r=arguments[2];this._inputGeom=e,this._distance=t,this._curveBuilder=r};$f.prototype.addPoint=function(e){if(this._distance<=0)return null;var t=e.getCoordinates(),r=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(r,Tl.EXTERIOR,Tl.INTERIOR)},$f.prototype.addPolygon=function(e){var t=this,r=this._distance,n=Ac.LEFT;this._distance<0&&(r=-this._distance,n=Ac.RIGHT);var i=e.getExteriorRing(),o=Tu.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&o.length<3)return null;this.addPolygonRing(o,r,n,Tl.EXTERIOR,Tl.INTERIOR);for(var a=0;a<e.getNumInteriorRing();a++){var s=e.getInteriorRingN(a),l=Tu.removeRepeatedPoints(s.getCoordinates());t._distance>0&&t.isErodedCompletely(s,-t._distance)||t.addPolygonRing(l,r,Ac.opposite(n),Tl.INTERIOR,Tl.EXTERIOR)}},$f.prototype.isTriangleErodedCompletely=function(e,t){var r=new Qf(e[0],e[1],e[2]),n=r.inCentre();return su.distancePointLine(n,r.p0,r.p1)<Math.abs(t)},$f.prototype.addLineString=function(e){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var t=Tu.removeRepeatedPoints(e.getCoordinates()),r=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(r,Tl.EXTERIOR,Tl.INTERIOR)},$f.prototype.addCurve=function(e,t,r){if(null===e||e.length<2)return null;var n=new Tf(e,new Wc(0,Tl.BOUNDARY,t,r));this._curveList.add(n)},$f.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},$f.prototype.addPolygonRing=function(e,t,r,n,i){if(0===t&&e.length<dc.MINIMUM_VALID_SIZE)return null;var o=n,a=i;e.length>=dc.MINIMUM_VALID_SIZE&&su.isCCW(e)&&(o=i,a=n,r=Ac.opposite(r));var s=this._curveBuilder.getRingCurve(e,r,t);this.addCurve(s,o,a)},$f.prototype.add=function(e){if(e.isEmpty())return null;e instanceof fc?this.addPolygon(e):e instanceof sc?this.addLineString(e):e instanceof uc?this.addPoint(e):(e instanceof hc||e instanceof ec||e instanceof pc||e instanceof $u)&&this.addCollection(e)},$f.prototype.isErodedCompletely=function(e,t){var r=e.getCoordinates();if(r.length<4)return t<0;if(4===r.length)return this.isTriangleErodedCompletely(r,t);var n=e.getEnvelopeInternal(),i=Math.min(n.getHeight(),n.getWidth());return t<0&&2*Math.abs(t)>i},$f.prototype.addCollection=function(e){for(var t=0;t<e.getNumGeometries();t++){var r=e.getGeometryN(t);this.add(r)}},$f.prototype.interfaces_=function(){return[]},$f.prototype.getClass=function(){return $f};var eh=function(){};eh.prototype.locate=function(e){},eh.prototype.interfaces_=function(){return[]},eh.prototype.getClass=function(){return eh};var th=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()};th.prototype.next=function(){if(this._atStart)return this._atStart=!1,th.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new ku;var e=this._parent.getGeometryN(this._index++);return e instanceof $u?(this._subcollectionIterator=new th(e),this._subcollectionIterator.next()):e},th.prototype.remove=function(){throw new Error(this.getClass().getName())},th.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},th.prototype.interfaces_=function(){return[bu]},th.prototype.getClass=function(){return th},th.isAtomic=function(e){return!(e instanceof $u)};var rh=function(){this._geom=null;var e=arguments[0];this._geom=e};rh.prototype.locate=function(e){return rh.locate(e,this._geom)},rh.prototype.interfaces_=function(){return[eh]},rh.prototype.getClass=function(){return rh},rh.isPointInRing=function(e,t){return!!t.getEnvelopeInternal().intersects(e)&&su.isPointInRing(e,t.getCoordinates())},rh.containsPointInPolygon=function(e,t){if(t.isEmpty())return!1;var r=t.getExteriorRing();if(!rh.isPointInRing(e,r))return!1;for(var n=0;n<t.getNumInteriorRing();n++){var i=t.getInteriorRingN(n);if(rh.isPointInRing(e,i))return!1}return!0},rh.containsPoint=function(e,t){if(t instanceof fc)return rh.containsPointInPolygon(e,t);if(t instanceof $u)for(var r=new th(t);r.hasNext();){var n=r.next();if(n!==t&&rh.containsPoint(e,n))return!0}return!1},rh.locate=function(e,t){return t.isEmpty()?Tl.EXTERIOR:rh.containsPoint(e,t)?Tl.INTERIOR:Tl.EXTERIOR};var nh=function(){this._edgeMap=new Uu,this._edgeList=null,this._ptInAreaLocation=[Tl.NONE,Tl.NONE]};nh.prototype.getNextCW=function(e){this.getEdges();var t=this._edgeList.indexOf(e),r=t-1;return 0===t&&(r=this._edgeList.size()-1),this._edgeList.get(r)},nh.prototype.propagateSideLabels=function(e){for(var t=Tl.NONE,r=this.iterator();r.hasNext();){var n=r.next().getLabel();n.isArea(e)&&n.getLocation(e,Ac.LEFT)!==Tl.NONE&&(t=n.getLocation(e,Ac.LEFT))}if(t===Tl.NONE)return null;for(var i=t,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getLabel();if(s.getLocation(e,Ac.ON)===Tl.NONE&&s.setLocation(e,Ac.ON,i),s.isArea(e)){var l=s.getLocation(e,Ac.LEFT),u=s.getLocation(e,Ac.RIGHT);if(u!==Tl.NONE){if(u!==i)throw new qc("side location conflict",a.getCoordinate());l===Tl.NONE&&tu.shouldNeverReachHere("found single null side (at "+a.getCoordinate()+")"),i=l}else tu.isTrue(s.getLocation(e,Ac.LEFT)===Tl.NONE,"found single null side"),s.setLocation(e,Ac.RIGHT,i),s.setLocation(e,Ac.LEFT,i)}}},nh.prototype.getCoordinate=function(){var e=this.iterator();return e.hasNext()?e.next().getCoordinate():null},nh.prototype.print=function(e){Jl.out.println("EdgeEndStar:   "+this.getCoordinate());for(var t=this.iterator();t.hasNext();)t.next().print(e)},nh.prototype.isAreaLabelsConsistent=function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},nh.prototype.checkAreaLabelsConsistent=function(e){var t=this.getEdges();if(t.size()<=0)return!0;var r=t.size()-1,n=t.get(r).getLabel().getLocation(e,Ac.LEFT);tu.isTrue(n!==Tl.NONE,"Found unlabelled area edge");for(var i=n,o=this.iterator();o.hasNext();){var a=o.next().getLabel();tu.isTrue(a.isArea(e),"Found non-area edge");var s=a.getLocation(e,Ac.LEFT),l=a.getLocation(e,Ac.RIGHT);if(s===l)return!1;if(l!==i)return!1;i=s}return!0},nh.prototype.findIndex=function(e){this.iterator();for(var t=0;t<this._edgeList.size();t++)if(this._edgeList.get(t)===e)return t;return-1},nh.prototype.iterator=function(){return this.getEdges().iterator()},nh.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Mu(this._edgeMap.values())),this._edgeList},nh.prototype.getLocation=function(e,t,r){return this._ptInAreaLocation[e]===Tl.NONE&&(this._ptInAreaLocation[e]=rh.locate(t,r[e].getGeometry())),this._ptInAreaLocation[e]},nh.prototype.toString=function(){var e=new Ol;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append("\n");for(var t=this.iterator();t.hasNext();){var r=t.next();e.append(r),e.append("\n")}return e.toString()},nh.prototype.computeEdgeEndLabels=function(e){for(var t=this.iterator();t.hasNext();)t.next().computeLabel(e)},nh.prototype.computeLabelling=function(e){this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var t=[!1,!1],r=this.iterator();r.hasNext();)for(var n=r.next().getLabel(),i=0;i<2;i++)n.isLine(i)&&n.getLocation(i)===Tl.BOUNDARY&&(t[i]=!0);for(var o=this.iterator();o.hasNext();)for(var a=o.next(),s=a.getLabel(),l=0;l<2;l++)if(s.isAnyNull(l)){var u=Tl.NONE;if(t[l])u=Tl.EXTERIOR;else{var c=a.getCoordinate();u=this.getLocation(l,c,e)}s.setAllLocationsIfNull(l,u)}},nh.prototype.getDegree=function(){return this._edgeMap.size()},nh.prototype.insertEdgeEnd=function(e,t){this._edgeMap.put(e,t),this._edgeList=null},nh.prototype.interfaces_=function(){return[]},nh.prototype.getClass=function(){return nh};var ih=function(e){function t(){e.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.linkResultDirectedEdges=function(){var e=this;this.getResultAreaEdges();for(var t=null,r=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var o=e._resultAreaEdgeList.get(i),a=o.getSym();if(o.getLabel().isArea())switch(null===t&&o.isInResult()&&(t=o),n){case e._SCANNING_FOR_INCOMING:if(!a.isInResult())continue;r=a,n=e._LINKING_TO_OUTGOING;break;case e._LINKING_TO_OUTGOING:if(!o.isInResult())continue;r.setNext(o),n=e._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new qc("no outgoing dirEdge found",this.getCoordinate());tu.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),r.setNext(t)}},t.prototype.insert=function(e){var t=e;this.insertEdgeEnd(t,t)},t.prototype.getRightmostEdge=function(){var e=this.getEdges(),t=e.size();if(t<1)return null;var r=e.get(0);if(1===t)return r;var n=e.get(t-1),i=r.getQuadrant(),o=n.getQuadrant();return $c.isNorthern(i)&&$c.isNorthern(o)?r:$c.isNorthern(i)||$c.isNorthern(o)?0!==r.getDy()?r:0!==n.getDy()?n:(tu.shouldNeverReachHere("found two horizontal edges incident on node"),null):n},t.prototype.print=function(e){Jl.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var t=this.iterator();t.hasNext();){var r=t.next();e.print("out "),r.print(e),e.println(),e.print("in "),r.getSym().print(e),e.println()}},t.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Mu;for(var e=this.iterator();e.hasNext();){var t=e.next();(t.isInResult()||t.getSym().isInResult())&&this._resultAreaEdgeList.add(t)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(e){for(var t=this.iterator();t.hasNext();){var r=t.next().getLabel();r.setAllLocationsIfNull(0,e.getLocation(0)),r.setAllLocationsIfNull(1,e.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var e=null,t=null,r=this._edgeList.size()-1;r>=0;r--){var n=this._edgeList.get(r),i=n.getSym();null===t&&(t=i),null!==e&&i.setNext(e),e=n}t.setNext(e)},t.prototype.computeDepths=function(){if(1===arguments.length){var e=arguments[0],t=this.findIndex(e),r=e.getDepth(Ac.LEFT),n=e.getDepth(Ac.RIGHT),i=this.computeDepths(t+1,this._edgeList.size(),r);if(this.computeDepths(0,t,i)!==n)throw new qc("depth mismatch at "+e.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],a=arguments[1],s=arguments[2],l=o;l<a;l++){var u=this._edgeList.get(l);u.setEdgeDepths(Ac.RIGHT,s),s=u.getDepth(Ac.LEFT)}return s}},t.prototype.mergeSymLabels=function(){for(var e=this.iterator();e.hasNext();){var t=e.next();t.getLabel().merge(t.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(e){for(var t=this,r=null,n=null,i=this._SCANNING_FOR_INCOMING,o=this._resultAreaEdgeList.size()-1;o>=0;o--){var a=t._resultAreaEdgeList.get(o),s=a.getSym();switch(null===r&&a.getEdgeRing()===e&&(r=a),i){case t._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==e)continue;n=s,i=t._LINKING_TO_OUTGOING;break;case t._LINKING_TO_OUTGOING:if(a.getEdgeRing()!==e)continue;n.setNextMin(a),i=t._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(tu.isTrue(null!==r,"found null for first outgoing dirEdge"),tu.isTrue(r.getEdgeRing()===e,"unable to link last incoming dirEdge"),n.setNextMin(r))},t.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var e=0,t=this.iterator();t.hasNext();){t.next().isInResult()&&e++}return e}if(1===arguments.length){for(var r=arguments[0],n=0,i=this.iterator();i.hasNext();){i.next().getEdgeRing()===r&&n++}return n}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var e=Tl.NONE,t=this.iterator();t.hasNext();){var r=t.next(),n=r.getSym();if(!r.isLineEdge()){if(r.isInResult()){e=Tl.INTERIOR;break}if(n.isInResult()){e=Tl.EXTERIOR;break}}}if(e===Tl.NONE)return null;for(var i=e,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getSym();a.isLineEdge()?a.getEdge().setCovered(i===Tl.INTERIOR):(a.isInResult()&&(i=Tl.EXTERIOR),s.isInResult()&&(i=Tl.INTERIOR))}},t.prototype.computeLabelling=function(t){e.prototype.computeLabelling.call(this,t),this._label=new Wc(Tl.NONE);for(var r=this.iterator();r.hasNext();)for(var n=r.next().getEdge().getLabel(),i=0;i<2;i++){var o=n.getLocation(i);o!==Tl.INTERIOR&&o!==Tl.BOUNDARY||this._label.setLocation(i,Tl.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(nh),oh=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createNode=function(e){return new Kc(e,new ih)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(nf),ah=function e(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=e.orientation(t)};ah.prototype.compareTo=function(e){var t=e;return ah.compareOriented(this._pts,this._orientation,t._pts,t._orientation)},ah.prototype.interfaces_=function(){return[Sl]},ah.prototype.getClass=function(){return ah},ah.orientation=function(e){return 1===Tu.increasingDirection(e)},ah.compareOriented=function(e,t,r,n){for(var i=t?1:-1,o=n?1:-1,a=t?e.length:-1,s=n?r.length:-1,l=t?0:e.length-1,u=n?0:r.length-1;;){var c=e[l].compareTo(r[u]);if(0!==c)return c;var f=(l+=i)===a,h=(u+=o)===s;if(f&&!h)return-1;if(!f&&h)return 1;if(f&&h)return 0}};var sh=function(){this._edges=new Mu,this._ocaMap=new Uu};sh.prototype.print=function(e){e.print("MULTILINESTRING ( ");for(var t=0;t<this._edges.size();t++){var r=this._edges.get(t);t>0&&e.print(","),e.print("(");for(var n=r.getCoordinates(),i=0;i<n.length;i++)i>0&&e.print(","),e.print(n[i].x+" "+n[i].y);e.println(")")}e.print(")  ")},sh.prototype.addAll=function(e){for(var t=e.iterator();t.hasNext();)this.add(t.next())},sh.prototype.findEdgeIndex=function(e){for(var t=0;t<this._edges.size();t++)if(this._edges.get(t).equals(e))return t;return-1},sh.prototype.iterator=function(){return this._edges.iterator()},sh.prototype.getEdges=function(){return this._edges},sh.prototype.get=function(e){return this._edges.get(e)},sh.prototype.findEqualEdge=function(e){var t=new ah(e.getCoordinates());return this._ocaMap.get(t)},sh.prototype.add=function(e){this._edges.add(e);var t=new ah(e.getCoordinates());this._ocaMap.put(t,e)},sh.prototype.interfaces_=function(){return[]},sh.prototype.getClass=function(){return sh};var lh=function(){};lh.prototype.processIntersections=function(e,t,r,n){},lh.prototype.isDone=function(){},lh.prototype.interfaces_=function(){return[]},lh.prototype.getClass=function(){return lh};var uh=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=arguments[0];this._li=e};uh.prototype.isTrivialIntersection=function(e,t,r,n){if(e===r&&1===this._li.getIntersectionNum()){if(uh.isAdjacentSegments(t,n))return!0;if(e.isClosed()){var i=e.size()-1;if(0===t&&n===i||0===n&&t===i)return!0}}return!1},uh.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},uh.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},uh.prototype.getLineIntersector=function(){return this._li},uh.prototype.hasProperIntersection=function(){return this._hasProper},uh.prototype.processIntersections=function(e,t,r,n){if(e===r&&t===n)return null;this.numTests++;var i=e.getCoordinates()[t],o=e.getCoordinates()[t+1],a=r.getCoordinates()[n],s=r.getCoordinates()[n+1];this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,t,r,n)||(this._hasIntersection=!0,e.addIntersections(this._li,t,0),r.addIntersections(this._li,n,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},uh.prototype.hasIntersection=function(){return this._hasIntersection},uh.prototype.isDone=function(){return!1},uh.prototype.hasInteriorIntersection=function(){return this._hasInterior},uh.prototype.interfaces_=function(){return[lh]},uh.prototype.getClass=function(){return uh},uh.isAdjacentSegments=function(e,t){return 1===Math.abs(e-t)};var ch=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var e=arguments[0],t=arguments[1],r=arguments[2];this.coord=new kl(e),this.segmentIndex=t,this.dist=r};ch.prototype.getSegmentIndex=function(){return this.segmentIndex},ch.prototype.getCoordinate=function(){return this.coord},ch.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)},ch.prototype.compareTo=function(e){var t=e;return this.compare(t.segmentIndex,t.dist)},ch.prototype.isEndPoint=function(e){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===e},ch.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},ch.prototype.getDistance=function(){return this.dist},ch.prototype.compare=function(e,t){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<t?-1:this.dist>t?1:0},ch.prototype.interfaces_=function(){return[Sl]},ch.prototype.getClass=function(){return ch};var fh=function(){this._nodeMap=new Uu,this.edge=null;var e=arguments[0];this.edge=e};fh.prototype.print=function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(e)},fh.prototype.iterator=function(){return this._nodeMap.values().iterator()},fh.prototype.addSplitEdges=function(e){this.addEndpoints();for(var t=this.iterator(),r=t.next();t.hasNext();){var n=t.next(),i=this.createSplitEdge(r,n);e.add(i),r=n}},fh.prototype.addEndpoints=function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)},fh.prototype.createSplitEdge=function(e,t){var r=t.segmentIndex-e.segmentIndex+2,n=this.edge.pts[t.segmentIndex],i=t.dist>0||!t.coord.equals2D(n);i||r--;var o=new Array(r).fill(null),a=0;o[a++]=new kl(e.coord);for(var s=e.segmentIndex+1;s<=t.segmentIndex;s++)o[a++]=this.edge.pts[s];return i&&(o[a]=t.coord),new gh(o,new Wc(this.edge._label))},fh.prototype.add=function(e,t,r){var n=new ch(e,t,r),i=this._nodeMap.get(n);return null!==i?i:(this._nodeMap.put(n,n),n)},fh.prototype.isIntersection=function(e){for(var t=this.iterator();t.hasNext();)if(t.next().coord.equals(e))return!0;return!1},fh.prototype.interfaces_=function(){return[]},fh.prototype.getClass=function(){return fh};var hh=function(){};hh.prototype.getChainStartIndices=function(e){var t=0,r=new Mu;r.add(new Rl(t));do{var n=this.findChainEnd(e,t);r.add(new Rl(n)),t=n}while(t<e.length-1);return hh.toIntArray(r)},hh.prototype.findChainEnd=function(e,t){for(var r=$c.quadrant(e[t],e[t+1]),n=t+1;n<e.length&&$c.quadrant(e[n-1],e[n])===r;)n++;return n-1},hh.prototype.interfaces_=function(){return[]},hh.prototype.getClass=function(){return hh},hh.toIntArray=function(e){for(var t=new Array(e.size()).fill(null),r=0;r<t.length;r++)t[r]=e.get(r).intValue();return t};var dh=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Wl,this.env2=new Wl;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var t=new hh;this.startIndex=t.getChainStartIndices(this.pts)};dh.prototype.getCoordinates=function(){return this.pts},dh.prototype.getMaxX=function(e){var t=this.pts[this.startIndex[e]].x,r=this.pts[this.startIndex[e+1]].x;return t>r?t:r},dh.prototype.getMinX=function(e){var t=this.pts[this.startIndex[e]].x,r=this.pts[this.startIndex[e+1]].x;return t<r?t:r},dh.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var e=arguments[0],t=arguments[1],r=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],t,t.startIndex[r],t.startIndex[r+1],n)}else if(6===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[i],f=this.pts[o],h=a.pts[s],d=a.pts[l];if(o-i==1&&l-s==1)return u.addIntersections(this.e,i,a.e,s),null;if(this.env1.init(c,f),this.env2.init(h,d),!this.env1.intersects(this.env2))return null;var p=Math.trunc((i+o)/2),y=Math.trunc((s+l)/2);i<p&&(s<y&&this.computeIntersectsForChain(i,p,a,s,y,u),y<l&&this.computeIntersectsForChain(i,p,a,y,l,u)),p<o&&(s<y&&this.computeIntersectsForChain(p,o,a,s,y,u),y<l&&this.computeIntersectsForChain(p,o,a,y,l,u))}},dh.prototype.getStartIndexes=function(){return this.startIndex},dh.prototype.computeIntersects=function(e,t){for(var r=0;r<this.startIndex.length-1;r++)for(var n=0;n<e.startIndex.length-1;n++)this.computeIntersectsForChain(r,e,n,t)},dh.prototype.interfaces_=function(){return[]},dh.prototype.getClass=function(){return dh};var ph=function e(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var r=0;r<3;r++)this._depth[t][r]=e.NULL_VALUE},yh={NULL_VALUE:{configurable:!0}};ph.prototype.getDepth=function(e,t){return this._depth[e][t]},ph.prototype.setDepth=function(e,t,r){this._depth[e][t]=r},ph.prototype.isNull=function(){if(0===arguments.length){for(var e=0;e<2;e++)for(var t=0;t<3;t++)if(this._depth[e][t]!==ph.NULL_VALUE)return!1;return!0}if(1===arguments.length){var r=arguments[0];return this._depth[r][1]===ph.NULL_VALUE}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this._depth[n][i]===ph.NULL_VALUE}},ph.prototype.normalize=function(){for(var e=this,t=0;t<2;t++)if(!e.isNull(t)){var r=e._depth[t][1];e._depth[t][2]<r&&(r=e._depth[t][2]),r<0&&(r=0);for(var n=1;n<3;n++){var i=0;e._depth[t][n]>r&&(i=1),e._depth[t][n]=i}}},ph.prototype.getDelta=function(e){return this._depth[e][Ac.RIGHT]-this._depth[e][Ac.LEFT]},ph.prototype.getLocation=function(e,t){return this._depth[e][t]<=0?Tl.EXTERIOR:Tl.INTERIOR},ph.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},ph.prototype.add=function(){var e=this;if(1===arguments.length)for(var t=arguments[0],r=0;r<2;r++)for(var n=1;n<3;n++){var i=t.getLocation(r,n);i!==Tl.EXTERIOR&&i!==Tl.INTERIOR||(e.isNull(r,n)?e._depth[r][n]=ph.depthAtLocation(i):e._depth[r][n]+=ph.depthAtLocation(i))}else if(3===arguments.length){var o=arguments[0],a=arguments[1];arguments[2]===Tl.INTERIOR&&this._depth[o][a]++}},ph.prototype.interfaces_=function(){return[]},ph.prototype.getClass=function(){return ph},ph.depthAtLocation=function(e){return e===Tl.EXTERIOR?0:e===Tl.INTERIOR?1:ph.NULL_VALUE},yh.NULL_VALUE.get=function(){return-1},Object.defineProperties(ph,yh);var gh=function(e){function t(){if(e.call(this),this.pts=null,this._env=null,this.eiList=new fh(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ph,this._depthDelta=0,1===arguments.length){var r=arguments[0];t.call(this,r,null)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.pts=n,this._label=i}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getDepth=function(){return this._depth},t.prototype.getCollapsedEdge=function(){var e=new Array(2).fill(null);return e[0]=this.pts[0],e[1]=this.pts[1],new t(e,Wc.toLineLabel(this._label))},t.prototype.isIsolated=function(){return this._isIsolated},t.prototype.getCoordinates=function(){return this.pts},t.prototype.setIsolated=function(e){this._isIsolated=e},t.prototype.setName=function(e){this._name=e},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;if(this.pts.length!==r.pts.length)return!1;for(var n=!0,i=!0,o=this.pts.length,a=0;a<this.pts.length;a++)if(this.pts[a].equals2D(r.pts[a])||(n=!1),this.pts[a].equals2D(r.pts[--o])||(i=!1),!n&&!i)return!1;return!0},t.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var e=arguments[0];return this.pts[e]}},t.prototype.print=function(e){e.print("edge "+this._name+": "),e.print("LINESTRING (");for(var t=0;t<this.pts.length;t++)t>0&&e.print(","),e.print(this.pts[t].x+" "+this.pts[t].y);e.print(")  "+this._label+" "+this._depthDelta)},t.prototype.computeIM=function(e){t.updateIM(this._label,e)},t.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},t.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},t.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},t.prototype.getDepthDelta=function(){return this._depthDelta},t.prototype.getNumPoints=function(){return this.pts.length},t.prototype.printReverse=function(e){e.print("edge "+this._name+": ");for(var t=this.pts.length-1;t>=0;t--)e.print(this.pts[t]+" ");e.println("")},t.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new dh(this)),this._mce},t.prototype.getEnvelope=function(){if(null===this._env){this._env=new Wl;for(var e=0;e<this.pts.length;e++)this._env.expandToInclude(this.pts[e])}return this._env},t.prototype.addIntersection=function(e,t,r,n){var i=new kl(e.getIntersection(n)),o=t,a=e.getEdgeDistance(r,n),s=o+1;if(s<this.pts.length){var l=this.pts[s];i.equals2D(l)&&(o=s,a=0)}this.eiList.add(i,o,a)},t.prototype.toString=function(){var e=new Ol;e.append("edge "+this._name+": "),e.append("LINESTRING (");for(var t=0;t<this.pts.length;t++)t>0&&e.append(","),e.append(this.pts[t].x+" "+this.pts[t].y);return e.append(")  "+this._label+" "+this._depthDelta),e.toString()},t.prototype.isPointwiseEqual=function(e){if(this.pts.length!==e.pts.length)return!1;for(var t=0;t<this.pts.length;t++)if(!this.pts[t].equals2D(e.pts[t]))return!1;return!0},t.prototype.setDepthDelta=function(e){this._depthDelta=e},t.prototype.getEdgeIntersectionList=function(){return this.eiList},t.prototype.addIntersections=function(e,t,r){for(var n=0;n<e.getIntersectionNum();n++)this.addIntersection(e,t,r,n)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.updateIM=function(){if(2!==arguments.length)return e.prototype.updateIM.apply(this,arguments);var t=arguments[0],r=arguments[1];r.setAtLeastIfValid(t.getLocation(0,Ac.ON),t.getLocation(1,Ac.ON),1),t.isArea()&&(r.setAtLeastIfValid(t.getLocation(0,Ac.LEFT),t.getLocation(1,Ac.LEFT),2),r.setAtLeastIfValid(t.getLocation(0,Ac.RIGHT),t.getLocation(1,Ac.RIGHT),2))},t}(Zc),vh=function(e){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new sh,this._bufParams=e||null};vh.prototype.setWorkingPrecisionModel=function(e){this._workingPrecisionModel=e},vh.prototype.insertUniqueEdge=function(e){var t=this._edgeList.findEqualEdge(e);if(null!==t){var r=t.getLabel(),n=e.getLabel();t.isPointwiseEqual(e)||(n=new Wc(e.getLabel())).flip(),r.merge(n);var i=vh.depthDelta(n),o=t.getDepthDelta()+i;t.setDepthDelta(o)}else this._edgeList.add(e),e.setDepthDelta(vh.depthDelta(e.getLabel()))},vh.prototype.buildSubgraphs=function(e,t){for(var r=new Mu,n=e.iterator();n.hasNext();){var i=n.next(),o=i.getRightmostCoordinate(),a=new Yf(r).getDepth(o);i.computeDepth(a),i.findResultEdges(),r.add(i),t.add(i.getDirectedEdges(),i.getNodes())}},vh.prototype.createSubgraphs=function(e){for(var t=new Mu,r=e.getNodes().iterator();r.hasNext();){var n=r.next();if(!n.isVisited()){var i=new Jc;i.create(n),t.add(i)}}return pf.sort(t,pf.reverseOrder()),t},vh.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},vh.prototype.getNoder=function(e){if(null!==this._workingNoder)return this._workingNoder;var t=new Gf,r=new iu;return r.setPrecisionModel(e),t.setSegmentIntersector(new uh(r)),t},vh.prototype.buffer=function(e,t){var r=this._workingPrecisionModel;null===r&&(r=e.getPrecisionModel()),this._geomFact=e.getFactory();var n=new Xf(r,this._bufParams),i=new $f(e,t,n).getCurves();if(i.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(i,r),this._graph=new of(new oh),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),a=new af(this._geomFact);this.buildSubgraphs(o,a);var s=a.getPolygons();return s.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(s)},vh.prototype.computeNodedEdges=function(e,t){var r=this.getNoder(t);r.computeNodes(e);for(var n=r.getNodedSubstrings().iterator();n.hasNext();){var i=n.next(),o=i.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var a=i.getData(),s=new gh(i.getCoordinates(),new Wc(a));this.insertUniqueEdge(s)}}},vh.prototype.setNoder=function(e){this._workingNoder=e},vh.prototype.interfaces_=function(){return[]},vh.prototype.getClass=function(){return vh},vh.depthDelta=function(e){var t=e.getLocation(0,Ac.LEFT),r=e.getLocation(0,Ac.RIGHT);return t===Tl.INTERIOR&&r===Tl.EXTERIOR?1:t===Tl.EXTERIOR&&r===Tl.INTERIOR?-1:0},vh.convertSegStrings=function(e){for(var t=new Lc,r=new Mu;e.hasNext();){var n=e.next(),i=t.createLineString(n.getCoordinates());r.add(i)}return t.buildGeometry(r)};var mh=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var e=arguments[0],t=arguments[1];this._noder=e,this._scaleFactor=t,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[2],o=arguments[3];this._noder=r,this._scaleFactor=n,this._offsetX=i,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};mh.prototype.rescale=function(){var e=this;if(Pl(arguments[0],Su))for(var t=arguments[0].iterator();t.hasNext();){var r=t.next();e.rescale(r.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/e._scaleFactor+e._offsetX,n[i].y=n[i].y/e._scaleFactor+e._offsetY;2===n.length&&n[0].equals2D(n[1])&&Jl.out.println(n)}},mh.prototype.scale=function(){var e=this;if(Pl(arguments[0],Su)){for(var t=arguments[0],r=new Mu,n=t.iterator();n.hasNext();){var i=n.next();r.add(new Tf(e.scale(i.getCoordinates()),i.getData()))}return r}if(arguments[0]instanceof Array){for(var o=arguments[0],a=new Array(o.length).fill(null),s=0;s<o.length;s++)a[s]=new kl(Math.round((o[s].x-e._offsetX)*e._scaleFactor),Math.round((o[s].y-e._offsetY)*e._scaleFactor),o[s].z);return Tu.removeRepeatedPoints(a)}},mh.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},mh.prototype.getNodedSubstrings=function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e},mh.prototype.computeNodes=function(e){var t=e;this._isScaled&&(t=this.scale(e)),this._noder.computeNodes(t)},mh.prototype.interfaces_=function(){return[Rf]},mh.prototype.getClass=function(){return mh};var _h=function(){this._li=new iu,this._segStrings=null;var e=arguments[0];this._segStrings=e},Sh={fact:{configurable:!0}};_h.prototype.checkEndPtVertexIntersections=function(){var e=this;if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var r=t.next().getCoordinates();e.checkEndPtVertexIntersections(r[0],e._segStrings),e.checkEndPtVertexIntersections(r[r.length-1],e._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var o=i.next().getCoordinates(),a=1;a<o.length-1;a++)if(o[a].equals(n))throw new $l("found endpt/interior pt intersection at index "+a+" :pt "+n)},_h.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();)for(var t=e.next(),r=this._segStrings.iterator();r.hasNext();){var n=r.next();this.checkInteriorIntersections(t,n)}else if(2===arguments.length)for(var i=arguments[0],o=arguments[1],a=i.getCoordinates(),s=o.getCoordinates(),l=0;l<a.length-1;l++)for(var u=0;u<s.length-1;u++)this.checkInteriorIntersections(i,l,o,u);else if(4===arguments.length){var c=arguments[0],f=arguments[1],h=arguments[2],d=arguments[3];if(c===h&&f===d)return null;var p=c.getCoordinates()[f],y=c.getCoordinates()[f+1],g=h.getCoordinates()[d],v=h.getCoordinates()[d+1];if(this._li.computeIntersection(p,y,g,v),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,p,y)||this.hasInteriorIntersection(this._li,g,v)))throw new $l("found non-noded intersection at "+p+"-"+y+" and "+g+"-"+v)}},_h.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},_h.prototype.checkCollapses=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var t=e.next();this.checkCollapses(t)}else if(1===arguments.length)for(var r=arguments[0].getCoordinates(),n=0;n<r.length-2;n++)this.checkCollapse(r[n],r[n+1],r[n+2])},_h.prototype.hasInteriorIntersection=function(e,t,r){for(var n=0;n<e.getIntersectionNum();n++){var i=e.getIntersection(n);if(!i.equals(t)&&!i.equals(r))return!0}return!1},_h.prototype.checkCollapse=function(e,t,r){if(e.equals(r))throw new $l("found non-noded collapse at "+_h.fact.createLineString([e,t,r]))},_h.prototype.interfaces_=function(){return[]},_h.prototype.getClass=function(){return _h},Sh.fact.get=function(){return new Lc},Object.defineProperties(_h,Sh);var xh=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],t=arguments[1],r=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=t,this._li=r,t<=0)throw new vl("Scale factor must be non-zero");1!==t&&(this._pt=new kl(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new kl,this._p1Scaled=new kl),this.initCorners(this._pt)},bh={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};xh.prototype.intersectsScaled=function(e,t){var r=Math.min(e.x,t.x),n=Math.max(e.x,t.x),i=Math.min(e.y,t.y),o=Math.max(e.y,t.y),a=this._maxx<r||this._minx>n||this._maxy<i||this._miny>o;if(a)return!1;var s=this.intersectsToleranceSquare(e,t);return tu.isTrue(!(a&&s),"Found bad envelope test"),s},xh.prototype.initCorners=function(e){this._minx=e.x-.5,this._maxx=e.x+.5,this._miny=e.y-.5,this._maxy=e.y+.5,this._corner[0]=new kl(this._maxx,this._maxy),this._corner[1]=new kl(this._minx,this._maxy),this._corner[2]=new kl(this._minx,this._miny),this._corner[3]=new kl(this._maxx,this._miny)},xh.prototype.intersects=function(e,t){return 1===this._scaleFactor?this.intersectsScaled(e,t):(this.copyScaled(e,this._p0Scaled),this.copyScaled(t,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},xh.prototype.scale=function(e){return Math.round(e*this._scaleFactor)},xh.prototype.getCoordinate=function(){return this._originalPt},xh.prototype.copyScaled=function(e,t){t.x=this.scale(e.x),t.y=this.scale(e.y)},xh.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var e=xh.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Wl(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv},xh.prototype.intersectsPixelClosure=function(e,t){return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},xh.prototype.intersectsToleranceSquare=function(e,t){var r=!1,n=!1;return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),this._li.isProper()||r&&n||e.equals(this._pt)||t.equals(this._pt)))))},xh.prototype.addSnappedNode=function(e,t){var r=e.getCoordinate(t),n=e.getCoordinate(t+1);return!!this.intersects(r,n)&&(e.addIntersection(this.getCoordinate(),t),!0)},xh.prototype.interfaces_=function(){return[]},xh.prototype.getClass=function(){return xh},bh.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(xh,bh);var wh=function(){this.tempEnv1=new Wl,this.selectedSegment=new Lf};wh.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var e=arguments[0],t=arguments[1];e.getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},wh.prototype.interfaces_=function(){return[]},wh.prototype.getClass=function(){return wh};var kh=function(){this._index=null;var e=arguments[0];this._index=e},Mh={HotPixelSnapAction:{configurable:!0}};kh.prototype.snap=function(){if(1===arguments.length){var e=arguments[0];return this.snap(e,null,-1)}if(3===arguments.length){var t=arguments[0],r=arguments[1],n=arguments[2],i=t.getSafeEnvelope(),o=new Eh(t,r,n);return this._index.query(i,{interfaces_:function(){return[cf]},visitItem:function(e){e.select(i,o)}}),o.isNodeAdded()}},kh.prototype.interfaces_=function(){return[]},kh.prototype.getClass=function(){return kh},Mh.HotPixelSnapAction.get=function(){return Eh},Object.defineProperties(kh,Mh);var Eh=function(e){function t(){e.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],r=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=r,this._hotPixelVertexIndex=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(2!==arguments.length)return e.prototype.select.apply(this,arguments);var t=arguments[0],r=arguments[1],n=t.getContext();if(null!==this._parentEdge&&n===this._parentEdge&&r===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,r)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(wh),Ih=function(){this._li=null,this._interiorIntersections=null;var e=arguments[0];this._li=e,this._interiorIntersections=new Mu};Ih.prototype.processIntersections=function(e,t,r,n){if(e===r&&t===n)return null;var i=e.getCoordinates()[t],o=e.getCoordinates()[t+1],a=r.getCoordinates()[n],s=r.getCoordinates()[n+1];if(this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));e.addIntersections(this._li,t,0),r.addIntersections(this._li,n,1)}},Ih.prototype.isDone=function(){return!1},Ih.prototype.getInteriorIntersections=function(){return this._interiorIntersections},Ih.prototype.interfaces_=function(){return[lh]},Ih.prototype.getClass=function(){return Ih};var Th=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new iu,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()};Th.prototype.checkCorrectness=function(e){var t=Tf.getNodedSubstrings(e),r=new _h(t);try{r.checkValid()}catch(e){if(!(e instanceof ql))throw e;e.printStackTrace()}},Th.prototype.getNodedSubstrings=function(){return Tf.getNodedSubstrings(this._nodedSegStrings)},Th.prototype.snapRound=function(e,t){var r=this.findInteriorIntersections(e,t);this.computeIntersectionSnaps(r),this.computeVertexSnaps(e)},Th.prototype.findInteriorIntersections=function(e,t){var r=new Ih(t);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(e),r.getInteriorIntersections()},Th.prototype.computeVertexSnaps=function(){var e=this;if(Pl(arguments[0],Su))for(var t=arguments[0].iterator();t.hasNext();){var r=t.next();e.computeVertexSnaps(r)}else if(arguments[0]instanceof Tf)for(var n=arguments[0],i=n.getCoordinates(),o=0;o<i.length;o++){var a=new xh(i[o],e._scaleFactor,e._li);e._pointSnapper.snap(a,n,o)&&n.addIntersection(i[o],o)}},Th.prototype.computeNodes=function(e){this._nodedSegStrings=e,this._noder=new Gf,this._pointSnapper=new kh(this._noder.getIndex()),this.snapRound(e,this._li)},Th.prototype.computeIntersectionSnaps=function(e){for(var t=this,r=e.iterator();r.hasNext();){var n=r.next(),i=new xh(n,t._scaleFactor,t._li);t._pointSnapper.snap(i)}},Th.prototype.interfaces_=function(){return[Rf]},Th.prototype.getClass=function(){return Th};var Lh=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Ff,this._resultGeometry=null,this._saveException=null,1===arguments.length){var e=arguments[0];this._argGeom=e}else if(2===arguments.length){var t=arguments[0],r=arguments[1];this._argGeom=t,this._bufParams=r}},Ph={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Lh.prototype.bufferFixedPrecision=function(e){var t=new mh(new Th(new Mc(1)),e.getScale()),r=new vh(this._bufParams);r.setWorkingPrecisionModel(e),r.setNoder(t),this._resultGeometry=r.buffer(this._argGeom,this._distance)},Lh.prototype.bufferReducedPrecision=function(){var e=this;if(0===arguments.length){for(var t=Lh.MAX_PRECISION_DIGITS;t>=0;t--){try{e.bufferReducedPrecision(t)}catch(t){if(!(t instanceof qc))throw t;e._saveException=t}if(null!==e._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var r=arguments[0],n=Lh.precisionScaleFactor(this._argGeom,this._distance,r),i=new Mc(n);this.bufferFixedPrecision(i)}},Lh.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===Mc.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()},Lh.prototype.setQuadrantSegments=function(e){this._bufParams.setQuadrantSegments(e)},Lh.prototype.bufferOriginalPrecision=function(){try{var e=new vh(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(e){if(!(e instanceof $l))throw e;this._saveException=e}},Lh.prototype.getResultGeometry=function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry},Lh.prototype.setEndCapStyle=function(e){this._bufParams.setEndCapStyle(e)},Lh.prototype.interfaces_=function(){return[]},Lh.prototype.getClass=function(){return Lh},Lh.bufferOp=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return new Lh(e).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof cu&&"number"==typeof arguments[1]){var r=arguments[0],n=arguments[1],i=arguments[2],o=new Lh(r);return o.setQuadrantSegments(i),o.getResultGeometry(n)}if(arguments[2]instanceof Ff&&arguments[0]instanceof cu&&"number"==typeof arguments[1]){var a=arguments[0],s=arguments[1],l=arguments[2];return new Lh(a,l).getResultGeometry(s)}}else if(4===arguments.length){var u=arguments[0],c=arguments[1],f=arguments[2],h=arguments[3],d=new Lh(u);return d.setQuadrantSegments(f),d.setEndCapStyle(h),d.getResultGeometry(c)}},Lh.precisionScaleFactor=function(e,t,r){var n=e.getEnvelopeInternal(),i=Cl.max(Math.abs(n.getMaxX()),Math.abs(n.getMaxY()),Math.abs(n.getMinX()),Math.abs(n.getMinY()))+2*(t>0?t:0),o=r-Math.trunc(Math.log(i)/Math.log(10)+1);return Math.pow(10,o)},Ph.CAP_ROUND.get=function(){return Ff.CAP_ROUND},Ph.CAP_BUTT.get=function(){return Ff.CAP_FLAT},Ph.CAP_FLAT.get=function(){return Ff.CAP_FLAT},Ph.CAP_SQUARE.get=function(){return Ff.CAP_SQUARE},Ph.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Lh,Ph);var Ch=function(){this._pt=[new kl,new kl],this._distance=ml.NaN,this._isNull=!0};Ch.prototype.getCoordinates=function(){return this._pt},Ch.prototype.getCoordinate=function(e){return this._pt[e]},Ch.prototype.setMinimum=function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var t=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(t,r),null;var n=t.distance(r);n<this._distance&&this.initialize(t,r,n)}},Ch.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],t=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(t),this._distance=e.distance(t),this._isNull=!1}else if(3===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(n),this._distance=i,this._isNull=!1}},Ch.prototype.getDistance=function(){return this._distance},Ch.prototype.setMaximum=function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var t=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(t,r),null;var n=t.distance(r);n>this._distance&&this.initialize(t,r,n)}},Ch.prototype.interfaces_=function(){return[]},Ch.prototype.getClass=function(){return Ch};var Nh=function(){};Nh.prototype.interfaces_=function(){return[]},Nh.prototype.getClass=function(){return Nh},Nh.computeDistance=function(){if(arguments[2]instanceof Ch&&arguments[0]instanceof sc&&arguments[1]instanceof kl)for(var e=arguments[0],t=arguments[1],r=arguments[2],n=e.getCoordinates(),i=new Lf,o=0;o<n.length-1;o++){i.setCoordinates(n[o],n[o+1]);var a=i.closestPoint(t);r.setMinimum(a,t)}else if(arguments[2]instanceof Ch&&arguments[0]instanceof fc&&arguments[1]instanceof kl){var s=arguments[0],l=arguments[1],u=arguments[2];Nh.computeDistance(s.getExteriorRing(),l,u);for(var c=0;c<s.getNumInteriorRing();c++)Nh.computeDistance(s.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Ch&&arguments[0]instanceof cu&&arguments[1]instanceof kl){var f=arguments[0],h=arguments[1],d=arguments[2];if(f instanceof sc)Nh.computeDistance(f,h,d);else if(f instanceof fc)Nh.computeDistance(f,h,d);else if(f instanceof $u)for(var p=f,y=0;y<p.getNumGeometries();y++){var g=p.getGeometryN(y);Nh.computeDistance(g,h,d)}else d.setMinimum(f.getCoordinate(),h)}else if(arguments[2]instanceof Ch&&arguments[0]instanceof Lf&&arguments[1]instanceof kl){var v=arguments[0],m=arguments[1],_=arguments[2],S=v.closestPoint(m);_.setMinimum(S,m)}};var Oh=function(e){this._maxPtDist=new Ch,this._inputGeom=e||null},Rh={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Oh.prototype.computeMaxMidpointDistance=function(e){var t=new Gh(this._inputGeom);e.apply(t),this._maxPtDist.setMaximum(t.getMaxPointDistance())},Oh.prototype.computeMaxVertexDistance=function(e){var t=new Vh(this._inputGeom);e.apply(t),this._maxPtDist.setMaximum(t.getMaxPointDistance())},Oh.prototype.findDistance=function(e){return this.computeMaxVertexDistance(e),this.computeMaxMidpointDistance(e),this._maxPtDist.getDistance()},Oh.prototype.getDistancePoints=function(){return this._maxPtDist},Oh.prototype.interfaces_=function(){return[]},Oh.prototype.getClass=function(){return Oh},Rh.MaxPointDistanceFilter.get=function(){return Vh},Rh.MaxMidpointDistanceFilter.get=function(){return Gh},Object.defineProperties(Oh,Rh);var Vh=function(e){this._maxPtDist=new Ch,this._minPtDist=new Ch,this._geom=e||null};Vh.prototype.filter=function(e){this._minPtDist.initialize(),Nh.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Vh.prototype.getMaxPointDistance=function(){return this._maxPtDist},Vh.prototype.interfaces_=function(){return[du]},Vh.prototype.getClass=function(){return Vh};var Gh=function(e){this._maxPtDist=new Ch,this._minPtDist=new Ch,this._geom=e||null};Gh.prototype.filter=function(e,t){if(0===t)return null;var r=e.getCoordinate(t-1),n=e.getCoordinate(t),i=new kl((r.x+n.x)/2,(r.y+n.y)/2);this._minPtDist.initialize(),Nh.computeDistance(this._geom,i,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Gh.prototype.isDone=function(){return!1},Gh.prototype.isGeometryChanged=function(){return!1},Gh.prototype.getMaxPointDistance=function(){return this._maxPtDist},Gh.prototype.interfaces_=function(){return[Qu]},Gh.prototype.getClass=function(){return Gh};var Ah=function(e){this._comps=e||null};Ah.prototype.filter=function(e){e instanceof fc&&this._comps.add(e)},Ah.prototype.interfaces_=function(){return[Ku]},Ah.prototype.getClass=function(){return Ah},Ah.getPolygons=function(){if(1===arguments.length){var e=arguments[0];return Ah.getPolygons(e,new Mu)}if(2===arguments.length){var t=arguments[0],r=arguments[1];return t instanceof fc?r.add(t):t instanceof $u&&t.apply(new Ah(r)),r}};var Fh=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var e=arguments[0];this._lines=e}else if(2===arguments.length){var t=arguments[0],r=arguments[1];this._lines=t,this._isForcedToLineString=r}};Fh.prototype.filter=function(e){if(this._isForcedToLineString&&e instanceof dc){var t=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(t),null}e instanceof sc&&this._lines.add(e)},Fh.prototype.setForceToLineString=function(e){this._isForcedToLineString=e},Fh.prototype.interfaces_=function(){return[uu]},Fh.prototype.getClass=function(){return Fh},Fh.getGeometry=function(){if(1===arguments.length){var e=arguments[0];return e.getFactory().buildGeometry(Fh.getLines(e))}if(2===arguments.length){var t=arguments[0],r=arguments[1];return t.getFactory().buildGeometry(Fh.getLines(t,r))}},Fh.getLines=function(){if(1===arguments.length){var e=arguments[0];return Fh.getLines(e,!1)}if(2===arguments.length){if(Pl(arguments[0],Su)&&Pl(arguments[1],Su)){for(var t=arguments[0],r=arguments[1],n=t.iterator();n.hasNext();){var i=n.next();Fh.getLines(i,r)}return r}if(arguments[0]instanceof cu&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1],s=new Mu;return o.apply(new Fh(s,a)),s}if(arguments[0]instanceof cu&&Pl(arguments[1],Su)){var l=arguments[0],u=arguments[1];return l instanceof sc?u.add(l):l.apply(new Fh(u)),u}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Pl(arguments[0],Su)&&Pl(arguments[1],Su)){for(var c=arguments[0],f=arguments[1],h=arguments[2],d=c.iterator();d.hasNext();){var p=d.next();Fh.getLines(p,f,h)}return f}if("boolean"==typeof arguments[2]&&arguments[0]instanceof cu&&Pl(arguments[1],Su)){var y=arguments[0],g=arguments[1],v=arguments[2];return y.apply(new Fh(g,v)),g}}};var Dh=function(){if(this._boundaryRule=pu.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(null===e)throw new vl("Rule must be non-null");this._boundaryRule=e}};Dh.prototype.locateInternal=function(){if(arguments[0]instanceof kl&&arguments[1]instanceof fc){var e=arguments[0],t=arguments[1];if(t.isEmpty())return Tl.EXTERIOR;var r=t.getExteriorRing(),n=this.locateInPolygonRing(e,r);if(n===Tl.EXTERIOR)return Tl.EXTERIOR;if(n===Tl.BOUNDARY)return Tl.BOUNDARY;for(var i=0;i<t.getNumInteriorRing();i++){var o=t.getInteriorRingN(i),a=this.locateInPolygonRing(e,o);if(a===Tl.INTERIOR)return Tl.EXTERIOR;if(a===Tl.BOUNDARY)return Tl.BOUNDARY}return Tl.INTERIOR}if(arguments[0]instanceof kl&&arguments[1]instanceof sc){var s=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(s))return Tl.EXTERIOR;var u=l.getCoordinates();return l.isClosed()||!s.equals(u[0])&&!s.equals(u[u.length-1])?su.isOnLine(s,u)?Tl.INTERIOR:Tl.EXTERIOR:Tl.BOUNDARY}if(arguments[0]instanceof kl&&arguments[1]instanceof uc){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?Tl.INTERIOR:Tl.EXTERIOR}},Dh.prototype.locateInPolygonRing=function(e,t){return t.getEnvelopeInternal().intersects(e)?su.locatePointInRing(e,t.getCoordinates()):Tl.EXTERIOR},Dh.prototype.intersects=function(e,t){return this.locate(e,t)!==Tl.EXTERIOR},Dh.prototype.updateLocationInfo=function(e){e===Tl.INTERIOR&&(this._isIn=!0),e===Tl.BOUNDARY&&this._numBoundaries++},Dh.prototype.computeLocation=function(e,t){var r=this;if(t instanceof uc&&this.updateLocationInfo(this.locateInternal(e,t)),t instanceof sc)this.updateLocationInfo(this.locateInternal(e,t));else if(t instanceof fc)this.updateLocationInfo(this.locateInternal(e,t));else if(t instanceof ec)for(var n=t,i=0;i<n.getNumGeometries();i++){var o=n.getGeometryN(i);r.updateLocationInfo(r.locateInternal(e,o))}else if(t instanceof pc)for(var a=t,s=0;s<a.getNumGeometries();s++){var l=a.getGeometryN(s);r.updateLocationInfo(r.locateInternal(e,l))}else if(t instanceof $u)for(var u=new th(t);u.hasNext();){var c=u.next();c!==t&&r.computeLocation(e,c)}},Dh.prototype.locate=function(e,t){return t.isEmpty()?Tl.EXTERIOR:t instanceof sc||t instanceof fc?this.locateInternal(e,t):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,t),this._boundaryRule.isInBoundary(this._numBoundaries)?Tl.BOUNDARY:this._numBoundaries>0||this._isIn?Tl.INTERIOR:Tl.EXTERIOR)},Dh.prototype.interfaces_=function(){return[]},Dh.prototype.getClass=function(){return Dh};var jh=function e(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var t=arguments[0],r=arguments[1];e.call(this,t,e.INSIDE_AREA,r)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],o=arguments[2];this._component=n,this._segIndex=i,this._pt=o}},Bh={INSIDE_AREA:{configurable:!0}};jh.prototype.isInsideArea=function(){return this._segIndex===jh.INSIDE_AREA},jh.prototype.getCoordinate=function(){return this._pt},jh.prototype.getGeometryComponent=function(){return this._component},jh.prototype.getSegmentIndex=function(){return this._segIndex},jh.prototype.interfaces_=function(){return[]},jh.prototype.getClass=function(){return jh},Bh.INSIDE_AREA.get=function(){return-1},Object.defineProperties(jh,Bh);var qh=function(e){this._pts=e||null};qh.prototype.filter=function(e){e instanceof uc&&this._pts.add(e)},qh.prototype.interfaces_=function(){return[Ku]},qh.prototype.getClass=function(){return qh},qh.getPoints=function(){if(1===arguments.length){var e=arguments[0];return e instanceof uc?pf.singletonList(e):qh.getPoints(e,new Mu)}if(2===arguments.length){var t=arguments[0],r=arguments[1];return t instanceof uc?r.add(t):t instanceof $u&&t.apply(new qh(r)),r}};var Uh=function(){this._locations=null;var e=arguments[0];this._locations=e};Uh.prototype.filter=function(e){(e instanceof uc||e instanceof sc||e instanceof fc)&&this._locations.add(new jh(e,0,e.getCoordinate()))},Uh.prototype.interfaces_=function(){return[Ku]},Uh.prototype.getClass=function(){return Uh},Uh.getLocations=function(e){var t=new Mu;return e.apply(new Uh(t)),t};var Jh=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Dh,this._minDistanceLocation=null,this._minDistance=ml.MAX_VALUE,2===arguments.length){var e=arguments[0],t=arguments[1];this._geom=[e,t],this._terminateDistance=0}else if(3===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=n,this._terminateDistance=i}};Jh.prototype.computeContainmentDistance=function(){var e=this;if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var r=arguments[0],n=arguments[1],i=1-r,o=Ah.getPolygons(this._geom[r]);if(o.size()>0){var a=Uh.getLocations(this._geom[i]);if(this.computeContainmentDistance(a,o,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[r]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Pl(arguments[0],wu)&&Pl(arguments[1],wu)){for(var s=arguments[0],l=arguments[1],u=arguments[2],c=0;c<s.size();c++)for(var f=s.get(c),h=0;h<l.size();h++)if(e.computeContainmentDistance(f,l.get(h),u),e._minDistance<=e._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof jh&&arguments[1]instanceof fc){var d=arguments[0],p=arguments[1],y=arguments[2],g=d.getCoordinate();if(Tl.EXTERIOR!==this._ptLocator.locate(g,p))return this._minDistance=0,y[0]=d,y[1]=new jh(p,g),null}},Jh.prototype.computeMinDistanceLinesPoints=function(e,t,r){for(var n=this,i=0;i<e.size();i++)for(var o=e.get(i),a=0;a<t.size();a++){var s=t.get(a);if(n.computeMinDistance(o,s,r),n._minDistance<=n._terminateDistance)return null}},Jh.prototype.computeFacetDistance=function(){var e=new Array(2).fill(null),t=Fh.getLines(this._geom[0]),r=Fh.getLines(this._geom[1]),n=qh.getPoints(this._geom[0]),i=qh.getPoints(this._geom[1]);return this.computeMinDistanceLines(t,r,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(t,i,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(r,n,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistancePoints(n,i,e),void this.updateMinDistance(e,!1))))},Jh.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Jh.prototype.updateMinDistance=function(e,t){if(null===e[0])return null;t?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])},Jh.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Jh.prototype.computeMinDistance=function(){var e=this;if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof sc&&arguments[1]instanceof uc){var t=arguments[0],r=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),o=r.getCoordinate(),a=0;a<i.length-1;a++){var s=su.distancePointLine(o,i[a],i[a+1]);if(s<e._minDistance){e._minDistance=s;var l=new Lf(i[a],i[a+1]).closestPoint(o);n[0]=new jh(t,a,l),n[1]=new jh(r,0,o)}if(e._minDistance<=e._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof sc&&arguments[1]instanceof sc){var u=arguments[0],c=arguments[1],f=arguments[2];if(u.getEnvelopeInternal().distance(c.getEnvelopeInternal())>this._minDistance)return null;for(var h=u.getCoordinates(),d=c.getCoordinates(),p=0;p<h.length-1;p++)for(var y=0;y<d.length-1;y++){var g=su.distanceLineLine(h[p],h[p+1],d[y],d[y+1]);if(g<e._minDistance){e._minDistance=g;var v=new Lf(h[p],h[p+1]),m=new Lf(d[y],d[y+1]),_=v.closestPoints(m);f[0]=new jh(u,p,_[0]),f[1]=new jh(c,y,_[1])}if(e._minDistance<=e._terminateDistance)return null}}},Jh.prototype.computeMinDistancePoints=function(e,t,r){for(var n=this,i=0;i<e.size();i++)for(var o=e.get(i),a=0;a<t.size();a++){var s=t.get(a),l=o.getCoordinate().distance(s.getCoordinate());if(l<n._minDistance&&(n._minDistance=l,r[0]=new jh(o,0,o.getCoordinate()),r[1]=new jh(s,0,s.getCoordinate())),n._minDistance<=n._terminateDistance)return null}},Jh.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new vl("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Jh.prototype.computeMinDistanceLines=function(e,t,r){for(var n=this,i=0;i<e.size();i++)for(var o=e.get(i),a=0;a<t.size();a++){var s=t.get(a);if(n.computeMinDistance(o,s,r),n._minDistance<=n._terminateDistance)return null}},Jh.prototype.interfaces_=function(){return[]},Jh.prototype.getClass=function(){return Jh},Jh.distance=function(e,t){return new Jh(e,t).distance()},Jh.isWithinDistance=function(e,t,r){return new Jh(e,t,r).distance()<=r},Jh.nearestPoints=function(e,t){return new Jh(e,t).nearestPoints()};var zh=function(){this._pt=[new kl,new kl],this._distance=ml.NaN,this._isNull=!0};zh.prototype.getCoordinates=function(){return this._pt},zh.prototype.getCoordinate=function(e){return this._pt[e]},zh.prototype.setMinimum=function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var t=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(t,r),null;var n=t.distance(r);n<this._distance&&this.initialize(t,r,n)}},zh.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],t=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(t),this._distance=e.distance(t),this._isNull=!1}else if(3===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(n),this._distance=i,this._isNull=!1}},zh.prototype.toString=function(){return Ql.toLineString(this._pt[0],this._pt[1])},zh.prototype.getDistance=function(){return this._distance},zh.prototype.setMaximum=function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var t=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(t,r),null;var n=t.distance(r);n>this._distance&&this.initialize(t,r,n)}},zh.prototype.interfaces_=function(){return[]},zh.prototype.getClass=function(){return zh};var Wh=function(){};Wh.prototype.interfaces_=function(){return[]},Wh.prototype.getClass=function(){return Wh},Wh.computeDistance=function(){if(arguments[2]instanceof zh&&arguments[0]instanceof sc&&arguments[1]instanceof kl)for(var e=arguments[0],t=arguments[1],r=arguments[2],n=new Lf,i=e.getCoordinates(),o=0;o<i.length-1;o++){n.setCoordinates(i[o],i[o+1]);var a=n.closestPoint(t);r.setMinimum(a,t)}else if(arguments[2]instanceof zh&&arguments[0]instanceof fc&&arguments[1]instanceof kl){var s=arguments[0],l=arguments[1],u=arguments[2];Wh.computeDistance(s.getExteriorRing(),l,u);for(var c=0;c<s.getNumInteriorRing();c++)Wh.computeDistance(s.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof zh&&arguments[0]instanceof cu&&arguments[1]instanceof kl){var f=arguments[0],h=arguments[1],d=arguments[2];if(f instanceof sc)Wh.computeDistance(f,h,d);else if(f instanceof fc)Wh.computeDistance(f,h,d);else if(f instanceof $u)for(var p=f,y=0;y<p.getNumGeometries();y++){var g=p.getGeometryN(y);Wh.computeDistance(g,h,d)}else d.setMinimum(f.getCoordinate(),h)}else if(arguments[2]instanceof zh&&arguments[0]instanceof Lf&&arguments[1]instanceof kl){var v=arguments[0],m=arguments[1],_=arguments[2],S=v.closestPoint(m);_.setMinimum(S,m)}};var Hh=function(){this._g0=null,this._g1=null,this._ptDist=new zh,this._densifyFrac=0;var e=arguments[0],t=arguments[1];this._g0=e,this._g1=t},Xh={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Hh.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Hh.prototype.setDensifyFraction=function(e){if(e>1||e<=0)throw new vl("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=e},Hh.prototype.compute=function(e,t){this.computeOrientedDistance(e,t,this._ptDist),this.computeOrientedDistance(t,e,this._ptDist)},Hh.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Hh.prototype.computeOrientedDistance=function(e,t,r){var n=new Yh(t);if(e.apply(n),r.setMaximum(n.getMaxPointDistance()),this._densifyFrac>0){var i=new Zh(t,this._densifyFrac);e.apply(i),r.setMaximum(i.getMaxPointDistance())}},Hh.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Hh.prototype.interfaces_=function(){return[]},Hh.prototype.getClass=function(){return Hh},Hh.distance=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return new Hh(e,t).distance()}if(3===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[2],o=new Hh(r,n);return o.setDensifyFraction(i),o.distance()}},Xh.MaxPointDistanceFilter.get=function(){return Yh},Xh.MaxDensifiedByFractionDistanceFilter.get=function(){return Zh},Object.defineProperties(Hh,Xh);var Yh=function(){this._maxPtDist=new zh,this._minPtDist=new zh,this._euclideanDist=new Wh,this._geom=null;var e=arguments[0];this._geom=e};Yh.prototype.filter=function(e){this._minPtDist.initialize(),Wh.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Yh.prototype.getMaxPointDistance=function(){return this._maxPtDist},Yh.prototype.interfaces_=function(){return[du]},Yh.prototype.getClass=function(){return Yh};var Zh=function(){this._maxPtDist=new zh,this._minPtDist=new zh,this._geom=null,this._numSubSegs=0;var e=arguments[0],t=arguments[1];this._geom=e,this._numSubSegs=Math.trunc(Math.round(1/t))};Zh.prototype.filter=function(e,t){var r=this;if(0===t)return null;for(var n=e.getCoordinate(t-1),i=e.getCoordinate(t),o=(i.x-n.x)/this._numSubSegs,a=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var l=n.x+s*o,u=n.y+s*a,c=new kl(l,u);r._minPtDist.initialize(),Wh.computeDistance(r._geom,c,r._minPtDist),r._maxPtDist.setMaximum(r._minPtDist)}},Zh.prototype.isDone=function(){return!1},Zh.prototype.isGeometryChanged=function(){return!1},Zh.prototype.getMaxPointDistance=function(){return this._maxPtDist},Zh.prototype.interfaces_=function(){return[Qu]},Zh.prototype.getClass=function(){return Zh};var Kh=function(e,t,r){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._bufDistance=t||null,this._result=r||null},Qh={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Kh.prototype.checkMaximumDistance=function(e,t,r){var n=new Hh(t,e);if(n.setDensifyFraction(.25),this._maxDistanceFound=n.orientedDistance(),this._maxDistanceFound>r){this._isValid=!1;var i=n.getCoordinates();this._errorLocation=i[1],this._errorIndicator=e.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Ql.toLineString(i[0],i[1])+")"}},Kh.prototype.isValid=function(){var e=Math.abs(this._bufDistance),t=Kh.MAX_DISTANCE_DIFF_FRAC*e;return this._minValidDistance=e-t,this._maxValidDistance=e+t,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Kh.VERBOSE&&Jl.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Kh.prototype.checkNegativeValid=function(){if(!(this._input instanceof fc||this._input instanceof pc||this._input instanceof $u))return null;var e=this.getPolygonLines(this._input);if(this.checkMinimumDistance(e,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(e,this._result,this._maxValidDistance)},Kh.prototype.getErrorIndicator=function(){return this._errorIndicator},Kh.prototype.checkMinimumDistance=function(e,t,r){var n=new Jh(e,t,r);if(this._minDistanceFound=n.distance(),this._minDistanceFound<r){this._isValid=!1;var i=n.nearestPoints();this._errorLocation=n.nearestPoints()[1],this._errorIndicator=e.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Ql.toLineString(i[0],i[1])+" )"}},Kh.prototype.checkPositiveValid=function(){var e=this._result.getBoundary();if(this.checkMinimumDistance(this._input,e,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,e,this._maxValidDistance)},Kh.prototype.getErrorLocation=function(){return this._errorLocation},Kh.prototype.getPolygonLines=function(e){for(var t=new Mu,r=new Fh(t),n=Ah.getPolygons(e).iterator();n.hasNext();)n.next().apply(r);return e.getFactory().buildGeometry(t)},Kh.prototype.getErrorMessage=function(){return this._errMsg},Kh.prototype.interfaces_=function(){return[]},Kh.prototype.getClass=function(){return Kh},Qh.VERBOSE.get=function(){return!1},Qh.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Kh,Qh);var $h=function(e,t,r){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._distance=t||null,this._result=r||null},ed={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};$h.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},$h.prototype.checkEnvelope=function(){if(this._distance<0)return null;var e=this._distance*$h.MAX_ENV_DIFF_FRAC;0===e&&(e=.001);var t=new Wl(this._input.getEnvelopeInternal());t.expandBy(this._distance);var r=new Wl(this._result.getEnvelopeInternal());r.expandBy(e),r.contains(t)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(r)),this.report("Envelope")},$h.prototype.checkDistance=function(){var e=new Kh(this._input,this._distance,this._result);e.isValid()||(this._isValid=!1,this._errorMsg=e.getErrorMessage(),this._errorLocation=e.getErrorLocation(),this._errorIndicator=e.getErrorIndicator()),this.report("Distance")},$h.prototype.checkArea=function(){var e=this._input.getArea(),t=this._result.getArea();this._distance>0&&e>t&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&e<t&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},$h.prototype.checkPolygonal=function(){this._result instanceof fc||this._result instanceof pc||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},$h.prototype.getErrorIndicator=function(){return this._errorIndicator},$h.prototype.getErrorLocation=function(){return this._errorLocation},$h.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},$h.prototype.report=function(e){if(!$h.VERBOSE)return null;Jl.out.println("Check "+e+": "+(this._isValid?"passed":"FAILED"))},$h.prototype.getErrorMessage=function(){return this._errorMsg},$h.prototype.interfaces_=function(){return[]},$h.prototype.getClass=function(){return $h},$h.isValidMsg=function(e,t,r){var n=new $h(e,t,r);return n.isValid()?null:n.getErrorMessage()},$h.isValid=function(e,t,r){return!!new $h(e,t,r).isValid()},ed.VERBOSE.get=function(){return!1},ed.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties($h,ed);var td=function(){this._pts=null,this._data=null;var e=arguments[0],t=arguments[1];this._pts=e,this._data=t};td.prototype.getCoordinates=function(){return this._pts},td.prototype.size=function(){return this._pts.length},td.prototype.getCoordinate=function(e){return this._pts[e]},td.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},td.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:Mf.octant(this.getCoordinate(e),this.getCoordinate(e+1))},td.prototype.setData=function(e){this._data=e},td.prototype.getData=function(){return this._data},td.prototype.toString=function(){return Ql.toLineString(new Sc(this._pts))},td.prototype.interfaces_=function(){return[Ef]},td.prototype.getClass=function(){return td};var rd=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Mu,this._intersectionCount=0,this._keepIntersections=!0;var e=arguments[0];this._li=e,this._interiorIntersection=null};rd.prototype.getInteriorIntersection=function(){return this._interiorIntersection},rd.prototype.setCheckEndSegmentsOnly=function(e){this._isCheckEndSegmentsOnly=e},rd.prototype.getIntersectionSegments=function(){return this._intSegments},rd.prototype.count=function(){return this._intersectionCount},rd.prototype.getIntersections=function(){return this._intersections},rd.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e},rd.prototype.setKeepIntersections=function(e){this._keepIntersections=e},rd.prototype.processIntersections=function(e,t,r,n){if(!this._findAllIntersections&&this.hasIntersection())return null;if(e===r&&t===n)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(e,t)&&!this.isEndSegment(r,n))return null;var i=e.getCoordinates()[t],o=e.getCoordinates()[t+1],a=r.getCoordinates()[n],s=r.getCoordinates()[n+1];this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=i,this._intSegments[1]=o,this._intSegments[2]=a,this._intSegments[3]=s,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},rd.prototype.isEndSegment=function(e,t){return 0===t||t>=e.size()-2},rd.prototype.hasIntersection=function(){return null!==this._interiorIntersection},rd.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},rd.prototype.interfaces_=function(){return[lh]},rd.prototype.getClass=function(){return rd},rd.createAllIntersectionsFinder=function(e){var t=new rd(e);return t.setFindAllIntersections(!0),t},rd.createAnyIntersectionFinder=function(e){return new rd(e)},rd.createIntersectionCounter=function(e){var t=new rd(e);return t.setFindAllIntersections(!0),t.setKeepIntersections(!1),t};var nd=function(){this._li=new iu,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var e=arguments[0];this._segStrings=e};nd.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},nd.prototype.getIntersections=function(){return this._segInt.getIntersections()},nd.prototype.isValid=function(){return this.execute(),this._isValid},nd.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e},nd.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new rd(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var e=new Gf;if(e.setSegmentIntersector(this._segInt),e.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},nd.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new qc(this.getErrorMessage(),this._segInt.getInteriorIntersection())},nd.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var e=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Ql.toLineString(e[0],e[1])+" and "+Ql.toLineString(e[2],e[3])},nd.prototype.interfaces_=function(){return[]},nd.prototype.getClass=function(){return nd},nd.computeIntersections=function(e){var t=new nd(e);return t.setFindAllIntersections(!0),t.isValid(),t.getIntersections()};var id=function e(){this._nv=null;var t=arguments[0];this._nv=new nd(e.toSegmentStrings(t))};id.prototype.checkValid=function(){this._nv.checkValid()},id.prototype.interfaces_=function(){return[]},id.prototype.getClass=function(){return id},id.toSegmentStrings=function(e){for(var t=new Mu,r=e.iterator();r.hasNext();){var n=r.next();t.add(new td(n.getCoordinates(),n))}return t},id.checkValid=function(e){new id(e).checkValid()};var od=function(e){this._mapOp=e};od.prototype.map=function(e){for(var t=new Mu,r=0;r<e.getNumGeometries();r++){var n=this._mapOp.map(e.getGeometryN(r));n.isEmpty()||t.add(n)}return e.getFactory().createGeometryCollection(Lc.toGeometryArray(t))},od.prototype.interfaces_=function(){return[]},od.prototype.getClass=function(){return od},od.map=function(e,t){return new od(t).map(e)};var ad=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Mu,this._resultLineList=new Mu;var e=arguments[0],t=arguments[1],r=arguments[2];this._op=e,this._geometryFactory=t,this._ptLocator=r};ad.prototype.collectLines=function(e){for(var t=this,r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var n=r.next();t.collectLineEdge(n,e,t._lineEdgesList),t.collectBoundaryTouchEdge(n,e,t._lineEdgesList)}},ad.prototype.labelIsolatedLine=function(e,t){var r=this._ptLocator.locate(e.getCoordinate(),this._op.getArgGeometry(t));e.getLabel().setLocation(t,r)},ad.prototype.build=function(e){return this.findCoveredLineEdges(),this.collectLines(e),this.buildLines(e),this._resultLineList},ad.prototype.collectLineEdge=function(e,t,r){var n=e.getLabel(),i=e.getEdge();e.isLineEdge()&&(e.isVisited()||!jd.isResultOfOp(n,t)||i.isCovered()||(r.add(i),e.setVisitedEdge(!0)))},ad.prototype.findCoveredLineEdges=function(){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();)e.next().getEdges().findCoveredLineEdges();for(var t=this._op.getGraph().getEdgeEnds().iterator();t.hasNext();){var r=t.next(),n=r.getEdge();if(r.isLineEdge()&&!n.isCoveredSet()){var i=this._op.isCoveredByA(r.getCoordinate());n.setCovered(i)}}},ad.prototype.labelIsolatedLines=function(e){for(var t=e.iterator();t.hasNext();){var r=t.next(),n=r.getLabel();r.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(r,0):this.labelIsolatedLine(r,1))}},ad.prototype.buildLines=function(e){for(var t=this._lineEdgesList.iterator();t.hasNext();){var r=t.next(),n=this._geometryFactory.createLineString(r.getCoordinates());this._resultLineList.add(n),r.setInResult(!0)}},ad.prototype.collectBoundaryTouchEdge=function(e,t,r){var n=e.getLabel();return e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult()?null:(tu.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),void(jd.isResultOfOp(n,t)&&t===jd.INTERSECTION&&(r.add(e.getEdge()),e.setVisitedEdge(!0))))},ad.prototype.interfaces_=function(){return[]},ad.prototype.getClass=function(){return ad};var sd=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Mu;var e=arguments[0],t=arguments[1];this._op=e,this._geometryFactory=t};sd.prototype.filterCoveredNodeToPoint=function(e){var t=e.getCoordinate();if(!this._op.isCoveredByLA(t)){var r=this._geometryFactory.createPoint(t);this._resultPointList.add(r)}},sd.prototype.extractNonCoveredResultNodes=function(e){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();){var r=t.next();if(!(r.isInResult()||r.isIncidentEdgeInResult()||0!==r.getEdges().getDegree()&&e!==jd.INTERSECTION)){var n=r.getLabel();jd.isResultOfOp(n,e)&&this.filterCoveredNodeToPoint(r)}}},sd.prototype.build=function(e){return this.extractNonCoveredResultNodes(e),this._resultPointList},sd.prototype.interfaces_=function(){return[]},sd.prototype.getClass=function(){return sd};var ld=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};ld.prototype.transformPoint=function(e,t){return this._factory.createPoint(this.transformCoordinates(e.getCoordinateSequence(),e))},ld.prototype.transformPolygon=function(e,t){var r=!0,n=this.transformLinearRing(e.getExteriorRing(),e);null!==n&&n instanceof dc&&!n.isEmpty()||(r=!1);for(var i=new Mu,o=0;o<e.getNumInteriorRing();o++){var a=this.transformLinearRing(e.getInteriorRingN(o),e);null===a||a.isEmpty()||(a instanceof dc||(r=!1),i.add(a))}if(r)return this._factory.createPolygon(n,i.toArray([]));var s=new Mu;return null!==n&&s.add(n),s.addAll(i),this._factory.buildGeometry(s)},ld.prototype.createCoordinateSequence=function(e){return this._factory.getCoordinateSequenceFactory().create(e)},ld.prototype.getInputGeometry=function(){return this._inputGeom},ld.prototype.transformMultiLineString=function(e,t){for(var r=new Mu,n=0;n<e.getNumGeometries();n++){var i=this.transformLineString(e.getGeometryN(n),e);null!==i&&(i.isEmpty()||r.add(i))}return this._factory.buildGeometry(r)},ld.prototype.transformCoordinates=function(e,t){return this.copy(e)},ld.prototype.transformLineString=function(e,t){return this._factory.createLineString(this.transformCoordinates(e.getCoordinateSequence(),e))},ld.prototype.transformMultiPoint=function(e,t){for(var r=new Mu,n=0;n<e.getNumGeometries();n++){var i=this.transformPoint(e.getGeometryN(n),e);null!==i&&(i.isEmpty()||r.add(i))}return this._factory.buildGeometry(r)},ld.prototype.transformMultiPolygon=function(e,t){for(var r=new Mu,n=0;n<e.getNumGeometries();n++){var i=this.transformPolygon(e.getGeometryN(n),e);null!==i&&(i.isEmpty()||r.add(i))}return this._factory.buildGeometry(r)},ld.prototype.copy=function(e){return e.copy()},ld.prototype.transformGeometryCollection=function(e,t){for(var r=new Mu,n=0;n<e.getNumGeometries();n++){var i=this.transform(e.getGeometryN(n));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||r.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Lc.toGeometryArray(r)):this._factory.buildGeometry(r)},ld.prototype.transform=function(e){if(this._inputGeom=e,this._factory=e.getFactory(),e instanceof uc)return this.transformPoint(e,null);if(e instanceof hc)return this.transformMultiPoint(e,null);if(e instanceof dc)return this.transformLinearRing(e,null);if(e instanceof sc)return this.transformLineString(e,null);if(e instanceof ec)return this.transformMultiLineString(e,null);if(e instanceof fc)return this.transformPolygon(e,null);if(e instanceof pc)return this.transformMultiPolygon(e,null);if(e instanceof $u)return this.transformGeometryCollection(e,null);throw new vl("Unknown Geometry subtype: "+e.getClass().getName())},ld.prototype.transformLinearRing=function(e,t){var r=this.transformCoordinates(e.getCoordinateSequence(),e);if(null===r)return this._factory.createLinearRing(null);var n=r.size();return n>0&&n<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)},ld.prototype.interfaces_=function(){return[]},ld.prototype.getClass=function(){return ld};var ud=function e(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Lf,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof sc&&"number"==typeof arguments[1]){var t=arguments[0],r=arguments[1];e.call(this,t.getCoordinates(),r)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this._srcPts=n,this._isClosed=e.isClosed(n),this._snapTolerance=i}};ud.prototype.snapVertices=function(e,t){for(var r=this._isClosed?e.size()-1:e.size(),n=0;n<r;n++){var i=e.get(n),o=this.findSnapForVertex(i,t);null!==o&&(e.set(n,new kl(o)),0===n&&this._isClosed&&e.set(e.size()-1,new kl(o)))}},ud.prototype.findSnapForVertex=function(e,t){for(var r=0;r<t.length;r++){if(e.equals2D(t[r]))return null;if(e.distance(t[r])<this._snapTolerance)return t[r]}return null},ud.prototype.snapTo=function(e){var t=new Iu(this._srcPts);return this.snapVertices(t,e),this.snapSegments(t,e),t.toCoordinateArray()},ud.prototype.snapSegments=function(e,t){if(0===t.length)return null;var r=t.length;t[0].equals2D(t[t.length-1])&&(r=t.length-1);for(var n=0;n<r;n++){var i=t[n],o=this.findSegmentIndexToSnap(i,e);o>=0&&e.add(o+1,new kl(i),!1)}},ud.prototype.findSegmentIndexToSnap=function(e,t){for(var r=this,n=ml.MAX_VALUE,i=-1,o=0;o<t.size()-1;o++){if(r._seg.p0=t.get(o),r._seg.p1=t.get(o+1),r._seg.p0.equals2D(e)||r._seg.p1.equals2D(e)){if(r._allowSnappingToSourceVertices)continue;return-1}var a=r._seg.distance(e);a<r._snapTolerance&&a<n&&(n=a,i=o)}return i},ud.prototype.setAllowSnappingToSourceVertices=function(e){this._allowSnappingToSourceVertices=e},ud.prototype.interfaces_=function(){return[]},ud.prototype.getClass=function(){return ud},ud.isClosed=function(e){return!(e.length<=1)&&e[0].equals2D(e[e.length-1])};var cd=function(e){this._srcGeom=e||null},fd={SNAP_PRECISION_FACTOR:{configurable:!0}};cd.prototype.snapTo=function(e,t){var r=this.extractTargetCoordinates(e);return new hd(t,r).transform(this._srcGeom)},cd.prototype.snapToSelf=function(e,t){var r=this.extractTargetCoordinates(this._srcGeom),n=new hd(e,r,!0).transform(this._srcGeom),i=n;return t&&Pl(i,cc)&&(i=n.buffer(0)),i},cd.prototype.computeSnapTolerance=function(e){return this.computeMinimumSegmentLength(e)/10},cd.prototype.extractTargetCoordinates=function(e){for(var t=new Wu,r=e.getCoordinates(),n=0;n<r.length;n++)t.add(r[n]);return t.toArray(new Array(0).fill(null))},cd.prototype.computeMinimumSegmentLength=function(e){for(var t=ml.MAX_VALUE,r=0;r<e.length-1;r++){var n=e[r].distance(e[r+1]);n<t&&(t=n)}return t},cd.prototype.interfaces_=function(){return[]},cd.prototype.getClass=function(){return cd},cd.snap=function(e,t,r){var n=new Array(2).fill(null),i=new cd(e);n[0]=i.snapTo(t,r);var o=new cd(t);return n[1]=o.snapTo(n[0],r),n},cd.computeOverlaySnapTolerance=function(){if(1===arguments.length){var e=arguments[0],t=cd.computeSizeBasedSnapTolerance(e),r=e.getPrecisionModel();if(r.getType()===Mc.FIXED){var n=1/r.getScale()*2/1.415;n>t&&(t=n)}return t}if(2===arguments.length){var i=arguments[0],o=arguments[1];return Math.min(cd.computeOverlaySnapTolerance(i),cd.computeOverlaySnapTolerance(o))}},cd.computeSizeBasedSnapTolerance=function(e){var t=e.getEnvelopeInternal();return Math.min(t.getHeight(),t.getWidth())*cd.SNAP_PRECISION_FACTOR},cd.snapToSelf=function(e,t,r){return new cd(e).snapToSelf(t,r)},fd.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(cd,fd);var hd=function(e){function t(t,r,n){e.call(this),this._snapTolerance=t||null,this._snapPts=r||null,this._isSelfSnap=void 0!==n&&n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.snapLine=function(e,t){var r=new ud(e,this._snapTolerance);return r.setAllowSnappingToSourceVertices(this._isSelfSnap),r.snapTo(t)},t.prototype.transformCoordinates=function(e,t){var r=e.toCoordinateArray(),n=this.snapLine(r,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(n)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ld),dd=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};dd.prototype.getCommon=function(){return ml.longBitsToDouble(this._commonBits)},dd.prototype.add=function(e){var t=ml.doubleToLongBits(e);return this._isFirst?(this._commonBits=t,this._commonSignExp=dd.signExpBits(this._commonBits),this._isFirst=!1,null):dd.signExpBits(t)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=dd.numCommonMostSigMantissaBits(this._commonBits,t),void(this._commonBits=dd.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},dd.prototype.toString=function(){if(1===arguments.length){var e=arguments[0],t=ml.longBitsToDouble(e),r="0000000000000000000000000000000000000000000000000000000000000000"+ml.toBinaryString(e),n=r.substring(r.length-64);return n.substring(0,1)+"  "+n.substring(1,12)+"(exp) "+n.substring(12)+" [ "+t+" ]"}},dd.prototype.interfaces_=function(){return[]},dd.prototype.getClass=function(){return dd},dd.getBit=function(e,t){return 0!=(e&1<<t)?1:0},dd.signExpBits=function(e){return e>>52},dd.zeroLowerBits=function(e,t){return e&~((1<<t)-1)},dd.numCommonMostSigMantissaBits=function(e,t){for(var r=0,n=52;n>=0;n--){if(dd.getBit(e,n)!==dd.getBit(t,n))return r;r++}return 52};var pd=function(){this._commonCoord=null,this._ccFilter=new gd},yd={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};pd.prototype.addCommonBits=function(e){var t=new vd(this._commonCoord);e.apply(t),e.geometryChanged()},pd.prototype.removeCommonBits=function(e){if(0===this._commonCoord.x&&0===this._commonCoord.y)return e;var t=new kl(this._commonCoord);t.x=-t.x,t.y=-t.y;var r=new vd(t);return e.apply(r),e.geometryChanged(),e},pd.prototype.getCommonCoordinate=function(){return this._commonCoord},pd.prototype.add=function(e){e.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},pd.prototype.interfaces_=function(){return[]},pd.prototype.getClass=function(){return pd},yd.CommonCoordinateFilter.get=function(){return gd},yd.Translater.get=function(){return vd},Object.defineProperties(pd,yd);var gd=function(){this._commonBitsX=new dd,this._commonBitsY=new dd};gd.prototype.filter=function(e){this._commonBitsX.add(e.x),this._commonBitsY.add(e.y)},gd.prototype.getCommonCoordinate=function(){return new kl(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},gd.prototype.interfaces_=function(){return[du]},gd.prototype.getClass=function(){return gd};var vd=function(){this.trans=null;var e=arguments[0];this.trans=e};vd.prototype.filter=function(e,t){var r=e.getOrdinate(t,0)+this.trans.x,n=e.getOrdinate(t,1)+this.trans.y;e.setOrdinate(t,0,r),e.setOrdinate(t,1,n)},vd.prototype.isDone=function(){return!1},vd.prototype.isGeometryChanged=function(){return!0},vd.prototype.interfaces_=function(){return[Qu]},vd.prototype.getClass=function(){return vd};var md=function(e,t){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=e,this._geom[1]=t,this.computeSnapTolerance()};md.prototype.selfSnap=function(e){return new cd(e).snapTo(e,this._snapTolerance)},md.prototype.removeCommonBits=function(e){this._cbr=new pd,this._cbr.add(e[0]),this._cbr.add(e[1]);var t=new Array(2).fill(null);return t[0]=this._cbr.removeCommonBits(e[0].copy()),t[1]=this._cbr.removeCommonBits(e[1].copy()),t},md.prototype.prepareResult=function(e){return this._cbr.addCommonBits(e),e},md.prototype.getResultGeometry=function(e){var t=this.snap(this._geom),r=jd.overlayOp(t[0],t[1],e);return this.prepareResult(r)},md.prototype.checkValid=function(e){e.isValid()||Jl.out.println("Snapped geometry is invalid")},md.prototype.computeSnapTolerance=function(){this._snapTolerance=cd.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},md.prototype.snap=function(e){var t=this.removeCommonBits(e);return cd.snap(t[0],t[1],this._snapTolerance)},md.prototype.interfaces_=function(){return[]},md.prototype.getClass=function(){return md},md.overlayOp=function(e,t,r){return new md(e,t).getResultGeometry(r)},md.union=function(e,t){return md.overlayOp(e,t,jd.UNION)},md.intersection=function(e,t){return md.overlayOp(e,t,jd.INTERSECTION)},md.symDifference=function(e,t){return md.overlayOp(e,t,jd.SYMDIFFERENCE)},md.difference=function(e,t){return md.overlayOp(e,t,jd.DIFFERENCE)};var _d=function(e,t){this._geom=new Array(2).fill(null),this._geom[0]=e,this._geom[1]=t};_d.prototype.getResultGeometry=function(e){var t=null,r=!1,n=null;try{t=jd.overlayOp(this._geom[0],this._geom[1],e),r=!0}catch(e){if(!(e instanceof $l))throw e;n=e}if(!r)try{t=md.overlayOp(this._geom[0],this._geom[1],e)}catch(e){throw e instanceof $l?n:e}return t},_d.prototype.interfaces_=function(){return[]},_d.prototype.getClass=function(){return _d},_d.overlayOp=function(e,t,r){return new _d(e,t).getResultGeometry(r)},_d.union=function(e,t){return _d.overlayOp(e,t,jd.UNION)},_d.intersection=function(e,t){return _d.overlayOp(e,t,jd.INTERSECTION)},_d.symDifference=function(e,t){return _d.overlayOp(e,t,jd.SYMDIFFERENCE)},_d.difference=function(e,t){return _d.overlayOp(e,t,jd.DIFFERENCE)};var Sd=function(){this.mce=null,this.chainIndex=null;var e=arguments[0],t=arguments[1];this.mce=e,this.chainIndex=t};Sd.prototype.computeIntersections=function(e,t){this.mce.computeIntersectsForChain(this.chainIndex,e.mce,e.chainIndex,t)},Sd.prototype.interfaces_=function(){return[]},Sd.prototype.getClass=function(){return Sd};var xd=function e(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var t=arguments[0],r=arguments[1];this._eventType=e.DELETE,this._xValue=t,this._insertEvent=r}else if(3===arguments.length){var n=arguments[0],i=arguments[1],o=arguments[2];this._eventType=e.INSERT,this._label=n,this._xValue=i,this._obj=o}},bd={INSERT:{configurable:!0},DELETE:{configurable:!0}};xd.prototype.isDelete=function(){return this._eventType===xd.DELETE},xd.prototype.setDeleteEventIndex=function(e){this._deleteEventIndex=e},xd.prototype.getObject=function(){return this._obj},xd.prototype.compareTo=function(e){var t=e;return this._xValue<t._xValue?-1:this._xValue>t._xValue?1:this._eventType<t._eventType?-1:this._eventType>t._eventType?1:0},xd.prototype.getInsertEvent=function(){return this._insertEvent},xd.prototype.isInsert=function(){return this._eventType===xd.INSERT},xd.prototype.isSameLabel=function(e){return null!==this._label&&this._label===e._label},xd.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},xd.prototype.interfaces_=function(){return[Sl]},xd.prototype.getClass=function(){return xd},bd.INSERT.get=function(){return 1},bd.DELETE.get=function(){return 2},Object.defineProperties(xd,bd);var wd=function(){};wd.prototype.interfaces_=function(){return[]},wd.prototype.getClass=function(){return wd};var kd=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var e=arguments[0],t=arguments[1],r=arguments[2];this._li=e,this._includeProper=t,this._recordIsolated=r};kd.prototype.isTrivialIntersection=function(e,t,r,n){if(e===r&&1===this._li.getIntersectionNum()){if(kd.isAdjacentSegments(t,n))return!0;if(e.isClosed()){var i=e.getNumPoints()-1;if(0===t&&n===i||0===n&&t===i)return!0}}return!1},kd.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},kd.prototype.setIsDoneIfProperInt=function(e){this._isDoneWhenProperInt=e},kd.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},kd.prototype.isBoundaryPointInternal=function(e,t){for(var r=t.iterator();r.hasNext();){var n=r.next().getCoordinate();if(e.isIntersection(n))return!0}return!1},kd.prototype.hasProperIntersection=function(){return this._hasProper},kd.prototype.hasIntersection=function(){return this._hasIntersection},kd.prototype.isDone=function(){return this._isDone},kd.prototype.isBoundaryPoint=function(e,t){return!(null===t||!this.isBoundaryPointInternal(e,t[0])&&!this.isBoundaryPointInternal(e,t[1]))},kd.prototype.setBoundaryNodes=function(e,t){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=e,this._bdyNodes[1]=t},kd.prototype.addIntersections=function(e,t,r,n){if(e===r&&t===n)return null;this.numTests++;var i=e.getCoordinates()[t],o=e.getCoordinates()[t+1],a=r.getCoordinates()[n],s=r.getCoordinates()[n+1];this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&(this._recordIsolated&&(e.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(e,t,r,n)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(e.addIntersections(this._li,t,0),r.addIntersections(this._li,n,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},kd.prototype.interfaces_=function(){return[]},kd.prototype.getClass=function(){return kd},kd.isAdjacentSegments=function(e,t){return 1===Math.abs(e-t)};var Md=function(e){function t(){e.call(this),this.events=new Mu,this.nOverlaps=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.prepareEvents=function(){pf.sort(this.events);for(var e=0;e<this.events.size();e++){var t=this.events.get(e);t.isDelete()&&t.getInsertEvent().setDeleteEventIndex(e)}},t.prototype.computeIntersections=function(){if(1===arguments.length){var e=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var t=0;t<this.events.size();t++){var r=this.events.get(t);if(r.isInsert()&&this.processOverlaps(t,r.getDeleteEventIndex(),r,e),e.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof kd&&Pl(arguments[0],wu)&&Pl(arguments[1],wu)){var n=arguments[0],i=arguments[1],o=arguments[2];this.addEdges(n,n),this.addEdges(i,i),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&Pl(arguments[0],wu)&&arguments[1]instanceof kd){var a=arguments[0],s=arguments[1];arguments[2]?this.addEdges(a,null):this.addEdges(a),this.computeIntersections(s)}},t.prototype.addEdge=function(e,t){for(var r=e.getMonotoneChainEdge(),n=r.getStartIndexes(),i=0;i<n.length-1;i++){var o=new Sd(r,i),a=new xd(t,r.getMinX(i),o);this.events.add(a),this.events.add(new xd(r.getMaxX(i),a))}},t.prototype.processOverlaps=function(e,t,r,n){for(var i=r.getObject(),o=e;o<t;o++){var a=this.events.get(o);if(a.isInsert()){var s=a.getObject();r.isSameLabel(a)||(i.computeIntersections(s,n),this.nOverlaps++)}}},t.prototype.addEdges=function(){if(1===arguments.length)for(var e=arguments[0].iterator();e.hasNext();){var t=e.next();this.addEdge(t,t)}else if(2===arguments.length)for(var r=arguments[0],n=arguments[1],i=r.iterator();i.hasNext();){var o=i.next();this.addEdge(o,n)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(wd),Ed=function(){this._min=ml.POSITIVE_INFINITY,this._max=ml.NEGATIVE_INFINITY},Id={NodeComparator:{configurable:!0}};Ed.prototype.getMin=function(){return this._min},Ed.prototype.intersects=function(e,t){return!(this._min>t||this._max<e)},Ed.prototype.getMax=function(){return this._max},Ed.prototype.toString=function(){return Ql.toLineString(new kl(this._min,0),new kl(this._max,0))},Ed.prototype.interfaces_=function(){return[]},Ed.prototype.getClass=function(){return Ed},Id.NodeComparator.get=function(){return Td},Object.defineProperties(Ed,Id);var Td=function(){};Td.prototype.compare=function(e,t){var r=e,n=t,i=(r._min+r._max)/2,o=(n._min+n._max)/2;return i<o?-1:i>o?1:0},Td.prototype.interfaces_=function(){return[bl]},Td.prototype.getClass=function(){return Td};var Ld=function(e){function t(){e.call(this),this._item=null;var t=arguments[0],r=arguments[1],n=arguments[2];this._min=t,this._max=r,this._item=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.query=function(e,t,r){if(!this.intersects(e,t))return null;r.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ed),Pd=function(e){function t(){e.call(this),this._node1=null,this._node2=null;var t=arguments[0],r=arguments[1];this._node1=t,this._node2=r,this.buildExtent(this._node1,this._node2)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildExtent=function(e,t){this._min=Math.min(e._min,t._min),this._max=Math.max(e._max,t._max)},t.prototype.query=function(e,t,r){if(!this.intersects(e,t))return null;null!==this._node1&&this._node1.query(e,t,r),null!==this._node2&&this._node2.query(e,t,r)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ed),Cd=function(){this._leaves=new Mu,this._root=null,this._level=0};Cd.prototype.buildTree=function(){pf.sort(this._leaves,new Ed.NodeComparator);for(var e=this._leaves,t=null,r=new Mu;;){if(this.buildLevel(e,r),1===r.size())return r.get(0);t=e,e=r,r=t}},Cd.prototype.insert=function(e,t,r){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Ld(e,t,r))},Cd.prototype.query=function(e,t,r){this.init(),this._root.query(e,t,r)},Cd.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},Cd.prototype.printNode=function(e){Jl.out.println(Ql.toLineString(new kl(e._min,this._level),new kl(e._max,this._level)))},Cd.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},Cd.prototype.buildLevel=function(e,t){this._level++,t.clear();for(var r=0;r<e.size();r+=2){var n=e.get(r);if(null===(r+1<e.size()?e.get(r):null))t.add(n);else{var i=new Pd(e.get(r),e.get(r+1));t.add(i)}}},Cd.prototype.interfaces_=function(){return[]},Cd.prototype.getClass=function(){return Cd};var Nd=function(){this._items=new Mu};Nd.prototype.visitItem=function(e){this._items.add(e)},Nd.prototype.getItems=function(){return this._items},Nd.prototype.interfaces_=function(){return[cf]},Nd.prototype.getClass=function(){return Nd};var Od=function(){this._index=null;var e=arguments[0];if(!Pl(e,cc))throw new vl("Argument must be Polygonal");this._index=new Gd(e)},Rd={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Od.prototype.locate=function(e){var t=new au(e),r=new Vd(t);return this._index.query(e.y,e.y,r),t.getLocation()},Od.prototype.interfaces_=function(){return[eh]},Od.prototype.getClass=function(){return Od},Rd.SegmentVisitor.get=function(){return Vd},Rd.IntervalIndexedGeometry.get=function(){return Gd},Object.defineProperties(Od,Rd);var Vd=function(){this._counter=null;var e=arguments[0];this._counter=e};Vd.prototype.visitItem=function(e){var t=e;this._counter.countSegment(t.getCoordinate(0),t.getCoordinate(1))},Vd.prototype.interfaces_=function(){return[cf]},Vd.prototype.getClass=function(){return Vd};var Gd=function(){this._index=new Cd;var e=arguments[0];this.init(e)};Gd.prototype.init=function(e){for(var t=Fh.getLines(e).iterator();t.hasNext();){var r=t.next().getCoordinates();this.addLine(r)}},Gd.prototype.addLine=function(e){for(var t=1;t<e.length;t++){var r=new Lf(e[t-1],e[t]),n=Math.min(r.p0.y,r.p1.y),i=Math.max(r.p0.y,r.p1.y);this._index.insert(n,i,r)}},Gd.prototype.query=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1],r=new Nd;return this._index.query(e,t,r),r.getItems()}if(3===arguments.length){var n=arguments[0],i=arguments[1],o=arguments[2];this._index.query(n,i,o)}},Gd.prototype.interfaces_=function(){return[]},Gd.prototype.getClass=function(){return Gd};var Ad=function(e){function t(){if(e.call(this),this._parentGeom=null,this._lineEdgeMap=new kc,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Dh,2===arguments.length){var t=arguments[0],r=arguments[1],n=pu.OGC_SFS_BOUNDARY_RULE;this._argIndex=t,this._parentGeom=r,this._boundaryNodeRule=n,null!==r&&this.add(r)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];this._argIndex=i,this._parentGeom=o,this._boundaryNodeRule=a,null!==o&&this.add(o)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertBoundaryPoint=function(e,r){var n=this._nodes.addNode(r).getLabel(),i=1;n.getLocation(e,Ac.ON)===Tl.BOUNDARY&&i++;var o=t.determineBoundary(this._boundaryNodeRule,i);n.setLocation(e,o)},t.prototype.computeSelfNodes=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return this.computeSelfNodes(e,t,!1)}if(3===arguments.length){var r=arguments[0],n=arguments[1],i=arguments[2],o=new kd(r,!0,!1);o.setIsDoneIfProperInt(i);var a=this.createEdgeSetIntersector(),s=this._parentGeom instanceof dc||this._parentGeom instanceof fc||this._parentGeom instanceof pc,l=n||!s;return a.computeIntersections(this._edges,o,l),this.addSelfIntersectionNodes(this._argIndex),o}},t.prototype.computeSplitEdges=function(e){for(var t=this._edges.iterator();t.hasNext();)t.next().eiList.addSplitEdges(e)},t.prototype.computeEdgeIntersections=function(e,t,r){var n=new kd(t,r,!0);return n.setBoundaryNodes(this.getBoundaryNodes(),e.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,e._edges,n),n},t.prototype.getGeometry=function(){return this._parentGeom},t.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},t.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},t.prototype.addPoint=function(){if(arguments[0]instanceof uc){var e=arguments[0].getCoordinate();this.insertPoint(this._argIndex,e,Tl.INTERIOR)}else if(arguments[0]instanceof kl){var t=arguments[0];this.insertPoint(this._argIndex,t,Tl.INTERIOR)}},t.prototype.addPolygon=function(e){this.addPolygonRing(e.getExteriorRing(),Tl.EXTERIOR,Tl.INTERIOR);for(var t=0;t<e.getNumInteriorRing();t++){var r=e.getInteriorRingN(t);this.addPolygonRing(r,Tl.INTERIOR,Tl.EXTERIOR)}},t.prototype.addEdge=function(e){this.insertEdge(e);var t=e.getCoordinates();this.insertPoint(this._argIndex,t[0],Tl.BOUNDARY),this.insertPoint(this._argIndex,t[t.length-1],Tl.BOUNDARY)},t.prototype.addLineString=function(e){var t=Tu.removeRepeatedPoints(e.getCoordinates());if(t.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=t[0],null;var r=new gh(t,new Wc(this._argIndex,Tl.INTERIOR));this._lineEdgeMap.put(e,r),this.insertEdge(r),tu.isTrue(t.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,t[0]),this.insertBoundaryPoint(this._argIndex,t[t.length-1])},t.prototype.getInvalidPoint=function(){return this._invalidPoint},t.prototype.getBoundaryPoints=function(){for(var e=this.getBoundaryNodes(),t=new Array(e.size()).fill(null),r=0,n=e.iterator();n.hasNext();){var i=n.next();t[r++]=i.getCoordinate().copy()}return t},t.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},t.prototype.addSelfIntersectionNode=function(e,t,r){if(this.isBoundaryNode(e,t))return null;r===Tl.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(e,t):this.insertPoint(e,t,r)},t.prototype.addPolygonRing=function(e,t,r){if(e.isEmpty())return null;var n=Tu.removeRepeatedPoints(e.getCoordinates());if(n.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=n[0],null;var i=t,o=r;su.isCCW(n)&&(i=r,o=t);var a=new gh(n,new Wc(this._argIndex,Tl.BOUNDARY,i,o));this._lineEdgeMap.put(e,a),this.insertEdge(a),this.insertPoint(this._argIndex,n[0],Tl.BOUNDARY)},t.prototype.insertPoint=function(e,t,r){var n=this._nodes.addNode(t),i=n.getLabel();null===i?n._label=new Wc(e,r):i.setLocation(e,r)},t.prototype.createEdgeSetIntersector=function(){return new Md},t.prototype.addSelfIntersectionNodes=function(e){for(var t=this._edges.iterator();t.hasNext();)for(var r=t.next(),n=r.getLabel().getLocation(e),i=r.eiList.iterator();i.hasNext();){var o=i.next();this.addSelfIntersectionNode(e,o.coord,n)}},t.prototype.add=function(){if(1!==arguments.length)return e.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof pc&&(this._useBoundaryDeterminationRule=!1),t instanceof fc)this.addPolygon(t);else if(t instanceof sc)this.addLineString(t);else if(t instanceof uc)this.addPoint(t);else if(t instanceof hc)this.addCollection(t);else if(t instanceof ec)this.addCollection(t);else if(t instanceof pc)this.addCollection(t);else{if(!(t instanceof $u))throw new Error(t.getClass().getName());this.addCollection(t)}},t.prototype.addCollection=function(e){for(var t=0;t<e.getNumGeometries();t++){var r=e.getGeometryN(t);this.add(r)}},t.prototype.locate=function(e){return Pl(this._parentGeom,cc)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Od(this._parentGeom)),this._areaPtLocator.locate(e)):this._ptLocator.locate(e,this._parentGeom)},t.prototype.findEdge=function(){if(1===arguments.length){var t=arguments[0];return this._lineEdgeMap.get(t)}return e.prototype.findEdge.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.determineBoundary=function(e,t){return e.isInBoundary(t)?Tl.BOUNDARY:Tl.INTERIOR},t}(of),Fd=function(){if(this._li=new iu,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var e=arguments[0];this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Ad(0,e)}else if(2===arguments.length){var t=arguments[0],r=arguments[1],n=pu.OGC_SFS_BOUNDARY_RULE;t.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Ad(0,t,n),this._arg[1]=new Ad(1,r,n)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];i.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Ad(0,i,a),this._arg[1]=new Ad(1,o,a)}};Fd.prototype.getArgGeometry=function(e){return this._arg[e].getGeometry()},Fd.prototype.setComputationPrecision=function(e){this._resultPrecisionModel=e,this._li.setPrecisionModel(this._resultPrecisionModel)},Fd.prototype.interfaces_=function(){return[]},Fd.prototype.getClass=function(){return Fd};var Dd=function(){};Dd.prototype.interfaces_=function(){return[]},Dd.prototype.getClass=function(){return Dd},Dd.map=function(){if(arguments[0]instanceof cu&&Pl(arguments[1],Dd.MapOp)){for(var e=arguments[0],t=arguments[1],r=new Mu,n=0;n<e.getNumGeometries();n++){var i=t.map(e.getGeometryN(n));null!==i&&r.add(i)}return e.getFactory().buildGeometry(r)}if(Pl(arguments[0],Su)&&Pl(arguments[1],Dd.MapOp)){for(var o=arguments[0],a=arguments[1],s=new Mu,l=o.iterator();l.hasNext();){var u=l.next(),c=a.map(u);null!==c&&s.add(c)}return s}},Dd.MapOp=function(){};var jd=function(e){function t(){var t=arguments[0],r=arguments[1];e.call(this,t,r),this._ptLocator=new Dh,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new sh,this._resultPolyList=new Mu,this._resultLineList=new Mu,this._resultPointList=new Mu,this._graph=new of(new oh),this._geomFact=t.getFactory()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertUniqueEdge=function(e){var t=this._edgeList.findEqualEdge(e);if(null!==t){var r=t.getLabel(),n=e.getLabel();t.isPointwiseEqual(e)||(n=new Wc(e.getLabel())).flip();var i=t.getDepth();i.isNull()&&i.add(r),i.add(n),r.merge(n)}else this._edgeList.add(e)},t.prototype.getGraph=function(){return this._graph},t.prototype.cancelDuplicateResultEdges=function(){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var t=e.next(),r=t.getSym();t.isInResult()&&r.isInResult()&&(t.setInResult(!1),r.setInResult(!1))}},t.prototype.isCoveredByLA=function(e){return!!this.isCovered(e,this._resultLineList)||!!this.isCovered(e,this._resultPolyList)},t.prototype.computeGeometry=function(e,r,n,i){var o=new Mu;return o.addAll(e),o.addAll(r),o.addAll(n),o.isEmpty()?t.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},t.prototype.mergeSymLabels=function(){for(var e=this._graph.getNodes().iterator();e.hasNext();)e.next().getEdges().mergeSymLabels()},t.prototype.isCovered=function(e,t){for(var r=t.iterator();r.hasNext();){var n=r.next();if(this._ptLocator.locate(e,n)!==Tl.EXTERIOR)return!0}return!1},t.prototype.replaceCollapsedEdges=function(){for(var e=new Mu,t=this._edgeList.iterator();t.hasNext();){var r=t.next();r.isCollapsed()&&(t.remove(),e.add(r.getCollapsedEdge()))}this._edgeList.addAll(e)},t.prototype.updateNodeLabelling=function(){for(var e=this._graph.getNodes().iterator();e.hasNext();){var t=e.next(),r=t.getEdges().getLabel();t.getLabel().merge(r)}},t.prototype.getResultGeometry=function(e){return this.computeOverlay(e),this._resultGeom},t.prototype.insertUniqueEdges=function(e){for(var t=e.iterator();t.hasNext();){var r=t.next();this.insertUniqueEdge(r)}},t.prototype.computeOverlay=function(e){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var t=new Mu;this._arg[0].computeSplitEdges(t),this._arg[1].computeSplitEdges(t),this.insertUniqueEdges(t),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),id.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(e),this.cancelDuplicateResultEdges();var r=new af(this._geomFact);r.add(this._graph),this._resultPolyList=r.getPolygons();var n=new ad(this,this._geomFact,this._ptLocator);this._resultLineList=n.build(e);var i=new sd(this,this._geomFact,this._ptLocator);this._resultPointList=i.build(e),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,e)},t.prototype.labelIncompleteNode=function(e,t){var r=this._ptLocator.locate(e.getCoordinate(),this._arg[t].getGeometry());e.getLabel().setLocation(t,r)},t.prototype.copyPoints=function(e){for(var t=this._arg[e].getNodeIterator();t.hasNext();){var r=t.next();this._graph.addNode(r.getCoordinate()).setLabel(e,r.getLabel().getLocation(e))}},t.prototype.findResultAreaEdges=function(e){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var n=r.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&t.isResultOfOp(i.getLocation(0,Ac.RIGHT),i.getLocation(1,Ac.RIGHT),e)&&n.setInResult(!0)}},t.prototype.computeLabelsFromDepths=function(){for(var e=this._edgeList.iterator();e.hasNext();){var t=e.next(),r=t.getLabel(),n=t.getDepth();if(!n.isNull()){n.normalize();for(var i=0;i<2;i++)r.isNull(i)||!r.isArea()||n.isNull(i)||(0===n.getDelta(i)?r.toLine(i):(tu.isTrue(!n.isNull(i,Ac.LEFT),"depth of LEFT side has not been initialized"),r.setLocation(i,Ac.LEFT,n.getLocation(i,Ac.LEFT)),tu.isTrue(!n.isNull(i,Ac.RIGHT),"depth of RIGHT side has not been initialized"),r.setLocation(i,Ac.RIGHT,n.getLocation(i,Ac.RIGHT))))}}},t.prototype.computeLabelling=function(){for(var e=this._graph.getNodes().iterator();e.hasNext();)e.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},t.prototype.labelIncompleteNodes=function(){for(var e=this._graph.getNodes().iterator();e.hasNext();){var t=e.next(),r=t.getLabel();t.isIsolated()&&(r.isNull(0)?this.labelIncompleteNode(t,0):this.labelIncompleteNode(t,1)),t.getEdges().updateLabelling(r)}},t.prototype.isCoveredByA=function(e){return!!this.isCovered(e,this._resultPolyList)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Fd);jd.overlayOp=function(e,t,r){return new jd(e,t).getResultGeometry(r)},jd.intersection=function(e,t){if(e.isEmpty()||t.isEmpty())return jd.createEmptyResult(jd.INTERSECTION,e,t,e.getFactory());if(e.isGeometryCollection()){var r=t;return od.map(e,{interfaces_:function(){return[Dd.MapOp]},map:function(e){return e.intersection(r)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),_d.overlayOp(e,t,jd.INTERSECTION)},jd.symDifference=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return jd.createEmptyResult(jd.SYMDIFFERENCE,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),_d.overlayOp(e,t,jd.SYMDIFFERENCE)},jd.resultDimension=function(e,t,r){var n=t.getDimension(),i=r.getDimension(),o=-1;switch(e){case jd.INTERSECTION:o=Math.min(n,i);break;case jd.UNION:o=Math.max(n,i);break;case jd.DIFFERENCE:o=n;break;case jd.SYMDIFFERENCE:o=Math.max(n,i)}return o},jd.createEmptyResult=function(e,t,r,n){var i=null;switch(jd.resultDimension(e,t,r)){case-1:i=n.createGeometryCollection(new Array(0).fill(null));break;case 0:i=n.createPoint();break;case 1:i=n.createLineString();break;case 2:i=n.createPolygon()}return i},jd.difference=function(e,t){return e.isEmpty()?jd.createEmptyResult(jd.DIFFERENCE,e,t,e.getFactory()):t.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),_d.overlayOp(e,t,jd.DIFFERENCE))},jd.isResultOfOp=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1],r=e.getLocation(0),n=e.getLocation(1);return jd.isResultOfOp(r,n,t)}if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];switch(i===Tl.BOUNDARY&&(i=Tl.INTERIOR),o===Tl.BOUNDARY&&(o=Tl.INTERIOR),a){case jd.INTERSECTION:return i===Tl.INTERIOR&&o===Tl.INTERIOR;case jd.UNION:return i===Tl.INTERIOR||o===Tl.INTERIOR;case jd.DIFFERENCE:return i===Tl.INTERIOR&&o!==Tl.INTERIOR;case jd.SYMDIFFERENCE:return i===Tl.INTERIOR&&o!==Tl.INTERIOR||i!==Tl.INTERIOR&&o===Tl.INTERIOR}return!1}},jd.INTERSECTION=1,jd.UNION=2,jd.DIFFERENCE=3,jd.SYMDIFFERENCE=4;var Bd=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Dh,this._seg=new Lf;var e=arguments[0],t=arguments[1];this._g=e,this._boundaryDistanceTolerance=t,this._linework=this.extractLinework(e)};Bd.prototype.isWithinToleranceOfBoundary=function(e){for(var t=this,r=0;r<this._linework.getNumGeometries();r++)for(var n=t._linework.getGeometryN(r).getCoordinateSequence(),i=0;i<n.size()-1;i++)if(n.getCoordinate(i,t._seg.p0),n.getCoordinate(i+1,t._seg.p1),t._seg.distance(e)<=t._boundaryDistanceTolerance)return!0;return!1},Bd.prototype.getLocation=function(e){return this.isWithinToleranceOfBoundary(e)?Tl.BOUNDARY:this._ptLocator.locate(e,this._g)},Bd.prototype.extractLinework=function(e){var t=new qd;e.apply(t);var r=t.getLinework(),n=Lc.toLineStringArray(r);return e.getFactory().createMultiLineString(n)},Bd.prototype.interfaces_=function(){return[]},Bd.prototype.getClass=function(){return Bd};var qd=function(){this._linework=null,this._linework=new Mu};qd.prototype.getLinework=function(){return this._linework},qd.prototype.filter=function(e){if(e instanceof fc){var t=e;this._linework.add(t.getExteriorRing());for(var r=0;r<t.getNumInteriorRing();r++)this._linework.add(t.getInteriorRingN(r))}},qd.prototype.interfaces_=function(){return[Ku]},qd.prototype.getClass=function(){return qd};var Ud=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var e=arguments[0];this._g=e};Ud.prototype.extractPoints=function(e,t,r){for(var n=e.getCoordinates(),i=0;i<n.length-1;i++)this.computeOffsetPoints(n[i],n[i+1],t,r)},Ud.prototype.setSidesToGenerate=function(e,t){this._doLeft=e,this._doRight=t},Ud.prototype.getPoints=function(e){for(var t=new Mu,r=Fh.getLines(this._g).iterator();r.hasNext();){var n=r.next();this.extractPoints(n,e,t)}return t},Ud.prototype.computeOffsetPoints=function(e,t,r,n){var i=t.x-e.x,o=t.y-e.y,a=Math.sqrt(i*i+o*o),s=r*i/a,l=r*o/a,u=(t.x+e.x)/2,c=(t.y+e.y)/2;if(this._doLeft){var f=new kl(u-l,c+s);n.add(f)}if(this._doRight){var h=new kl(u+l,c-s);n.add(h)}},Ud.prototype.interfaces_=function(){return[]},Ud.prototype.getClass=function(){return Ud};var Jd=function e(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new Mu;var t=arguments[0],r=arguments[1],n=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(t,r),this._geom=[t,r,n],this._locFinder=[new Bd(this._geom[0],this._boundaryDistanceTolerance),new Bd(this._geom[1],this._boundaryDistanceTolerance),new Bd(this._geom[2],this._boundaryDistanceTolerance)]},zd={TOLERANCE:{configurable:!0}};Jd.prototype.reportResult=function(e,t,r){Jl.out.println("Overlay result invalid - A:"+Tl.toLocationSymbol(t[0])+" B:"+Tl.toLocationSymbol(t[1])+" expected:"+(r?"i":"e")+" actual:"+Tl.toLocationSymbol(t[2]))},Jd.prototype.isValid=function(e){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(e)},Jd.prototype.checkValid=function(){var e=this;if(1===arguments.length){for(var t=arguments[0],r=0;r<this._testCoords.size();r++){var n=e._testCoords.get(r);if(!e.checkValid(t,n))return e._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],o=arguments[1];return this._location[0]=this._locFinder[0].getLocation(o),this._location[1]=this._locFinder[1].getLocation(o),this._location[2]=this._locFinder[2].getLocation(o),!!Jd.hasLocation(this._location,Tl.BOUNDARY)||this.isValidResult(i,this._location)}},Jd.prototype.addTestPts=function(e){var t=new Ud(e);this._testCoords.addAll(t.getPoints(5*this._boundaryDistanceTolerance))},Jd.prototype.isValidResult=function(e,t){var r=jd.isResultOfOp(t[0],t[1],e),n=!(r^t[2]===Tl.INTERIOR);return n||this.reportResult(e,t,r),n},Jd.prototype.getInvalidLocation=function(){return this._invalidLocation},Jd.prototype.interfaces_=function(){return[]},Jd.prototype.getClass=function(){return Jd},Jd.hasLocation=function(e,t){for(var r=0;r<3;r++)if(e[r]===t)return!0;return!1},Jd.computeBoundaryDistanceTolerance=function(e,t){return Math.min(cd.computeSizeBasedSnapTolerance(e),cd.computeSizeBasedSnapTolerance(t))},Jd.isValid=function(e,t,r,n){return new Jd(e,t,n).isValid(r)},zd.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Jd,zd);var Wd=function e(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(t),this._inputGeoms=t};Wd.prototype.extractElements=function(e,t){if(null===e)return null;for(var r=0;r<e.getNumGeometries();r++){var n=e.getGeometryN(r);this._skipEmpty&&n.isEmpty()||t.add(n)}},Wd.prototype.combine=function(){for(var e=new Mu,t=this._inputGeoms.iterator();t.hasNext();){var r=t.next();this.extractElements(r,e)}return 0===e.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(e)},Wd.prototype.interfaces_=function(){return[]},Wd.prototype.getClass=function(){return Wd},Wd.combine=function(){if(1===arguments.length){var e=arguments[0];return new Wd(e).combine()}if(2===arguments.length){var t=arguments[0],r=arguments[1];return new Wd(Wd.createList(t,r)).combine()}if(3===arguments.length){var n=arguments[0],i=arguments[1],o=arguments[2];return new Wd(Wd.createList(n,i,o)).combine()}},Wd.extractFactory=function(e){return e.isEmpty()?null:e.iterator().next().getFactory()},Wd.createList=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1],r=new Mu;return r.add(e),r.add(t),r}if(3===arguments.length){var n=arguments[0],i=arguments[1],o=arguments[2],a=new Mu;return a.add(n),a.add(i),a.add(o),a}};var Hd=function(){this._inputPolys=null,this._geomFactory=null;var e=arguments[0];this._inputPolys=e,null===this._inputPolys&&(this._inputPolys=new Mu)},Xd={STRTREE_NODE_CAPACITY:{configurable:!0}};Hd.prototype.reduceToGeometries=function(e){for(var t=new Mu,r=e.iterator();r.hasNext();){var n=r.next(),i=null;Pl(n,wu)?i=this.unionTree(n):n instanceof cu&&(i=n),t.add(i)}return t},Hd.prototype.extractByEnvelope=function(e,t,r){for(var n=new Mu,i=0;i<t.getNumGeometries();i++){var o=t.getGeometryN(i);o.getEnvelopeInternal().intersects(e)?n.add(o):r.add(o)}return this._geomFactory.buildGeometry(n)},Hd.prototype.unionOptimized=function(e,t){var r=e.getEnvelopeInternal(),n=t.getEnvelopeInternal();if(!r.intersects(n))return Wd.combine(e,t);if(e.getNumGeometries()<=1&&t.getNumGeometries()<=1)return this.unionActual(e,t);var i=r.intersection(n);return this.unionUsingEnvelopeIntersection(e,t,i)},Hd.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var e=new Sf(Hd.STRTREE_NODE_CAPACITY),t=this._inputPolys.iterator();t.hasNext();){var r=t.next();e.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var n=e.itemsTree();return this.unionTree(n)},Hd.prototype.binaryUnion=function(){if(1===arguments.length){var e=arguments[0];return this.binaryUnion(e,0,e.size())}if(3===arguments.length){var t=arguments[0],r=arguments[1],n=arguments[2];if(n-r<=1){var i=Hd.getGeometry(t,r);return this.unionSafe(i,null)}if(n-r==2)return this.unionSafe(Hd.getGeometry(t,r),Hd.getGeometry(t,r+1));var o=Math.trunc((n+r)/2),a=this.binaryUnion(t,r,o),s=this.binaryUnion(t,o,n);return this.unionSafe(a,s)}},Hd.prototype.repeatedUnion=function(e){for(var t=null,r=e.iterator();r.hasNext();){var n=r.next();t=null===t?n.copy():t.union(n)}return t},Hd.prototype.unionSafe=function(e,t){return null===e&&null===t?null:null===e?t.copy():null===t?e.copy():this.unionOptimized(e,t)},Hd.prototype.unionActual=function(e,t){return Hd.restrictToPolygons(e.union(t))},Hd.prototype.unionTree=function(e){var t=this.reduceToGeometries(e);return this.binaryUnion(t)},Hd.prototype.unionUsingEnvelopeIntersection=function(e,t,r){var n=new Mu,i=this.extractByEnvelope(r,e,n),o=this.extractByEnvelope(r,t,n),a=this.unionActual(i,o);return n.add(a),Wd.combine(n)},Hd.prototype.bufferUnion=function(){if(1===arguments.length){var e=arguments[0];return e.get(0).getFactory().buildGeometry(e).buffer(0)}if(2===arguments.length){var t=arguments[0],r=arguments[1];return t.getFactory().createGeometryCollection([t,r]).buffer(0)}},Hd.prototype.interfaces_=function(){return[]},Hd.prototype.getClass=function(){return Hd},Hd.restrictToPolygons=function(e){if(Pl(e,cc))return e;var t=Ah.getPolygons(e);return 1===t.size()?t.get(0):e.getFactory().createMultiPolygon(Lc.toPolygonArray(t))},Hd.getGeometry=function(e,t){return t>=e.size()?null:e.get(t)},Hd.union=function(e){return new Hd(e).union()},Xd.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Hd,Xd);var Yd=function(){};function Zd(){return new Kd}function Kd(){this.reset()}Yd.prototype.interfaces_=function(){return[]},Yd.prototype.getClass=function(){return Yd},Yd.union=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return jd.createEmptyResult(jd.UNION,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),_d.overlayOp(e,t,jd.UNION)},Kd.prototype={constructor:Kd,reset:function(){this.s=this.t=0},add:function(e){$d(Qd,e,this.t),$d(this,Qd.s,this.s),this.s?this.t+=Qd.t:this.s=Qd.t},valueOf:function(){return this.s}};var Qd=new Kd;function $d(e,t,r){var n=e.s=t+r,i=n-t,o=n-i;e.t=t-o+(r-i)}var ep=1e-6,tp=Math.PI,rp=tp/2,np=tp/4,ip=2*tp,op=180/tp,ap=tp/180,sp=Math.abs,lp=Math.atan,up=Math.atan2,cp=Math.cos,fp=Math.sin,hp=Math.sqrt;function dp(e){return e>1?0:e<-1?tp:Math.acos(e)}function pp(e){return e>1?rp:e<-1?-rp:Math.asin(e)}function yp(){}function gp(e,t){e&&Sp.hasOwnProperty(e.type)&&Sp[e.type](e,t)}var vp,mp,_p={Feature:function(e,t){gp(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,n=-1,i=r.length;++n<i;)gp(r[n].geometry,t)}},Sp={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)e=r[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){xp(e.coordinates,t,0)},MultiLineString:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)xp(r[n],t,0)},Polygon:function(e,t){bp(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,n=-1,i=r.length;++n<i;)bp(r[n],t)},GeometryCollection:function(e,t){for(var r=e.geometries,n=-1,i=r.length;++n<i;)gp(r[n],t)}};function xp(e,t,r){var n,i=-1,o=e.length-r;for(t.lineStart();++i<o;)n=e[i],t.point(n[0],n[1],n[2]);t.lineEnd()}function bp(e,t){var r=-1,n=e.length;for(t.polygonStart();++r<n;)xp(e[r],t,1);t.polygonEnd()}function wp(e){return[up(e[1],e[0]),pp(e[2])]}function kp(e){var t=e[0],r=e[1],n=cp(r);return[n*cp(t),n*fp(t),fp(r)]}function Mp(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ep(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ip(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Tp(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Lp(e){var t=hp(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Pp(e,t){function r(r,n){return r=e(r,n),t(r[0],r[1])}return e.invert&&t.invert&&(r.invert=function(r,n){return(r=t.invert(r,n))&&e.invert(r[0],r[1])}),r}function Cp(e,t){return[e>tp?e-ip:e<-tp?e+ip:e,t]}function Np(e){return function(t,r){return[(t+=e)>tp?t-ip:t<-tp?t+ip:t,r]}}function Op(e){var t=Np(e);return t.invert=Np(-e),t}function Rp(e,t){var r=cp(e),n=fp(e),i=cp(t),o=fp(t);function a(e,t){var a=cp(t),s=cp(e)*a,l=fp(e)*a,u=fp(t),c=u*r+s*n;return[up(l*i-c*o,s*r-u*n),pp(c*i+l*o)]}return a.invert=function(e,t){var a=cp(t),s=cp(e)*a,l=fp(e)*a,u=fp(t),c=u*i-l*o;return[up(l*i+u*o,s*r+c*n),pp(c*r-s*n)]},a}function Vp(e,t){(t=kp(t))[0]-=e,Lp(t);var r=dp(-t[1]);return((-t[2]<0?-r:r)+ip-ep)%ip}function Gp(){var e,t=[];return{point:function(t,r){e.push([t,r])},lineStart:function(){t.push(e=[])},lineEnd:yp,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],e=null,r}}}function Ap(e,t){return sp(e[0]-t[0])<ep&&sp(e[1]-t[1])<ep}function Fp(e,t,r,n){this.x=e,this.z=t,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function Dp(e,t,r,n,i){var o,a,s=[],l=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,r,n=e[0],a=e[t];if(Ap(n,a)){for(i.lineStart(),o=0;o<t;++o)i.point((n=e[o])[0],n[1]);i.lineEnd()}else s.push(r=new Fp(n,e,null,!0)),l.push(r.o=new Fp(n,null,r,!1)),s.push(r=new Fp(a,e,null,!1)),l.push(r.o=new Fp(a,null,r,!0))}}),s.length){for(l.sort(t),jp(s),jp(l),o=0,a=l.length;o<a;++o)l[o].e=r=!r;for(var u,c,f=s[0];;){for(var h=f,d=!0;h.v;)if((h=h.n)===f)return;u=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else n(h.x,h.n.x,1,i);h=h.n}else{if(d)for(u=h.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else n(h.x,h.p.x,-1,i);h=h.p}u=(h=h.o).z,d=!d}while(!h.v);i.lineEnd()}}}function jp(e){if(t=e.length){for(var t,r,n=0,i=e[0];++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function Bp(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function qp(e){for(var t,r,n,i=e.length,o=-1,a=0;++o<i;)a+=e[o].length;for(r=new Array(a);--i>=0;)for(t=(n=e[i]).length;--t>=0;)r[--a]=n[t];return r}Zd(),Zd(),Zd(),Cp.invert=Cp,1===(vp=Bp).length&&(mp=vp,vp=function(e,t){return Bp(mp(e),t)});var Up=1e9,Jp=-Up,zp=Zd();function Wp(e){return e}Zd(),Zd(),Zd();var Hp=1/0,Xp=Hp,Yp=-Hp,Zp=Yp,Kp={point:function(e,t){e<Hp&&(Hp=e),e>Yp&&(Yp=e),t<Xp&&(Xp=t),t>Zp&&(Zp=t)},lineStart:yp,lineEnd:yp,polygonStart:yp,polygonEnd:yp,result:function(){var e=[[Hp,Xp],[Yp,Zp]];return Yp=Zp=-(Xp=Hp=1/0),e}};function Qp(e,t,r,n){return function(i,o){var a,s,l,u=t(o),c=i.invert(n[0],n[1]),f=Gp(),h=t(f),d=!1,p={point:y,lineStart:v,lineEnd:m,polygonStart:function(){p.point=_,p.lineStart=S,p.lineEnd=x,s=[],a=[]},polygonEnd:function(){p.point=y,p.lineStart=v,p.lineEnd=m,s=qp(s);var e=function(e,t){var r=t[0],n=t[1],i=[fp(r),-cp(r),0],o=0,a=0;zp.reset();for(var s=0,l=e.length;s<l;++s)if(c=(u=e[s]).length)for(var u,c,f=u[c-1],h=f[0],d=f[1]/2+np,p=fp(d),y=cp(d),g=0;g<c;++g,h=m,p=S,y=x,f=v){var v=u[g],m=v[0],_=v[1]/2+np,S=fp(_),x=cp(_),b=m-h,w=b>=0?1:-1,k=w*b,M=k>tp,E=p*S;if(zp.add(up(E*w*fp(k),y*x+E*cp(k))),o+=M?b+w*ip:b,M^h>=r^m>=r){var I=Ep(kp(f),kp(v));Lp(I);var T=Ep(i,I);Lp(T);var L=(M^b>=0?-1:1)*pp(T[2]);(n>L||n===L&&(I[0]||I[1]))&&(a+=M^b>=0?1:-1)}}return(o<-1e-6||o<ep&&zp<-1e-6)^1&a}(a,c);s.length?(d||(o.polygonStart(),d=!0),Dp(s,ey,e,r,o)):e&&(d||(o.polygonStart(),d=!0),o.lineStart(),r(null,null,1,o),o.lineEnd()),d&&(o.polygonEnd(),d=!1),s=a=null},sphere:function(){o.polygonStart(),o.lineStart(),r(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function y(t,r){var n=i(t,r);e(t=n[0],r=n[1])&&o.point(t,r)}function g(e,t){var r=i(e,t);u.point(r[0],r[1])}function v(){p.point=g,u.lineStart()}function m(){p.point=y,u.lineEnd()}function _(e,t){l.push([e,t]);var r=i(e,t);h.point(r[0],r[1])}function S(){h.lineStart(),l=[]}function x(){_(l[0][0],l[0][1]),h.lineEnd();var e,t,r,n,i=h.clean(),u=f.result(),c=u.length;if(l.pop(),a.push(l),l=null,c)if(1&i){if((t=(r=u[0]).length-1)>0){for(d||(o.polygonStart(),d=!0),o.lineStart(),e=0;e<t;++e)o.point((n=r[e])[0],n[1]);o.lineEnd()}}else c>1&&2&i&&u.push(u.pop().concat(u.shift())),s.push(u.filter($p))}return p}}function $p(e){return e.length>1}function ey(e,t){return((e=e.x)[0]<0?e[1]-rp-ep:rp-e[1])-((t=t.x)[0]<0?t[1]-rp-ep:rp-t[1])}Zd();var ty=Qp(function(){return!0},function(e){var t,r=NaN,n=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?tp:-tp,l=sp(o-r);sp(l-tp)<ep?(e.point(r,n=(n+a)/2>0?rp:-rp),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),t=0):i!==s&&l>=tp&&(sp(r-i)<ep&&(r-=i*ep),sp(o-s)<ep&&(o-=s*ep),n=function(e,t,r,n){var i,o,a=fp(e-r);return sp(a)>ep?lp((fp(t)*(o=cp(n))*fp(r)-fp(n)*(i=cp(t))*fp(e))/(i*o*a)):(t+n)/2}(r,n,o,a),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),t=0),e.point(r=o,n=a),i=s},lineEnd:function(){e.lineEnd(),r=n=NaN},clean:function(){return 2-t}}},function(e,t,r,n){var i;if(null==e)i=r*rp,n.point(-tp,i),n.point(0,i),n.point(tp,i),n.point(tp,0),n.point(tp,-i),n.point(0,-i),n.point(-tp,-i),n.point(-tp,0),n.point(-tp,i);else if(sp(e[0]-t[0])>ep){var o=e[0]<t[0]?tp:-tp;i=r*o/2,n.point(-o,i),n.point(0,i),n.point(o,i)}else n.point(t[0],t[1])},[-tp,-rp]);function ry(e){return function(t){var r=new ny;for(var n in e)r[n]=e[n];return r.stream=t,r}}function ny(){}function iy(e,t,r){var n=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),null!=o&&e.clipExtent(null),function(e,t){e&&_p.hasOwnProperty(e.type)?_p[e.type](e,t):gp(e,t)}(r,e.stream(Kp));var a=Kp.result(),s=Math.min(n/(a[1][0]-a[0][0]),i/(a[1][1]-a[0][1])),l=+t[0][0]+(n-s*(a[1][0]+a[0][0]))/2,u=+t[0][1]+(i-s*(a[1][1]+a[0][1]))/2;return null!=o&&e.clipExtent(o),e.scale(150*s).translate([l,u])}ny.prototype={constructor:ny,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var oy=cp(30*ap);function ay(e,t){return+t?function(e,t){function r(n,i,o,a,s,l,u,c,f,h,d,p,y,g){var v=u-n,m=c-i,_=v*v+m*m;if(_>4*t&&y--){var S=a+h,x=s+d,b=l+p,w=hp(S*S+x*x+b*b),k=pp(b/=w),M=sp(sp(b)-1)<ep||sp(o-f)<ep?(o+f)/2:up(x,S),E=e(M,k),I=E[0],T=E[1],L=I-n,P=T-i,C=m*L-v*P;(C*C/_>t||sp((v*L+m*P)/_-.5)>.3||a*h+s*d+l*p<oy)&&(r(n,i,o,a,s,l,I,T,M,S/=w,x/=w,b,y,g),g.point(I,T),r(I,T,M,S,x,b,u,c,f,h,d,p,y,g))}}return function(t){var n,i,o,a,s,l,u,c,f,h,d,p,y={point:g,lineStart:v,lineEnd:_,polygonStart:function(){t.polygonStart(),y.lineStart=S},polygonEnd:function(){t.polygonEnd(),y.lineStart=v}};function g(r,n){r=e(r,n),t.point(r[0],r[1])}function v(){c=NaN,y.point=m,t.lineStart()}function m(n,i){var o=kp([n,i]),a=e(n,i);r(c,f,u,h,d,p,c=a[0],f=a[1],u=n,h=o[0],d=o[1],p=o[2],16,t),t.point(c,f)}function _(){y.point=g,t.lineEnd()}function S(){v(),y.point=x,y.lineEnd=b}function x(e,t){m(n=e,t),i=c,o=f,a=h,s=d,l=p,y.point=m}function b(){r(c,f,u,h,d,p,i,o,n,a,s,l,16,t),y.lineEnd=_,_()}return y}}(e,t):function(e){return ry({point:function(t,r){t=e(t,r),this.stream.point(t[0],t[1])}})}(e)}var sy=ry({point:function(e,t){this.stream.point(e*ap,t*ap)}});var ly=function(e,t){var r=cp(e),n=cp(t),i=function(e){return(e=dp(e))&&e/fp(e)}(r*n);return[i*n*fp(e),i*fp(t)]};function uy(e,t,n,i){var o=e.properties||{},s="Feature"===e.type?e.geometry:e;if("GeometryCollection"===s.type){var l=[];return j(e,function(e){var r=uy(e,t,n,i);r&&l.push(r)}),p(l)}var u=function(e){var t=ar(s).geometry.coordinates,n=[-t[0],-t[1]];return function(e){return function(e){var t,r,n,i,o,a,s,l,u,c,f=150,h=480,d=250,p=0,y=0,g=0,v=0,m=0,_=null,S=ty,x=null,b=Wp,w=.5,k=ay(I,w);function M(e){return[(e=o(e[0]*ap,e[1]*ap))[0]*f+r,n-e[1]*f]}function E(e){return(e=o.invert((e[0]-r)/f,(n-e[1])/f))&&[e[0]*op,e[1]*op]}function I(e,i){return[(e=t(e,i))[0]*f+r,n-e[1]*f]}function T(){o=Pp(i=function(e,t,r){return(e%=ip)?t||r?Pp(Op(e),Rp(t,r)):Op(e):t||r?Rp(t,r):Cp}(g,v,m),t);var e=t(p,y);return r=h-e[0]*f,n=d+e[1]*f,L()}function L(){return u=c=null,M}return M.stream=function(e){return u&&c===e?u:u=sy(S(i,k(b(c=e))))},M.clipAngle=function(e){return arguments.length?(S=+e?function(e,t){var r=cp(e),n=r>0,i=sp(r)>ep;function o(e,t){return cp(e)*cp(t)>r}function a(e,t,n){var i=[1,0,0],o=Ep(kp(e),kp(t)),a=Mp(o,o),s=o[0],l=a-s*s;if(!l)return!n&&e;var u=r*a/l,c=-r*s/l,f=Ep(i,o),h=Tp(i,u);Ip(h,Tp(o,c));var d=f,p=Mp(h,d),y=Mp(d,d),g=p*p-y*(Mp(h,h)-1);if(!(g<0)){var v=hp(g),m=Tp(d,(-p-v)/y);if(Ip(m,h),m=wp(m),!n)return m;var _,S=e[0],x=t[0],b=e[1],w=t[1];x<S&&(_=S,S=x,x=_);var k=x-S,M=sp(k-tp)<ep;if(!M&&w<b&&(_=b,b=w,w=_),M||k<ep?M?b+w>0^m[1]<(sp(m[0]-S)<ep?b:w):b<=m[1]&&m[1]<=w:k>tp^(S<=m[0]&&m[0]<=x)){var E=Tp(d,(-p+v)/y);return Ip(E,h),[m,wp(E)]}}}function s(t,r){var i=n?e:tp-e,o=0;return t<-i?o|=1:t>i&&(o|=2),r<-i?o|=4:r>i&&(o|=8),o}return Qp(o,function(e){var t,r,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(f,h){var d,p=[f,h],y=o(f,h),g=n?y?0:s(f,h):y?s(f+(f<0?tp:-tp),h):0;if(!t&&(u=l=y)&&e.lineStart(),y!==l&&(!(d=a(t,p))||Ap(t,d)||Ap(p,d))&&(p[0]+=ep,p[1]+=ep,y=o(p[0],p[1])),y!==l)c=0,y?(e.lineStart(),d=a(p,t),e.point(d[0],d[1])):(d=a(t,p),e.point(d[0],d[1]),e.lineEnd()),t=d;else if(i&&t&&n^y){var v;g&r||!(v=a(p,t,!0))||(c=0,n?(e.lineStart(),e.point(v[0][0],v[0][1]),e.point(v[1][0],v[1][1]),e.lineEnd()):(e.point(v[1][0],v[1][1]),e.lineEnd(),e.lineStart(),e.point(v[0][0],v[0][1])))}!y||t&&Ap(t,p)||e.point(p[0],p[1]),t=p,l=y,r=g},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return c|(u&&l)<<1}}},function(r,n,i,o){!function(e,t,r,n,i,o){if(r){var a=cp(t),s=fp(t),l=n*r;null==i?(i=t+n*ip,o=t-l/2):(i=Vp(a,i),o=Vp(a,o),(n>0?i<o:i>o)&&(i+=n*ip));for(var u,c=i;n>0?c>o:c<o;c-=l)u=wp([a,-s*cp(c),-s*fp(c)]),e.point(u[0],u[1])}}(o,e,t,i,r,n)},n?[0,-e]:[-tp,e-tp])}(_=e*ap,6*ap):(_=null,ty),L()):_*op},M.clipExtent=function(e){return arguments.length?(b=null==e?(x=a=s=l=null,Wp):function(e,t,r,n){function i(i,o){return e<=i&&i<=r&&t<=o&&o<=n}function o(i,o,s,u){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||l(i,o)<0^s>0)do{u.point(0===c||3===c?e:r,c>1?n:t)}while((c=(c+s+4)%4)!==f);else u.point(o[0],o[1])}function a(n,i){return sp(n[0]-e)<ep?i>0?0:3:sp(n[0]-r)<ep?i>0?2:1:sp(n[1]-t)<ep?i>0?1:0:i>0?3:2}function s(e,t){return l(e.x,t.x)}function l(e,t){var r=a(e,1),n=a(t,1);return r!==n?r-n:0===r?t[1]-e[1]:1===r?e[0]-t[0]:2===r?e[1]-t[1]:t[0]-e[0]}return function(a){var l,u,c,f,h,d,p,y,g,v,m,_=a,S=Gp(),x={point:b,lineStart:function(){x.point=w,u&&u.push(c=[]),v=!0,g=!1,p=y=NaN},lineEnd:function(){l&&(w(f,h),d&&g&&S.rejoin(),l.push(S.result())),x.point=b,g&&_.lineEnd()},polygonStart:function(){_=S,l=[],u=[],m=!0},polygonEnd:function(){var t=function(){for(var t=0,r=0,i=u.length;r<i;++r)for(var o,a,s=u[r],l=1,c=s.length,f=s[0],h=f[0],d=f[1];l<c;++l)o=h,a=d,h=(f=s[l])[0],d=f[1],a<=n?d>n&&(h-o)*(n-a)>(d-a)*(e-o)&&++t:d<=n&&(h-o)*(n-a)<(d-a)*(e-o)&&--t;return t}(),r=m&&t,i=(l=qp(l)).length;(r||i)&&(a.polygonStart(),r&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&Dp(l,s,t,o,a),a.polygonEnd()),_=a,l=u=c=null}};function b(e,t){i(e,t)&&_.point(e,t)}function w(o,a){var s=i(o,a);if(u&&c.push([o,a]),v)f=o,h=a,d=s,v=!1,s&&(_.lineStart(),_.point(o,a));else if(s&&g)_.point(o,a);else{var l=[p=Math.max(Jp,Math.min(Up,p)),y=Math.max(Jp,Math.min(Up,y))],S=[o=Math.max(Jp,Math.min(Up,o)),a=Math.max(Jp,Math.min(Up,a))];!function(e,t,r,n,i,o){var a,s=e[0],l=e[1],u=0,c=1,f=t[0]-s,h=t[1]-l;if(a=r-s,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>u&&(u=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<c&&(c=a)}if(a=n-l,h||!(a>0)){if(a/=h,h<0){if(a<u)return;a<c&&(c=a)}else if(h>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,h||!(a<0)){if(a/=h,h<0){if(a>c)return;a>u&&(u=a)}else if(h>0){if(a<u)return;a<c&&(c=a)}return u>0&&(e[0]=s+u*f,e[1]=l+u*h),c<1&&(t[0]=s+c*f,t[1]=l+c*h),!0}}}}}(l,S,e,t,r,n)?s&&(_.lineStart(),_.point(o,a),m=!1):(g||(_.lineStart(),_.point(l[0],l[1])),_.point(S[0],S[1]),s||_.lineEnd(),m=!1)}p=o,y=a,g=s}return x}}(x=+e[0][0],a=+e[0][1],s=+e[1][0],l=+e[1][1]),L()):null==x?null:[[x,a],[s,l]]},M.scale=function(e){return arguments.length?(f=+e,T()):f},M.translate=function(e){return arguments.length?(h=+e[0],d=+e[1],T()):[h,d]},M.center=function(e){return arguments.length?(p=e[0]%360*ap,y=e[1]%360*ap,T()):[p*op,y*op]},M.rotate=function(e){return arguments.length?(g=e[0]%360*ap,v=e[1]%360*ap,m=e.length>2?e[2]%360*ap:0,T()):[g*op,v*op,m*op]},M.precision=function(e){return arguments.length?(k=ay(I,w=e*e),L()):hp(w)},M.fitExtent=function(e,t){return iy(M,e,t)},M.fitSize=function(e,t){return function(e,t,r){return iy(M,[[0,0],t],r)}(0,e,t)},function(){return t=e.apply(this,arguments),M.invert=t.invert&&E,T()}}(function(){return e})()}(ly).scale(79.4188).clipAngle(179.999).rotate(n).scale(r)}(),c={type:s.type,coordinates:function e(t,r){return"object"!=typeof t[0]?r(t):t.map(function(t){return e(t,r)})}(s.coordinates,u)},f=(new Vc).read(c),h=S(x(t,n),"meters"),d=Lh.bufferOp(f,h,i);if(!function e(t){return Array.isArray(t[0])?e(t[0]):isNaN(t[0])}((d=(new Gc).write(d)).coordinates))return a({type:d.type,coordinates:function e(t,r){return"object"!=typeof t[0]?r.invert(t):t.map(function(t){return e(t,r)})}(d.coordinates,u)},o)}function cy(e,t,r){void 0===r&&(r={});var n=ie(e),i=ie(t),o=yl.intersection(n.coordinates,i.coordinates);return 0===o.length?null:1===o.length?c(o[0],r.properties):v(o,r.properties)}function fy(e,t,r){void 0===r&&(r={});var n=JSON.stringify(r.properties||{}),i=e[0],o=e[1],a=e[2],s=e[3],l=(o+s)/2,u=(i+a)/2,c=2*t/vt([i,l],[a,l],r)*(a-i),f=2*t/vt([u,o],[u,s],r)*(s-o),h=c/2,d=2*h,y=Math.sqrt(3)/2*f,g=a-i,v=s-o,m=.75*d,_=y,S=(g-d)/(d-h/2),x=Math.floor(S),b=(x*m-h/2-g)/2-h/2+m/2,w=Math.floor((v-y)/y),k=(v-w*y)/2,M=w*y-v>y/2;M&&(k-=y/4);for(var E=[],I=[],T=0;T<6;T++){var L=2*Math.PI/6*T;E.push(Math.cos(L)),I.push(Math.sin(L))}for(var P=[],C=0;C<=x;C++)for(var N=0;N<=w;N++){var O=C%2==1;if(!(0===N&&O||0===N&&M)){var R=C*m+i-b,V=N*_+o+k;if(O&&(V-=y/2),!0===r.triangles)dy([R,V],c/2,f/2,JSON.parse(n),E,I).forEach(function(e){r.mask?cy(r.mask,e)&&P.push(e):P.push(e)});else{var G=hy([R,V],c/2,f/2,JSON.parse(n),E,I);r.mask?cy(r.mask,G)&&P.push(G):P.push(G)}}}return p(P)}function hy(e,t,r,n,i,o){for(var a=[],s=0;s<6;s++){var l=e[0]+t*i[s],u=e[1]+r*o[s];a.push([l,u])}return a.push(a[0].slice()),c([a],n)}function dy(e,t,r,n,i,o){for(var a=[],s=0;s<6;s++){var l=[];l.push(e),l.push([e[0]+t*i[s],e[1]+r*o[s]]),l.push([e[0]+t*i[(s+1)%6],e[1]+r*o[(s+1)%6]]),l.push(e),a.push(c([l],n))}return a}function py(e){return v(e)}function yy(e,t,r){return void 0===r&&(r={}),function(e,t,r,n){void 0===n&&(n={});for(var i=[],o=e[0],a=e[1],s=e[2],l=e[3],u=t/vt([o,a],[s,a],n)*(s-o),f=r/vt([o,a],[o,l],n)*(l-a),h=s-o,d=l-a,y=Math.floor(h/u),g=Math.floor(d/f),v=(d-g*f)/2,m=o+(h-y*u)/2,_=0;_<y;_++){for(var S=a+v,x=0;x<g;x++){var b=c([[[m,S],[m,S+f],[m+u,S+f],[m+u,S],[m,S]]],n.properties);n.mask?ta(n.mask,b)&&i.push(b):i.push(b),S+=f}m+=u}return p(i)}(e,t,t,r)}function gy(e,t,r){void 0===r&&(r={});for(var n=[],i=t/vt([e[0],e[1]],[e[2],e[1]],r)*(e[2]-e[0]),o=t/vt([e[0],e[1]],[e[0],e[3]],r)*(e[3]-e[1]),a=0,s=e[0];s<=e[2];){for(var l=0,u=e[1];u<=e[3];){var f=null,h=null;a%2==0&&l%2==0?(f=c([[[s,u],[s,u+o],[s+i,u],[s,u]]],r.properties),h=c([[[s,u+o],[s+i,u+o],[s+i,u],[s,u+o]]],r.properties)):a%2==0&&l%2==1?(f=c([[[s,u],[s+i,u+o],[s+i,u],[s,u]]],r.properties),h=c([[[s,u],[s,u+o],[s+i,u+o],[s,u]]],r.properties)):l%2==0&&a%2==1?(f=c([[[s,u],[s,u+o],[s+i,u+o],[s,u]]],r.properties),h=c([[[s,u],[s+i,u+o],[s+i,u],[s,u]]],r.properties)):l%2==1&&a%2==1&&(f=c([[[s,u],[s,u+o],[s+i,u],[s,u]]],r.properties),h=c([[[s,u+o],[s+i,u+o],[s+i,u],[s,u+o]]],r.properties)),r.mask?(cy(r.mask,f)&&n.push(f),cy(r.mask,h)&&n.push(h)):(n.push(f),n.push(h)),u+=o,l++}a++,s+=i}return p(n)}ly.invert=function(e,t){var r=hp(e*e+t*t),n=r,i=fp(n),o=cp(n);return[up(e*i,r*o),pp(r&&t*i/r)]},t.along=function(e,t,r){void 0===r&&(r={});for(var n=ie(e).coordinates,i=0,o=0;o<n.length&&!(t>=i&&o===n.length-1);o++){if(i>=t){var a=t-i;if(a){var s=or(n[o],n[o-1])-180;return nr(n[o],a,s,r)}return l(n[o])}i+=vt(n[o],n[o+1],r)}return l(n[n.length-1])},t.angle=function(e,t,r,n){if(void 0===n&&(n={}),!L(n))throw new Error("options is invalid");if(!e)throw new Error("startPoint is required");if(!t)throw new Error("midPoint is required");if(!r)throw new Error("endPoint is required");var i=e,o=t,a=r,s=w(!0!==n.mercator?or(i,o):yi(i,o)),l=w(!0!==n.mercator?or(a,o):yi(a,o)),u=Math.abs(s-l);return!0===n.explementary?360-u:u},t.applyFilter=Ls,t.area=_n,t.areaFactors=o,t.bbox=K,t.bboxClip=function(e,t){var r=ie(e),n=r.type,i="Feature"===e.type?e.properties:{},o=r.coordinates;switch(n){case"LineString":case"MultiLineString":var a=[];return"LineString"===n&&(o=[o]),o.forEach(function(e){!function(e,t,r){var n,i,o,a,s,l=e.length,u=si(e[0],t),c=[];for(r||(r=[]),n=1;n<l;n++){for(a=e[n-1],i=o=si(s=e[n],t);;){if(!(u|i)){c.push(a),i!==o?(c.push(s),n<l-1&&(r.push(c),c=[])):n===l-1&&c.push(s);break}if(u&i)break;u?u=si(a=ai(a,s,u,t),t):i=si(s=ai(a,s,i,t),t)}u=o}c.length&&r.push(c)}(e,t,a)}),1===a.length?h(a[0],i):y(a,i);case"Polygon":return c(li(o,t),i);case"MultiPolygon":return v(o.map(function(e){return li(e,t)}),i);default:throw new Error("geometry "+n+" not supported")}},t.bboxPolygon=er,t.bearing=or,t.bearingToAngle=w,t.bearingToAzimuth=w,t.bezier=$t,t.bezierSpline=$t,t.booleanClockwise=xi,t.booleanContains=function(e,t){var r=ie(e),n=ie(t),i=r.type,o=n.type,a=r.coordinates,s=n.coordinates;switch(i){case"Point":switch(o){case"Point":return Jo(a,s);default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"Point":return function(e,t){var r,n=!1;for(r=0;r<e.coordinates.length;r++)if(Jo(e.coordinates[r],t.coordinates)){n=!0;break}return n}(r,n);case"MultiPoint":return function(e,t){for(var r=0,n=t.coordinates;r<n.length;r++){for(var i=n[r],o=!1,a=0,s=e.coordinates;a<s.length;a++)if(Jo(i,s[a])){o=!0;break}if(!o)return!1}return!0}(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"Point":return Mn(n,r,{ignoreEndVertices:!0});case"LineString":return function(e,t){for(var r=!1,n=0,i=t.coordinates;n<i.length;n++){var o=i[n];if(Mn({type:"Point",coordinates:o},e,{ignoreEndVertices:!0})&&(r=!0),!Mn({type:"Point",coordinates:o},e,{ignoreEndVertices:!1}))return!1}return r}(r,n);case"MultiPoint":return function(e,t){for(var r=!1,n=0,i=t.coordinates;n<i.length;n++){var o=i[n];if(Mn(o,e,{ignoreEndVertices:!0})&&(r=!0),!Mn(o,e))return!1}return!!r}(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Point":return pt(n,r,{ignoreBoundary:!0});case"LineString":return function(e,t){var r=!1,n=0;if(!Uo(K(e),K(t)))return!1;for(;n<t.coordinates.length-1;n++)if(pt({type:"Point",coordinates:zo(t.coordinates[n],t.coordinates[n+1])},e,{ignoreBoundary:!0})){r=!0;break}return r}(r,n);case"Polygon":return function(e,t){if("Feature"===e.type&&null===e.geometry)return!1;if("Feature"===t.type&&null===t.geometry)return!1;if(!Uo(K(e),K(t)))return!1;for(var r=0,n=ie(t).coordinates;r<n.length;r++)for(var i=0,o=n[r];i<o.length;i++)if(!pt(o[i],e))return!1;return!0}(r,n);case"MultiPoint":return function(e,t){for(var r=0,n=t.coordinates;r<n.length;r++)if(!pt(n[r],e,{ignoreBoundary:!0}))return!1;return!0}(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}},t.booleanCrosses=function(e,t){var r=ie(e),n=ie(t),i=r.type,o=n.type;switch(i){case"MultiPoint":switch(o){case"LineString":return Wo(r,n);case"Polygon":return Xo(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"MultiPoint":return Wo(n,r);case"LineString":return function(e,t){if(ln(e,t).features.length>0)for(var r=0;r<e.coordinates.length-1;r++)for(var n=0;n<t.coordinates.length-1;n++){var i=!0;if(0!==n&&n!==t.coordinates.length-2||(i=!1),Yo(e.coordinates[r],e.coordinates[r+1],t.coordinates[n],i))return!0}return!1}(r,n);case"Polygon":return Ho(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"MultiPoint":return Xo(n,r);case"LineString":return Ho(n,r);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}},t.booleanDisjoint=Do,t.booleanEqual=function(e,t){return ie(e).type===ie(t).type&&new ea({precision:6}).compare(Ut(e),Ut(t))},t.booleanIntersects=ta,t.booleanOverlap=function(e,t){var r=ie(e),n=ie(t),i=r.type,o=n.type;if("MultiPoint"===i&&"MultiPoint"!==o||("LineString"===i||"MultiLineString"===i)&&"LineString"!==o&&"MultiLineString"!==o||("Polygon"===i||"MultiPolygon"===i)&&"Polygon"!==o&&"MultiPolygon"!==o)throw new Error("features must be of the same type");if("Point"===i)throw new Error("Point geometry not supported");if(new ea({precision:6}).compare(e,t))return!1;var a=0;switch(i){case"MultiPoint":for(var s=0;s<r.coordinates.length;s++)for(var l=0;l<n.coordinates.length;l++){var u=r.coordinates[s],c=n.coordinates[l];if(u[0]===c[0]&&u[1]===c[1])return!0}return!1;case"LineString":case"MultiLineString":J(e,function(e){J(t,function(t){hi(e,t).features.length&&a++})});break;case"Polygon":case"MultiPolygon":J(e,function(e){J(t,function(t){ln(e,t).features.length&&a++})})}return a>0},t.booleanParallel=function(e,t){if(!e)throw new Error("line1 is required");if(!t)throw new Error("line2 is required");if("LineString"!==da(e,"line1"))throw new Error("line1 must be a LineString");if("LineString"!==da(t,"line2"))throw new Error("line2 must be a LineString");for(var r=Gr(Ut(e)).features,n=Gr(Ut(t)).features,i=0;i<r.length;i++){var o=r[i].geometry.coordinates;if(!n[i])break;if(!ha(o,n[i].geometry.coordinates))return!1}return!0},t.booleanPointInPolygon=pt,t.booleanPointOnLine=Mn,t.booleanWithin=In,t.buffer=function(e,t,r){var n=(r=r||{}).units||"kilometers",i=r.steps||8;if(!e)throw new Error("geojson is required");if("object"!=typeof r)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be an number");if(void 0===t)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var o=[];switch(e.type){case"GeometryCollection":return j(e,function(e){var r=uy(e,t,n,i);r&&o.push(r)}),p(o);case"FeatureCollection":return A(e,function(e){var r=uy(e,t,n,i);r&&A(r,function(e){e&&o.push(e)})}),p(o)}return uy(e,t,n,i)},t.center=ar,t.centerMean=is,t.centerMedian=function(e,t){if(void 0===t&&(t={}),!L(t=t||{}))throw new Error("options is invalid");var r=t.counter||10;if(!T(r))throw new Error("counter must be a number");var n=t.weight,i=is(e,{weight:t.weight}),o=p([]);A(e,function(e){var t;o.features.push(sr(e,{properties:{weight:null===(t=e.properties)||void 0===t?void 0:t[n]}}))});var a={tolerance:t.tolerance,medianCandidates:[]};return function e(t,r,n,i,o){var a=i.tolerance||.001,s=0,u=0,c=0,f=0;if(A(n,function(e){var r,n=null===(r=e.properties)||void 0===r?void 0:r.weight,i=null==n?1:n;if(!T(i=Number(i)))throw new Error("weight value must be a number");if(i>0){f+=1;var o=i*vt(e,t);0===o&&(o=1);var a=i/o;s+=e.geometry.coordinates[0]*a,u+=e.geometry.coordinates[1]*a,c+=a}}),f<1)throw new Error("no features to measure");var h=s/c,d=u/c;return 1===f||0===o||Math.abs(h-r[0])<a&&Math.abs(d-r[1])<a?l([h,d],{medianCandidates:i.medianCandidates}):(i.medianCandidates.push([h,d]),e([h,d],t,n,i,o-1))}(i.geometry.coordinates,[0,0],o,a,r)},t.centerOfMass=function e(t,r){switch(void 0===r&&(r={}),oe(t)){case"Point":return l(Q(t),r.properties);case"Polygon":var n=[];O(t,function(e){n.push(e)});var i,o,a,s,u,c,f,h,d=sr(t,{properties:r.properties}),p=d.geometry.coordinates,y=0,g=0,v=0,m=n.map(function(e){return[e[0]-p[0],e[1]-p[1]]});for(i=0;i<n.length-1;i++)s=(o=m[i])[0],c=o[1],u=(a=m[i+1])[0],v+=h=s*(f=a[1])-u*c,y+=(s+u)*h,g+=(c+f)*h;if(0===v)return d;var _=1/(.5*v*6);return l([p[0]+_*y,p[1]+_*g],r.properties);default:var S=dt(t);return S?e(S,{properties:r.properties}):sr(t,{properties:r.properties})}},t.centroid=sr,t.circle=ir,t.cleanCoords=Ut,t.clone=bt,t.clusterEach=Es,t.clusterReduce=Is,t.clusters=Ns,t.clustersDbscan=function(e,t,r){void 0===r&&(r={}),!0!==r.mutate&&(e=bt(e)),r.minPoints=r.minPoints||3;var n=new aa.DBSCAN,i=-1;return n.run(D(e),E(t,r.units),r.minPoints,vt).forEach(function(t){i++,t.forEach(function(t){var r=e.features[t];r.properties||(r.properties={}),r.properties.cluster=i,r.properties.dbscan="core"})}),n.noise.forEach(function(t){var r=e.features[t];r.properties||(r.properties={}),r.properties.cluster?r.properties.dbscan="edge":r.properties.dbscan="noise"}),e},t.clustersKmeans=function(e,t){void 0===t&&(t={});var r=e.features.length;t.numberOfClusters=t.numberOfClusters||Math.round(Math.sqrt(r/2)),t.numberOfClusters>r&&(t.numberOfClusters=r),!0!==t.mutate&&(e=bt(e));var n=D(e),i=n.slice(0,t.numberOfClusters),o=function(e,t,r,n){var i=[],o=[],a=[],s=[],l=!1,u=n||1e4,c=e.length,f=e[0].length,h=f>0,d=[];if(r)i="kmrand"==r?function(e,t){for(var r={},n=[],i=t<<2,o=e.length,a=e[0].length>0;n.length<t&&i-- >0;){var s=e[Math.floor(Math.random()*o)],l=a?s.join("_"):""+s;r[l]||(r[l]=!0,n.push(s))}if(n.length<t)throw new Error("Error initializating clusters");return n}(e,t):"kmpp"==r?function(e,t){var r=e[0].length?la:ua,n=[],i=e.length,o=e[0].length>0,a=e[Math.floor(Math.random()*i)];for(o&&a.join("_"),n.push(a);n.length<t;){for(var s=[],l=n.length,u=0,c=[],f=0;f<i;f++){for(var h=1/0,d=0;d<l;d++){var p=r(e[f],n[d]);p<=h&&(h=p)}s[f]=h}for(var y=0;y<i;y++)u+=s[y];for(var g=0;g<i;g++)c[g]={i:g,v:e[g],pr:s[g]/u,cs:0};c.sort(function(e,t){return e.pr-t.pr}),c[0].cs=c[0].pr;for(var v=1;v<i;v++)c[v].cs=c[v-1].cs+c[v].pr;for(var m=Math.random(),_=0;_<i-1&&c[_++].cs<m;);n.push(c[_-1].v)}return n}(e,t):r;else for(var p={};i.length<t;){var y=Math.floor(Math.random()*c);p[y]||(p[y]=!0,i.push(e[y]))}do{fa(t,0,d);for(var g=0;g<c;g++){for(var v=1/0,m=0,_=0;_<t;_++)(s=h?ca(e[g],i[_]):Math.abs(e[g]-i[_]))<=v&&(v=s,m=_);a[g]=m,d[m]++}for(var S=[],x=(o=[],0);x<t;x++)S[x]=h?fa(f,0,S[x]):0,o[x]=i[x];if(h){for(var b=0;b<t;b++)i[b]=[];for(var w=0;w<c;w++)for(var k=S[a[w]],M=e[w],E=0;E<f;E++)k[E]+=M[E];l=!0;for(var I=0;I<t;I++){for(var T=i[I],L=S[I],P=o[I],C=d[I],N=0;N<f;N++)T[N]=L[N]/C||0;if(l)for(var O=0;O<f;O++)if(P[O]!=T[O]){l=!1;break}}}else{for(var R=0;R<c;R++)S[a[R]]+=e[R];for(var V=0;V<t;V++)i[V]=S[V]/d[V]||0;l=!0;for(var G=0;G<t;G++)if(o[G]!=i[G]){l=!1;break}}l=l||--u<=0}while(!l);return{it:1e4-u,k:t,idxs:a,centroids:i}}(n,t.numberOfClusters,i),a={};return o.centroids.forEach(function(e,t){a[t]=e}),A(e,function(e,t){var r=o.idxs[t];e.properties.cluster=r,e.properties.centroid=a[r]}),e},t.collect=function(e,t,r,n){var i=we(6),o=t.features.map(function(e){var t;return{minX:e.geometry.coordinates[0],minY:e.geometry.coordinates[1],maxX:e.geometry.coordinates[0],maxY:e.geometry.coordinates[1],property:null===(t=e.properties)||void 0===t?void 0:t[r]}});return i.load(o),e.features.forEach(function(e){e.properties||(e.properties={});var t=K(e),r=[];i.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}).forEach(function(t){pt([t.minX,t.minY],e)&&r.push(t.property)}),e.properties[n]=r}),e},t.collectionOf=ne,t.combine=function(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return A(e,function(e){var r,n,i,o;switch(null===(o=e.geometry)||void 0===o?void 0:o.type){case"Point":t.MultiPoint.coordinates.push(e.geometry.coordinates),t.MultiPoint.properties.push(e.properties);break;case"MultiPoint":(r=t.MultiPoint.coordinates).push.apply(r,e.geometry.coordinates),t.MultiPoint.properties.push(e.properties);break;case"LineString":t.MultiLineString.coordinates.push(e.geometry.coordinates),t.MultiLineString.properties.push(e.properties);break;case"MultiLineString":(n=t.MultiLineString.coordinates).push.apply(n,e.geometry.coordinates),t.MultiLineString.properties.push(e.properties);break;case"Polygon":t.MultiPolygon.coordinates.push(e.geometry.coordinates),t.MultiPolygon.properties.push(e.properties);break;case"MultiPolygon":(i=t.MultiPolygon.coordinates).push.apply(i,e.geometry.coordinates),t.MultiPolygon.properties.push(e.properties)}}),p(Object.keys(t).filter(function(e){return t[e].coordinates.length}).sort().map(function(e){return a({type:e,coordinates:t[e].coordinates},{collectedProperties:t[e].properties})}))},t.concave=function(e,t){void 0===t&&(t={});var r=t.maxEdge||1/0,n=mt(function(e){var t=[],r={};return A(e,function(e){if(e.geometry){var n=e.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(r,n)||(t.push(e),r[n]=!0)}}),p(t)}(e));if(n.features=n.features.filter(function(e){var n=e.geometry.coordinates[0][0],i=e.geometry.coordinates[0][1],o=e.geometry.coordinates[0][2],a=vt(n,i,t),s=vt(i,o,t),l=vt(n,o,t);return a<=r&&s<=r&&l<=r}),n.features.length<1)return null;var i=function(e,t){if(void 0===t&&(t={}),!L(t=t||{}))throw new Error("options is invalid");var r=t.mutate;if("FeatureCollection"!==oe(e))throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");!1!==r&&void 0!==r||(e=bt(e));var n=function(e){var t={};q(e,function(e){t[e.geometry.type]=!0});var r=Object.keys(t);return 1===r.length?r[0]:null}(e);if(!n)throw new Error("geojson must be homogenous");var i=e;switch(n){case"LineString":return function(e,t){if(void 0===t&&(t={}),!L(t=t||{}))throw new Error("options is invalid");var r=t.mutate;if("FeatureCollection"!==oe(e))throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");!1!==r&&void 0!==r||(e=bt(e));var n=[],i=H(e,function(e,t){return function(e,t){var r,n=e.geometry.coordinates,i=t.geometry.coordinates,o=Mt(n[0]),a=Mt(n[n.length-1]),s=Mt(i[0]),l=Mt(i[i.length-1]);if(o===l)r=i.concat(n.slice(1));else if(s===a)r=n.concat(i.slice(1));else if(o===s)r=n.slice(1).reverse().concat(i);else{if(a!==l)return null;r=n.concat(i.reverse().slice(1))}return h(r)}(e,t)||(n.push(e),t)});return i&&n.push(i),n.length?1===n.length?n[0]:y(n.map(function(e){return e.coordinates})):null}(i,t);case"Polygon":return qt(i,t);default:throw new Error(n+" is not supported")}}(n);return 1===i.coordinates.length&&(i.coordinates=i.coordinates[0],i.type="Polygon"),a(i)},t.containsNumber=ee,t.convertArea=I,t.convertDistance=E,t.convertLength=E,t.convex=dt,t.coordAll=D,t.coordEach=O,t.coordReduce=R,t.createBins=Ts,t.degrees2radians=M,t.degreesToRadians=M,t.destination=nr,t.difference=function(e,t){var r=ie(e),n=ie(t),i=e.properties||{},o=yl.difference(r.coordinates,n.coordinates);return 0===o.length?null:1===o.length?c(o[0],i):v(o,i)},t.dissolve=function(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r=t.propertyName;ne(e,"Polygon","dissolve");var n=[];if(!t.propertyName)return On(v(yl.union.apply(null,e.features.map(function(e){return e.geometry.coordinates}))));var i={};A(e,function(e){Object.prototype.hasOwnProperty.call(i,e.properties[r])||(i[e.properties[r]]=[]),i[e.properties[r]].push(e)});for(var o=Object.keys(i),a=0;a<o.length;a++){var s=v(yl.union.apply(null,i[o[a]].map(function(e){return e.geometry.coordinates})));s.properties[r]=o[a],n.push(s)}return On(p(n))},t.distance=vt,t.distanceToDegrees=b,t.distanceToRadians=x,t.distanceWeight=us,t.earthRadius=r,t.ellipse=rs,t.envelope=tr,t.explode=lr,t.factors=n,t.feature=a,t.featureCollection=p,t.featureEach=A,t.featureOf=re,t.featureReduce=F,t.filterProperties=Cs,t.findPoint=Y,t.findSegment=X,t.flatten=On,t.flattenEach=q,t.flattenReduce=U,t.flip=function(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r=t.mutate;if(!e)throw new Error("geojson is required");return!1!==r&&void 0!==r||(e=bt(e)),O(e,function(e){var t=e[0],r=e[1];e[0]=r,e[1]=t}),e},t.geojsonType=te,t.geomEach=j,t.geomReduce=B,t.geometry=s,t.geometryCollection=m,t.getCluster=Ms,t.getCoord=Q,t.getCoords=$,t.getGeom=ie,t.getType=oe,t.greatCircle=function(e,t,r){if("object"!=typeof(r=r||{}))throw new Error("options is invalid");var n=r.properties,i=r.npoints,o=r.offset;return e=Q(e),t=Q(t),n=n||{},i=i||100,o=o||10,new Wn({x:e[0],y:e[1]},{x:t[0],y:t[1]},n).Arc(i,{offset:o}).json()},t.helpers=N,t.hexGrid=fy,t.inside=pt,t.interpolate=function(e,t,r){if("object"!=typeof(r=r||{}))throw new Error("options is invalid");var n=r.gridType,i=r.property,o=r.weight;if(!e)throw new Error("points is required");if(ne(e,"Point","input must contain Points"),!t)throw new Error("cellSize is required");if(void 0!==o&&"number"!=typeof o)throw new Error("weight must be a number");i=i||"elevation",n=n||"square",o=o||1;var a,s=K(e);switch(n){case"point":case"points":a=Cn(s,t,r);break;case"square":case"squares":a=yy(s,t,r);break;case"hex":case"hexes":a=fy(s,t,r);break;case"triangle":case"triangles":a=gy(s,t,r);break;default:throw new Error("invalid gridType")}var l=[];return A(a,function(t){var a=0,s=0;A(e,function(e){var l,u=vt("point"===n?t:sr(t),e,r);if(void 0!==i&&(l=e.properties[i]),void 0===l&&(l=e.geometry.coordinates[2]),void 0===l)throw new Error("zValue is missing");0===u&&(a=l);var c=1/Math.pow(u,o);s+=c,a+=c*l});var u=bt(t);u.properties[i]=a/s,l.push(u)}),p(l)},t.intersect=cy,t.invariant=ae,t.isNumber=T,t.isObject=L,t.isobands=function(e,t,r){if(!L(r=r||{}))throw new Error("options is invalid");var n=r.zProperty||"elevation",i=r.commonProperties||{},o=r.breaksProperties||[];if(ne(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks is not an Array");if(!L(i))throw new Error("commonProperties is not an Object");if(!Array.isArray(o))throw new Error("breaksProperties is not an Array");var a=function(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r=t.zProperty||"elevation",n=t.flip,i=t.flags;ne(e,"Point","input must contain Points");for(var o=function(e,t){var r={};return A(e,function(e){var t=$(e)[1];r[t]||(r[t]=[]),r[t].push(e)}),Object.keys(r).map(function(e){return r[e].sort(function(e,t){return $(e)[0]-$(t)[0]})}).sort(function(e,r){return t?$(e[0])[1]-$(r[0])[1]:$(r[0])[1]-$(e[0])[1]})}
/*!
     * @license GNU Affero General Public License.
     * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
     * v. 1.2.0
     * https://github.com/RaumZeit/MarchingSquares.js
     *
     * MarchingSquaresJS is free software: you can redistribute it and/or modify
     * it under the terms of the GNU Affero General Public License as published by
     * the Free Software Foundation, either version 3 of the License, or
     * (at your option) any later version.
     *
     * MarchingSquaresJS is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     * GNU Affero General Public License for more details.
     *
     * As additional permission under GNU Affero General Public License version 3
     * section 7, third-party projects (personal or commercial) may distribute,
     * include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
     * requirement that said third-party project for that reason alone becomes
     * subject to any requirement of the GNU Affero General Public License version 3.
     * Any modifications to MarchingSquaresJS, however, must be shared with the public
     * and made available.
     *
     * In summary this:
     * - allows you to use MarchingSquaresJS at no cost
     * - allows you to use MarchingSquaresJS for both personal and commercial purposes
     * - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
     *   license as long as this license notice is included
     * - enables you to keep the source code of your program that uses MarchingSquaresJS
     *   undisclosed
     * - forces you to share any modifications you have made to MarchingSquaresJS,
     *   e.g. bug-fixes
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
     */(e,n),a=[],s=0;s<o.length;s++){for(var l=o[s],u=[],c=0;c<l.length;c++){var f=l[c];f.properties[r]?u.push(f.properties[r]):u.push(0),!0===i&&(f.properties.matrixPosition=[s,c])}a.push(u)}return a}(e,{zProperty:n,flip:!0}),s=function(e,t,r){for(var n=[],i=1;i<t.length;i++){var o=+t[i-1],a=+t[i],s=ko(wo(Ii(e,o,a-o))),l={};l.groupedRings=s,l[r]=o+"-"+a,n.push(l)}return n}(a,t,n);return p((s=function(e,t,r){var n=K(r),i=n[2]-n[0],o=n[3]-n[1],a=n[0],s=n[1],l=i/(t[0].length-1),u=o/(t.length-1),c=function(e){e[0]=e[0]*l+a,e[1]=e[1]*u+s};return e.forEach(function(e){e.groupedRings.forEach(function(e){e.forEach(function(e){e.forEach(c)})})}),e}(s,a,e)).map(function(e,t){if(o[t]&&!L(o[t]))throw new Error("Each mappedProperty is required to be an Object");var r=ce({},i,o[t]);return r[n]=e[n],v(e.groupedRings,r)}))},t.isolines=function(e,t,r){if(!L(r=r||{}))throw new Error("options is invalid");var n=r.zProperty||"elevation",i=r.commonProperties||{},o=r.breaksProperties||[];if(ne(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks must be an Array");if(!L(i))throw new Error("commonProperties must be an Object");if(!Array.isArray(o))throw new Error("breaksProperties must be an Array");var a=function(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r=t.zProperty||"elevation",n=t.flip,i=t.flags;ne(e,"Point","input must contain Points");for(var o=function(e,t){var r={};return A(e,function(e){var t=$(e)[1];r[t]||(r[t]=[]),r[t].push(e)}),Object.keys(r).map(function(e){return r[e].sort(function(e,t){return $(e)[0]-$(t)[0]})}).sort(function(e,r){return t?$(e[0])[1]-$(r[0])[1]:$(r[0])[1]-$(e[0])[1]})}(e,n),a=[],s=0;s<o.length;s++){for(var l=o[s],u=[],c=0;c<l.length;c++){var f=l[c];f.properties[r]?u.push(f.properties[r]):u.push(0),!0===i&&(f.properties.matrixPosition=[s,c])}a.push(u)}return a}(e,{zProperty:n,flip:!0});return p(function(e,t,r){var n=K(r),i=n[2]-n[0],o=n[3]-n[1],a=n[0],s=n[1],l=i/(t[0].length-1),u=o/(t.length-1),c=function(e){e[0]=e[0]*l+a,e[1]=e[1]*u+s};return e.forEach(function(e){O(e,c)}),e}(function(e,t,r,n,i){for(var o=[],a=1;a<t.length;a++){var s=+t[a],l=ce({},n,i[a]);l[r]=s;var u=y(de(e,s),l);o.push(u)}return o}(a,t,n,i,o),a,e))},t.kinks=function(e){var t,r,n={type:"FeatureCollection",features:[]};if("LineString"===(r="Feature"===e.type?e.geometry:e).type)t=[r.coordinates];else if("MultiLineString"===r.type)t=r.coordinates;else if("MultiPolygon"===r.type)t=[].concat.apply([],r.coordinates);else{if("Polygon"!==r.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");t=r.coordinates}return t.forEach(function(e){t.forEach(function(t){for(var r=0;r<e.length-1;r++)for(var i=r;i<t.length-1;i++){if(e===t){if(1===Math.abs(r-i))continue;if(0===r&&i===e.length-2&&e[r][0]===e[e.length-1][0]&&e[r][1]===e[e.length-1][1])continue}var o=yn(e[r][0],e[r][1],e[r+1][0],e[r+1][1],t[i][0],t[i][1],t[i+1][0],t[i+1][1]);o&&n.features.push(l([o[0],o[1]]))}})}),n},t.length=wn,t.lengthToDegrees=b,t.lengthToRadians=x,t.lineArc=Kn,t.lineChunk=function(e,t,r){if(!L(r=r||{}))throw new Error("options is invalid");var n=r.units,i=r.reverse;if(!e)throw new Error("geojson is required");if(t<=0)throw new Error("segmentLength must be greater than 0");var o=[];return q(e,function(e){i&&(e.geometry.coordinates=e.geometry.coordinates.reverse()),function(e,t,r,n){var i=wn(e,{units:r});if(i<=t)return n(e);var o=i/t;Number.isInteger(o)||(o=Math.floor(o)+1);for(var a=0;a<o;a++)n(kn(e,t*a,t*(a+1),{units:r}))}(e,t,n,function(e){o.push(e)})}),p(o)},t.lineDistance=wn,t.lineEach=W,t.lineIntersect=ln,t.lineOffset=function(e,t,r){if(!L(r=r||{}))throw new Error("options is invalid");var n=r.units;if(!e)throw new Error("geojson is required");if(null==t||isNaN(t))throw new Error("distance is required");var i=oe(e),o=e.properties;switch(i){case"LineString":return No(e,t,n);case"MultiLineString":var a=[];return q(e,function(e){a.push(No(e,t,n).geometry.coordinates)}),y(a,o);default:throw new Error("geometry "+i+" is not supported")}},t.lineOverlap=hi,t.lineReduce=H,t.lineSegment=Gr,t.lineSlice=function(e,t,r){var n=$(r);if("LineString"!==oe(r))throw new Error("line must be a LineString");for(var i,o=cn(r,e),a=cn(r,t),s=[(i=o.properties.index<=a.properties.index?[o,a]:[a,o])[0].geometry.coordinates],l=i[0].properties.index+1;l<i[1].properties.index+1;l++)s.push(n[l]);return s.push(i[1].geometry.coordinates),h(s,r.properties)},t.lineSliceAlong=kn,t.lineSplit=function(e,t){if(!e)throw new Error("line is required");if(!t)throw new Error("splitter is required");var r=oe(e),n=oe(t);if("LineString"!==r)throw new Error("line must be LineString");if("FeatureCollection"===n)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===n)throw new Error("splitter cannot be a GeometryCollection");var i=Nn(t,{precision:7});switch(n){case"Point":return Xn(e,i);case"MultiPoint":return Hn(e,i);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Hn(e,ln(e,i))}},t.lineString=h,t.lineStringToPolygon=ri,t.lineStrings=d,t.lineToPolygon=ri,t.mask=function(e,t){var r,n=c(t&&t.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]);return("FeatureCollection"===e.type?py(2===(r=e).features.length?yl.union(r.features[0].geometry.coordinates,r.features[1].geometry.coordinates):yl.union.apply(yl,r.features.map(function(e){return e.geometry.coordinates}))):py(yl.union(e.geometry.coordinates))).geometry.coordinates.forEach(function(e){n.geometry.coordinates.push(e[0])}),n},t.meta=Z,t.midpoint=function(e,t){return nr(e,vt(e,t)/2,or(e,t))},t.moranIndex=function(e,t){var r=t.inputField,n=t.threshold||1e5,i=t.p||2,o=t.binary||!1,a=us(e,{alpha:t.alpha||-1,binary:o,p:i,standardization:t.standardization||!0,threshold:n}),s=[];A(e,function(e){var t=e.properties||{};s.push(t[r])});for(var l=cs(s),u=function(e){for(var t=cs(e),r=0,n=0,i=e;n<i.length;n++){var o=i[n];r+=Math.pow(o-t,2)}return r/e.length}(s),c=0,f=0,h=0,d=0,p=a.length,y=0;y<p;y++){for(var g=0,v=0;v<p;v++)c+=a[y][v]*(s[y]-l)*(s[v]-l),f+=a[y][v],h+=Math.pow(a[y][v]+a[v][y],2),g+=a[y][v]+a[v][y];d+=Math.pow(g,2)}var m=c/f/u,_=-1/(p-1),S=(p*p*(h*=.5)-p*d+f*f*3)/((p-1)*(p+1)*(f*f))-_*_,x=Math.sqrt(S);return{expectedMoranIndex:_,moranIndex:m,stdNorm:x,zNorm:(m-_)/x}},t.multiLineString=y,t.multiPoint=g,t.multiPolygon=v,t.nearest=Vr,t.nearestPoint=Vr,t.nearestPointOnLine=cn,t.nearestPointToLine=function(e,t,r){void 0===r&&(r={});var n=r.units,i=r.properties||{},o=function(e){var t=[];switch(e.geometry?e.geometry.type:e.type){case"GeometryCollection":return j(e,function(e){"Point"===e.type&&t.push({type:"Feature",properties:{},geometry:e})}),{type:"FeatureCollection",features:t};case"FeatureCollection":return e.features=e.features.filter(function(e){return"Point"===e.geometry.type}),e;default:throw new Error("points must be a Point Collection")}}(e);if(!o.features.length)throw new Error("points must contain features");if(!t)throw new Error("line is required");if("LineString"!==oe(t))throw new Error("line must be a LineString");var a=1/0,s=null;return A(o,function(e){var r=hn(e,t,{units:n});r<a&&(a=r,s=e)}),s&&(s.properties=ce({dist:a},s.properties,i)),s},t.planepoint=function(e,t){var r=Q(e),n=ie(t).coordinates[0];if(n.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var i=t.properties||{},o=i.a,a=i.b,s=i.c,l=r[0],u=r[1],c=n[0][0],f=n[0][1],h=void 0!==o?o:n[0][2],d=n[1][0],p=n[1][1],y=void 0!==a?a:n[1][2],g=n[2][0],v=n[2][1],m=void 0!==s?s:n[2][2];return(m*(l-c)*(u-p)+h*(l-d)*(u-v)+y*(l-g)*(u-f)-y*(l-c)*(u-v)-m*(l-d)*(u-f)-h*(l-g)*(u-p))/((l-c)*(u-p)+(l-d)*(u-v)+(l-g)*(u-f)-(l-c)*(u-v)-(l-d)*(u-f)-(l-g)*(u-p))},t.point=l,t.pointGrid=Cn,t.pointOnFeature=gn,t.pointOnLine=cn,t.pointOnSurface=gn,t.pointToLineDistance=hn,t.points=u,t.pointsWithinPolygon=gt,t.polygon=c,t.polygonSmooth=function(e,t){var r=[],n=t.iterations||1;if(!e)throw new Error("inputPolys is required");return j(e,function(e,t,i){var o,a,s;switch(e.type){case"Polygon":o=[[]];for(var l=0;l<n;l++)s=[[]],a=e,l>0&&(a=c(o).geometry),as(a,s),o=s.slice(0);r.push(c(o,i));break;case"MultiPolygon":o=[[[]]];for(var u=0;u<n;u++)s=[[[]]],a=e,u>0&&(a=v(o).geometry),ss(a,s),o=s.slice(0);r.push(v(o,i));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}}),p(r)},t.polygonTangents=function(e,t){var r,n,i,o,a=$(e),s=$(t),u=K(t),c=0,f=null;switch(a[0]>u[0]&&a[0]<u[2]&&a[1]>u[1]&&a[1]<u[3]&&(c=(f=Vr(e,lr(t))).properties.featureIndex),oe(t)){case"Polygon":r=s[0][c],n=s[0][0],null!==f&&f.geometry.coordinates[1]<a[1]&&(n=s[0][c]),o=Si(s[0][0],s[0][s[0].length-1],a);var h=mi(s[0],a,o,i,r,n);r=h[0],n=h[1];break;case"MultiPolygon":for(var d=0,y=0,g=0,v=0;v<s[0].length;v++){d=v;for(var m=!1,_=0;_<s[0][v].length;_++){if(y=_,g===c){m=!0;break}g++}if(m)break}r=s[0][d][y],n=s[0][d][y],o=Si(s[0][0][0],s[0][0][s[0][0].length-1],a),s.forEach(function(e){var t=mi(e[0],a,o,i,r,n);r=t[0],n=t[1]})}return p([l(r),l(n)])},t.polygonToLine=$n,t.polygonToLineString=$n,t.polygonize=function(e){var t=Fo.fromGeoJson(e);t.deleteDangles(),t.deleteCutEdges();var r=[],n=[];return t.getEdgeRings().filter(function(e){return e.isValid()}).forEach(function(e){e.isHole()?r.push(e):n.push(e)}),r.forEach(function(e){Ao.findEdgeRingContaining(e,n)&&n.push(e)}),p(n.map(function(e){return e.toPolygon()}))},t.polygons=f,t.projection=gs,t.propEach=V,t.propReduce=G,t.propertiesContainsFilter=Ps,t.radians2degrees=k,t.radiansToDegrees=k,t.radiansToDistance=S,t.radiansToLength=S,t.random=ks,t.randomLineString=xs,t.randomPoint=_s,t.randomPolygon=Ss,t.randomPosition=ms,t.rewind=function(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r=t.reverse||!1,n=t.mutate||!1;if(!e)throw new Error("<geojson> is required");if("boolean"!=typeof r)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof n)throw new Error("<mutate> must be a boolean");!1===n&&(e=bt(e));var i=[];switch(e.type){case"GeometryCollection":return j(e,function(e){bi(e,r)}),e;case"FeatureCollection":return A(e,function(e){A(bi(e,r),function(e){i.push(e)})}),p(i)}return bi(e,r)},t.rhumbBearing=yi,t.rhumbDestination=vi,t.rhumbDistance=fn,t.round=_,t.sample=function(e,t){if(!e)throw new Error("featurecollection is required");if(null==t)throw new Error("num is required");if("number"!=typeof t)throw new Error("num must be a number");return p(function(e,t){for(var r,n,i=e.slice(0),o=e.length,a=o-t;o-- >a;)r=i[n=Math.floor((o+1)*Math.random())],i[n]=i[o],i[o]=r;return i.slice(a)}(e.features,t))},t.sector=function(e,t,r,n,i){if(!L(i=i||{}))throw new Error("options is invalid");var o=i.properties;if(!e)throw new Error("center is required");if(null==r)throw new Error("bearing1 is required");if(null==n)throw new Error("bearing2 is required");if(!t)throw new Error("radius is required");if("object"!=typeof i)throw new Error("options must be an object");if(pi(r)===pi(n))return ir(e,t,i);var a=$(e),s=[[a]];return O(Kn(e,t,r,n,i),function(e){s[0].push(e)}),s[0].push(a),c(s,o)},t.segmentEach=J,t.segmentReduce=z,t.shortestPath=function(e,t,r){if(!L(r=r||{}))throw new Error("options is invalid");var n=r.resolution,i=r.minDistance,o=r.obstacles||p([]);if(!e)throw new Error("start is required");if(!t)throw new Error("end is required");if(n&&!T(n)||n<=0)throw new Error("options.resolution must be a number, greater than 0");if(i)throw new Error("options.minDistance is not yet implemented");var s=Q(e),u=Q(t);switch(e=l(s),t=l(u),oe(o)){case"FeatureCollection":if(0===o.features.length)return h([s,u]);break;case"Polygon":o=p([a(ie(o))]);break;default:throw new Error("invalid obstacles")}var c=o;c.features.push(e),c.features.push(t);var f=K(To(er(K(c)),1.15));n||(n=vt([f[0],f[1]],[f[2],f[1]],r)/100),c.features.pop(),c.features.pop();for(var d=f[0],y=f[1],g=f[2],v=f[3],m=n/vt([d,y],[g,y],r)*(g-d),_=n/vt([d,y],[d,v],r)*(v-y),S=g-d,x=v-y,b=(S-Math.floor(S/m)*m)/2,w=[],k=[],M=[],E=[],I=1/0,P=1/0,C=v-(x-Math.floor(x/_)*_)/2,N=0;C>=y;){for(var O=[],R=[],V=d+b,G=0;V<=g;){var A=l([V,C]),F=_a(A,o);O.push(F?0:1),R.push(V+"|"+C);var D=vt(A,e);!F&&D<I&&(I=D,M={x:G,y:N});var j=vt(A,t);!F&&j<P&&(P=j,E={x:G,y:N}),V+=m,G++}k.push(O),w.push(R),C-=_,N++}var B=new ga(k,{diagonal:!0}),q=B.grid[M.y][M.x],U=B.grid[E.y][E.x],J=[s];return ya.search(B,q,U).forEach(function(e){var t=w[e.x][e.y].split("|");J.push([+t[0],+t[1]])}),J.push(u),Ut(h(J))},t.simplify=function(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r=void 0!==t.tolerance?t.tolerance:1,n=t.highQuality||!1,i=t.mutate||!1;if(!e)throw new Error("geojson is required");if(r&&r<0)throw new Error("invalid tolerance");return!0!==i&&(e=bt(e)),j(e,function(e){!function(e,t,r){var n=e.type;if("Point"===n||"MultiPoint"===n)return e;Ut(e,!0);var i=e.coordinates;switch(n){case"LineString":e.coordinates=Yt(i,t,r);break;case"MultiLineString":e.coordinates=i.map(function(e){return Yt(e,t,r)});break;case"Polygon":e.coordinates=Zt(i,t,r);break;case"MultiPolygon":e.coordinates=i.map(function(e){return Zt(e,t,r)})}}(e,r,n)}),e},t.square=rr,t.squareGrid=yy,t.standardDeviationalEllipse=function(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r=t.steps||64,n=t.weight,i=t.properties||{};if(!T(r))throw new Error("steps must be a number");if(!L(i))throw new Error("properties must be a number");var o=D(e).length,a=is(e,{weight:n}),s=0,l=0,u=0;A(e,function(e){var t=e.properties[n]||1,r=os($(e),$(a));s+=Math.pow(r.x,2)*t,l+=Math.pow(r.y,2)*t,u+=r.x*r.y*t});var c=s-l,f=Math.sqrt(Math.pow(c,2)+4*Math.pow(u,2)),h=2*u,d=Math.atan((c+f)/h),y=180*d/Math.PI,g=0,v=0,m=0;A(e,function(e){var t=e.properties[n]||1,r=os($(e),$(a));g+=Math.pow(r.x*Math.cos(d)-r.y*Math.sin(d),2)*t,v+=Math.pow(r.x*Math.sin(d)+r.y*Math.cos(d),2)*t,m+=t});var _=Math.sqrt(2*g/m),S=Math.sqrt(2*v/m),x=rs(a,_,S,{units:"degrees",angle:y,steps:r,properties:i}),b=gt(e,p([x])),w={meanCenterCoordinates:$(a),semiMajorAxis:_,semiMinorAxis:S,numberOfFeatures:o,angle:y,percentageWithinEllipse:100*D(b).length/o};return x.properties.standardDeviationalEllipse=w,x},t.tag=function(e,t,r,n){return e=bt(e),t=bt(t),A(e,function(e){e.properties||(e.properties={}),A(t,function(t){void 0===e.properties[n]&&pt(e,t)&&(e.properties[n]=t.properties[r])})}),e},t.tesselate=function(e){if(!e.geometry||"Polygon"!==e.geometry.type&&"MultiPolygon"!==e.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var t={type:"FeatureCollection",features:[]};return"Polygon"===e.geometry.type?t.features=Rr(e.geometry.coordinates):e.geometry.coordinates.forEach(function(e){t.features=t.features.concat(Rr(e))}),t},t.tin=mt,t.toMercator=fs,t.toWgs84=hs,t.transformRotate=Io,t.transformScale=To,t.transformTranslate=function(e,t,r,n){if(!L(n=n||{}))throw new Error("options is invalid");var i=n.units,o=n.zTranslation,a=n.mutate;if(!e)throw new Error("geojson is required");if(null==t||isNaN(t))throw new Error("distance is required");if(o&&"number"!=typeof o&&isNaN(o))throw new Error("zTranslation is not a number");if(o=void 0!==o?o:0,0===t&&0===o)return e;if(null==r||isNaN(r))throw new Error("direction is required");return t<0&&(t=-t,r+=180),!1!==a&&void 0!==a||(e=bt(e)),O(e,function(e){var n=$(vi(e,t,r,{units:i}));e[0]=n[0],e[1]=n[1],o&&3===e.length&&(e[2]+=o)}),e},t.triangleGrid=gy,t.truncate=Nn,t.union=function(e,t,r){void 0===r&&(r={});var n=ie(e),i=ie(t),o=yl.union(n.coordinates,i.coordinates);return 0===o.length?null:1===o.length?c(o[0],r.properties):v(o,r.properties)},t.unitsFactors=i,t.unkinkPolygon=function(e){var t=[];return q(e,function(e){"Polygon"===e.geometry.type&&A(function(e){if("Feature"!=e.type)throw new Error("The input must a geojson object of type Feature");if(void 0===e.geometry||null==e.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=e.geometry.type)throw new Error("The input must be a geojson Polygon");for(var t=e.geometry.coordinates.length,r=[],n=0;n<t;n++){var i=e.geometry.coordinates[n];Dn(i[0],i[i.length-1])||i.push(i[0]),r.push.apply(r,i.slice(0,i.length-1))}if(!function(e){for(var t={},r=1,n=0,i=e.length;n<i;++n){if(Object.prototype.hasOwnProperty.call(t,e[n])){r=0;break}t[e[n]]=1}return r}(r))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=r.length,a=function(e,t,r){if("Polygon"!==e.geometry.type)throw new Error("The input feature must be a Polygon");void 0===r&&(r=1);var n=e.geometry.coordinates,i=[],o={};if(r){for(var a=[],s=0;s<n.length;s++)for(var l=0;l<n[s].length-1;l++)a.push(y(s,l));var u=we();u.load(a)}for(var c=0;c<n.length;c++)for(var f=0;f<n[c].length-1;f++)if(r)u.search(y(c,f)).forEach(function(e){var t=e.ring,r=e.edge;p(c,f,t,r)});else for(var h=0;h<n.length;h++)for(var d=0;d<n[h].length-1;d++)p(c,f,h,d);return t||(i={type:"Feature",geometry:{type:"MultiPoint",coordinates:i}}),i;function p(e,r,a,s){var l,u,c=n[e][r],f=n[e][r+1],h=n[a][s],d=n[a][s+1],p=function(e,t,r,n){if(Rn(e,r)||Rn(e,n)||Rn(t,r)||Rn(n,r))return null;var i=e[0],o=e[1],a=t[0],s=t[1],l=r[0],u=r[1],c=n[0],f=n[1],h=(i-a)*(u-f)-(o-s)*(l-c);return 0===h?null:[((i*s-o*a)*(l-c)-(i-a)*(l*f-u*c))/h,((i*s-o*a)*(u-f)-(o-s)*(l*f-u*c))/h]}(c,f,h,d);if(null!==p&&(l=f[0]!==c[0]?(p[0]-c[0])/(f[0]-c[0]):(p[1]-c[1])/(f[1]-c[1]),u=d[0]!==h[0]?(p[0]-h[0])/(d[0]-h[0]):(p[1]-h[1])/(d[1]-h[1]),!(l>=1||l<=0||u>=1||u<=0))){var y=p,g=!o[y];g&&(o[y]=!0),t?i.push(t(p,e,r,c,f,l,a,s,h,d,u,g)):i.push(p)}}function y(e,t){var r,i,o,a,s=n[e][t],l=n[e][t+1];return s[0]<l[0]?(r=s[0],i=l[0]):(r=l[0],i=s[0]),s[1]<l[1]?(o=s[1],a=l[1]):(o=l[1],a=s[1]),{minX:r,minY:o,maxX:i,maxY:a,ring:e,edge:t}}}(e,function(e,t,r,n,i,o,a,s,l,u,c,f){return[e,t,r,n,i,o,a,s,l,u,c,f]}),s=a.length;if(0==s){var l=[];for(n=0;n<t;n++)l.push(c([e.geometry.coordinates[n]],{parent:-1,winding:Fn(e.geometry.coordinates[n])}));var u=p(l);return F(),D(),u}var f=[],h=[];for(n=0;n<t;n++){f.push([]);for(var d=0;d<e.geometry.coordinates[n].length-1;d++)f[n].push([new Vn(e.geometry.coordinates[n][jn(d+1,e.geometry.coordinates[n].length-1)],1,[n,d],[n,jn(d+1,e.geometry.coordinates[n].length-1)],void 0)]),h.push(new Gn(e.geometry.coordinates[n][d],[n,jn(d-1,e.geometry.coordinates[n].length-1)],[n,d],void 0,void 0,!1,!0))}for(n=0;n<s;n++)f[a[n][1]][a[n][2]].push(new Vn(a[n][0],a[n][5],[a[n][1],a[n][2]],[a[n][6],a[n][7]],void 0)),a[n][11]&&h.push(new Gn(a[n][0],[a[n][1],a[n][2]],[a[n][6],a[n][7]],void 0,void 0,!0,!0));var y=h.length;for(n=0;n<f.length;n++)for(d=0;d<f[n].length;d++)f[n][d].sort(function(e,t){return e.param<t.param?-1:1});var g=[];for(n=0;n<y;n++)g.push({minX:h[n].coord[0],minY:h[n].coord[1],maxX:h[n].coord[0],maxY:h[n].coord[1],index:n});var v=we();for(v.load(g),n=0;n<f.length;n++)for(d=0;d<f[n].length;d++)for(var m=0;m<f[n][d].length;m++){S=m==f[n][d].length-1?f[n][jn(d+1,e.geometry.coordinates[n].length-1)][0].coord:f[n][d][m+1].coord;var _=v.search({minX:S[0],minY:S[1],maxX:S[0],maxY:S[1]})[0];f[n][d][m].nxtIsectAlongEdgeIn=_.index}for(n=0;n<f.length;n++)for(d=0;d<f[n].length;d++)for(m=0;m<f[n][d].length;m++){var S=f[n][d][m].coord,x=(_=v.search({minX:S[0],minY:S[1],maxX:S[0],maxY:S[1]})[0]).index;x<o?h[x].nxtIsectAlongRingAndEdge2=f[n][d][m].nxtIsectAlongEdgeIn:Dn(h[x].ringAndEdge1,f[n][d][m].ringAndEdgeIn)?h[x].nxtIsectAlongRingAndEdge1=f[n][d][m].nxtIsectAlongEdgeIn:h[x].nxtIsectAlongRingAndEdge2=f[n][d][m].nxtIsectAlongEdgeIn}var b=[];for(n=0,d=0;d<t;d++){var w=n;for(m=0;m<e.geometry.coordinates[d].length-1;m++)h[n].coord[0]<h[w].coord[0]&&(w=n),n++;var k=h[w].nxtIsectAlongRingAndEdge2;for(m=0;m<h.length;m++)if(h[m].nxtIsectAlongRingAndEdge1==w||h[m].nxtIsectAlongRingAndEdge2==w){var M=m;break}var E=An([h[M].coord,h[w].coord,h[k].coord],!0)?1:-1;b.push({isect:w,parent:-1,winding:E})}for(b.sort(function(e,t){return h[e.isect].coord>h[t.isect].coord?-1:1}),l=[];b.length>0;){var I=b.pop(),T=I.isect,L=I.parent,P=I.winding,C=l.length,N=[h[T].coord],O=T;if(h[T].ringAndEdge1Walkable)var R=h[T].ringAndEdge1,V=h[T].nxtIsectAlongRingAndEdge1;else R=h[T].ringAndEdge2,V=h[T].nxtIsectAlongRingAndEdge2;for(;!Dn(h[T].coord,h[V].coord);){N.push(h[V].coord);var G=void 0;for(n=0;n<b.length;n++)if(b[n].isect==V){G=n;break}if(null!=G&&b.splice(G,1),Dn(R,h[V].ringAndEdge1)){if(R=h[V].ringAndEdge2,h[V].ringAndEdge2Walkable=!1,h[V].ringAndEdge1Walkable){var A={isect:V};An([h[O].coord,h[V].coord,h[h[V].nxtIsectAlongRingAndEdge2].coord],1==P)?(A.parent=L,A.winding=-P):(A.parent=C,A.winding=P),b.push(A)}O=V,V=h[V].nxtIsectAlongRingAndEdge2}else R=h[V].ringAndEdge1,h[V].ringAndEdge1Walkable=!1,h[V].ringAndEdge2Walkable&&(A={isect:V},An([h[O].coord,h[V].coord,h[h[V].nxtIsectAlongRingAndEdge1].coord],1==P)?(A.parent=L,A.winding=-P):(A.parent=C,A.winding=P),b.push(A)),O=V,V=h[V].nxtIsectAlongRingAndEdge1}N.push(h[V].coord),l.push(c([N],{index:C,parent:L,winding:P,netWinding:void 0}))}function F(){for(var e=[],t=0;t<u.features.length;t++)-1==u.features[t].properties.parent&&e.push(t);if(e.length>1)for(t=0;t<e.length;t++){for(var r=-1,n=0;n<u.features.length;n++)e[t]!=n&&pt(u.features[e[t]].geometry.coordinates[0][0],u.features[n],{ignoreBoundary:!0})&&_n(u.features[n])<1/0&&(r=n);u.features[e[t]].properties.parent=r}}function D(){for(var e=0;e<u.features.length;e++)if(-1==u.features[e].properties.parent){var t=u.features[e].properties.winding;u.features[e].properties.netWinding=t,j(e,t)}}function j(e,t){for(var r=0;r<u.features.length;r++)if(u.features[r].properties.parent==e){var n=t+u.features[r].properties.winding;u.features[r].properties.netWinding=n,j(r,n)}}return u=p(l),F(),D(),u}(e),function(r){t.push(c(r.geometry.coordinates,e.properties))})}),p(t)},t.validateBBox=P,t.validateId=C,t.voronoi=function(e,t){if(!L(t=t||{}))throw new Error("options is invalid");var r=t.bbox||[-180,-85,180,85];if(!e)throw new Error("points is required");if(!Array.isArray(r))throw new Error("bbox is invalid");return ne(e,"Point","points"),p(function(){var e=xa,t=ba,r=null;function n(n){return new es(n.map(function(r,i){var o=[Math.round(e(r,i,n)/Ka)*Ka,Math.round(t(r,i,n)/Ka)*Ka];return o.index=i,o.data=r,o}),r)}return n.polygons=function(e){return n(e).polygons()},n.links=function(e){return n(e).links()},n.triangles=function(e){return n(e).triangles()},n.x=function(t){return arguments.length?(e="function"==typeof t?t:Sa(+t),n):e},n.y=function(e){return arguments.length?(t="function"==typeof e?e:Sa(+e),n):t},n.extent=function(e){return arguments.length?(r=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],n):r&&[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},n.size=function(e){return arguments.length?(r=null==e?null:[[0,0],[+e[0],+e[1]]],n):r&&[r[1][0]-r[0][0],r[1][1]-r[0][1]]},n}().x(function(e){return e.geometry.coordinates[0]}).y(function(e){return e.geometry.coordinates[1]}).extent([[r[0],r[1]],[r[2],r[3]]]).polygons(e.features).map(ts))},t.within=gt,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,r(250))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcExtent=t.editGeometryByArc3=t.editFeatureByArc3=t.createGeometryByGeoJSON=t.createGeometry=void 0;var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(35)),i=r(1),o=r(6),a=r(9),s=r(133);t.createGeometry=function(e){switch((e=(0,i.defaultValue)(e,{})).type){case o.GeometryType.point:return new a.Point(e);case o.GeometryType.multiPoint:return new a.MultiPoint(e);case o.GeometryType.lineString:return new a.LineString(e);case o.GeometryType.multiLineString:return new a.MultiLineString(e);case o.GeometryType.polygon:return new a.Polygon(e);case o.GeometryType.multiPolygon:return new a.MultiPolygon(e);case o.GeometryType.circle:return new a.Circle(e);case o.GeometryType.extent:return new a.Extent(e);default:i.Log.error("未输入正确的几何类型")}},t.createGeometryByGeoJSON=function(e,t){var r;switch((r="Feature"===e.type?e.geometry:e).type){case o.GeometryType.point:return new a.Point({coordinates:r.coordinates,spatialReference:t});case o.GeometryType.multiPoint:case o.GeometryType.lineString:return new a.LineString({coordinates:r.coordinates,spatialReference:t});case o.GeometryType.multiLineString:return new a.MultiLineString({coordinates:r.coordinates,spatialReference:t});case o.GeometryType.polygon:return new a.Polygon({coordinates:r.coordinates,spatialReference:t});case o.GeometryType.multiPolygon:return new a.MultiPolygon({coordinates:r.coordinates,spatialReference:t});default:i.Log.error("无法解析type类型为"+r.type+"的geojson")}},t.editFeatureByArc3=function(e){var t=s.Feature.fromJSON(e),r=a.GeometryEngine.getArcFromGeometry({geometry:t.geometry,arcInfo:t.additional.arc3}),n=t.toJSON();return n.geometry.coordinates=r.coordinates,s.Feature.fromJSON(n)},t.editGeometryByArc3=function(e,t){return t&&t.arc3?a.GeometryEngine.getArcFromGeometry({geometry:e,arcInfo:t.arc3}):e},t.calcExtent=function(e,t,r,s){var l=void 0;switch(r=(0,i.defaultValue)(r,o.GeometryType.polygon)){case o.GeometryType.polygon:l=n.polygon(e);break;case o.GeometryType.lineString:l=n.lineString(e);break;case o.GeometryType.multiPolygon:l=n.multiPolygon(e);break;case o.GeometryType.multiLineString:l=n.multiLineString(e)}var u=n.bbox(l);if(!t)return new a.Extent({xmin:u[0],ymin:u[1],xmax:u[2],ymax:u[3],spatialReference:s});var c=[];switch(r){case o.GeometryType.polygon:case o.GeometryType.multiLineString:for(var f=0;f<e.length;f++)for(var h=0;h<e[f].length;h++)c.push(e[f][h][2]);break;case o.GeometryType.lineString:for(var d=0;d<e.length;d++)c.push(e[d][2]);break;case o.GeometryType.multiPolygon:for(var p=0;p<e.length;p++)for(var y=0;y<e[p].length;y++)for(var g=0;g<e[p][y].length;g++)c.push(e[p][y][g][2])}c.sort(function(e,t){return e-t});var v=c[0],m=c[c.length-1];return new a.Extent({xmin:u[0],ymin:u[1],xmax:u[2],ymax:u[3],zmin:v,zmax:m,spatialReference:s})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(11)),i=y(r(10)),o=y(r(3)),a=y(r(0)),s=y(r(2)),l=y(r(4)),u=y(r(7)),c=y(r(5)),f=r(1),h=y(r(29)),d=r(6),p=y(r(58));function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));if(e=(0,f.defaultValue)(e,{}),r.coordinates=(0,f.defaultValue)(e.coordinates,[]),r.type=d.GeometryType.point,!Array.isArray(r.coordinates))throw new Error("坐标必须为数组");if(r.coordinates.length<2||r.coordinates.length>3)throw new Error("坐标数组的长度必须在合理范围内(2或者3)");if(!(0,f.isNumber)(r.coordinates[0])||!(0,f.isNumber)(r.coordinates[1]))throw new Error("坐标数组成员必须为数字");return 3===r.coordinates.length?r.hasZ=!0:r.hasZ=!1,r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"copy",value:function(e){return t.fromJSON(e.toJSON()),this}},{key:"distance",value:function(e){if(!e)throw new Error("输入参数不合法.");var r=t.toCoordinates(e),n=Math.abs(this.coordinates[0]-r[0]),i=Math.abs(this.coordinates[1]-r[1]),o=0;return this.hasZ&&r.length>=3&&(o=Math.abs(this.coordinates[2]-e.coordinates[[2]])),Math.sqrt(Math.pow(n,2)+Math.pow(i,2)+Math.pow(o,2))}},{key:"equals",value:function(e){if(e instanceof t)return this.hasZ?!!Math.abs(this.coordinates[0]-e.coordinates[0])<=1e-7&&!!Math.abs(this.coordinates[1]-e.coordinates[1])<=1e-7&&!!Math.abs(this.coordinates[2]-e.coordinates[2])<=1e-7:!!Math.abs(this.coordinates[0]-e.coordinates[0])<=1e-7&&!!Math.abs(this.coordinates[1]-e.coordinates[1])<=1e-7;if(e instanceof Array){if(2===e.length)return!!Math.abs(this.coordinates[0]-e[0])<=1e-7&&!!Math.abs(this.coordinates[1]-e[1])<=1e-7;if(3===e.length)return!!Math.abs(this.coordinates[0]-e[0])<=1e-7&&!!Math.abs(this.coordinates[1]-e[1])<=1e-7&&!!Math.abs(this.coordinates[2]-e[2])<=1e-7;throw new Error("坐标数组的数量有误!")}throw new Error("必须为点对象或坐标数组才能比较是否相等!")}},{key:"normalize",value:function(){var e;e=this.hasZ?new t({coordinates:[0,0,0]}):new t({coordinates:[0,0]});var r=this.distance(e),n=this._cloneCoordinates();return n[0]/=r,n[1]/=r,this.hasZ&&(n[2]/=r),this.coordinates=n,this}},{key:"toString",value:function(){return this.hasZ?this.coordinates[0]+","+this.coordinates[1]+","+this.coordinates[2]:this.coordinates[0]+","+this.coordinates[1]}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.coordinates=JSON.parse((0,i.default)(this.coordinates)),e.extent=(0,f.toJSON)(this.extent,p.default),e}},{key:"getIGSType",value:function(){return this.hasZ?d.IGSGeometryType.point3D:d.IGSGeometryType.point}},{key:"toOldIGSGeometry",value:function(){return{PntGeom:[{Dot:{x:this.coordinates[0],y:this.coordinates[1]}}],GID:parseInt(String(1e7*Math.random()))}}},{key:"_cloneCoordinates",value:function(){return JSON.parse((0,i.default)(this.coordinates))}},{key:"_calcExtent",value:function(e,t){return t?new p.default({xmin:e[0],ymin:e[1],zmin:e[2],xmax:e[0],ymax:e[1],zmax:e[2],spatialReference:this.spatialReference}):new p.default({xmin:e[0],ymin:e[1],xmax:e[0],ymax:e[1],spatialReference:this.spatialReference})}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"toCoordinates",value:function(e){if(!e)throw new Error("输入参数不合法.");var r=JSON.parse((0,i.default)(e));if(e instanceof t)r=e._cloneCoordinates();else{if(e instanceof Array)return r;e instanceof Object&&(r=t.fromJSON(e)._cloneCoordinates())}return r}},{key:"fromJSON",value:function(e){return new t(e=(0,f.defaultValue)(e,{}))}}]),t}(h.default);(0,n.default)(g.prototype,{extent:{configurable:!1,get:function(){return this._calcExtent(this.coordinates,this.hasZ)}}}),t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerBaseUrlRegExp=t.LayerBaseUrlRegExp=t.BaseRegExp=t.ServerUtil=t.UrlUtil=t.Interceptor=t.GeometryFilter=t.RequestConfig=void 0;var n=u(r(425)),i=u(r(426)),o=u(r(427)),a=u(r(67)),s=u(r(428)),l=r(488);function u(e){return e&&e.__esModule?e:{default:e}}t.RequestConfig=n.default,t.GeometryFilter=i.default,t.Interceptor=o.default,t.UrlUtil=a.default,t.ServerUtil=s.default,t.BaseRegExp=l.BaseRegExp,t.LayerBaseUrlRegExp=l.LayerBaseUrlRegExp,t.ServerBaseUrlRegExp=l.ServerBaseUrlRegExp},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubLayer=t.VoxelFilter=t.FeatureFilter=t.S3MTilesCacheLayer=t.SceneLayer=t.OverlayLayer=t.TileLayer=t.VectorTileLayer=t.LOD=t.getFullBaseUrl=t.appendUrlParams=t.TileInfo=t.FeatureCollection=t.getZoomOffset=t.WebTileLayer=t.ArcGISVectorTileLayer=t.setElevationInfo=t.TileInfoUtil=t.getLayerViewScaleVisible=t.showLayerByScale=t.isCustomSP=t.is4326=t.getUrlType=t.ArcGISTileLayer=t.ArcGISMapImageSubLayer=t.ArcGISMapImageLayer=t.Projection=t.M3DModelCacheLayer=t.ISSceneSubLayer=t.ISSceneLayer=t.IGSFeatureLayer=t.BaseScene=t.ISScene=t.Scene=t.IGSTileLayer=t.IGSSceneSubLayer=t.IGSSceneLayer=t.IGSMapImageSubLayer=t.IGSMapImageLayer=t.IGSVectorTileSubLayer=t.IGSVectorTileLayer=t.VideoLayer=t.UnknownLayer=t.GeoJSONLayer=t.GraphicsLayer=t.GroupLayer=t.MapVLayer=t.EchartsLayer=t.TerrainCacheLayer=t.Cesium3DTilesCacheLayer=t.FeatureLayer=t.WMTSSubLayer=t.WFSLayer=t.WMSSubLayer=t.WMSLayer=t.WMTSLayer=t.OGCLayer=t.Layer=void 0;var n=r(219),i=r(526),o=L(r(143)),a=r(15),s=r(528),l=r(49),u=r(533),c=L(r(537)),f=L(r(538)),h=r(539),d=L(r(542)),p=L(r(543)),y=L(r(544)),g=L(r(545)),v=L(r(546)),m=L(r(81)),_=r(59),S=L(r(71)),x=L(r(86)),b=L(r(103)),w=L(r(145)),k=L(r(547)),M=L(r(548)),E=L(r(549)),I=L(r(229)),T=L(r(235));function L(e){return e&&e.__esModule?e:{default:e}}t.Layer=a.Layer,t.OGCLayer=u.OGCLayer,t.WMTSLayer=u.WMTSLayer,t.WMSLayer=u.WMSLayer,t.WMSSubLayer=u.WMSSubLayer,t.WFSLayer=u.WFSLayer,t.WMTSSubLayer=u.WMTSSubLayer,t.FeatureLayer=a.FeatureLayer,t.Cesium3DTilesCacheLayer=c.default,t.TerrainCacheLayer=f.default,t.EchartsLayer=h.EchartsLayer,t.MapVLayer=h.MapVLayer,t.GroupLayer=d.default,t.GraphicsLayer=p.default,t.GeoJSONLayer=y.default,t.UnknownLayer=M.default,t.VideoLayer=v.default,t.IGSVectorTileLayer=n.IGSVectorTileLayer,t.IGSVectorTileSubLayer=n.IGSVectorTileSubLayer,t.IGSMapImageLayer=n.IGSMapImageLayer,t.IGSMapImageSubLayer=n.IGSMapImageSubLayer,t.IGSSceneLayer=n.IGSSceneLayer,t.IGSSceneSubLayer=n.IGSSceneSubLayer,t.IGSTileLayer=n.IGSTileLayer,t.Scene=n.Scene,t.ISScene=i.ISScene,t.BaseScene=o.default,t.IGSFeatureLayer=n.IGSFeatureLayer,t.ISSceneLayer=i.ISSceneLayer,t.ISSceneSubLayer=i.ISSceneSubLayer,t.M3DModelCacheLayer=g.default,t.Projection=m.default,t.ArcGISMapImageLayer=s.ArcGISMapImageLayer,t.ArcGISMapImageSubLayer=s.ArcGISMapImageSubLayer,t.ArcGISTileLayer=s.ArcGISTileLayer,t.getUrlType=_.getUrlType,t.is4326=_.is4326,t.isCustomSP=_.isCustomSP,t.showLayerByScale=_.showLayerByScale,t.getLayerViewScaleVisible=_.getLayerViewScaleVisible,t.TileInfoUtil=x.default,t.setElevationInfo=l.setElevationInfo,t.ArcGISVectorTileLayer=s.ArcGISVectorTileLayer,t.WebTileLayer=k.default,t.getZoomOffset=_.getZoomOffset,t.FeatureCollection=w.default,t.TileInfo=S.default,t.appendUrlParams=_.appendUrlParams,t.getFullBaseUrl=_.getFullBaseUrl,t.LOD=b.default,t.VectorTileLayer=a.VectorTileLayer,t.TileLayer=a.TileLayer,t.OverlayLayer=h.OverlayLayer,t.SceneLayer=a.SceneLayer,t.S3MTilesCacheLayer=E.default,t.FeatureFilter=I.default,t.VoxelFilter=T.default,t.SubLayer=a.SubLayer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(11)),i=v(r(14)),o=v(r(3)),a=v(r(0)),s=v(r(2)),l=v(r(4)),u=v(r(5)),c=r(8),f=r(1),h=r(6),d=r(46),p=v(r(57)),y=r(9),g=r(49);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this));return e=(0,f.defaultValue)(e,{}),r.id=(0,f.defaultValue)(e.id,(0,f.getGUID)()),r.description=(0,f.defaultValue)(e.description,"图层基类"),r.copyright=(0,f.defaultValue)(e.copyright,"中地数码版权所有"),r.loadStatus=(0,f.defaultValue)(e.loadStatus,h.LoadStatus.notLoaded),r.loaded=!1,r.tokenKey=(0,f.defaultValue)(e.tokenKey,"token"),r.tokenValue=(0,f.defaultValue)(e.tokenValue,void 0),r.tokenAttachType=(0,f.defaultValue)(e.tokenAttachType,h.TokenAttachType.normal),r.index=(0,f.defaultValue)(e.index,void 0),r.title=(0,f.defaultValue)(e.title,void 0),r.minScale=(0,f.defaultValue)(e.minScale,0),r.maxScale=(0,f.defaultValue)(e.maxScale,0),r.extendProps=(0,f.defaultValue)(e.extendProps,{}),r.type=h.LayerType.baseLayer,r.httpMethod=(0,f.defaultValue)(e.httpMethod,h.FetchMethod.get),r.headers=(0,f.defaultValue)(e.headers,{}),r.extensionOptions=(0,f.defaultValue)(e.extensionOptions,{}),r._visible=(0,f.defaultValue)(e.visible,!0),r._opacity=parseFloat((0,f.defaultValue)(e.opacity,1)),r._spatialReference=e.spatialReference?p.default.fromJSON(e.spatialReference):void 0,r._realIndex=void 0,r._isBasemapLayer=!1,r.autoAddTo2D=(0,f.defaultValue)(e.autoAddTo2D,!0),r.autoAddTo3D=(0,f.defaultValue)(e.autoAddTo3D,!0),r._loadPromise=null,r}return(0,u.default)(t,e),(0,s.default)(t,[{key:"isLoaded",value:function(){return this.loadStatus===h.LoadStatus.loaded}},{key:"load",value:function(){return this.loadStatus===h.LoadStatus.notLoaded?(this.loadStatus=h.LoadStatus.loading,this._loadPromise=this._load()):(this.loadStatus,h.LoadStatus.loading),this._loadPromise}},{key:"_load",value:function(){var e=this;return new i.default(function(t){e.loadStatus=h.LoadStatus.loaded,e.loaded=!0,t(e)})}},{key:"setMap",value:function(e){this._map=e}},{key:"destroy",value:function(){}},{key:"_fireUpdateEvent",value:function(e,t){this._map&&this._map.fire(h.LayerEventType.layerUpdate,new d.LayerViewUpdateEvent({type:h.LayerEventType.layerUpdate,target:this._map,layer:this,message:e,updateContent:t}))}},{key:"toJSON",value:function(){return{id:this.id,description:this.description,copyright:this.copyright,loadStatus:this.loadStatus,loaded:this.loaded,tokenKey:this.tokenKey,tokenValue:this.tokenValue,tokenAttachType:this.tokenAttachType,index:this.index,title:this.title,minScale:this.minScale,maxScale:this.maxScale,type:this.type,visible:this.visible,opacity:this.opacity,spatialReference:(0,f.toJSON)(this.spatialReference,p.default),extent:(0,f.toJSON)(this.extent,y.Extent),autoAddTo2D:this.autoAddTo2D,autoAddTo3D:this.autoAddTo3D,extendProps:this.extendProps,extensionOptions:this.extensionOptions}}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"refresh",value:function(){this._fireUpdateEvent("刷新图层",[{params:arguments,dataChanged:!0,name:"refresh",operationType:"method"}])}},{key:"_updateIndex",value:function(){this._fireUpdateEvent("修改图层的index",[{name:"index",params:[this],dataChanged:!0,operationType:"property"}])}}],[{key:"fromJSON",value:function(e){return e=e||{},(0,g.createLayer)(e)}},{key:"fromServerUrl",value:function(e,r){return new i.default(function(n){r.url=e,n(new t(r))})}}]),t}(c.Evented);(0,n.default)(m.prototype,{visible:{get:function(){return this._visible},set:function(e){this._visible=e,this._fireUpdateEvent("显隐变化",[{name:"visible",params:[this._visible],dataChanged:!0,operationType:"property"}])}},opacity:{get:function(){return this._opacity},set:function(e){this._opacity=Number(e),this._fireUpdateEvent("透明度变化",[{name:"opacity",params:[this._opacity],dataChanged:!0,operationType:"property"}])}},spatialReference:{get:function(){return this._spatialReference},set:function(e){this._spatialReference=e}},extent:{get:function(){return this._extentSrc},set:function(e){this._extentSrc=e}}}),t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(11)),i=u(r(0)),o=u(r(2)),a=r(8),s=r(22),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,i.default)(this,e),t=(0,l.defaultValue)(t,{}),this._vertexStyle=(0,l.defaultValue)(t.vertexStyle,new s.SimpleMarkerSymbol({color:new a.Color(24,144,255,1),size:10,outline:new s.SimpleLineSymbol({color:new a.Color(255,255,255,1),width:1})})),this._lineStyle=(0,l.defaultValue)(t.lineStyle,new s.SimpleLineSymbol({color:new a.Color(24,144,255,1),width:3})),this._fillStyle=(0,l.defaultValue)(t.fillStyle,new s.SimpleFillSymbol({color:new a.Color(24,144,255,.3),outline:new s.SimpleLineSymbol({color:new a.Color(24,144,255,1),width:2})})),this._textStyle=(0,l.defaultValue)(t.textStyle,new s.TextSymbol({color:new a.Color(24,144,255,1),text:"默认文字",font:{family:"微软雅黑",size:20,style:"normal",weight:"normal"}})),this._movingLineStyle=(0,l.defaultValue)(t.lineStyle,new s.SimpleLineSymbol({color:new a.Color(255,255,0,1),width:2})),this._selectBoxStyle=(0,l.defaultValue)(t.selectBoxStyle,new s.SimpleFillSymbol({color:new a.Color(241,188,0,.1),outline:new s.SimpleLineSymbol({color:new a.Color(241,188,0,.8),width:2})})),this._selectBoxVertexStyle=(0,l.defaultValue)(t.selectBoxVertexStyle,new s.SimpleMarkerSymbol({color:new a.Color(255,255,255,1),size:10,outline:new s.SimpleLineSymbol({color:new a.Color(241,188,0,1),width:3})})),this._selectVertexStyle=(0,l.defaultValue)(t.selectVertexStyle,new s.SimpleMarkerSymbol({color:new a.Color(241,188,0,1),size:11,outline:new s.SimpleLineSymbol({color:new a.Color(255,255,255,1),width:1})})),this._selectTextStyle=(0,l.defaultValue)(t.selectTextStyle,new s.TextSymbol({color:new a.Color(241,188,0,1),text:"默认文字",font:{family:"微软雅黑",size:20,style:"normal",weight:"normal"}})),this._selectMidVertexStyle=(0,l.defaultValue)(t.selectMidVertexStyle,new s.SimpleMarkerSymbol({color:new a.Color(255,255,255,1),size:8,outline:new s.SimpleLineSymbol({color:new a.Color(241,188,0,1),width:1})})),this._coincidentPointStyle=(0,l.defaultValue)(t.coincidentPointStyle,new s.SimpleMarkerSymbol({color:new a.Color(255,255,0,1),size:10,outline:new s.SimpleLineSymbol({color:new a.Color(255,255,255,1),width:1})})),this._highlightPointStyle=(0,l.defaultValue)(t.highlightPointStyle,new s.SimpleMarkerSymbol({color:new a.Color(255,255,0,1),size:10,outline:new s.SimpleLineSymbol({color:new a.Color(255,255,255,1),width:1})})),this._highlightLineStyle=(0,l.defaultValue)(t.highlightLineStyle,new s.SimpleLineSymbol({color:new a.Color(255,255,0,1),width:3})),this._parallelLineStyle=(0,l.defaultValue)(t.parallelLineStyle,this._highlightLineStyle),this._perpendicularLineStyle=(0,l.defaultValue)(t.perpendicularLineStyle,this._highlightLineStyle)}return(0,o.default)(e,[{key:"clone",value:function(){return new e(this.toJSON())}},{key:"toJSON",value:function(){var e={};return e.vertexStyle=this._vertexStyle.clone(),e.lineStyle=this._lineStyle.clone(),e.fillStyle=this._fillStyle.clone(),e.movingLineStyle=this._movingLineStyle.clone(),e.selectBoxStyle=this._selectBoxStyle.clone(),e.selectBoxVertexStyle=this._selectBoxVertexStyle.clone(),e.selectVertexStyle=this._selectVertexStyle.clone(),e.selectMidVertexStyle=this._selectMidVertexStyle.clone(),e.coincidentPointStyle=this._coincidentPointStyle.clone(),e.highlightPointStyle=this._highlightPointStyle.clone(),e.highlightLineStyle=this._highlightLineStyle.clone(),e.parallelLineStyle=this._parallelLineStyle.clone(),e.perpendicularLineStyle=this._perpendicularLineStyle.clone(),e.textStyle=this._textStyle.clone(),e.selectTextStyle=this._selectTextStyle.clone(),e}},{key:"fromJSON",value:function(){}}]),e}();(0,n.default)(c.prototype,{vertexStyle:{get:function(){return this._vertexStyle},set:function(e){this._vertexStyle=e}},lineStyle:{get:function(){return this._lineStyle},set:function(e){this._lineStyle=e}},fillStyle:{get:function(){return this._fillStyle},set:function(e){this._fillStyle=e}},textStyle:{get:function(){return this._textStyle},set:function(e){this._textStyle=e}},selectBoxStyle:{get:function(){return this._selectBoxStyle},set:function(e){this._selectBoxStyle=e}},selectBoxVertexStyle:{get:function(){return this._selectBoxVertexStyle},set:function(e){this._selectBoxVertexStyle=e}},selectVertexStyle:{get:function(){return this._selectVertexStyle},set:function(e){this._selectVertexStyle=e}},selectTextStyle:{get:function(){return this._selectTextStyle},set:function(e){this._selectTextStyle=e}},selectMidVertexStyle:{get:function(){return this._selectMidVertexStyle},set:function(e){this._selectMidVertexStyle=e}},coincidentPointStyle:{get:function(){return this._coincidentPointStyle},set:function(e){this._coincidentPointStyle=e}},highlightPointStyle:{get:function(){return this._highlightPointStyle},set:function(e){this._highlightPointStyle=e}},highlightLineStyle:{get:function(){return this._highlightLineStyle},set:function(e){this._highlightLineStyle=e}},parallelLineStyle:{get:function(){return this._parallelLineStyle},set:function(e){this._parallelLineStyle=e}},perpendicularLineStyle:{get:function(){return this._perpendicularLineStyle},set:function(e){this._perpendicularLineStyle=e}}}),t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(10)),i=p(r(3)),o=p(r(0)),a=p(r(2)),s=p(r(4)),l=p(r(5)),u=r(8),c=r(9),f=p(r(43)),h=p(r(41)),d=r(1);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r._initEvent(),r.type="sketchPointDrawTool",r._drawTools=[r],r._otherDrawTools=[],r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_initEvent",value:function(){this._processEvent=this._processEvent.bind(this),this.on("pan",this._processEvent)}},{key:"getPanEvent",value:function(e,t,r){return{event:e,target:t,type:r}}},{key:"drawFeature",value:function(){var e=this;this._editMode=u.SketchEditMode.DRAWING,this.view._mapActionControl("video-map-active",!0),this.cursorStyle=this.view.cursor,(0,d.isNull)(this.cursorStyle)&&(this.view.cursor="crosshair"),this._setInitSnap(),this._fireStartDrawEvent();var t=function(t){if(t&&t.x&&t.y){e.view.off(u.ViewEventType.pointerMove,e._handlerInitMouseMove),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]);var r,n={x:t.x,y:t.y};r=e._snapPoint?e._snapPoint:e.view.toMap({x:n.x,y:n.y});var i=e._getFeature(r);e.sketchStage.entityGraphic=i,e._addFeatureToLayer(i,e.layer),e.stop(),e._editMode=u.SketchEditMode.NONE,e.view.cursor=e.cursorStyle,e.fire("drawn",{geometry:i.geometry,feature:i},self),e._fireStopDrawEvent(i),e.view._mapActionControl("video-map-active",!1)}};this._drawEventHandlers.push(t),this.view.on(u.ViewEventType.pointerDown,t)}},{key:"addFeature",value:function(e,t,r,n){var i;i=t&&t.vertexStyle?t.vertexStyle:this.sketchStyle._vertexStyle;var o=this._getFeature(e,i);r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"addFeatureByGeometry",value:function(e,t,r,n){var i;i=t&&t.vertexStyle?t.vertexStyle:this.sketchStyle._vertexStyle;var o=new u.Feature({geometry:e,symbol:i,elevationInfo:this.elevationInfo});r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"_getFeature",value:function(e,t){return e||(e=u.Projection.project(new c.Point({coordinates:[0,0,0]}),this._spatialReference)),t||(t=this._sketchDataType===u.SketchDataType.TEXT?this.sketchStyle.textStyle:this.sketchStyle.vertexStyle),new u.Feature({geometry:e,symbol:t,elevationInfo:this.elevationInfo})}},{key:"hitTestFeature",value:function(e,t){this.view._mapActionControl("video-map-active",!0),this.editOption.showSelectBox?(this._editMode=u.SketchEditMode.EDITGRAGIC,this.selectFeature(e)):this._parent._sketchDataType===u.SketchDataType.POINT||this._parent._sketchDataType===u.SketchDataType.TEXT?this.startPanGraphics(e,t):this._parent&&this._parent._editMode===u.SketchEditMode.EDITGRAGIC?"circleVertex"===e.attributes.type?this.startCircleVertexScaleGraphics(e,t):"midVertex"===e.attributes.type?this.startMidVertexScaleGraphics(e,t):this.startVertexScaleGraphics(e,t):this._parent&&this._parent._editMode===u.SketchEditMode.EDITVERTEX&&this.startVertexMoveGraphics(e,t)}},{key:"selectFeature",value:function(e){var r=this;if(this.editOption.showSelectBox){var n=new t({view:this.view,layer:this._sketchInnerLayer,sketchInnerLayer:this._sketchInnerLayer,sketchStyle:new h.default({vertexStyle:this._sketchDataType===u.SketchDataType.TEXT?this.sketchStyle._selectTextStyle:this.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this}),i=e.geometry;if(this._drawTools.push(n),n.addFeatureByGeometry(i,null,null,this.sketchInnerLayer),this.sketchStage.selectBoxGraphics=[n.sketchStage.entityGraphic],this._otherDrawTools.push(n),this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage),!this._parent||this._parent&&!this._parent._mapClickEvent){var o=function(){r._preventFirstCall?r._preventFirstCall=void 0:(r.sketchStage.selectBoxGraphics.forEach(function(e){r._removeFeatureFromLayer(e,r.sketchInnerLayer)}),r.view.off(u.ViewEventType.immediateClick,r._mapClickEvent),r._mapClickEvent=void 0,r.fire("selected",{isSelected:!1},self),r.sketchStage.selectBoxGraphics=[],r.view._mapActionControl("video-map-active",!1))};this._hitTestEventHandlers.push(this._mapClickEvent),this._mapClickEvent||(this._mapClickEvent=o,this.view.on(u.ViewEventType.immediateClick,o)),"leaflet"===this.view.engineType&&this.sketchDataType===u.SketchDataType.TEXT?this._preventFirstCall=!1:this._preventFirstCall=!0}}}},{key:"startPanGraphics",value:function(e,t){var r=this;this.view._mapActionControl("drag-pan",!1);var n=!1;this._startPan=!0;var i=null;i=t.mapPoint,this._parent&&this._parent._mapClickEvent&&this.view.off(u.ViewEventType.immediateClick,this._parent._mapClickEvent),this._parent&&this._fireStartPanEvent(this._parent.sketchStage.entityGraphic,this._parent);var o=function(e){if(e&&e.x&&e.y&&!n&&r._startPan){clearTimeout(null),n=!0;var t={x:e.x,y:e.y},o=r.view.toMap({x:t.x,y:t.y}),a=o.coordinates[0]-i.coordinates[0],s=o.coordinates[1]-i.coordinates[1];if(0!==a||0!==s){var l=r.getPanCoordinates(r.sketchStage.entityGraphic.geometry.coordinates,a,s);i.coordinates=l,r.sketchStage.entityGraphic.geometry.coordinates=l,n=!1,r._parent&&(r._parent.sketchStage.entityGraphic.geometry.coordinates=l,r._firePanningEvent(r._parent.sketchStage.entityGraphic,r._parent))}else n=!1}},a=function e(){r._startPan&&(r._startPan=!1,r.view.off(u.ViewEventType.pointerUp,e),r.view.off(u.ViewEventType.pointerMove,o),r._parent&&r._parent.undoRedoManager&&r._parent.undoRedoManager.addProcess("update",r._parent.sketchStage),r._parent&&r._parent._mapClickEvent&&r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent),r._parent&&r._fireStopPanEvent(r._parent.sketchStage.entityGraphic,r._parent),setTimeout(function(){r.view._mapActionControl("drag-pan",!0)},0))};this._hitTestEventHandlers.push(o),this._hitTestEventHandlers.push(a),this.view.on(u.ViewEventType.pointerUp,a),this.view.on(u.ViewEventType.pointerMove,o)}},{key:"startVertexScaleGraphics",value:function(e,t){var r=this;this.view._mapActionControl("drag-pan",!1);var n,i=!1;this._startPan=!0,n=t.mapPoint;var o;o=this._parent.sketchStage.entityGraphic.geometry instanceof c.Extent?this._parent.sketchStage.entityGraphic.geometry:this._parent.sketchStage.entityGraphic.geometry.extent,this._parent&&this._parent._mapClickEvent&&this.view.off(u.ViewEventType.immediateClick,this._mapClickEvent);var a=e.attributes.direction;this._parent&&this._fireStartScaleEvent(this._parent.sketchStage.entityGraphic,this._parent);var s=function(t){if(t&&t.x&&t.y&&!i&&r._startPan){clearTimeout(null),i=!0;var s={x:t.x,y:t.y},l=r.view.toMap({x:s.x,y:s.y}),u=l.coordinates[0]-n.coordinates[0],c=l.coordinates[1]-n.coordinates[1],f=l.coordinates[0]/n.coordinates[0],h=l.coordinates[1]/n.coordinates[1];0!==u||0!==c?(r._dispatchEvent("vertexScale",{startPoint:n,movePoint:l,deltaPosition:{x:u,y:c},scale:{x:f,y:h},direction:a,extent:o,feature:e,action:"scale"},r),i=!1,r._parent&&r._fireScalingEvent(r._parent.sketchStage.entityGraphic,r._parent)):i=!1}},l=function e(){r._startPan&&(r._dispatchEvent("vertexScale",{action:"stop"},r),r._startPan=!1,r.view.off(u.ViewEventType.pointerUp,e),r.view.off(u.ViewEventType.pointerMove,s),r._parent&&r._parent.undoRedoManager&&r._parent.undoRedoManager.addProcess("update",r._parent.sketchStage),r._parent&&r._parent._mapClickEvent&&setTimeout(function(){r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent)},0),r.view._mapActionControl("drag-pan",!0),r._parent&&r._fireStopScaleEvent(r._parent.sketchStage.entityGraphic,r._parent))};this._hitTestEventHandlers.push(s),this._hitTestEventHandlers.push(l),this.view.on(u.ViewEventType.pointerUp,l),this.view.on(u.ViewEventType.pointerMove,s)}},{key:"startMidVertexScaleGraphics",value:function(e,t){var r=this;this.view._mapActionControl("drag-pan",!1);var n,i=!1;this._startPan=!0,n=t.mapPoint;var o;o=this._parent.sketchStage.entityGraphic.geometry instanceof c.Extent?this._parent.sketchStage.entityGraphic.geometry:this._parent.sketchStage.entityGraphic.geometry.extent,this._parent&&this._parent._mapClickEvent&&this.view.off(u.ViewEventType.immediateClick,this._parent._mapClickEvent);var a=e.attributes.direction;this._parent&&this._fireStartScaleEvent(this._parent.sketchStage.entityGraphic,this._parent);var s=function(e){if(e&&e.x&&e.y&&!i&&r._startPan){clearTimeout(null),i=!0;var t={x:e.x,y:e.y},s=r.view.toMap({x:t.x,y:t.y}),l=s.coordinates[0]-n.coordinates[0],u=s.coordinates[1]-n.coordinates[1],c=s.coordinates[0]/n.coordinates[0],f=s.coordinates[1]/n.coordinates[1];0!==l||0!==u?(r._dispatchEvent("midVertexScale",{startPoint:n,movePoint:s,deltaPosition:{x:l,y:u},scale:{x:c,y:f},direction:a,extent:o,action:"scale"},r),i=!1,r._parent&&r._fireScalingEvent(r._parent.sketchStage.entityGraphic,r._parent)):i=!1}},l=function e(){r._startPan&&(r._dispatchEvent("vertexScale",{action:"stop"},r),r._startPan=!1,r.view.off(u.ViewEventType.pointerUp,e),r.view.off(u.ViewEventType.pointerMove,s),r.view._mapActionControl("drag-pan",!0),r._parent&&r._parent.undoRedoManager&&r._parent.undoRedoManager.addProcess("update",r._parent.sketchStage),r._parent&&r._parent._mapClickEvent&&setTimeout(function(){r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent)},0),r.view._mapActionControl("drag-pan",!0),r._parent&&r._fireStopScaleEvent(r._parent.sketchStage.entityGraphic,r._parent))};this._hitTestEventHandlers.push(s),this._hitTestEventHandlers.push(l),this.view.on(u.ViewEventType.pointerUp,l),this.view.on(u.ViewEventType.pointerMove,s)}},{key:"startCircleVertexScaleGraphics",value:function(e,t){var r=this;this.view._mapActionControl("drag-pan",!1);var n,i=!1;this._startPan=!0,n=t.mapPoint;var o=this._parent.sketchStage.entityGraphic.geometry.extent;this._parent&&this._parent._mapClickEvent&&this.view.off(u.ViewEventType.immediateClick,this._mapClickEvent);var a=e.attributes.direction;this._parent&&this._fireStartScaleEvent(this._parent.sketchStage.entityGraphic,this._parent);var s=function(t){if(t&&t.x&&t.y&&!i&&r._startPan){clearTimeout(null),i=!0;var s={x:t.x,y:t.y},l=r.view.toMap({x:s.x,y:s.y}),u=l.coordinates[0]-n.coordinates[0],c=l.coordinates[1]-n.coordinates[1],f=l.coordinates[0]/n.coordinates[0],h=l.coordinates[1]/n.coordinates[1];0!==u||0!==c?(r._dispatchEvent("circleVertexScale",{startPoint:n,movePoint:l,deltaPosition:{x:u,y:c},scale:{x:f,y:h},direction:a,extent:o,feature:e,action:"scale"},r),i=!1,r._parent&&r._fireScalingEvent(r._parent.sketchStage.entityGraphic,r._parent)):i=!1}},l=function e(){r._startPan&&(r._dispatchEvent("circleVertexScale",{action:"stop"},r),r._startPan=!1,r.view.off(u.ViewEventType.pointerUp,e),r.view.off(u.ViewEventType.pointerMove,s),r._parent&&r._parent.undoRedoManager&&r._parent.undoRedoManager.addProcess("update",r._parent.sketchStage),r._parent&&r._parent._mapClickEvent&&setTimeout(function(){r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent)},0),r.view._mapActionControl("drag-pan",!0),r._parent&&r._fireStopScaleEvent(r._parent.sketchStage.entityGraphic,r._parent))};this._hitTestEventHandlers.push(s),this._hitTestEventHandlers.push(l),this.view.on(u.ViewEventType.pointerUp,l),this.view.on(u.ViewEventType.pointerMove,s)}},{key:"startVertexMoveGraphics",value:function(e,t){var r=this;this.view._mapActionControl("drag-pan",!1);var n=!1;this._startPan=!0;var i=null;i=t.mapPoint;var o=e.attributes?e.attributes.vertexIndex:-2;"midVertex"===e.attributes.type?(this._fireAddVertexEvent(this._parent.sketchStage.entityGraphic,this._parent),this._dispatchEvent("midVertexAdd",{point:i,vertexIndex:e.attributes?o:void 0,action:"changeFeature"},this),this._startPan=!0):this._startPan=!0,this._parent&&this._parent._mapClickEvent&&this.view.off(u.ViewEventType.immediateClick,this._parent._mapClickEvent),this._parent&&this._fireStartVertexMoveEvent(this._parent.sketchStage.entityGraphic,this._parent);var a=function(t){if(t&&t.x&&t.y&&!n&&r._startPan){clearTimeout(null),n=!0;var a={x:t.x,y:t.y},s=r.view.toMap({x:a.x,y:a.y}),l=s.coordinates[0]-i.coordinates[0],u=s.coordinates[1]-i.coordinates[1];0!==l||0!==u?("midVertex"===e.attributes.type?r._dispatchEvent("midVertexAdd",{startPoint:i,movePoint:s,vertexIndex:o,vertexType:e.attributes?e.attributes.type:void 0,action:"moveMidVertex"},r):r._dispatchEvent("vertexMove",{startPoint:i,movePoint:s,vertexIndex:o,vertexType:e.attributes?e.attributes.type:void 0},r),i=s,n=!1,r._parent&&r._fireUpdateVertex(r._parent.sketchStage.entityGraphic,r._parent)):n=!1}},s=function t(o){if(o&&o.x&&o.y&&r._startPan){if(r.view._mapActionControl("drag-pan",!1),r._startPan=!1,r.view.off(u.ViewEventType.pointerUp,t),r.view.off(u.ViewEventType.pointerMove,a),r.view._mapActionControl("drag-pan",!0),"midVertex"===e.attributes.type){var s=e.attributes.vertexIndex;r._dispatchEvent("midVertexAdd",{point:i,vertexIndex:e.attributes?s:void 0,action:"addVertex"},r)}n=!1,r._parent&&r._parent.undoRedoManager&&r._parent.undoRedoManager.addProcess("update",r._parent.sketchStage),r._parent&&r._parent._mapClickEvent&&setTimeout(function(){r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent)},0),r.view._mapActionControl("drag-pan",!0),r._parent&&r._fireStopVertexMoveEvent(r._parent.sketchStage.entityGraphic,r._parent)}};this._hitTestEventHandlers.push(a),this._hitTestEventHandlers.push(s),this.view.on(u.ViewEventType.pointerUp,s),this.view.on(u.ViewEventType.pointerMove,a)}},{key:"_processEvent",value:function(e){"pan"===e.type?this._handlerPanEvent(e):"vertexScale"===e.type?this._handlerVertexScaleEvent(e):"midVertexScale"===e.type?this._handlerMidVertexScaleEvent(e):"circleVertexScale"===e.type&&this._handlerCircleVertexScaleEvent(e)}},{key:"_handlerPanEvent",value:function(e){var t=this.getPanCoordinates(this.sketchStage.entityGraphic.geometry.coordinates,e.deltaPosition.x,e.deltaPosition.y,this.sketchStage.entityGraphic.attributes.direction,e.extent),r=new c.Point({coordinates:t,spatialReference:this._spatialReference});this.sketchStage.entityGraphic.geometry=r}},{key:"_handlerVertexScaleEvent",value:function(e){if("scale"===e.action){if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var t=JSON.parse((0,n.default)([this.sketchStage.entityGraphic.geometry.coordinates]));this.sketchStage.entityGraphic.attributes.lastCoordinates=t}this.sketchStage.entityGraphic.attributes=this.sketchStage.entityGraphic.attributes?this.sketchStage.entityGraphic.attributes:{};var r=void 0;if(this._parent){var i=this._parent.sketchStage.entityGraphic.geometry.extent,o=this.sketchStage.entityGraphic.attributes.direction;"e"===o?r=this._getCenterCoordinate([i.xmax,i.ymin],[i.xmax,i.ymax]):"s"===o?r=this._getCenterCoordinate([i.xmax,i.ymin],[i.xmin,i.ymin]):"w"===o?r=this._getCenterCoordinate([i.xmin,i.ymin],[i.xmin,i.ymax]):"n"===o?r=this._getCenterCoordinate([i.xmax,i.ymax],[i.xmin,i.ymax]):"ne"===o?r=[i.xmax,i.ymax]:"se"===o?r=[i.xmax,i.ymin]:"sw"===o?r=[i.xmin,i.ymin]:"nw"===o&&(r=[i.xmin,i.ymax])}r||(r=this.getScaleCoordinates([this.sketchStage.entityGraphic.geometry.coordinates],e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates,this.sketchStage.entityGraphic.attributes.direction)[0]);var a=new c.Point({coordinates:r,spatialReference:this._spatialReference});this.sketchStage.entityGraphic.geometry=a}"stop"===e.action&&this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0)}},{key:"_handlerMidVertexScaleEvent",value:function(e){if("scale"===e.action){var t;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=JSON.parse((0,n.default)([this.sketchStage.entityGraphic.geometry.coordinates]));this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var i=this.getMidScaleCoordinates([this.sketchStage.entityGraphic.geometry.coordinates],e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t=new c.Point({coordinates:i[0],spatialReference:this._spatialReference}),this.sketchStage.entityGraphic.geometry=t,this._parent&&this._parent.sketchStage.updateGraphic(this.sketchStage.entityGraphic)}else"stop"===e.action&&this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0)}},{key:"_handlerCircleVertexScaleEvent",value:function(e){this._handlerMidVertexScaleEvent(e)}}]),t}(f.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(5)),l=r(8),u=r(1),c=r(9),f=d(r(565)),h=r(148);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this));return r._id=(0,u.defaultValue)(e.id,(0,u.getGUID)()),r.view=(0,u.defaultValue)(e.view,null),r.layer=(0,u.defaultValue)(e.layer,void 0),r.sketchInnerLayer=(0,u.defaultValue)(e.sketchInnerLayer,void 0),r.sketchStage=new f.default,void 0!==e.sketchStyle&&(r.sketchStyle=e.sketchStyle.clone()),r.elevationInfo=(0,u.defaultValue)(e.elevationInfo,void 0),r.type="sketchBaseDrawTool",r.extensionOptions=(0,u.defaultValue)(e.extensionOptions,void 0),r._editMode=l.SketchEditMode.NONE,r._spatialReference=e.view._spatialReference?e.view._spatialReference:new c.SpatialReference("EPSG:4326"),r._drawEventHandlers=[],r._hitTestEventHandlers=[],r._sketchDataType=null,r._parent=(0,u.defaultValue)(e._parent,void 0),r.undoRedoManager=(0,u.defaultValue)(e.undoRedoManager,void 0),r.editOption=(0,u.defaultValue)(e.editOption,{showSelectBox:!0,showSelectVertex:!1,canEditFeature:!0,canEditVertex:!0,_hitTestMode:0}),r._drawTools=[],r._hitTestDrawToolStack=[],r._clampToGround=!0,r.snapAndReferGeometries=[],r._sketchEditor=(0,u.defaultValue)(e._sketchEditor,void 0),r._sketchEditor&&(r.sketchSnappingTool=r._sketchEditor._sketchSnappingTool,r.snapAndReferGeometries=r._sketchEditor.snapAndReferGeometries),r.cursorStyle=null,r._snapPoint=null,r._sketchDataType=e.sketchDataType,r.arcType=e.arcType,r._getCenterCoordinate=e._getCenterCoordinate,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"start",value:function(){this.stop(),this.drawFeature()}},{key:"stop",value:function(){this._editMode===l.SketchEditMode.DRAWING||this._editMode===l.SketchEditMode.NONE?this._stopDraw():this._editMode===l.SketchEditMode.EDITGRAGIC||this._editMode===l.SketchEditMode.EDITVERTEX?this._stopHitTest():(this._stopDraw(),this._stopHitTest())}},{key:"_stopAll",value:function(){this._stopDraw(),this._stopHitTest()}},{key:"_stopDraw",value:function(){var e=this;this._drawEventHandlers&&(this._drawEventHandlers.forEach(function(t){e.view.off(l.ViewEventType.immediateClick,t),e.view.off(l.ViewEventType.pointerUp,t),e.view.off(l.ViewEventType.pointerMove,t),e.view.off(l.ViewEventType.pointerDown,t),e.view.off(l.ViewEventType.doubleClick,t),e.view.off(l.ViewEventType.drag,t)}),this._drawEventHandlers=[]),this._stopInitSnap()}},{key:"_stopHitTest",value:function(){var e=this;this._hitTestEventHandlers&&(this._hitTestEventHandlers.forEach(function(t){e.view.off(l.ViewEventType.pointerUp,t),e.view.off(l.ViewEventType.pointerMove,t),e.view.off(l.ViewEventType.pointerDown,t),e.view.off(l.ViewEventType.click,t),e.view.off(l.ViewEventType.immediateClick,e._mapClickEvent)}),this._mapClickEvent=null,this._hitTestEventHandlers=[])}},{key:"setSketchStyle",value:function(e){this.sketchStyle=e}},{key:"_clearEditGraphics",value:function(e){var t=this,r=function(){t.sketchStage.selectBoxGraphics.concat(t.sketchStage.selectBoxVertexGraphics).forEach(function(e){t._removeFeatureFromLayer(e,t.sketchInnerLayer)}),t._otherDrawTools=[],t.sketchStage.selectBoxGraphics=[],t.sketchStage.selectBoxVertexGraphics=[]},n=function(){var e=null;(e=t._parent?t._parent:t).sketchStage.vertexGraphics.concat(e.sketchStage.midVertexGraphics).forEach(function(e){t._removeFeatureFromLayer(e,t.sketchInnerLayer)}),e._otherDrawTools=[],e.sketchStage.vertexGraphics=[],e.sketchStage.midVertexGraphics=[]};e===l.SketchEditMode.EDITGRAGIC?r():e===l.SketchEditMode.EDITVERTEX?n():(r(),n())}},{key:"_isDrawToolFeature",value:function(e){var t=this,r=e.id,n=!1;return this.sketchStage.entityGraphic.id===r&&(n=!0,this._editMode=l.SketchEditMode.EDITGRAGIC),this.sketchStage.vertexGraphics.forEach(function(e){e.id===r&&(n=!0,t._editMode=l.SketchEditMode.EDITVERTEX)}),this.sketchStage.midVertexGraphics.forEach(function(e){e.id===r&&(n=!0,t._editMode=l.SketchEditMode.EDITVERTEX)}),n||(this._editMode=l.SketchEditMode.NONE),n}},{key:"_getDrawToolByFeature",value:function(e){var t=e.id,r=null;return this.sketchStage.entityGraphic.id===t&&(r=this.sketchStage.entityGraphic),r.length>0?r[0]:null}},{key:"_addFeaturesToMap",value:function(e){this.layer&&this.layer.add(e)}},{key:"_addFeatureToLayer",value:function(e,t){t&&t.add(e)}},{key:"_removeFeatureFromMap",value:function(e){this.layer&&this.layer.remove(e)}},{key:"_removeFeatureFromLayer",value:function(e,t){t&&t.remove(e)}},{key:"_dispatchEvent",value:function(e,t,r){return this._parent&&this._parent.fire(e,t,r),this}},{key:"updateFeature",value:function(e,t){var r=t.id;this.sketchStage.entityGraphic.id===r&&(this.sketchStage.entityGraphic.coordinates=e.coordinates,this.sketchStage.entityGraphic.geometry=e,t=this.sketchStage.entityGraphic)}},{key:"removeDrawTool",value:function(){var e=this;this._removeFeatureFromLayer(this.sketchStage.entityGraphic,this.layer),this.sketchStage.getAllFeatures().forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),this._stopAll()}},{key:"removeEntityGraphic",value:function(){this._removeFeatureFromLayer(this.sketchStage.entityGraphic,this._layer),this.sketchStage.entityGraphic=null}},{key:"removeVertexGraphics",value:function(){var e=this;this.sketchStage.vertexGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e._sketchInnerLayer)}),this.sketchStage.vertexGraphics=[]}},{key:"addVertex",value:function(e,t){}},{key:"updateVertex",value:function(e,t){}},{key:"removeVertex",value:function(e,t){}},{key:"getDistanceByPixel",value:function(e){return this.view.getResolution?this.view.getResolution()*e:1e3}},{key:"getPanCoordinates",value:function(e,t,r,n,i){return"e"===n?this._getCenterCoordinate([i.xmax,i.ymin],[i.xmax,i.ymax]):"s"===n?this._getCenterCoordinate([i.xmax,i.ymin],[i.xmin,i.ymin]):"w"===n?this._getCenterCoordinate([i.xmin,i.ymin],[i.xmin,i.ymax]):"n"===n?this._getCenterCoordinate([i.xmax,i.ymax],[i.xmin,i.ymax]):[e[0]+t,e[1]+r]}},{key:"getScaleCoordinates",value:function(e,t,r,n,i,o,a){var s=[];return o=o||[],e.forEach(function(e,a){var l=function(e,t,r,o,a){var s=1,l=1,u=Number(e[0].toString()),c=Number(e[1].toString()),f=n.coordinates,h=i.coordinates;return o=o||[],"ne"===r&&(s=(h[0]-t.xmin)/(f[0]-t.xmin),u=([o[0]]-t.xmin)*s+t.xmin,l=(h[1]-t.ymin)/(f[1]-t.ymin),c=(o[1]-t.ymin)*l+t.ymin),"se"===r&&(s=(h[0]-t.xmin)/(f[0]-t.xmin),u=([o[0]]-t.xmin)*s+t.xmin,l=(h[1]-t.ymax)/(f[1]-t.ymax),c=(o[1]-t.ymax)*l+t.ymax),"sw"===r&&(s=(h[0]-t.xmax)/(f[0]-t.xmax),u=([o[0]]-t.xmax)*s+t.xmax,l=(h[1]-t.ymax)/(f[1]-t.ymax),c=(o[1]-t.ymax)*l+t.ymax),"nw"===r&&(s=(h[0]-t.xmax)/(f[0]-t.xmax),u=([o[0]]-t.xmax)*s+t.xmax,l=(h[1]-t.ymin)/(f[1]-t.ymin),c=(o[1]-t.ymin)*l+t.ymin),[u,c]}(e,r,t,o[a]);void 0!==e[2]&&(l[2]=e[2]),s.push(l)}),s}},{key:"getMidScaleCoordinates",value:function(e,t,r,n,i,o){var a=[];return o=o||[],e.forEach(function(e,s){var l=function(e,t,r,o){var a=1,s=1,l=e[0],u=e[1],c=n.coordinates,f=i.coordinates;return o=o||[],"e"===r&&(a=(f[0]-t.xmin)/(c[0]-t.xmin),l=([o[0]]-t.xmin)*a+t.xmin),"s"===r&&(s=(f[1]-t.ymax)/(c[1]-t.ymax),u=(o[1]-t.ymax)*s+t.ymax),"w"===r&&(a=(f[0]-t.xmax)/(c[0]-t.xmax),l=([o[0]]-t.xmax)*a+t.xmax),"n"===r&&(s=(f[1]-t.ymin)/(c[1]-t.ymin),u=(o[1]-t.ymin)*s+t.ymin),[l,u]}(e,r,t,o[s]);e[2]&&(l[2]=e[2]),a.push(l)}),a}},{key:"getCenterScaleCoordinates",value:function(e,t,r,n,i,o){var a=[];return o=o||[],e.forEach(function(e,s){var l=function(e,t,r,o){var a=1,s=1,l=e[0],u=e[1],c=n.coordinates,f=i.coordinates;return o=o||[],"e"===r&&(a=(f[0]-t.xmin)/(c[0]-t.xmin),l=([o[0]]-t.xmin)*a+t.xmin),"s"===r&&(s=(f[1]-t.ymax)/(c[1]-t.ymax),u=(o[1]-t.ymax)*s+t.ymax),"w"===r&&(a=(f[0]-t.xmax)/(c[0]-t.xmax),l=([o[0]]-t.xmax)*a+t.xmax),"n"===r&&(s=(f[1]-t.ymin)/(c[1]-t.ymin),u=(o[1]-t.ymin)*s+t.ymin),[l,u]}(e,r,t,o[s]);e[2]&&(l[2]=e[2]),a.push(l)}),a}},{key:"_setSketchStage",value:function(e){this.sketchStage=e}},{key:"_getDrawToolByFeatureId",value:function(e){return this._drawTools.find(function(t){return t.sketchStage.entityGraphic&&t.sketchStage.entityGraphic.id===e})}},{key:"_removeEditGraphics",value:function(){var e=this;this.sketchStage.selectBoxGraphics.concat(this.sketchStage.selectBoxVertexGraphics).concat(this.sketchStage.vertexGraphics).concat(this.sketchStage.midVertexGraphics).forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),this.sketchStage.selectBoxGraphics=[],this.sketchStage.selectBoxVertexGraphics=[],this.sketchStage.vertexGraphics=[],this.sketchStage.midVertexGraphics=[]}},{key:"_getInteractiveDom",value:function(){for(var e=[],t=document.getElementsByClassName("leaflet-interactive"),r=0;r<t.length;r++)e.push(t[r]);return e}},{key:"_removeInteractiveStyle",value:function(e){for(var t=0;t<e.length;t++)e[t].classList.remove("leaflet-interactive")}},{key:"_addInteractiveStyle",value:function(e){for(var t=0;t<e.length;t++)e[t].classList.add("leaflet-interactive")}},{key:"_setInitSnap",value:function(){var e=this;this._snapPoint=null,this._handlerInitMouseMove=function(t){if(t&&t.x&&t.y){var r={x:t.x,y:t.y},n=e.view.toMap({x:r.x,y:r.y});e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),e._snapPoint=e.getSnapGraphics(n)}},this._drawEventHandlers.push(this._handlerInitMouseMove),this.view.on(l.ViewEventType.pointerMove,this._handlerInitMouseMove)}},{key:"_stopInitSnap",value:function(){this._handlerInitMouseMove&&(this.view.off(l.ViewEventType.pointerMove,this._handlerInitMouseMove),this._handlerInitMouseMove=void 0)}},{key:"_fireStartDrawEvent",value:function(e){e=e||this;var t=new h.SketchEditorEvent({type:l.SketchEditorEventType.create,toolEventInfo:{},state:l.SketchEditorState.start});e.fire(l.SketchEditorEventType.create,t,self)}},{key:"_fireDrawVertexEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.create,toolEventInfo:{type:l.SketchEditorToolEventType.vertexAdd},state:l.SketchEditorState.active,feature:e,geometry:e?e.geometry:void 0});t.fire(l.SketchEditorEventType.create,r,self)}},{key:"_fireChangeCursorEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.create,toolEventInfo:{type:l.SketchEditorToolEventType.cursorChange},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.create,r,self)}},{key:"_fireStopDrawEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.create,toolEventInfo:null,state:l.SketchEditorState.complete,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.create,r,self)}},{key:"_fireStartPanEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.moveStart},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_firePanningEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.move},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireStopPanEvent",value:function(e,t){var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.moveStop},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireStartScaleEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.scaleStart},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireScalingEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.scale},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireStopScaleEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.scaleStop},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireStartVertexMoveEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.vertexMoveStart},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireUpdateVertex",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.vertexUpdate},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireStopVertexMoveEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.vertexMoveStop},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireAddVertexEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.vertexAdd},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireAddVertexEventByFun",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.vertexAdd},state:l.SketchEditorState.complete,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,this)}},{key:"_fireUpdateVertexByFun",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.vertexUpdate},state:l.SketchEditorState.active,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireRemoveVertexByFun",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.vertexRemove},state:l.SketchEditorState.complete,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,this)}},{key:"_fireRemoveSelectEvent",value:function(e,t){t=t||this;var r=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:null,state:l.SketchEditorState.complete,feature:e,geometry:e.geometry});t.fire(l.SketchEditorEventType.update,r,self)}},{key:"_fireUnsimpleDraw",value:function(e){e=e||this;var t=new h.SketchEditorEvent({type:l.SketchEditorEventType.create,toolEventInfo:{type:l.SketchEditorToolEventType.geometryUnsimple},state:l.SketchEditorState.active});e.fire(l.SketchEditorEventType.create,t,self)}},{key:"_fireUnsimpleUpdate",value:function(e){e=e||this;var t=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.geometryUnsimple},state:l.SketchEditorState.active});e.fire(l.SketchEditorEventType.update,t,self)}},{key:"_fireUnsimpleUpdateByFun",value:function(e){e=e||this;var t=new h.SketchEditorEvent({type:l.SketchEditorEventType.update,toolEventInfo:{type:l.SketchEditorToolEventType.geometryUnsimple},state:l.SketchEditorState.complete});e.fire(l.SketchEditorEventType.update,t,self)}},{key:"getSnapGraphics",value:function(e,t){var r=this,n=null,i=null,o=[],a=null;t&&0!==t.length?1===t.length?i=new c.LineString({coordinates:[t[0],e.coordinates],spatialReference:this._spatialReference}):(i=new c.LineString({coordinates:t.slice(-2),spatialReference:this._spatialReference}),"sketchFreehandPolylineDrawTool"!==this.type&&"sketchFreehandPolygonDrawTool"!==this.type&&(a=new c.LineString({coordinates:t.slice(0,t.length),spatialReference:this._spatialReference}))):i=e,o=this.snapAndReferGeometries,this.sketchSnappingTool.snapSketchGeometry&&a&&(o=this.snapAndReferGeometries.concat([a])),t&&t.length>0&&("sketchFreehandPolylineDrawTool"===this.type||"sketchFreehandPolygonDrawTool"===this.type)&&o.push(new c.Point({coordinates:t[0],spatialReference:this._spatialReference}));var s=this.sketchSnappingTool.snapGeometries(e,i,o);if(s.coincidentPoint){var u=new l.Feature({geometry:s.coincidentPoint.realPoint,symbol:this.sketchStyle._coincidentPointStyle,elevationInfo:this.elevationInfo});this.sketchStage.snapGraphics.push(u),n=s.coincidentPoint.realPoint}else if(s.inLineAndParallel){s.inLineAndParallel.lines.forEach(function(e){var t=new l.Feature({geometry:e,symbol:r.sketchStyle._parallelLineStyle,elevationInfo:r.elevationInfo});r.sketchStage.snapGraphics.push(t)});var f=new l.Feature({geometry:s.inLineAndParallel.realPoint,symbol:this.sketchStyle._highlightPointStyle,elevationInfo:this.elevationInfo});if(this.sketchStage.snapGraphics.push(f),s.inLineAndParallel.symbolGeometry){var h=new l.Feature({geometry:s.inLineAndParallel.symbolGeometry,symbol:this.sketchStyle._parallelLineStyle,elevationInfo:this.elevationInfo});this.sketchStage.snapGraphics.push(h)}n=s.inLineAndParallel.realPoint}else if(s.inLineAndPerpendicular){s.inLineAndPerpendicular.lines.forEach(function(e){var t=new l.Feature({geometry:e,symbol:r.sketchStyle._perpendicularLineStyle,elevationInfo:r.elevationInfo});r.sketchStage.snapGraphics.push(t)});var d=new l.Feature({geometry:s.inLineAndPerpendicular.realPoint,symbol:this.sketchStyle._highlightPointStyle,elevationInfo:this.elevationInfo});if(this.sketchStage.snapGraphics.push(d),s.inLineAndPerpendicular.symbolGeometry){var p=new l.Feature({geometry:s.inLineAndPerpendicular.symbolGeometry,symbol:this.sketchStyle._perpendicularLineStyle,elevationInfo:this.elevationInfo});this.sketchStage.snapGraphics.push(p)}n=s.inLineAndPerpendicular.realPoint}else if(s.pointInLine){var y=new l.Feature({geometry:s.pointInLine.line,symbol:this.sketchStyle._highlightLineStyle,elevationInfo:this.elevationInfo});this.sketchStage.snapGraphics.push(y);var g=new l.Feature({geometry:s.pointInLine.realPoint,symbol:this.sketchStyle._highlightPointStyle,elevationInfo:this.elevationInfo});this.sketchStage.snapGraphics.push(g),n=s.pointInLine.realPoint}else if(s.parallelLine){var v=new l.Feature({geometry:s.parallelLine.line,symbol:this.sketchStyle._parallelLineStyle,elevationInfo:this.elevationInfo});this.sketchStage.snapGraphics.push(v);var m=new l.Feature({geometry:s.parallelLine.realPoint,symbol:this.sketchStyle._highlightPointStyle,elevationInfo:this.elevationInfo});if(this.sketchStage.snapGraphics.push(m),s.parallelLine.symbolGeometry){var _=new l.Feature({geometry:s.parallelLine.symbolGeometry,symbol:this.sketchStyle._parallelLineStyle,elevationInfo:this.elevationInfo});this.sketchStage.snapGraphics.push(_)}n=s.parallelLine.realPoint}else if(s.perpendicularLine){var S=new l.Feature({geometry:s.perpendicularLine.line,symbol:this.sketchStyle._perpendicularLineStyle,elevationInfo:this.elevationInfo});this.sketchStage.snapGraphics.push(S);var x=new l.Feature({geometry:s.perpendicularLine.realPoint,symbol:this.sketchStyle._highlightPointStyle,elevationInfo:this.elevationInfo});if(this.sketchStage.snapGraphics.push(x),s.perpendicularLine.symbolGeometry){var b=new l.Feature({geometry:s.perpendicularLine.symbolGeometry,symbol:this.sketchStyle._perpendicularLineStyle,elevationInfo:this.elevationInfo});this.sketchStage.snapGraphics.push(b)}n=s.perpendicularLine.realPoint}return this.sketchStage.snapGraphics.forEach(function(e){r._addFeatureToLayer(e,r.sketchInnerLayer)}),n}},{key:"setSnapAndReferGeometries",value:function(e){e?this.snapAndReferGeometries=e:this._sketchEditor&&(this.snapAndReferGeometries=this._sketchEditor.snapAndReferGeometries)}},{key:"debounce",value:function(e,t){var r=void 0;return function(){var n=this,i=arguments;clearTimeout(r),r=setTimeout(function(){e.apply(n,i)},t)}}}]),t}(l.Evented);t.default=p},function(e,t,r){var n=r(107),i=r(106);e.exports=function(e){return n(i(e))}},function(e,t,r){var n=r(27),i=r(62);e.exports=r(26)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasemapChangeEvent=t.LayerLoadedEvent=t.LayerChangeEvent=t.CollectionChangeEvent=t.ProxyEvent=t.LayerViewUpdateEvent=t.LayerEvent=t.ErrorEvent=t.Event=void 0;var n=h(r(47)),i=h(r(280)),o=h(r(166)),a=r(167),s=h(r(292)),l=h(r(293)),u=h(r(294)),c=h(r(295)),f=h(r(296));function h(e){return e&&e.__esModule?e:{default:e}}t.Event=n.default,t.ErrorEvent=i.default,t.LayerEvent=o.default,t.LayerViewUpdateEvent=a.LayerViewUpdateEvent,t.ProxyEvent=s.default,t.CollectionChangeEvent=l.default,t.LayerChangeEvent=u.default,t.LayerLoadedEvent=c.default,t.BasemapChangeEvent=f.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(0)),i=o(r(2));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){(0,n.default)(this,e),this.initPropertys(t)}return(0,i.default)(e,[{key:"initPropertys",value:function(e){var t=e||{};return this.type=t.type,this.target=t.target,t}},{key:"addProperty",value:function(e,t){e&&(this[e]=t)}}]),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(0)),i=o(r(2));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(){(0,n.default)(this,e),this.type="unkown"}return(0,i.default)(e,[{key:"toJSON",value:function(){return{type:this.type}}},{key:"clone",value:function(){}}],[{key:"fromJSON",value:function(){}}]),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSublayerArr=t.getLayersCollection=t.createLayer=t.flatServerSublayerInfos=t.setElevationInfo=t.fireEvent=t.setSublayer=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(16)),i=r(8),o=r(6),a=r(15),s=r(39);t.setSublayer=function(e,t,r){for(var i=!0,o=0;o<e._sublayers.length;o++)if(String(e._sublayers[o].name)===String(t.name)||String(e._sublayers[o].id)===String(t.id)){(0,n.default)(e._sublayers[o],t),i=!1;break}for(var a=0;a<e.allSublayers.length;a++)if(String(e.allSublayers[a].name)===String(t.name)||String(e.allSublayers[a].id)===String(t.id)){(0,n.default)(e.allSublayers[a],t),i=!1;break}if(i)if(t instanceof r)e._sublayers.push(t);else if(t instanceof Object&&!(t instanceof Array))for(var s=0;s<e.allSublayers.length;s++)if(String(t.id)===String(e.allSublayers[s].id)||String(t.name)===String(e.allSublayers[s].name)){e._sublayers.push(new r((0,n.default)(e.allSublayers[s].toJSON(),t)));break}},t.fireEvent=function(e,t,r){e._map&&e._map.fire(t,new i.LayerEvent({type:r,target:e._map,layer:e,extend:{type:r}}))},t.setElevationInfo=function(e,t){e.elevationInfo||(t.elevationInfo?e.elevationInfo=t.elevationInfo:e.elevationInfo=new i.ElevationInfo)},t.flatServerSublayerInfos=function e(t,r){!t||!Array.isArray(t)||t.length<=0||t.forEach(function(t){r.push(t),t.children&&e(t.children,r)})},t.createLayer=function(e){var t=void 0;switch((e=e||{}).type){case o.LayerType.arcgisMapImage:t=s.ArcGISMapImageLayer.fromJSON(e);break;case o.LayerType.arcgisTile:t=s.ArcGISTileLayer.fromJSON(e);break;case o.LayerType.arcgisVectorTile:t=s.ArcGISVectorTileLayer.fromJSON(e);break;case o.LayerType.cesium3DTiles:t=s.Cesium3DTilesCacheLayer.fromJSON(e);break;case o.LayerType.echarts:t=s.EchartsLayer.fromJSON(e);break;case o.LayerType.feature:t=s.FeatureLayer.fromJSON(e);break;case o.LayerType.geojson:t=s.GeoJSONLayer.fromJSON(e);break;case o.LayerType.graphics:t=s.GraphicsLayer.fromJSON(e);break;case o.LayerType.group:t=s.GroupLayer.fromJSON(e);break;case o.LayerType.igsFeature:t=s.IGSFeatureLayer.fromJSON(e);break;case o.LayerType.igsMapImage:t=s.IGSMapImageLayer.fromJSON(e);break;case o.LayerType.igsVectorTile:t=s.IGSVectorTileLayer.fromJSON(e);break;case o.LayerType.igsTile:t=s.IGSTileLayer.fromJSON(e);break;case o.LayerType.m3dCache:t=s.M3DModelCacheLayer.fromJSON(e);break;case o.LayerType.mapv:t=s.MapVLayer.fromJSON(e);break;case o.LayerType.terrain:t=s.TerrainCacheLayer.fromJSON(e);break;case o.LayerType.webTileLayer:t=s.WebTileLayer.fromJSON(e);break;case o.LayerType.wfs:t=s.WFSLayer.fromJSON(e);break;case o.LayerType.wms:t=s.WMSLayer.fromJSON(e);break;case o.LayerType.wmts:t=s.WMTSLayer.fromJSON(e);break;case o.LayerType.s3m:t=s.S3MTilesCacheLayer.fromJSON(e);break;case o.LayerType.unknown:default:t=s.UnknownLayer.fromJSON(e)}return t},t.getLayersCollection=function(e){return(e=e||[])instanceof i.Collection?e:(e=e.filter(function(e){return e}).map(function(e){return e instanceof s.Layer?e:s.Layer.fromJSON(e)}),new i.Collection(e))},t.toSublayerArr=function(e){if(e){var t=[];return e instanceof i.Collection?t=e.items:Array.isArray(e)&&(t=e),t.map(function(e){return e instanceof a.SubLayer?e.toJSON():e})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(5)),l=r(70),u=r(8),c=r(1);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this));return e=(0,c.defaultValue)(e,{}),r.id=(0,c.defaultValue)(e.id,(0,c.getGUID)()),r.type="",r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,id:this.id}}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.Evented);h.fromJSON=function(e){return(0,l.createRender)(e)},t.default=h},function(e,t,r){var n=r(106);e.exports=function(e){return Object(n(e))}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";t.__esModule=!0;var n=a(r(271)),i=a(r(273)),o="function"==typeof i.default&&"symbol"==typeof n.default?function(e){return typeof e}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":typeof e};function a(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof i.default&&"symbol"===o(n.default)?function(e){return void 0===e?"undefined":o(e)}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":void 0===e?"undefined":o(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=s(r(168));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,r,i,a){(0,n.default)(this,e),this.red=(0,o.defaultValue)(t,0),this.green=(0,o.defaultValue)(r,0),this.blue=(0,o.defaultValue)(i,0),this.alpha=(0,o.defaultValue)(a,1)}return(0,i.default)(e,[{key:"toCesiumRGB",value:function(){return{red:this.red/255,green:this.green/255,blue:this.blue/255,alpha:this.alpha}}},{key:"toCssRGBAString",value:function(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"}},{key:"toCssRGBString",value:function(){return"rgb("+this.red+","+this.green+","+this.blue+")"}},{key:"clone",value:function(){return new e(this.red,this.green,this.blue,this.alpha)}},{key:"toJSON",value:function(){return{red:this.red,green:this.green,blue:this.blue,alpha:this.alpha}}}]),e}();l.fromRGBString=function(e){if(l.isRGB(e))if(e.indexOf("rgba")>-1||e.indexOf("RGBA")>-1){var t=e.substring(5,e.length-1);if(4===(t=t.split(",")).length)return new l(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3]))}else if(e.indexOf("rgb")>-1||e.indexOf("RGB")>-1){var r=e.substring(4,e.length-1);if(3===(r=r.split(",")).length)return new l(Number(r[0]),Number(r[1]),Number(r[2]))}},l.fromHexString=function(e){if(l.isHex(e)){var t=l.hexToRgb(e);if(t.indexOf("rgba")>-1||t.indexOf("RGBA")>-1)return l.fromRGBString(t);if(t.indexOf("rgb")>-1||t.indexOf("RGB")>-1)return l.fromRGBString(t)}},l.fromJSON=function(e){e=(0,o.defaultValue)(e,{});var t=(0,o.defaultValue)(e.red,255),r=(0,o.defaultValue)(e.green,255),n=(0,o.defaultValue)(e.blue,255),i=(0,o.defaultValue)(e.alpha,1);return new l(t,r,n,i)},l.hexToRgb=function(e){if(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{4}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$/.test(e)){var t=e.toLowerCase().replace(/\#/g,""),r=t.length;if(3===r||4===r){for(var n="",i=0;i<r;i++)n+=t.slice(i,i+1).concat(t.slice(i,i+1));r=(t=n).length}for(var o=[],a=0;a<r;a+=2){var s=t.slice(a,a+2);o.push(parseInt("0x"+s))}var l=void 0;if(6===r)l="rgb("+o.join(",")+")";else if(8===r){l="rgba(";for(var u=0;u<3;u++)l+=o[u]+",";l+=o[3]/255+")"}return l}},l.rgbToHex=function(e){if(/^(rgb|rgba|RGB|RGBA)/.test(e)){var t;t=e.indexOf("rgba")>-1||e.indexOf("RGBA")>-1?e.slice(5,e.length-1).split(","):e.slice(4,e.length-1).split(",");for(var r="#",n=0;n<3;n++)r+=i(t[n]);return 4===t.length&&(r+=i(255*Number(t[3]))),r}function i(e){var t=Number(e).toString(16);return"0"===t&&(t+="0"),1===t.length&&(t="0"+t),t}},l.fromCssString=function(e){if(!e||"string"!=typeof e)return l.fromHexString("#000000");var t=e.toLowerCase(),r=a.default[t];return r?l.fromHexString(r):l.fromHexString("#000000")},l.fromColor=function(e){return"string"==typeof e?l.isHex(e)?l.fromHexString(e):l.isRGB(e)?l.fromRGBString(e):l.fromCssString(e):e instanceof l?e:Array.isArray(e)?3===e.length?new l(e[0],e[1],e[2]):4===e.length?new l(e[0],e[1],e[2],e[3]):(o.Log.info("非法颜色值数组!"),new l):e instanceof Object?l.fromJSON(e):new l},l.isHex=function(e){return/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{4}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$/.test(e)},l.isRGB=function(e){return/^(rgb|rgba|RGB|RGBA)/.test(e)},t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={default:"default",color:"color",opacity:"opacity",size:"size"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(5)),l=d(r(80)),u=r(8),c=r(1),f=r(6),h=r(22);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this));return e=(0,c.defaultValue)(e,{}),r.id=(0,c.defaultValue)(e.id,(0,c.getGUID)()),r.color=u.Color.fromColor((0,c.defaultValue)(e.color,new u.Color(255,255,255,.25))),r.type=f.SymbolType.default,r.extensionOptions=(0,c.defaultValue)(e.extensionOptions,{}),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{color:u.Color.fromColor(this.color).toJSON(),type:this.type,extensionOptions:(0,c.cloneObject)(this.extensionOptions),id:this.id}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return(0,h.createSymbol)(e)}}]),t}(l.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(53)),i=u(r(0)),o=u(r(2)),a=r(1),s=r(184),l=u(r(132));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,i.default)(this,e),t=(0,a.defaultValue)(t,{});var r=this._parseSpatialReferenceOptions(t),n=r.wkid,o=r.wkt;this.wkid=n,this.wkt=o,this.unit=t.unit}return(0,o.default)(e,[{key:"_parseSpatialReferenceOptions",value:function(e){var t=4326,r=void 0;if(e.wkid&&e.wkt)return{wkid:e.wkid,wkt:e.wkt};if("string"==typeof e){var i=e.match(/\d+$/);/^(EPSG|epsg)(:)?\d+$/.test(e)&&i?(t=parseInt(i[0]),r=void 0):(r=e,t=void 0)}else"object"===(void 0===e?"undefined":(0,n.default)(e))?((0,a.defined)(e.wkid)&&(t=parseInt(e.wkid)),e.wkt&&(r=e.wkt,t=void 0)):a.Log.error("无法解析传入的空间参考系参数");return{wkid:t,wkt:r}}},{key:"clone",value:function(){return new e(this.toJSON())}},{key:"toJSON",value:function(){return{wkid:this.wkid,wkt:this.wkt}}},{key:"toString",value:function(){return this.wkid?"EPSG:"+this.wkid:this.wkt?this.wkt:void 0}},{key:"equals",value:function(t){if(!(t instanceof e||t instanceof Object&&t.hasOwnProperty("wkid")&&t.hasOwnProperty("wkt")))throw new Error("spatialReference的格式不正确！");return!!(this===t||this.wkid&&t.wkid&&this.wkid===t.wkid||this.wkt&&t.wkt&&this.wkt.toUpperCase()===t.wkt.toUpperCase())}},{key:"isWGS84",get:function(){return 4326===this.wkid}},{key:"isGeographic",get:function(){return!!(this.wkid&&void 0===s.ProjUnitWkidMap[this.wkid]||/^GEOGCS/.test(this.wkt)||/^[+]proj=longlat/.test(this.wkt))||this.wkid===l.default.bd09ll||this.wkid===l.default.gcj02ll}},{key:"isWebMercator",get:function(){return[102113,102100,900913,3857].indexOf(this.wkid)>-1||this.wkid===l.default.bd09mc||this.wkid===l.default.gcj02mc}},{key:"isWrappable",get:function(){return[4326,4490,4610,4214,102113,102100,900913,3857].indexOf(this.wkid)>-1}},{key:"WebMercator",get:function(){return this.isWebMercator?this.clone():void 0}},{key:"WGS84",get:function(){return this.isGeographic?this.clone():void 0}}],[{key:"fromJSON",value:function(t){return new e(t=(0,a.defaultValue)(t,{}))}}]),e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(r(11)),i=_(r(3)),o=_(r(0)),a=_(r(2)),s=_(r(4)),l=_(r(7)),u=_(r(5)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(35)),f=_(r(29)),h=r(1),d=_(r(37)),p=r(6),y=_(r(81)),g=_(r(57)),v=_(r(66)),m=_(r(83));function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));if(e=(0,h.defaultValue)(e,{}),r.xmin=(0,h.defaultValue)(e.xmin,0),r.ymin=(0,h.defaultValue)(e.ymin,0),r.xmax=(0,h.defaultValue)(e.xmax,0),r.ymax=(0,h.defaultValue)(e.ymax,0),r.zmin=(0,h.defaultValue)(e.zmin,void 0),r.zmax=(0,h.defaultValue)(e.zmax,void 0),r.type=p.GeometryType.extent,r.hasZ=!(!(0,h.isNumber)(r.zmin)||!(0,h.isNumber)(r.zmax)),!(0,h.isNumber)(r.xmin)||!(0,h.isNumber)(r.ymin)||!(0,h.isNumber)(r.xmax)||!(0,h.isNumber)(r.ymax)||void 0!==r.zmin&&!(0,h.isNumber)(r.zmin)||void 0!==r.zmax&&!(0,h.isNumber)(r.zmax))throw new Error("坐标必须为数字");return r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"centerAt",value:function(e){if(!e)throw new Error("传入参数错误");var t=d.default.toCoordinates(e),r=this.width,n=this.height;if(this.xmin=t[0]-r/2,this.xmax=t[0]+r/2,this.ymin=t[1]-n/2,this.ymax=t[1]+n/2,this.hasZ&&e.hasZ){var i=this.zmax-this.zmin;this.zmin=t[2]-i/2,this.zmax=t[2]+i/2}return this}},{key:"contains",value:function(e){if(!(e instanceof d.default||e instanceof t))return!1;var r=e;r.isGeographic||(r=y.default.project(e,new g.default({wkid:4326})));var n=this;n.isGeographic||(n=y.default.project(this,new g.default({wkid:4326})));var i,o=c.polygon([[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]);return i=r instanceof d.default?c.point(r._cloneCoordinates()):c.polygon([[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]),c.booleanContains(o,i)}},{key:"intersection",value:function(e){e||h.Log.error("传入参数错误!"),e instanceof t||h.Log.error("extent不是Extent几何!"),this.spatialReference.equals(e.spatialReference)||h.Log.error("不是同一个坐标系!");var r=e;r.isGeographic||(r=y.default.project(e,new g.default({wkid:4326})));var n=this;n.isGeographic||(n=y.default.project(this,new g.default({wkid:4326})));var i=c.polygon([[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]),o=c.polygon([[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]),a=null,s=c.intersect(i,o);if(s&&s.geometry){var l=void 0;"Polygon"===s.geometry.type?l=c.bbox(c.polygon(s.geometry.coordinates)):"MultiPolygon"===s.geometry.type&&(l=c.bbox(c.multiPolygon(s.geometry.coordinates))),l&&(a=new t({xmin:l[0],ymin:l[1],xmax:l[2],ymax:l[3]}),this.spatialReference.isGeographic||(a=y.default.project(a,g.default.fromJSON(this.spatialReference))))}return a}},{key:"intersects",value:function(e){return v.default.intersects(this,e)}},{key:"equals",value:function(e){if(!e)throw new Error("传入参数错误");var t=!!Math.abs(this.xmax-e.xmax)<=1e-7,r=!!Math.abs(this.xmin-e.xmin)<=1e-7,n=!!Math.abs(this.ymax-e.ymax)<=1e-7,i=!!Math.abs(this.ymin-e.ymin)<=1e-7;if(!this.hasZ)return t&&r&&n&&i;var o=!!Math.abs(this.zmax-e.zmax)<=1e-7,a=!!Math.abs(this.zmin-e.zmin)<=1e-7;return t&&r&&n&&i&&o&&a}},{key:"expand",value:function(e){if("number"==typeof e){if(e>=1){e=Math.abs(e);var t=this.width*e,r=this.height*e,n=t-this.width,i=r-this.height;this.xmin-=n/2,this.xmax+=n/2,this.ymin-=i/2,this.ymax+=i/2}return this}throw new Error("按照给定的因子扩大范围,需要的是一个num值")}},{key:"offset",value:function(e,t,r){if(!(0,h.isNumber)(e)||!(0,h.isNumber)(t)||this.hasZ&&!(0,h.isNumber)(r))throw new Error("传入参数错误");return this.xmax+=e,this.xmin+=e,this.ymax+=t,this.ymin+=t,this.hasZ&&(this.zmax+=r,this.zmin+=r),this}},{key:"union",value:function(e){if(!e)throw new Error("传入参数错误");return this.hasZ?new t({xmin:e.xmin<this.xmin?e.xmin:this.xmin,xmax:e.xmax>this.xmax?e.xmax:this.xmax,ymin:e.ymin<this.ymin?e.ymin:this.ymin,ymax:e.ymax>this.ymax?e.ymax:this.ymax,zmin:e.zmin<this.zmin?e.zmin:this.zmin,zmax:e.zmax>this.zmax?e.zmax:this.zmax}):new t({xmin:e.xmin<this.xmin?e.xmin:this.xmin,xmax:e.xmax>this.xmax?e.xmax:this.xmax,ymin:e.ymin<this.ymin?e.ymin:this.ymin,ymax:e.ymax>this.ymax?e.ymax:this.ymax})}},{key:"toString",value:function(){return this.hasZ?this.xmin+","+this.ymin+","+this.zmin+","+this.xmax+","+this.ymax+","+this.zmax:this.xmin+","+this.ymin+","+this.xmax+","+this.ymax}},{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return e.xmin=this.xmin,e.ymin=this.ymin,e.xmax=this.xmax,e.ymax=this.ymax,e.zmin=this.zmin,e.zmax=this.zmax,e.width=this.width,e.height=this.height,e}},{key:"toIGSOldString",value:function(){return this.xmin+"$"+this.ymin+"$"+this.xmax+"$"+this.ymax}},{key:"getIGSType",value:function(){return this.hasZ?p.IGSGeometryType.extent3D:p.IGSGeometryType.extent}},{key:"normalize",value:function(){var e=new d.default({coordinates:[this.xmin,this.ymin]}),r=new d.default({coordinates:[this.xmax,this.ymax]});return e=e.normalize(),r=r.normalize(),new t({xmin:e.coordinates[0],ymin:e.coordinates[1],xmax:r.coordinates[0],ymax:r.coordinates[1]})}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toPolygon",value:function(){return m.default.fromExtent(this)}},{key:"toGeoJSON",value:function(){return this.toPolygon().toGeoJSON()}}],[{key:"fromJSON",value:function(e){return new t(e=(0,h.defaultValue)(e,{}))}}]),t}(f.default);(0,n.default)(S.prototype,{width:{configurable:!1,get:function(){return this.xmax-this.xmin}},height:{configurable:!1,get:function(){return this.ymax-this.ymin}},center:{configurable:!1,set:function(e){this.centerAt(e)},get:function(){return this.hasZ?new d.default({coordinates:[(this.xmax-this.xmin)/2+this.xmin,(this.ymax-this.ymin)/2+this.ymin,(this.zmax-this.zmin)/2+this.zmin],spatialReference:this.spatialReference}):new d.default({coordinates:[(this.xmax-this.xmin)/2+this.xmin,(this.ymax-this.ymin)/2+this.ymin],spatialReference:this.spatialReference})}}}),t.default=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getGeometryFilter=t.getFullBaseUrl=t.appendUrlParams=t.getGeometryTypeByFeatureSet=t.getZoomOffset=t.getTileResolution=t.initCorporationType=t.getEPSGCodeFromOGCSupportedCRSString=t.formatIGSRenderer=t.formatIGSSymbol=t.getLayerViewScaleVisible=t.showLayerByScale=t.isCustomSP=t.is4326=t.getUrlType=t.getEPSGFromTileMatrixSetId=void 0;var n=l(r(23)),i=r(6),o=r(1),a=r(8),s=r(167);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){switch((e=(0,o.defaultValue)(e,{})).type){case i.SymbolType.simpleMarker:case i.SymbolType.simpleFill:e.color&&(e.color=new a.Color(e.color[0],e.color[1],e.color[2],e.color[3]/255)),e.outline&&e.outline.color&&(e.outline.color=new a.Color(e.outline.color[0],e.outline.color[1],e.outline.color[2],e.outline.color[3]/255));break;case i.SymbolType.simpleLine:e.color&&(e.color=new a.Color(e.color[0],e.color[1],e.color[2],e.color[3]/255));break;case i.SymbolType.pictureMarker:e.color&&(e.color=new a.Color(e.color[0],e.color[1],e.color[2],e.color[3]/255)),e.url||(e.url=e.imageData);break;case i.SymbolType.pictureFill:e.outline&&e.outline.color&&(e.outline.color=new a.Color(e.outline.color[0],e.outline.color[1],e.outline.color[2],e.outline.color[3]/255)),e.url||(e.url=e.imageData);break;case i.SymbolType.text:e.color&&(e.color=new a.Color(e.color[0],e.color[1],e.color[2],e.color[3]/255)),e.backgroundColor&&(e.backgroundColor=new a.Color(e.backgroundColor[0],e.backgroundColor[1],e.backgroundColor[2],e.backgroundColor[3]/255)),e.borderLineColor&&(e.borderLineColor=new a.Color(e.borderLineColor[0],e.borderLineColor[1],e.borderLineColor[2],e.borderLineColor[3]/255)),e.haloColor&&(e.haloColor=new a.Color(e.haloColor[0],e.haloColor[1],e.haloColor[2],e.haloColor[3]/255))}return e}function c(e,t){t=(0,o.defaultValue)(t,{});var r="";return(0,n.default)(t).forEach(function(e){r+=e+"="+t[e]+"&"}),""===(r=r.substring(0,r.length-1))?e:e.indexOf("?")>-1?e.indexOf("&")>-1?e+"&"+r:""+e+r:e+"?"+r}l(r(67)),t.getEPSGFromTileMatrixSetId=function(e){if(!e)return"EPSG:4326";var t=e;return e.indexOf("EPSG:4326")>-1?t="EPSG:4326":e.indexOf("EPSG:4490")>-1?t="EPSG:4490":e.indexOf("EPSG:4610")>-1?t="EPSG:4610":e.indexOf("EPSG:3857")>-1&&(t="EPSG:3857"),t},t.getUrlType=function(e){var t=void 0,r=new RegExp("^http://t[0-6].tianditu.gov.cn/[a-z]{3}_[w|c]{1}/wmts$"),n=new RegExp("^http://[0-9.a-zA-Z]+:[0-9]{1,5}/igs/rest/services/[一-龟\\w/:_]+/WMTSServer$"),o=new RegExp("^https://[0-9.a-zA-Z]+:[0-9]{1,5}/igs/rest/services/[一-龟\\w/:_]+/WMTSServer$"),a=new RegExp("^http://[0-9.a-zA-Z]+/igs/rest/services/[一-龟\\w/:_]+/WMTSServer$"),s=new RegExp("^https://[0-9.a-zA-Z]+/igs/rest/services/[一-龟\\w/:_]+/WMTSServer$"),l=new RegExp("^http://[0-9.a-zA-Z]+:[0-9]{1,5}/arcgis/rest/services/[一-龟\\w/:_]+/WMTSServer$"),u=new RegExp("^https://[0-9.a-zA-Z]+:[0-9]{1,5}/arcgis/rest/services/[一-龟\\w/:_]+/WMTSServer$"),c=new RegExp("^http://[0-9.a-zA-Z]+/arcgis/rest/services/[一-龟\\w/:_]+/WMTSServer$"),f=new RegExp("^https://[0-9.a-zA-Z]+/arcgis/rest/services/[一-龟\\w/:_]+/WMTSServer$");return r.test(e)?t=i.UrlServerType.tdt:n.test(e)||o.test(e)||a.test(e)||s.test(e)?t=i.UrlServerType.igs_2:(l.test(e)||u.test(e)||c.test(e)||f.test(e))&&(t=i.UrlServerType.igs_2),t},t.is4326=function(e){return"4326"===String(e.wkid)||"4214"===String(e.wkid)||"4490"===String(e.wkid)||"4610"===String(e.wkid)},t.isCustomSP=function(e){return"4326"!==String(e.wkid)&&"4214"!==String(e.wkid)&&"4490"!==String(e.wkid)&&"4610"!==String(e.wkid)&&"3857"!==String(e.wkid)&&"900913"!==String(e.wkid)},t.showLayerByScale=function(e,t){t.visible&&function(e,t){var r=new s.LayerViewUpdateContent({name:"visible",params:[void 0],dataChanged:!0,operationType:"property",extensionOptions:{type:"scaleVisible",viewId:t._id}});e._fireUpdateEvent("最大最小比例尺引起图层显隐变化",[r])}(t,e)},t.getLayerViewScaleVisible=function(e){var t=void 0,r=e.view,n=e.layer,i=r.scale;if(!r.scale&&r.getScale&&(i=r.getScale()),!i)return!0;var o=n.minScale,a=n.maxScale;return"number"==typeof i&&i>0&&(t="number"==typeof o&&"number"==typeof a&&o>0&&a>0?i<=o&&i>=a:"number"==typeof o&&o>0&&("number"!=typeof a||a<=0)?i<=o:!("number"==typeof a&&a>0&&("number"!=typeof o||o<=0))||i>=a),t},t.formatIGSSymbol=u,t.formatIGSRenderer=function(e){switch((e=(0,o.defaultValue)(e,{})).type){case i.RendererType.simple:e.symbol=u(e.symbol);break;case i.RendererType.uniqueValue:e.defaultSymbol=u(e.defaultSymbol);for(var t=0;t<e.uniqueValueInfos.length;t++)e.uniqueValueInfos[t].symbol=u(e.uniqueValueInfos[t].symbol);break;case i.RendererType.classBreak:e.defaultSymbol=u(e.defaultSymbol);for(var r=0;r<e.classBreakInfos.length;r++)e.classBreakInfos[r].symbol=u(e.classBreakInfos[r].symbol);if(e.classBreakInfos.length>0){e.classBreakInfos[0].minValue=e.minValue,e.classBreakInfos[0].maxValue=e.classBreakInfos[0].classMaxValue;for(var n=1;n<e.classBreakInfos.length;n++)e.classBreakInfos[n].minValue=e.classBreakInfos[n-1].classMaxValue,e.classBreakInfos[n].maxValue=e.classBreakInfos[n].classMaxValue}}return e},t.getEPSGCodeFromOGCSupportedCRSString=function(e){var t=4326,r=-1;return(r=e.search("EPSG::"))>-1?t=parseInt(e.substring(r+"EPSG::".length)):(r=e.search("EPSG:"))>-1&&e.search("3857")>0?t=3857:((r=e.search("OGC:2:84"))<0&&(r=e.search("OGC:1.3:CRS84")),r>-1&&(t=4326)),3867!==t&&900913!==t&&102100!==t||(t=3857),t},t.initCorporationType=function(e){return void 0===e?i.WMTSCorporation.none:e.search("arcgis/rest/services")>0?i.WMTSCorporation.corporationArcGIS:e.search("WMTSServer")>0||e.search("WMSServer")>0?i.WMTSCorporation.corporationZD:e.search("geoserver")>0?i.WMTSCorporation.corporationGeoServer:e.search("tianditu.com")>0||e.search("tianditu.gov.cn")>0?i.WMTSCorporation.corporationTianDiTu:i.WMTSCorporation.corporationOther},t.getTileResolution=function(e,t,r,n){var o="",a=-1,s=0,l=0,u=0,c=25.4/96,f=1e3;return t===i.WMTSCorporation.corporationZD?(a=e.lastIndexOf("_GB"))>0?((a=(o=e.slice(0,e.length-3)).lastIndexOf("_"))>0&&(o=o.slice(a+1)),"028mm"===o?s=0:"arcgis"===o?s=1:"dpi96"===o?s=2:"GoogleMapsCompatible"===o&&(s=3),n.isGeographic?0===s?(f=111319490.79327358,c=.28):1===s?(c=.28,f=111194872.221777):2===s&&(f=111319490.79327358,c=25.4/96):0===s?c=.28:1===s?c=.28:2===s?c=25.4/96:3===s&&(c=.28)):n.isGeographic?(f=111194872.221777,c=25.4/96):c=25.4/96:t===i.WMTSCorporation.corporationArcGIS?(l=e.includes("default")?0:e.includes("native")?1:e.includes("GoogleMapsCompatible")?2:3,n.isGeographic?0===l?(r=.28*r*96/25.4,f=111194872.221777,c=.2645838625):1===l&&(f=111194872.221777,c=.2645838625):0===l?(r=.28*r*96/25.4,c=.2645838625):1===l?c=.2645838625:2===l&&(c=.28)):t===i.WMTSCorporation.corporationGeoServer?n.isGeographic?(f=111319490.79327358,c=.28):c=.28:t===i.WMTSCorporation.corporationTianDiTu?n.isGeographic?(f=111319490.79327358,c=25.4/96):c=25.4/96:(e.includes("028")&&(u=1),"".includes("GoogleMapsCompatible")&&(u=1),"".includes("GoogleCRS84Quad")&&(u=1),n.isGeographic?1===u?(r=.28*r*96/25.4,f=111194872.221777,c=.2645838625):(f=111319490.79327358,c=25.4/96):1===u?(r=.28*r*96/25.4,c=.2645838625):c=25.4/96),r*c/f},t.getZoomOffset=function(e,t,r){r=(0,o.defaultValue)(r,.01);for(var n=0;n<e.length;n++)if(Math.abs(e[n].resolution-t.resolution)/t.resolution<r)return e[0].level-n+t.level;return 0},t.getGeometryTypeByFeatureSet=function(e){var t=i.GeometryType.geometry;return e&&e.features&&Array.isArray(e.features)&&e.features.length>0&&(t=e.features[0].geometry.type),t},t.appendUrlParams=c,t.getFullBaseUrl=function(e){var t={};return e.tokenKey&&e.tokenValue&&(t[e.tokenKey]=e.tokenValue),c(e.url,t)},t.getGeometryFilter=function(e,t){var r={geometryType:void 0,geometry:"",spatialRel:t=(0,o.defaultValue)(t,a.SpatialRelation.Intersects)};function n(e){for(var t="",r=0;r<e.length;r++){for(var n=0;n<e[r].length;n++)t+=e[r][n][0]+","+e[r][n][1]+",";t=t.substring(0,t.length-1),t+="|"}return t.substring(0,t.length-1)}switch(e.type){case i.GeometryType.extent:return r.geometryType="rect",r.geometry=e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,r;case i.GeometryType.polygon:return r.geometryType="polygon",r.geometry=n(e.coordinates),r;case i.GeometryType.multiPolygon:r.geometryType="polygon";for(var s=0;s<e.coordinates.length;s++)r.geometry+=n(e.coordinates[s]),r.geometry+=";";return r.geometry=r.geometry.substring(0,r.geometry.length-1),r;default:return}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(10)),i=y(r(3)),o=y(r(0)),a=y(r(2)),s=y(r(4)),l=y(r(5)),u=r(8),c=r(9),f=y(r(43)),h=y(r(42)),d=y(r(41)),p=r(1);function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r._initEvent(),r.type="sketchPolygonDrawTool",r._drawTools=[r],r._otherDrawTools=[],r._currentMovePoint=void 0,r.vertexNum=0,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_initEvent",value:function(){this._processEvent=this._processEvent.bind(this),this.on("pan",this._processEvent),this.on("vertexScale",this._processEvent),this.on("midVertexScale",this._processEvent),this.on("vertexMove",this._processEvent),this.on("midVertexAdd",this._processEvent)}},{key:"drawFeature",value:function(){var e=this;this._editMode=u.SketchEditMode.DRAWING,this.view._mapActionControl("double-click-zoom",!1),this.view._mapActionControl("video-map-active",!0);var t=!1,r=!1,i=null,o=[],a=[];this.vertexNum=0;var s=null;this.cursorStyle=this.view.cursor,(0,p.isNull)(this.cursorStyle)&&(this.view.cursor="crosshair");var l=this._getInteractiveDom(),f=this.extensionOptions&&this.extensionOptions.vertexNumber?this.extensionOptions.vertexNumber:null;this._setInitSnap(),this._fireStartDrawEvent();var d=function r(n){if(n&&n.x&&n.y){e._stopInitSnap(),clearTimeout(null);var o={x:n.x,y:n.y};e._editMode=u.SketchEditMode.DRAWING;var l;l=e._snapPoint?e._snapPoint:e.view.toMap({x:o.x,y:o.y});var d=e.vertexNum+1;if(1===d)a=[l.coordinates],(i=e._getFeature()).geometry.coordinates=[[a[0],a[0],a[0],a[0]]];else if(2===d){var y=i.geometry.coordinates[0][0];if(y&&y[0]===l.coordinates[0]&&y[1]===l.coordinates[1])return p.Log.info("相邻两顶点重复！");a=[i.geometry.coordinates[0][0],i.geometry.coordinates[0][1]]}else{var g=(a=i.geometry.coordinates[0].slice(0,i.geometry.coordinates[0].length-2))[a.length-1];if(g&&g[0]===l.coordinates[0]&&g[1]===l.coordinates[1])return p.Log.info("相邻两顶点重复！");if(a.push(l.coordinates),e._sketchEditor.isSimple){var v=new c.Polygon({coordinates:[a.concat([a[0]])],spatialReference:e._spatialReference,extensionOptions:{arcType:e.arcType}});if(!c.GeometryEngine.isSimple(v))return e._fireUnsimpleDraw(),p.Log.info("该坐标构成的几何不符合拓扑规范！")}}if(e.vertexNum=d,f&&d>=f)e.view.off(u.ViewEventType.immediateClick,r);else{e.sketchStage.entityGraphic=i;var m=new h.default({view:e.view,layer:e.layer,_parent:e,sketchStyle:e.sketchStyle,elevationInfo:e.elevationInfo});m.addFeature(l,void 0,void 0,e.sketchInnerLayer),e._drawTools.push(m);var _=m.sketchStage.entityGraphic;e.sketchStage.vertexGraphics.push(_),i&&(t=!0),s="click",e.fire("drawn-vertex",{geometry:m.sketchStage.entityGraphic.geometry,feature:m.sketchStage.entityGraphic},self),e._fireDrawVertexEvent(i),e.undoRedoManager&&e.undoRedoManager.addProcess("add-vertex",e.sketchStage,e._editMode)}}},y=!0,g=function(u){if(u&&u.x&&u.y&&t&&!r){clearTimeout(null),r=!0,i=e.sketchStage.entityGraphic,e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]);var c={x:u.x,y:u.y};o[o.length-1]=c;var h=e.view.toMap({x:c.x,y:c.y}),d=f&&e.vertexNum===f?e.vertexNum-1:e.vertexNum;1===d?a=[i.geometry.coordinates[0][0]]:2===d?(i.geometry.coordinates[0][2]=h.coordinates,a=i.geometry.coordinates[0].slice(0,i.geometry.coordinates[0].length-2)):a=i.geometry.coordinates[0].slice(0,i.geometry.coordinates[0].length-2),1===e.vertexNum?e._snapPoint=e.getSnapGraphics(h,a):e.vertexNum>1&&(e._snapPoint=e.getSnapGraphics(h,a)),e._snapPoint&&(h=e._snapPoint),e._currentMovePoint=h,1===d?(i.geometry.coordinates[0][1]=h.coordinates,i.geometry.coordinates[0][2]=h.coordinates):2===d?i.geometry.coordinates[0][2]=h.coordinates:"click"===s?i.geometry.coordinates[0].splice(i.geometry.coordinates[0].length-1,0,h.coordinates):"move"===s&&i.geometry.coordinates[0].splice(i.geometry.coordinates[0].length-2,1,h.coordinates),e.sketchStage.entityGraphic=i,i.geometry.coordinates=[JSON.parse((0,n.default)(i.geometry.coordinates[0]))],y&&(e._addFeatureToLayer(i,e.layer),y=!1),r=!1,s="move";var p=e._getInteractiveDom();l=l.concat(p),e._removeInteractiveStyle(p),e._fireChangeCursorEvent(i)}},v=function(){return clearTimeout(null),clearTimeout(null),t?(i=e.sketchStage.entityGraphic)&&e._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(i.geometry)?(e._fireUnsimpleDraw(),p.Log.info("该坐标构成的几何不符合拓扑规范！")):e.vertexNum<3&&e.sketchStage.entityGraphic?p.Log.info("区几何顶点少于三个，不符合规范！"):(a=[],o=[],t=!1,e.stop(),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),e._editMode=u.SketchEditMode.NONE,s="doubleClick",e.view.cursor=e.cursorStyle,e._addInteractiveStyle(l),e.fire("drawn",{geometry:i.geometry,feature:i},self),e._fireStopDrawEvent(i),e.sketchStage.vertexGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.vertexNum=0,e.sketchStage.vertexGraphics=[],e._currentMovePoint=void 0,e.undoRedoManager._initDrawProcess(),void setTimeout(function(){e.view._mapActionControl("double-click-zoom",!0),e.view._mapActionControl("video-map-active",!1)},0)):(i=null,a=[],void(o=[]))};this._drawEventHandlers.push(d,g,v),this.view.on(u.ViewEventType.immediateClick,d),this.view.on(u.ViewEventType.pointerMove,g),this.view.on(u.ViewEventType.doubleClick,v)}},{key:"addFeature",value:function(e,t,r,n){var i;i=t&&t.fillStyle?t.fillStyle:this.sketchStyle._fillStyle;var o=this._getFeature(e,i);r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"addFeatureByGeometry",value:function(e,t,r,n){var i;i=t&&t.fillStyle?t.fillStyle:this.sketchStyle._fillStyle;var o=new u.Feature({geometry:e,symbol:i,elevationInfo:this.elevationInfo});r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"_getFeature",value:function(e){e||(e=[[0,0],[0,0],[0,0],[0,0]]);var t=new c.Polygon({coordinates:[e],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),r=this.sketchStyle.fillStyle.clone(),n=new u.Feature({geometry:t,symbol:r,elevationInfo:this.elevationInfo});return n.isShowArea=this.sketchStyle.isShowArea,n.isShowArea&&(n._textStyle=this.sketchStyle.textStyle),n}},{key:"hitTestFeature",value:function(e,t){this.view._mapActionControl("video-map-active",!0),!this._parent&&this.editOption.showSelectBox&&(this._editMode===u.SketchEditMode.NONE?this._editMode=u.SketchEditMode.EDITGRAGIC:this._editMode===u.SketchEditMode.EDITVERTEX&&(this.view.off(u.ViewEventType.immediateClick,this._mapClickEvent),this._mapClickEvent=null,this._editMode=u.SketchEditMode.EDITGRAGIC),this.selectFeature(e)),this._parent&&this._parent._editMode===u.SketchEditMode.EDITGRAGIC&&this.startPanGraphics(e,t)}},{key:"selectFeature",value:function(e){var r=this;if(this.editOption.showSelectBox){this._clearEditGraphics(2);var n=e.geometry.extent,i=new t({view:this.view,layer:this.layer,sketchStyle:new d.default({fillStyle:this.sketchStyle._selectBoxStyle,isShowSegmentLength:!0,isShowArea:!0}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,arcType:this.arcType,_getCenterCoordinate:this._getCenterCoordinate,_parent:this});this._drawTools.push(i),i.addFeature([[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax]],void 0,void 0,this.sketchInnerLayer),this.sketchStage.selectBoxGraphics=[i.sketchStage.entityGraphic];var o=[];if(o=[{point:new c.Point({coordinates:[n.xmax,n.ymax],spatialReference:this._spatialReference}),direction:"ne"},{point:new c.Point({coordinates:[n.xmax,n.ymin],spatialReference:this._spatialReference}),direction:"se"},{point:new c.Point({coordinates:[n.xmin,n.ymin],spatialReference:this._spatialReference}),direction:"sw"},{point:new c.Point({coordinates:[n.xmin,n.ymax],spatialReference:this._spatialReference}),direction:"nw"}],this._sketchEditor&&this._getCenterCoordinate){var a=[{point:new c.Point({coordinates:this._getCenterCoordinate([n.xmax,n.ymax],[n.xmax,n.ymin]),spatialReference:this._spatialReference}),direction:"e",type:"midVertex"},{point:new c.Point({coordinates:this._getCenterCoordinate([n.xmax,n.ymin],[n.xmin,n.ymin]),spatialReference:this._spatialReference}),direction:"s",type:"midVertex"},{point:new c.Point({coordinates:this._getCenterCoordinate([n.xmin,n.ymin],[n.xmin,n.ymax]),spatialReference:this._spatialReference}),direction:"w",type:"midVertex"},{point:new c.Point({coordinates:this._getCenterCoordinate([n.xmin,n.ymax],[n.xmax,n.ymax]),spatialReference:this._spatialReference}),direction:"n",type:"midVertex"}];o=o.concat(a)}var s=[],l=[];o.forEach(function(e){var t=new h.default({view:r.view,layer:r.layer,sketchStyle:new d.default({vertexStyle:r.sketchStyle._selectBoxVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},arcType:r.arcType,_getCenterCoordinate:r._getCenterCoordinate,elevationInfo:r.elevationInfo,_parent:r});r._drawTools.push(t),t.addFeature(e.point,r.sketchStage,{direction:e.direction,type:e.type},r.sketchInnerLayer),s.push(t),l.push(t.sketchStage.entityGraphic)}),this.sketchStage.selectBoxVertexGraphics=l,this._otherDrawTools?this._otherDrawTools.push(i):this._otherDrawTools=[i],this._otherDrawTools=this._otherDrawTools.concat(s),this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage,this._editMode),this._mapClickEvent||this._parent&&(!this._parent||this._parent._mapClickEvent)||(this._mapClickEvent=function(){r._preventFirstCall?r._preventFirstCall=void 0:(r.sketchStage.selectBoxGraphics.concat(r.sketchStage.selectBoxVertexGraphics).concat(r.sketchStage.vertexGraphics).concat(r.sketchStage.midVertexGraphics).forEach(function(e){r._removeFeatureFromLayer(e,r.sketchInnerLayer)}),r.view.off(u.ViewEventType.immediateClick,r._mapClickEvent),r.view._mapActionControl("drag-pan",!0),r._mapClickEvent=null,r.fire("selected",{isSelected:!1},self),r._fireRemoveSelectEvent(r.sketchStage.entityGraphic),r.sketchStage.selectBoxGraphics=[],r.sketchStage.selectBoxVertexGraphics=[],r.sketchStage.vertexGraphics=[],r.sketchStage.midVertexGraphics=[],r._editMode=u.SketchEditMode.NONE,r.view._mapActionControl("video-map-active",!1))},this._hitTestEventHandlers.push(this._mapClickEvent),setTimeout(function(){r.view.on(u.ViewEventType.immediateClick,r._mapClickEvent)},0))}}},{key:"selectFeatureVertex",value:function(e){var t=this;this._clearEditGraphics(1);var r=[],n=[];e.geometry.coordinates[0].forEach(function(i,o){if(o<e.geometry.coordinates[0].length-1){var a=new h.default({view:t.view,layer:t.layer,sketchStyle:new d.default({vertexStyle:t.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t}),s=new c.Point({coordinates:i,spatialReference:t._spatialReference});t._drawTools.push(a),a.addFeature(s,void 0,{vertexIndex:o},t.sketchInnerLayer),r.push(a),t.sketchStage.vertexGraphics.push(a.sketchStage.entityGraphic)}if(o>0){var l=new h.default({view:t.view,layer:t.layer,sketchStyle:new d.default({vertexStyle:t.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t});n.push(l);var u,f=e.geometry.coordinates[0][o-1],p=t._getCenterCoordinate(i,f);u=new c.Point({coordinates:p,spatialReference:t._spatialReference}),t._drawTools.push(l),l.addFeature(u,void 0,{vertexIndex:o-1,type:"midVertex"},t.sketchInnerLayer),t.sketchStage.midVertexGraphics.push(l.sketchStage.entityGraphic)}});var i=r.concat(n);this._otherDrawTools=this._otherDrawTools?this._otherDrawTools.concat(i):i,this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage,this._editMode)}},{key:"startPanGraphics",value:function(e,t){var r=this;this.view._mapActionControl("drag-pan",!1);var n=!1;this._startPan=!0;var i=null;i=t.mapPoint;var o=!0,a=setTimeout(function(){o=!1,r._parent&&r._fireStartPanEvent(r._parent.sketchStage.entityGraphic,r._parent)},200);this._parent&&this._parent._mapClickEvent&&this.view.off(u.ViewEventType.immediateClick,this._parent._mapClickEvent);var s=function(t){if(t&&t.x&&t.y&&!n&&r._startPan&&!r._editMode!==u.SketchEditMode.EDITGRAGIC&&!o){clearTimeout(null),n=!0;var a={x:t.x,y:t.y},s=r.view.toMap({x:a.x,y:a.y}),l=s.coordinates[0]-i.coordinates[0],f=s.coordinates[1]-i.coordinates[1];if(0!==l||0!==f){var h=[];e.geometry.coordinates[0].forEach(function(e){h.push(r.getPanCoordinates(e,l,f))});var d=new c.Polygon({coordinates:[h],spatialReference:r._spatialReference,extensionOptions:{arcType:r.arcType}});i=s,r._dispatchEvent("pan",{deltaPosition:{x:l,y:f},extent:d.extent},r),r.updateFeature(d,e),n=!1,r._parent&&r._firePanningEvent(r._parent.sketchStage.entityGraphic,r._parent)}else n=!1}},l=function e(){if(!r._editMode!==u.SketchEditMode.EDITGRAGIC&&r._startPan){if(o&&r._parent&&r._parent._editMode===u.SketchEditMode.EDITGRAGIC&&"sketchPointDrawTool"!==r._parent.type&&r._parent.selectFeatureVertex)return r._parent._editMode=u.SketchEditMode.EDITVERTEX,clearTimeout(a),r._parent.selectFeatureVertex(r._parent.sketchStage.entityGraphic),r._parent&&r._parent._mapClickEvent&&setTimeout(function(){r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent)},0),r._startPan=!1,r.view.off(u.ViewEventType.pointerMove,s),void r.view.off(u.ViewEventType.pointerUp,e);r._editMode=u.SketchEditMode.NONE,r._startPan=!1,r.view.off(u.ViewEventType.pointerMove,s),r.view.off(u.ViewEventType.pointerUp,e),r._parent&&r._parent.undoRedoManager&&r._parent.undoRedoManager.addProcess("update",r._parent.sketchStage,r._editMode),r._parent&&r._parent._mapClickEvent&&r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent),r._parent&&r._fireStopPanEvent(r._parent.sketchStage.entityGraphic,r._parent),setTimeout(function(){r.view._mapActionControl("drag-pan",!0)},0)}};this._hitTestEventHandlers.push(s),this._hitTestEventHandlers.push(l),this.view.on(u.ViewEventType.pointerUp,l),this.view.on(u.ViewEventType.pointerMove,s)}},{key:"_processEvent",value:function(e){"pan"===e.type?this._handlerPanEvent(e):"vertexScale"===e.type?this._handlerVertexScaleEvent(e):"midVertexScale"===e.type?this._handlerMidVertexScaleEvent(e):"circleVertexScale"===e.type?this._handlerCircleVertexScaleEvent(e):"vertexMove"===e.type?this._handlerVertexMoveEvent(e):"midVertexAdd"===e.type&&this._handlerMidVertexAddEvent(e)}},{key:"_handlerPanEvent",value:function(e){var t=this,r=[];this.sketchStage.entityGraphic.geometry.coordinates[0].forEach(function(n){r.push(t.getPanCoordinates(n,e.deltaPosition.x,e.deltaPosition.y))});var n=new c.Polygon({coordinates:[r],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}});this.sketchStage.entityGraphic.geometry=n,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}},{key:"_handlerVertexScaleEvent",value:function(e){if("scale"===e.action){var t;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates[0]));this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var i=this.getScaleCoordinates(this.sketchStage.entityGraphic.geometry.coordinates[0],e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t=new c.Polygon({coordinates:[i],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),this._resetSelectBoxDirection())}},{key:"_handlerMidVertexScaleEvent",value:function(e){var t;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates[0]));this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var i=this.getMidScaleCoordinates(this.sketchStage.entityGraphic.geometry.coordinates[0],e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t=new c.Polygon({coordinates:[i],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),this._resetSelectBoxDirection())}},{key:"_resetSelectBoxDirection",value:function(){var e=this,t=this.sketchStage.entityGraphic.geometry.extent;this.sketchStage.selectBoxVertexGraphics.forEach(function(r){r.attributes&&("ne"===r.attributes.direction?r.geometry.coordinates=[t.xmax,t.ymax]:"se"===r.attributes.direction?r.geometry.coordinates=[t.xmax,t.ymin]:"sw"===r.attributes.direction?r.geometry.coordinates=[t.xmin,t.ymin]:"nw"===r.attributes.direction?r.geometry.coordinates=[t.xmin,t.ymax]:"e"===r.attributes.direction?r.geometry.coordinates=e._getCenterCoordinate([t.xmax,t.ymax],[t.xmax,t.ymin]):"s"===r.attributes.direction?r.geometry.coordinates=e._getCenterCoordinate([t.xmax,t.ymin],[t.xmin,t.ymin]):"w"===r.attributes.direction?r.geometry.coordinates=e._getCenterCoordinate([t.xmin,t.ymin],[t.xmin,t.ymax]):"n"===r.attributes.direction&&(r.geometry.coordinates=e._getCenterCoordinate([t.xmin,t.ymax],[t.xmax,t.ymax])))})}},{key:"_handlerCircleVertexScaleEvent",value:function(e){if(this._parent&&this._parent.sketchStage.entityGraphic){var t,r=this._parent.sketchStage.entityGraphic.geometry.extent,n=[[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax]];(t=new c.Polygon({coordinates:[[[0,0],[0,0],[0,0],[0,0]]],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}})).coordinates=[n],this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}))}}},{key:"_handlerVertexMoveEvent",value:function(e){this.sketchStage.currentVertexIndex=e.vertexIndex;var t=this.sketchStage.entityGraphic,r=t.geometry.coordinates[0],i=JSON.parse((0,n.default)(r));i[e.vertexIndex]=e.movePoint.coordinates,i.length-1===e.vertexIndex?i[0]=e.movePoint.coordinates:0===e.vertexIndex&&(i[t.geometry.coordinates[0].length-1]=e.movePoint.coordinates);var o=new c.Polygon({coordinates:[i],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}});if(this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(o))return this._fireUnsimpleUpdate(),p.Log.info("该坐标构成的几何不符合拓扑规范！");if(t.geometry=o,this._otherDrawTools){var a=e.vertexIndex,s=0===a?a-1+this.sketchStage.midVertexGraphics.length:a-1,l=a===this.sketchStage.midVertexGraphics.length-1?0:a+1,u=this.sketchStage.midVertexGraphics[a],f=this.sketchStage.midVertexGraphics[s],h=this.sketchStage.vertexGraphics[a],d=i[s],y=i[a],g=i[l];u.geometry.coordinates=this._getCenterCoordinate(y,g),f.geometry.coordinates=this._getCenterCoordinate(y,d),h.geometry.coordinates=y}}},{key:"_handlerMidVertexAddEvent",value:function(e){var t=this;if("changeFeature"===e.action&&(this.sketchStage.entityGraphic.geometry.coordinates[0].splice(e.vertexIndex+1,0,e.point.coordinates),this.sketchStage.entityGraphic.geometry=new c.Polygon({coordinates:[this.sketchStage.entityGraphic.geometry.coordinates[0]],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}})),"moveMidVertex"===e.action){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates[0]));r[e.vertexIndex+1]=e.movePoint.coordinates;var i=new c.Polygon({coordinates:[r],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}});if(this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(i))return this._fireUnsimpleUpdate(),p.Log.info("该坐标构成的几何不符合拓扑规范！");this.sketchStage.currentVertexIndex=e.vertexIndex,this.sketchStage.entityGraphic.geometry=i,this.sketchStage.midVertexGraphics[e.vertexIndex].geometry.coordinates=e.movePoint.coordinates}if("addVertex"===e.action){var o=this.sketchStage.midVertexGraphics[e.vertexIndex].id.toString(),a=new h.default({view:this.view,layer:this.layer,sketchStyle:new d.default({vertexStyle:this.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(a),a.addFeature(e.point,void 0,void 0,this.sketchInnerLayer),this.sketchStage.vertexGraphics.splice(e.vertexIndex+1,0,a.sketchStage.entityGraphic);var s,l=this.sketchStage.entityGraphic.geometry.coordinates[0][e.vertexIndex];this._getHight;var u=this._getCenterCoordinate(l,e.point.coordinates);s=new c.Point({coordinates:u,spatialReference:this._spatialReference});var f=new h.default({view:this.view,layer:this.layer,sketchStyle:new d.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(f),f.addFeature(s,void 0,{type:"midVertex"},this.sketchInnerLayer),this.sketchStage.midVertexGraphics.splice(e.vertexIndex,1,f.sketchStage.entityGraphic);var y,g=this.sketchStage.entityGraphic.geometry.coordinates[0][e.vertexIndex+2];this._getHight;var v=this._getCenterCoordinate(g,e.point.coordinates);y=new c.Point({coordinates:v,spatialReference:this._spatialReference});var m=new h.default({view:this.view,layer:this.layer,sketchStyle:new d.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(m),m.addFeature(y,void 0,{type:"midVertex"},this.sketchInnerLayer),this.sketchStage.midVertexGraphics.splice(e.vertexIndex+1,0,m.sketchStage.entityGraphic),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools.forEach(function(e){e.sketchStage.entityGraphic.id===o&&t._removeFeatureFromLayer(e.sketchStage.entityGraphic,t.sketchInnerLayer)}),this._otherDrawTools.push(a),this._otherDrawTools.push(f),this._otherDrawTools.push(m)}}},{key:"addMidVertex",value:function(e,t){var r=new h.default;r.addPoint(t),this.sketchStage.midVertexGraphics=r}},{key:"addVertex",value:function(e,t){var r=null;if(--t>-1){var i=[];if(t<this.sketchStage.entityGraphic.geometry.coordinates[0].length-1){if((i=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates[0]))).splice(t,0,e.coordinates),0===t?i[i.length-1]=e.coordinates:t===i.length-1&&i.splice(0,0,e.coordinates),r=new c.Polygon({coordinates:[i],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(r))return this._fireUnsimpleUpdateByFun(),p.Log.info("该坐标构成的几何不符合拓扑规范！");this.sketchStage.entityGraphic.geometry=r;var o=void 0,a=void 0,s=this.sketchStage.entityGraphic.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var l=[[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin],[s.xmin,s.ymax],this._getCenterCoordinate([s.xmax,s.ymax],[s.xmin,s.ymax]),this._getCenterCoordinate([s.xmax,s.ymin],[s.xmin,s.ymin]),this._getCenterCoordinate([s.xmax,s.ymax],[s.xmax,s.ymin]),this._getCenterCoordinate([s.xmin,s.ymax],[s.xmin,s.ymin])];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=l[t]})}if(this.sketchStage.vertexGraphics.length>0&&(o=new h.default({view:this.view,layer:this.layer,sketchStyle:new d.default({vertexStyle:this.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this}),this._drawTools.push(o),o.addFeatureByGeometry(e,void 0,void 0,this.sketchInnerLayer),this.sketchStage.vertexGraphics.splice(t,0,o.sketchStage.entityGraphic),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}})),this.sketchStage.midVertexGraphics.length>0){var u=-1,f=-1,y=null,g=null;0===t?(f=0,u=this.sketchStage.midVertexGraphics.length-1,y=this.sketchStage.entityGraphic.geometry.coordinates[0][this.sketchStage.entityGraphic.geometry.coordinates[0].length-2],g=this.sketchStage.entityGraphic.geometry.coordinates[0][1]):(u=t-1,f=t+1,y=this.sketchStage.entityGraphic.geometry.coordinates[0][u],g=this.sketchStage.entityGraphic.geometry.coordinates[0][f]);var v=new c.Point({coordinates:this._getCenterCoordinate(y,e.coordinates),spatialReference:this._spatialReference});this.sketchStage.midVertexGraphics[u].geometry.coordinates=v.coordinates;var m=new c.Point({coordinates:this._getCenterCoordinate(g,e.coordinates),spatialReference:this._spatialReference});a=new h.default({view:this.view,layer:this.layer,sketchStyle:new d.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this}),this._drawTools.push(a),a.addFeatureByGeometry(m,void 0,{type:"midVertex"}),this.sketchStage.midVertexGraphics.splice(t,0,a.sketchStage.entityGraphic),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}})}o&&this._otherDrawTools.push(o),a&&this._otherDrawTools.push(a),this.undoRedoManager.addProcess("update",this.sketchStage,this._editMode),this._fireAddVertexEventByFun(o.sketchStage.entityGraphic,this._parent)}return r}}},{key:"updateVertex",value:function(e,t){var r=null;if(--t>-1){if(t<this.sketchStage.entityGraphic.geometry.coordinates[0].length-1){var i=this.sketchStage.entityGraphic,o=JSON.parse((0,n.default)(i.geometry.coordinates[0]));if(this.currentVertexIndex=t,o[t]=e.coordinates,o.length-1===t?o[0]=e.coordinates:0===t&&(o[o.length-1]=e.coordinates),r=new c.Polygon({coordinates:[o],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(r))return this._fireUnsimpleUpdateByFun(),p.Log.info("该坐标构成的几何不符合拓扑规范！");i.geometry.coordinates=[o];var a=i.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var s=[[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin],[a.xmin,a.ymax],this._getCenterCoordinate([a.xmax,a.ymax],[a.xmin,a.ymax]),this._getCenterCoordinate([a.xmax,a.ymin],[a.xmin,a.ymin]),this._getCenterCoordinate([a.xmax,a.ymax],[a.xmax,a.ymin]),this._getCenterCoordinate([a.xmin,a.ymax],[a.xmin,a.ymin])];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=s[t]})}if(this.sketchStage.vertexGraphics.length>0&&(this.sketchStage.vertexGraphics[t].geometry.coordinates=e.coordinates),this.sketchStage.midVertexGraphics.length>0){var l=t,u=0===l?l-1+this.sketchStage.midVertexGraphics.length:l-1,f=l===this.sketchStage.midVertexGraphics.length-1?0:l+1,h=this.sketchStage.midVertexGraphics[l],d=this.sketchStage.midVertexGraphics[u],y=o[u],g=o[l],v=o[f];h.geometry.coordinates=this._getCenterCoordinate(v,g),h.geometry=new c.Point({coordinates:h.geometry.coordinates,spatialReference:this._spatialReference}),d.geometry.coordinates=this._getCenterCoordinate(y,g),d.geometry=new c.Point({coordinates:d.geometry.coordinates,spatialReference:this._spatialReference})}}this.undoRedoManager.addProcess("update",this.sketchStage,this._editMode),this._fireUpdateVertexByFun(this.sketchStage.entityGraphic,this._parent)}return r}},{key:"removeVertex",value:function(e){var t=null;if(--e>-1){var r=this.sketchStage.entityGraphic.geometry.coordinates[0].length-1;if(r>3&&e<r){var i=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates[0]));if(i.splice(e,1),0===e&&i.splice(i.length-1,1,i[0]),t=new c.Polygon({coordinates:[i],spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(t))return this._fireUnsimpleUpdateByFun(),p.Log.info("该坐标构成的几何不符合拓扑规范！");this.sketchStage.entityGraphic.geometry=t;var o=this.sketchStage.entityGraphic.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var a=[[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin],[o.xmin,o.ymax],this._getCenterCoordinate([o.xmax,o.ymax],[o.xmin,o.ymax]),this._getCenterCoordinate([o.xmax,o.ymin],[o.xmin,o.ymin]),this._getCenterCoordinate([o.xmax,o.ymax],[o.xmax,o.ymin]),this._getCenterCoordinate([o.xmin,o.ymax],[o.xmin,o.ymin])];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=a[t]})}if(this.sketchStage.vertexGraphics.length>0){var s=this.sketchStage.vertexGraphics[e].id.toString();this._removeFeatureFromLayer(this.sketchStage.vertexGraphics[e],this.sketchInnerLayer),this.sketchStage.vertexGraphics.splice(e,1),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools=this._otherDrawTools.filter(function(e){if(e.sketchStage.entityGraphic.id!==s)return e})}if(this.sketchStage.midVertexGraphics.length>0){var l=[],u=-1;0===e?(l=[(t.coordinates[0][t.coordinates[0].length-2][0]+t.coordinates[0][e][0])/2,(t.coordinates[0][t.coordinates[0].length-2][1]+t.coordinates[0][e][1])/2],u=this.sketchStage.midVertexGraphics.length-1):(l=[(t.coordinates[0][e-1][0]+t.coordinates[0][e][0])/2,(t.coordinates[0][e-1][1]+t.coordinates[0][e][1])/2],u=e-1),this.sketchStage.midVertexGraphics[u].geometry=new c.Point({coordinates:l,spatialReference:this._spatialReference});var f=this.sketchStage.vertexGraphics[e].id.toString();this._removeFeatureFromLayer(this.sketchStage.midVertexGraphics[e],this.sketchInnerLayer),this.sketchStage.midVertexGraphics.splice(e,1),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools=this._otherDrawTools.filter(function(e){if(e.sketchStage.entityGraphic.id!==f)return e})}}this.undoRedoManager.addProcess("update",this.sketchStage,this._editMode),this._fireRemoveVertexByFun(this.sketchStage.entityGraphic,this._parent)}return t}}]),t}(f.default);t.default=g},function(e,t,r){var n=r(149),i=r(111);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){"use strict";var n=r(254)(!0);r(115)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t){e.exports={}},function(e,t,r){e.exports={default:r(325),__esModule:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=x(r(10)),i=x(r(23)),o=x(r(0)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(35)),s=r(1),l=r(6),u=x(r(29)),c=x(r(83)),f=x(r(185)),h=x(r(186)),d=x(r(81)),p=x(r(57)),y=x(r(95)),g=x(r(188)),v=x(r(37)),m=x(r(189)),_=x(r(58)),S=x(r(191));function x(e){return e&&e.__esModule?e:{default:e}}var b=function e(){(0,o.default)(this,e)};b.difference=function(e,t){(0,s.isNull)(e)&&s.Log.error("inputGeometry不能为空！"),(0,s.isNull)(t)&&s.Log.error("subtractGeometry不能为空！"),e instanceof c.default||e instanceof h.default||e instanceof _.default||e instanceof m.default||s.Log.error("inputGeometry类型错误！"),t instanceof c.default||t instanceof h.default||t instanceof _.default||t instanceof m.default||s.Log.error("subtractGeometry类型错误！");var r=void 0;switch(e.type){case y.default.polygon:r=b._polygonDifferenceGeometry(a.polygon(e.coordinates),t);break;case y.default.extent:var n=new c.default({coordinates:[[[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin]]]});r=b._polygonDifferenceGeometry(a.polygon(n.coordinates),t);break;case y.default.circle:r=b._polygonDifferenceGeometry(a.polygon(e.toPolygon().coordinates),t);break;case y.default.multiPolygon:r=b._polygonDifferenceGeometry(a.multiPolygon(e.coordinates),t)}return(0,s.isNull)(r)||(r="Polygon"===r.geometry.type?new c.default({coordinates:r.geometry.coordinates,spatialReference:p.default.fromJSON(e.spatialReference)}):new h.default({coordinates:r.geometry.coordinates,spatialReference:p.default.fromJSON(e.spatialReference)})),r},b._polygonDifferenceGeometry=function(e,t){var r=e,n=void 0;switch(t.type){case y.default.polygon:n=a.polygon(t.coordinates);break;case y.default.multiPolygon:n=a.multiPolygon(t.coordinates);break;case y.default.circle:n=a.polygon(t.toPolygon().coordinates);break;case y.default.extent:var i=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});n=a.polygon(i.coordinates)}return a.difference(r,n)},b.buffer=function(e,t,r,n){r=(0,s.defaultValue)(r,l.LengthUnit.meter),n=(0,s.defaultValue)(n,!1),t=(0,s.defaultValue)(t,1e3),b._checkBufferOptions(e,t,r,n);var i=void 0;if(e instanceof Array)if(t instanceof Array){if(t.length<e.length){i=[];for(var o=t.length>0?t[t.length-1]:1e3,a=t.length;a<e.length;a++)i.push(o)}}else{i=[];for(var f=0;f<e.length;f++)i.push(t)}else i=t instanceof Array?t.length>0?t[0]:1e3:t;var h=e;if(e instanceof Array){h=[];for(var g=0;g<e.length;g++)h.push(d.default.projectGeometry(e[g],new p.default({wkid:4326})))}else 4326!==e.spatialReference.wkid&&(h=d.default.projectGeometry(e,new p.default({wkid:4326})));var v=void 0;if(e instanceof Array){if(e instanceof Array){if(v=[],t instanceof Array&&t.length<e.length)for(var m=t[t.length-1],_=t.length-1;_<e.length;_++)t.push(m);for(var S=0;S<h.length;S++){var x;x=t instanceof Array?t[S]:t,v.push(b._polygonBuffer(h[S],x,r))}n&&(v=b.union(v))}}else switch(e.type){case y.default.point:case y.default.multiPoint:case y.default.lineString:case y.default.multiLineString:case y.default.polygon:case y.default.multiPolygon:v=b._polygonBuffer(h,i,r);break;case y.default.extent:var w=new c.default({coordinates:[[[h.xmin,h.ymin],[h.xmax,h.ymin],[h.xmax,h.ymax],[h.xmin,h.ymax],[h.xmin,h.ymin]]]});v=b._polygonBuffer(w,i,r);break;case y.default.circle:(v=u.default.fromJSON(e)).radius+=i;break;default:s.Log.error("geometry是不支持的几何类型！")}if(e instanceof Array){if(!e[0].spatialReference.isGeographic)if(v instanceof Array)for(var k=0;k<v.length;k++)v[k].type!==y.default.circle&&(v[k]=d.default.projectGeometry(v[k],p.default.fromJSON(e[0].spatialReference)));else v.type!==y.default.circle&&(v=d.default.projectGeometry(v,p.default.fromJSON(e[0].spatialReference)))}else e.spatialReference.isGeographic||e.type===y.default.circle||(v=d.default.projectGeometry(v,p.default.fromJSON(e.spatialReference)));return v},b._checkBufferOptions=function(e,t,r,n){if((0,s.isNull)(e)&&s.Log.error("geometry不能为空！"),(0,s.isNull)(t)&&s.Log.error("distance不能为空！"),(0,s.isNull)(e)&&s.Log.error("unit不能为空！"),(0,s.isNull)(e)&&s.Log.error("unionResults不能为空！"),e instanceof Array){for(var o=0;o<e.length;o++)if(!(e[o]instanceof c.default||e[o]instanceof h.default)){s.Log.error("geometry的子元素类型不为Polygon或者MultiPolygon！");break}0===e.length&&s.Log.error("geometry的长度为0！")}else e instanceof u.default||s.Log.error("geometry不是基础几何类型！");if(t instanceof Array){e instanceof Array||s.Log.error("distance的类型为数组，但是geometry的类型不是数组！");for(var a=0;a<t.length;a++)if("number"!=typeof t[a]){s.Log.error("distance的子元素不是数字类型！");break}}else"number"!=typeof t&&s.Log.error("distance的不是数字类型！");if("string"==typeof r)if(r){var f=!1;(0,i.default)(l.LengthUnit).forEach(function(e){f||l.LengthUnit[e]!==r||(f=!0)}),f||s.Log.error("unit是不支持的单位类型！")}else s.Log.error("unit的值不能为空！");else s.Log.error("unit类型不是字符串！");"boolean"!=typeof n&&s.Log.error("unionResults类型不是布尔值类型！")},b._polygonBuffer=function(e,t,r){var n=void 0;switch(e.type){case y.default.point:n=a.point(e.coordinates);break;case y.default.multiPoint:n=a.multiPoint(e.coordinates);break;case y.default.lineString:n=a.lineString(e.coordinates);break;case y.default.multiLineString:n=a.multiLineString(e.coordinates);break;case y.default.polygon:n=a.polygon(e.coordinates);break;case y.default.multiPolygon:n=a.multiPolygon(e.coordinates)}var i=a.buffer(n,t,{units:r});return u.default.fromJSON({type:i.geometry.type,coordinates:i.geometry.coordinates})},b._multiPolygonBuffer=function(e,t,r){var n=a.multiPolygon(e.coordinates),i=a.buffer(n,t,{units:r});return"Polygon"===i.geometry.type?new c.default({coordinates:i.geometry.coordinates}):new h.default({coordinates:i.geometry.coordinates})},b._buffer=function(e,t,r){if(e.hasOwnProperty("coordinates")||s.Log.error("geometry缺少coordinates属性！"),e instanceof c.default){var n=a.polygon(e.coordinates);return a.buffer(n,t,{units:r})}},b.union=function(e){if((e=(0,s.defaultValue)(e,[]))instanceof Array||s.Log.error("geometries必须为数组类型！"),0===e.length)return[];var t=!0,r=!0,n=e[0].type;if(e.length>1){switch(e[0].type){case y.default.polygon:case y.default.multiPolygon:for(var i=1;i<e.length;i++)if(e[i].type!==y.default.polygon&&e[i].type!==y.default.multiPolygon){t=!1;break}break;case y.default.point:case y.default.multiPoint:for(var o=1;o<e.length;o++)if(e[o].type!==y.default.point&&e[o].type!==y.default.multiPoint){t=!1;break}break;case y.default.circle:for(var l=1;l<e.length;l++)if(e[l].type!==y.default.circle){t=!1;break}break;case y.default.extent:for(var u=1;u<e.length;u++)if(e[u].type!==y.default.extent){t=!1;break}break;case y.default.lineString:case y.default.multiLineString:for(var d=1;d<e.length;d++)if(e[d].type!==y.default.lineString&&e[d].type!==y.default.multiLineString){t=!1;break}break;default:s.Log.error("geometries的子元素中有求并方法不支持的数据类型!")}t||s.Log.error("几何数组的类型不同！");for(var m=e[0].spatialReference,_=1;_<e.length;_++)m.equals(e[_].spatialReference)||(r=!1);r||s.Log.error("几何数组的坐标系不同！");var x=void 0,w=[];switch(n){case y.default.point:case y.default.multiPoint:for(var k=[],M=0;M<e.length;M++)e[M]instanceof v.default?k.push(e[M].coordinates):e[M]instanceof g.default&&(k=k.concat(e[M].coordinates));if(1===k.length)x=new v.default({coordinates:k[0],spatialReference:p.default.fromJSON(e[0].spatialReference)});else{var E=a.multiPoint(k);E=a.cleanCoords(E),x=new g.default({coordinates:E.geometry.coordinates,spatialReference:p.default.fromJSON(e[0].spatialReference)})}break;case y.default.polygon:case y.default.multiPolygon:var I=void 0,T=e[0].type===y.default.polygon?a.polygon(e[0].coordinates):a.multiPolygon(e[0].coordinates),L=e[1].type===y.default.polygon?a.polygon(e[1].coordinates):a.multiPolygon(e[1].coordinates);I=a.union(T,L);for(var P=2;P<e.length;P++){var C=e[P].type===y.default.polygon?a.polygon(e[P].coordinates):a.multiPolygon(e[P].coordinates);I=a.union(I.geometry,C)}x=I.geometry.type===y.default.polygon?new c.default({coordinates:I.geometry.coordinates,spatialReference:p.default.fromJSON(e[0].spatialReference)}):new h.default({coordinates:I.geometry.coordinates,spatialReference:p.default.fromJSON(e[0].spatialReference)});break;case y.default.lineString:case y.default.multiLineString:for(var N=[],O=0;O<e.length;O++)e[O]instanceof f.default?N.push(e[O].coordinates):N=N.concat(e[O].coordinates);x=1===N.length?new f.default({coordinates:N[0],spatialReference:p.default.fromJSON(e[0].spatialReference)}):new S.default({coordinates:N,spatialReference:p.default.fromJSON(e[0].spatialReference)});break;case y.default.extent:w=[];for(var R=0;R<e.length;R++){var V=new c.default({coordinates:[[[e[R].xmin,e[R].ymin],[e[R].xmax,e[R].ymin],[e[R].xmax,e[R].ymax],[e[R].xmin,e[R].ymax],[e[R].xmin,e[R].ymin]]],spatialReference:p.default.fromJSON(e[0].spatialReference)});w.push(V)}x=b.union(w);break;case y.default.circle:w=[];for(var G=0;G<e.length;G++)w.push(e[G].toPolygon());x=b.union(w)}return x}return 1===e.length?e[0]:void 0},b.intersects=function(e,t){b._checkTwoGeometry(e,t);var r=b._geometryToTurf(e),n=b._geometryToTurf(t);return!a.booleanDisjoint(r,n)},b.geodesicLength=function(e,t){(0,s.isNull)(e)&&s.Log.error("geometry对象不能为空！"),e instanceof f.default||s.Log.error("geometry类型不正确！"),"string"!=typeof(t=(0,s.defaultValue)(t,l.LengthUnit.meter))&&s.Log.error("unit类型不正确！");var r=0;switch(e.type){case y.default.lineString:var n=a.lineString(e.coordinates);r=1e3*a.length(n,{units:"kilometers"})}if(!e.spatialReference.isGeographic)switch(t){case l.LengthUnit.kilometer:r/=1e3;break;case l.LengthUnit.mile:r*=.000621371192237}return r},b.geodesicArea=function(e,t){(0,s.isNull)(e)&&s.Log.error("geometry对象不能为空！"),e instanceof c.default||e instanceof h.default||e instanceof m.default||e instanceof _.default||s.Log.error("polygon对象不是Polyon或MultiPolygon或Circle或Extent类型！"),t=(0,s.defaultValue)(t,l.LinearUnits.meters);var r=0;switch(e instanceof c.default||e instanceof h.default?r=b._geodesicPolygonArea(e):(e instanceof m.default||e instanceof _.default)&&(r=b._geodesicPolygonArea(e.toPolygon())),t){case l.AreaUnits.squareKilometers:r*=1e-6;break;case l.AreaUnits.squareMiles:r*=6214e-7*6214e-7;break;case l.AreaUnits.squareYards:r*=1.1959900499368898;break;case l.AreaUnits.squareFeet:r*=10.763910416689228;break;case l.AreaUnits.acres:r*=2471e-7;break;case l.AreaUnits.ares:r*=.01;break;case l.AreaUnits.hectares:r*=1e-4;break;case l.AreaUnits.squareMeters:}return r},b._geodesicPolygonArea=function(e){return a.area(a.polygon(e.coordinates))},b._geometryToTurf=function(e){var t=void 0;switch(e.type!==y.default.extent&&e.type!==y.default.circle&&(t=JSON.parse((0,n.default)(e.coordinates))),e.type){case y.default.point:return a.point(t);case y.default.multiPoint:return a.multiPoint(t);case y.default.lineString:return a.lineString(t);case y.default.multiLineString:return a.multiLineString(t);case y.default.polygon:return a.polygon(t);case y.default.multiPolygon:return a.multiPolygon(t);case y.default.extent:return a.polygon([[[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin]]]);case y.default.circle:return a.polygon(e.toPolygon().coordinates);default:s.Log.error("geometry为不支持的几何类型！")}},b._lineContainPoint=function(e,t){var r=a.point(t.coordinates),n=a.lineString(e.coordinates),i=a.booleanContains(n,r);if(!i)for(var o=0;o<e.coordinates.length;o++){var s=new v.default({coordinates:e.coordinates[o],spatialReference:p.default.fromJSON(e.spatialReference)});if(b.equals(t,s)){i=!0;break}}return i},b._multiLineContainPoint=function(e,t){for(var r=!1,n=0;n<e.coordinates.length;n++){var i=new f.default({coordinates:e.coordinates[n],spatialReference:p.default.fromJSON(e.spatialReference)});if(b._lineContainPoint(i,t)){r=!0;break}}return r},b._polygonContainPoint=function(e,t){var r=a.point(t.coordinates),n=a.polygon(e.coordinates);return a.booleanContains(n,r)},b._polygonContainLine=function(e,t){var r=a.polygon(e.coordinates),n=a.lineString(t.coordinates);return a.booleanContains(r,n)},b._multiPointContainsPoint=function(e,t){var r=a.point(t.coordinates),n=a.multiPoint(e.coordinates);return a.booleanContains(n,r)},b._lineContainMultiPoint=function(e,t){for(var r=!0,n=0;n<t.coordinates.length;n++){var i=new v.default({coordinates:t.coordinates[n]});if(!(r=b._lineContainPoint(e,i)))break}return r},b._polygonContainMultiPoint=function(e,t){for(var r=!0,n=0;n<t.coordinates.length;n++){var i=new v.default({coordinates:t.coordinates[n]});if(!(r=b._polygonContainPoint(e,i)))break}return r},b._checkTwoGeometry=function(e,t){(0,s.isNull)(e)&&s.Log.error("geometry1对象为空！"),(0,s.isNull)(t)&&s.Log.error("geometry2对象为空！"),e instanceof u.default||s.Log.error("geometry1对象未继承于Geometry对象！"),t instanceof u.default||s.Log.error("geometry2对象未继承于Geometry对象！"),e.spatialReference.equals(t.spatialReference)||s.Log.error("geometry1和geometry2的坐标系不相同！")},b.intersect=function(e,t){(0,s.isNull)(e)&&s.Log.error("geometry1不能为空！"),(0,s.isNull)(t)&&s.Log.error("geometry2不能为空！"),e instanceof u.default||e instanceof Array||s.Log.error("geometry1必须为几何对象或者数组对象！"),t instanceof u.default||s.Log.error("geometry2必须为几何对象或者数组对象！");var r=void 0;if(e instanceof Array){r=[];for(var n=0;n<e.length;n++)r.push(b.intersect(e[n],t));return r}switch(e.type){case y.default.point:r=b._pointIntersectGeometry(e,t);break;case y.default.multiPoint:r=b._multiPointIntersectGeometry(e,t);break;case y.default.lineString:switch(t.type){case y.default.point:b.contains(e,t)&&(r=new v.default({coordinates:t.coordinates}));break;case y.default.multiPoint:r=b._lineIntersectMultiPoint(e,t);break;case y.default.polygon:r=b._lineIntersectPolygon(e,t);break;case y.default.multiPolygon:r=b._lineIntersectMultiPolygon(e,t);break;case y.default.lineString:case y.default.multiLineString:r=b._lineIntersectLine(e,t);break;case y.default.extent:r=b._lineIntersectExtent(e,t);break;case y.default.circle:r=b._lineIntersectPolygon(e,t.toPolygon())}break;case y.default.polygon:switch(t.type){case y.default.point:r=b._pointIntersectGeometry(t,e);break;case y.default.multiPoint:r=b._multiPointIntersectGeometry(t,e);break;case y.default.lineString:r=b._lineIntersectPolygon(t,e);break;case y.default.multiLineString:r=b._multiLineIntersectPolygon(t,e);break;case y.default.polygon:r=b._polygonIntersectPolygon(e,t);break;case y.default.multiPolygon:r=b._polygonIntersectMultiPolygon(e,t);break;case y.default.circle:r=b._polygonIntersectPolygon(e,t.toPolygon());break;case y.default.extent:r=b._polygonIntersectExtent(e,t)}break;case y.default.multiPolygon:switch(t.type){case y.default.point:r=b._pointIntersectGeometry(t,e);break;case y.default.multiPoint:r=b._multiPointIntersectGeometry(t,e);break;case y.default.lineString:r=b._lineIntersectMultiPolygon(t,e);break;case y.default.multiLineString:r=b._multiLineIntersectMultiPolygon(t,e);break;case y.default.polygon:r=b._polygonIntersectMultiPolygon(t,e);break;case y.default.multiPolygon:r=b._multiPolygonIntersectMultiPolygon(e,t);break;case y.default.extent:r=b._multiPolygonIntersectExtent(e,t);break;case y.default.circle:r=b._polygonIntersectMultiPolygon(t.toPolygon(),e)}break;case y.default.extent:switch(t.type){case y.default.point:r=b._pointIntersectGeometry(t,e);break;case y.default.multiPoint:r=b._multiPointIntersectGeometry(t,e);break;case y.default.lineString:r=b._lineIntersectExtent(t,e);break;case y.default.multiLineString:r=b._multiLineIntersectExtent(t,e);break;case y.default.polygon:r=b._polygonIntersectExtent(t,e);break;case y.default.multiPolygon:r=b._multiPolygonIntersectExtent(t,e);break;case y.default.extent:var i=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});r=b._polygonIntersectExtent(i,e);break;case y.default.circle:var o=new c.default({coordinates:[[[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin]]]});r=b._polygonIntersectPolygon(o,t.toPolygon())}break;case y.default.circle:var a=e.toPolygon();switch(t.type){case y.default.point:r=b._pointIntersectGeometry(t,a);break;case y.default.multiPoint:r=b._multiPointIntersectGeometry(t,a);break;case y.default.lineString:r=b._lineIntersectPolygon(t,a);break;case y.default.multiLineString:r=b._multiLineIntersectPolygon(t,a);break;case y.default.polygon:r=b._polygonIntersectPolygon(t,a);break;case y.default.multiPolygon:r=b._polygonIntersectMultiPolygon(a,t);break;case y.default.circle:r=b._polygonIntersectPolygon(t.toPolygon(),a);break;case y.default.extent:r=b._polygonIntersectExtent(a,t)}break;case y.default.multiLineString:switch(t.type){case y.default.point:r=b._pointIntersectGeometry(t,e);break;case y.default.multiPoint:r=b._multiPointIntersectGeometry(t,e);break;case y.default.lineString:r=b._lineIntersectLine(t,e);break;case y.default.multiLineString:for(var l=[],h=[],d=0;d<e.coordinates.length;d++){var p=new f.default({coordinates:e.coordinates[d]}),g=b._lineIntersectLine(p,t);g&&g.point&&l.push(g.point),g&&g.lineString&&h.push(g.lineString)}(r={point:void 0,lineString:void 0}).point=b.union(l),r.lineString=b.union(h);break;case y.default.polygon:r=b._multiLineIntersectPolygon(e,t);break;case y.default.multiPolygon:r=b._multiLineIntersectMultiPolygon(e,t)}}return r},b._lineIntersectLine=function(e,t){var r,n;r=e.type===y.default.lineString?a.lineString(e.coordinates):a.multiLineString(e.coordinates),n=t.type===y.default.lineString?a.lineString(t.coordinates):a.multiLineString(t.coordinates);var i=void 0,o=void 0;if(e.type===y.default.lineString)i=[e];else{i=[];for(var s=0;s<e.coordinates.length;s++)i.push(new f.default({coordinates:e.coordinates[s]}))}if(t.type===y.default.lineString)o=[t];else{o=[];for(var l=0;l<t.coordinates.length;l++)o.push(new f.default({coordinates:t.coordinates[l]}))}for(var u=[],c=0;c<i.length;c++)for(var h=0;h<o.length;h++){var d=a.lineString(i[c].coordinates),p=a.lineString(o[h].coordinates),m=a.lineOverlap(d,p);if(m.features.length>0)for(var _=0;_<m.features.length;_++)u.push(new f.default({coordinates:m.features[_].geometry.coordinates}))}var S=a.lineIntersect(r,n),x={point:void 0,lineString:void 0};1===u.length?x.lineString=new f.default({coordinates:u[0].coordinates}):u.length>1&&(x.lineString=b.union(u));for(var w=0;w<S.features.length;w++){var k=new v.default({coordinates:S.features[w].geometry.coordinates});x.lineString&&b.contains(x.lineString,k)&&S.features.splice(w,1)}if(1===S.features.length)x.point=new v.default({coordinates:S.features[0].geometry.coordinates});else if(S.features.length>1){for(var M=[],E=0;E<S.features.length;E++)M.push(S.features[E].geometry.coordinates);x.point=new g.default({coordinates:M})}return x},b._lineIntersectMultiPoint=function(e,t){for(var r=[],n=void 0,i=0;i<t.coordinates.length;i++){var o=new v.default({coordinates:t.coordinates[i]});b.contains(e,o)&&r.push(o.coordinates)}return 1===r.length?n=new v.default({coordinates:r[0]}):r.length>1&&(n=new g.default({coordinates:r})),n},b._lineIntersectPolygon=function(e,t){var r=a.lineString(e.coordinates),n=a.polygon(t.coordinates),i=a.lineIntersect(r,n);i.features=i.features.sort(function(e,t){return e.geometry.coordinates[0]-t.geometry.coordinates[0]});for(var o=[],s=0;s<e.coordinates.length-1;s++){var l=new f.default({coordinates:[e.coordinates[s],e.coordinates[s+1]]});l.coordinates=l.coordinates.sort(function(e,t){return e-t});for(var u=[],c=0;c<i.features.length;c++){var h=new v.default({coordinates:i.features[c].geometry.coordinates});b.contains(l,h)&&u.push(h)}var d=new v.default({coordinates:e.coordinates[s]});u[0]&&b.equals(d,u[0])||(u=[d].concat(u));var p=new v.default({coordinates:e.coordinates[s+1]});0!==u.length&&b.equals(p,u[u.length-1])||u.push(p);for(var m=0;m<u.length-1;m++){var _=new f.default({coordinates:[u[m].coordinates,u[m+1].coordinates]});b.contains(t,_)&&o.push(_)}}if(1===o.length)return o[0];if(o.length>1){for(var x=[],w=0;w<o.length;w++)x.push(o[w].coordinates);return new S.default({coordinates:x})}for(var k=[],M=0;M<i.features.length;M++)i.features[M].geometry.type===y.default.point&&k.push(i.features[M].geometry.coordinates);return 1===k.length?new v.default({coordinates:k[0]}):k.length>1?new g.default({coordinates:k}):void 0},b._multiLineIntersectPolygon=function(e,t){for(var r=[],n=0;n<e.coordinates.length;n++){var i=new f.default({coordinates:e.coordinates[n]}),o=b._lineIntersectPolygon(i,t);o&&r.push(o)}if(1===r.length)return new f.default({coordinates:r[0].coordinates});if(r.length>1){for(var a=[],s=0;s<r.length;s++)r[s].type===y.default.lineString?a.push(r[s].coordinates):a=a.concat(r[s].coordinates);return new S.default({coordinates:a})}},b._multiLineIntersectMultiPolygon=function(e,t){for(var r=[],n=0;n<t.coordinates.length;n++){var i=new c.default({coordinates:t.coordinates[n]}),o=b._multiLineIntersectPolygon(e,i);o&&r.push(o)}return b.union(r)},b._lineIntersectExtent=function(e,t){var r=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});return b._lineIntersectPolygon(e,r)},b._multiLineIntersectExtent=function(e,t){for(var r=[],n=0;n<e.coordinates.length;n++){var i=new f.default({coordinates:e.coordinates[n]}),o=b._lineIntersectExtent(i,t);o&&r.push(o)}if(1===r.length)return r[0];if(r.length>1){for(var a=[],s=0;s<r.length;s++)a.push(r[s].coordinates);return new S.default({coordinates:a})}},b._lineIntersectMultiPolygon=function(e,t){for(var r=void 0,n=[],i=0;i<t.coordinates.length;i++){var o=new c.default({coordinates:t.coordinates[i]});n.push(b._lineIntersectPolygon(e,o))}for(var a=[],s=0;s<n.length;s++)n[s].type===y.default.lineString?a.push(n[s].coordinates):a=a.concat(n[s].coordinates);return 1===a.length?r=new f.default({coordinates:a}):a.length>1&&(r=new S.default({coordinates:a})),r},b._pointIntersectGeometry=function(e,t){if(b.contains(t,e))return new v.default({coordinates:e.coordinates})},b._multiPointIntersectGeometry=function(e,t){for(var r=[],n=0;n<e.coordinates.length;n++){var i=new v.default({coordinates:e.coordinates[n]});b.contains(t,i)&&r.push(i.coordinates)}var o=void 0;return 1===r.length?o=new v.default({coordinates:r[0]}):r.length>1&&(o=new g.default({coordinates:r})),o},b._polygonIntersectPolygon=function(e,t){var r=a.polygon(e.coordinates),n=a.polygon(t.coordinates),i=a.intersect(r,n);if(i)return i.geometry.type===y.default.polygon?new c.default({coordinates:i.geometry.coordinates}):new h.default({coordinates:i.geometry.coordinates})},b._polygonIntersectMultiPolygon=function(e,t){for(var r=[],n=0;n<t.coordinates.length;n++){var i=new c.default({coordinates:t.coordinates[n]}),o=b._polygonIntersectPolygon(e,i);o&&r.push(o)}return b.union(r)},b._multiPolygonIntersectMultiPolygon=function(e,t){for(var r=[],n=0;n<e.coordinates.length;n++){var i=new c.default({coordinates:e.coordinates[n]}),o=b._polygonIntersectMultiPolygon(i,t);o&&r.push(o)}return b.union(r)},b._polygonIntersectExtent=function(e,t){var r=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});return b._polygonIntersectPolygon(e,r)},b._multiPolygonIntersectExtent=function(e,t){for(var r=[],n=0;n<e.coordinates.length;n++){var i=new c.default({coordinates:e.coordinates[n]}),o=b._polygonIntersectExtent(i,t);o&&r.push(o)}return b.union(r)},b.overlaps=function(e,t){return!!b.intersects(e,t)&&!b.contains(e,t)&&!b.contains(t,e)},b.rotate=function(e,t,r){t=(0,s.defaultValue)(t,0),(0,s.isNull)(e)&&s.Log.error("geometry不能为空！"),(0,s.isNull)(t)&&s.Log.error("angle不能为空！"),e instanceof u.default||s.Log.error("geometry不是基础几何对象！"),"number"!=typeof t&&s.Log.error("angle不是数字！"),!r||r instanceof v.default||s.Log.error("rotationOrigin不是Point对象！"),r&&!e.spatialReference.equals(r.spatialReference)&&s.Log.error("rotationOrigin和geometry不是同一个坐标系！");var n=void 0,i=void 0;e.spatialReference.isGeographic?(n=e,i=r):(n=d.default.projectGeometry(e,new p.default({wkid:4326})),i=d.default.projectGeometry(r,new p.default({wkid:4326})));var o=b._geometryToTurf(n),l=void 0;i&&(l=[i.coordinates[0],i.coordinates[1]]);var c={pivot:l,mutate:!0},f=a.transformRotate(o,t,c);return f=b._turfFeatureToGeometry(f),e.spatialReference.isGeographic||(f=d.default.projectGeometry(f,p.default.fromJSON(e.spatialReference))),f},b._turfFeatureToGeometry=function(e){switch(e.geometry.type){case y.default.point:return new v.default({coordinates:e.geometry.coordinates});case y.default.multiPoint:return new g.default({coordinates:e.geometry.coordinates});case y.default.lineString:return new f.default({coordinates:e.geometry.coordinates});case y.default.multiLineString:return new S.default({coordinates:e.geometry.coordinates});case y.default.polygon:return new c.default({coordinates:e.geometry.coordinates});case y.default.multiPolygon:return new h.default({coordinates:e.geometry.coordinates})}},b.nearestCoordinate=function(e,t){(0,s.isNull)(e)&&s.Log.error("geometry不能为空！"),(0,s.isNull)(t)&&s.Log.error("inputPoint不能为空！");var r=e,n=t;if(n instanceof v.default||s.Log.error("inputPoint类型错误，需要输入Point！"),r instanceof v.default||r instanceof f.default||r instanceof c.default||r instanceof g.default||r instanceof S.default||r instanceof h.default||r instanceof _.default||r instanceof m.default||s.Log.error("geometry类型错误！"),r.spatialReference.equals(n.spatialReference)||s.Log.error("_geometryPro1、inputPoint坐标系不同！"),r=(0,s.defaultValue)(r,void 0),n=(0,s.defaultValue)(n,void 0),r.spatialReference.isGeographic||(r=d.default.projectGeometry(r,new p.default({wkid:4326})),n=d.default.projectGeometry(n,new p.default({wkid:4326}))),!(0,s.isNull)(r)&&!(0,s.isNull)(n)){var i=void 0,o=void 0,l=void 0,x=[],b=a.point(n.coordinates);switch(r.type){case y.default.multiPoint:for(var w=0;w<r.coordinates.length;w++)x.push(a.point(r.coordinates[w]));var k=a.featureCollection(x);i=a.nearestPoint(b,k);break;case y.default.lineString:o=a.lineString(r.coordinates),i=a.nearestPointOnLine(o,b,{units:"kilometers"});break;case y.default.multiLineString:o=a.multiLineString(r.coordinates),i=a.nearestPointOnLine(o,b,{units:"kilometers"});break;case y.default.polygon:for(var M=0;M<r.coordinates[0].length;M++)x.push(r.coordinates[0][M]);o=a.lineString(x),i=a.nearestPointOnLine(o,b,{units:"kilometers"});break;case y.default.multiPolygon:for(var E=[],I=0;I<r.coordinates.length;I++){x=[];for(var T=0;T<r.coordinates[I][0].length;T++)x.push(r.coordinates[I][0][T]);E.push(x),o=a.multiLineString(E)}i=a.nearestPointOnLine(o,b,{units:"kilometers"});break;case y.default.circle:l=a.polygon(r.toPolygon().coordinates);for(var L=0;L<l.geometry.coordinates[0].length;L++)x.push(l.geometry.coordinates[0][L]);o=a.lineString(x),i=a.nearestPointOnLine(o,b,{units:"kilometers"});break;case y.default.extent:l=new c.default({coordinates:[[[r.xmin,r.ymin],[r.xmax,r.ymin],[r.xmax,r.ymax],[r.xmin,r.ymax],[r.xmin,r.ymin]]]});for(var P=0;P<l.coordinates[0].length;P++)x.push(l.coordinates[0][P]);o=a.lineString(x),i=a.nearestPointOnLine(o,b,{units:"kilometers"})}return i=u.default.fromJSON(i.geometry),t.spatialReference.isGeographic||(i=d.default.projectGeometry(i,t.spatialReference)),i}},b.planarArea=function(e,t){t=(0,s.defaultValue)(t,l.LinearUnits.meters),e instanceof c.default||e instanceof h.default||e instanceof m.default||e instanceof _.default||s.Log.error("polygon对象不是Polyon或MultiPolygon或Circle或Extent类型！");var r=0;if(e instanceof c.default)r=b._polygonArea(e);else if(e instanceof h.default)for(var n=e.toPolygonArray(),i=0;i<n.length;i++)r+=b._polygonArea(n[i]);else e instanceof m.default?r=Math.abs(Math.PI*e.radius*e.radius):e instanceof _.default&&(r=Math.abs((e.xmax-e.xmin)*(e.ymax-e.ymin)));switch(t){case l.AreaUnits.squareKilometers:r*=1e-6;break;case l.AreaUnits.squareMiles:r*=6214e-7*6214e-7;break;case l.AreaUnits.squareYards:r*=1.1959900499368898;break;case l.AreaUnits.squareFeet:r*=10.763910416689228;break;case l.AreaUnits.acres:r*=2471e-7;break;case l.AreaUnits.ares:r*=.01;break;case l.AreaUnits.hectares:r*=1e-4;break;case l.AreaUnits.squareMeters:}return r},b._ringArea=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r][0]*e[r===e.length-1?0:r+1][1]*.5,t-=e[r===e.length-1?0:r+1][0]*e[r][1]*.5;return Math.abs(t)},b._polygonArea=function(e){for(var t=b._ringArea(e.coordinates[0]),r=0,n=1;n<e.coordinates.length;n++)r+=b._ringArea(e.coordinates[n]);return t-r},b.planarLength=function(e,t){t=(0,s.defaultValue)(t,l.LinearUnits.meters),(0,s.isNull)(e)&&s.Log.error("geometry对象不能为空！"),e instanceof f.default||e instanceof S.default||e instanceof c.default||e instanceof h.default||e instanceof m.default||e instanceof _.default||s.Log.error("geometry类型不正确！");var r=0,n=void 0;switch(e.type){case y.default.lineString:r=b._planarLineStringLength(e);break;case y.default.multiLineString:r=b._planarMultiLineStringLength(e);break;case y.default.polygon:n=new c.default({coordinates:[e.coordinates[0]]}),r=b._planarMultiLineStringLength(n);break;case y.default.multiPolygon:for(var i=0;i<e.coordinates.length;i++){var o=new c.default({coordinates:[e.coordinates[i][0]]});r+=b._planarMultiLineStringLength(o)}break;case y.default.circle:r=2*Math.PI*e.radius;break;case y.default.extent:n=new c.default({coordinates:[[[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin]]]}),r+=b._planarMultiLineStringLength(n)}switch(t){case l.LinearUnits.kilometers:r*=.001;break;case l.LinearUnits.feet:r*=3.28083989501;break;case l.LinearUnits.miles:r*=6214e-7;break;case l.LinearUnits.nauticalMiles:r*=54e-5;break;case l.LinearUnits.yards:r*=1.0936133;break;case l.LinearUnits.meters:}return r},b._planarLineStringLength=function(e){for(var t=0,r=0;r<e.coordinates.length-1;r++){var n=Math.abs(e.coordinates[r+1][0]-e.coordinates[r][0]),i=Math.abs(e.coordinates[r+1][1]-e.coordinates[r][1]);t+=Math.sqrt(Math.pow(n,2)+Math.pow(i,2))}return t},b._planarMultiLineStringLength=function(e){for(var t=0,r=0;r<e.coordinates.length;r++){var n=new f.default({coordinates:e.coordinates[r]});t+=b._planarLineStringLength(n)}return t},b.contains=function(e,t){b._checkTwoGeometry(e,t);var r=!1,n=void 0;switch(e.type){case y.default.point:switch(t.type){case y.default.point:return b.equals(e,t)}break;case y.default.multiPoint:switch(t.type){case y.default.point:return b._multiPointContainsPoint(e,t);case y.default.multiPoint:r=!0;for(var i=0;i<t.coordinates.length&&(n=new v.default({coordinates:t.coordinates[i]}),r=b._lineContainPoint(e,n));i++);return r}break;case y.default.lineString:switch(t.type){case y.default.point:return b._lineContainPoint(e,t);case y.default.multiPoint:r=!0;for(var o=0;o<t.coordinates.length;o++)if(n=new v.default({coordinates:t.coordinates[o],spatialReference:p.default.fromJSON(t.spatialReference)}),!b._lineContainPoint(e,n)){r=!1;break}return r;case y.default.lineString:return b._lineContainLine(e,t);case y.default.multiLineString:r=!0;for(var a=0;a<t.coordinates.length;a++){var s=new f.default({coordinates:t.coordinates[a],spatialReference:p.default.fromJSON(t.spatialReference)});if(!b._lineContainLine(e,s)){r=!1;break}}return r}break;case y.default.multiLineString:switch(t.type){case y.default.point:return b._multiLineContainPoint(e,t);case y.default.multiPoint:r=!0;for(var l=0;l<t.coordinates.length;l++){var u=new v.default({coordinates:t.coordinates[l],spatialReference:p.default.fromJSON(t.spatialReference)});if(!b._multiLineContainPoint(e,u)){r=!1;break}}return r;case y.default.lineString:return b._multiLineContainLine(e,t);case y.default.multiLineString:r=!0;for(var h=0;h<t.coordinates.length;h++){var d=new f.default({coordinates:t.coordinates[h],spatialReference:p.default.fromJSON(t.spatialReference)});if(!b._multiLineContainLine(e,d)){r=!1;break}}return r}break;case y.default.polygon:switch(t.type){case y.default.point:return b._polygonContainPoint(e,t);case y.default.multiPoint:r=!0;for(var g=0;g<t.coordinates.length;g++){var m=new v.default({coordinates:t.coordinates[g]});if(!b._polygonContainPoint(e,m)){r=!1;break}}return r;case y.default.lineString:return b._polygonContainLine(e,t);case y.default.multiLineString:r=!0;for(var _=0;_<t.coordinates.length;_++){var S=new f.default({coordinates:t.coordinates[_]});if(!b._polygonContainLine(e,S)){r=!1;break}}return r;case y.default.polygon:return b._polygonContainPolygon(e,t);case y.default.multiPolygon:r=!0;for(var x=0;x<t.coordinates.length;x++){var w=new c.default({coordinates:t.coordinates[x]});if(!b._polygonContainPolygon(e,w)){r=!1;break}}return r;case y.default.circle:return b._polygonContainPolygon(e,t.toPolygon());case y.default.extent:var k=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});return b._polygonContainPolygon(e,k)}break;case y.default.multiPolygon:switch(t.type){case y.default.point:return b._multiPolygonContainsPoint(e,t);case y.default.multiPoint:return b._multiContainsMulti(e,t,v.default,b._multiPolygonContainsPoint);case y.default.lineString:return b._multiPolygonContainsLine(e,t);case y.default.multiLineString:return b._multiContainsMulti(e,t,f.default,b._multiPolygonContainsLine);case y.default.polygon:return b._multiPolygonContainsPolygon(e,t);case y.default.multiPolygon:return b._multiContainsMulti(e,t,c.default,b._multiPolygonContainsPolygon);case y.default.circle:r=!1;for(var M=0;M<e.coordinates.length;M++){var E=new c.default({coordinates:e.coordinates[M]});if(b._polygonContainPolygon(E,t.toPolygon())){r=!0;break}}return r;case y.default.extent:r=!1;for(var I=0;I<e.coordinates.length;I++){var T=new c.default({coordinates:e.coordinates[I]}),L=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});if(b._polygonContainPolygon(T,L)){r=!0;break}}return r}break;case y.default.circle:switch(t.type){case y.default.point:return b._polygonContainPoint(e.toPolygon(),t);case y.default.multiPoint:return b._singleContainsMulti(e.toPolygon(),t,v.default,b._polygonContainPoint);case y.default.lineString:return b._polygonContainMultiPoint(e.toPolygon(),t);case y.default.multiLineString:return b._singleContainsMulti(e.toPolygon(),t,f.default,b._polygonContainMultiPoint);case y.default.polygon:return b._polygonContainPolygon(e.toPolygon(),t);case y.default.multiPolygon:return b._singleContainsMulti(e.toPolygon(),t,c.default,b._polygonContainPolygon);case y.default.circle:return b._polygonContainPolygon(e.toPolygon(),t.toPolygon());case y.default.extent:var P=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});return b._polygonContainPolygon(e.toPolygon(),P)}break;case y.default.extent:var C=new c.default({coordinates:[[[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin]]]});switch(t.type){case y.default.point:return b._polygonContainPoint(C,t);case y.default.multiPoint:return b._singleContainsMulti(C,t,v.default,b._polygonContainPoint);case y.default.lineString:return b._polygonContainMultiPoint(C,t);case y.default.multiLineString:return b._singleContainsMulti(C,t,f.default,b._polygonContainMultiPoint);case y.default.polygon:return b._polygonContainPolygon(C,t);case y.default.multiPolygon:return b._singleContainsMulti(C,t,c.default,b._polygonContainPolygon);case y.default.circle:return b._polygonContainPolygon(C,t.toPolygon());case y.default.extent:var N=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});return b._polygonContainPolygon(C,N)}break;default:return!1}},b._singleContainsMulti=function(e,t,r,n){for(var i=!0,o=0;o<t.coordinates.length;o++)if(!n(e,new r({coordinates:t.coordinates[o]}))){i=!1;break}return i},b._multiContainsMulti=function(e,t,r,n){for(var i=!0,o=0;o<t.coordinates.length;o++)if(!n(e,new r({coordinates:t.coordinates[o]}))){i=!1;break}return i},b._multiPolygonContainsPoint=function(e,t){for(var r=!1,n=0;n<e.coordinates.length;n++){var i=new c.default({coordinates:e.coordinates[n]});if(b._polygonContainPoint(i,t)){r=!0;break}}return r},b._multiPolygonContainsLine=function(e,t){for(var r=!1,n=0;n<e.coordinates.length;n++){var i=new c.default({coordinates:e.coordinates[n]});if(b._polygonContainMultiPoint(i,t)){r=!0;break}}return r},b._multiPolygonContainsPolygon=function(e,t){for(var r=!1,n=0;n<e.coordinates.length;n++){var i=new c.default({coordinates:e.coordinates[n]});if(b._polygonContainPolygon(i,t)){r=!0;break}}return r},b._lineContainLine=function(e,t){var r=a.lineString(e.coordinates),n=a.lineString(t.coordinates),i=a.booleanContains(r,n);if(i||(i=b.equals(e,t)),!i){var o=new f.default({coordinates:[t.coordinates[1],t.coordinates[0]]});i=b.equals(e,o)}return i},b._multiLineContainLine=function(e,t){for(var r=!1,n=0;n<e.coordinates.length;n++){var i=new f.default({coordinates:e.coordinates[n],spatialReference:p.default.fromJSON(e.spatialReference)});if(b._lineContainLine(i,t)){r=!0;break}}return r},b._polygonContainPolygon=function(e,t){var r=a.polygon(e.coordinates),n=a.polygon(t.coordinates);return a.booleanContains(r,n)},b.distance=function(e,t,r){if((0,s.isNull)(e)&&s.Log.error("geometry1不能为空！"),(0,s.isNull)(t)&&s.Log.error("geometry2不能为空！"),e instanceof v.default||s.Log.error("geometry1类型错误，需要输入Point！"),t instanceof v.default||t instanceof f.default||t instanceof c.default||t instanceof g.default||t instanceof S.default||t instanceof h.default||t instanceof _.default||t instanceof m.default||s.Log.error("geometry2类型错误！"),e.spatialReference.equals(t.spatialReference)||s.Log.error("geometry1、geometry2坐标系不同！"),r=(0,s.defaultValue)(r,l.LengthUnit.kilometer),e=(0,s.defaultValue)(e,void 0),t=(0,s.defaultValue)(t,void 0),e.spatialReference.isGeographic||(e=d.default.projectGeometry(e,new p.default({wkid:4326})),t=d.default.projectGeometry(t,new p.default({wkid:4326}))),!(0,s.isNull)(e)&&!(0,s.isNull)(t)){var n=void 0,i=void 0,o=void 0,u=[],x=[],b=a.point(e.coordinates);switch(t.type){case y.default.point:i=a.point(t.coordinates),n=a.distance(b,i,{units:r});break;case y.default.multiPoint:for(var w=0;w<t.coordinates.length;w++)u.push(a.point(t.coordinates[w]));var k=a.featureCollection(u),M=a.nearestPoint(b,k);n=a.distance(b,M,{units:r});break;case y.default.lineString:i=a.lineString(t.coordinates),n=a.pointToLineDistance(b,i,{units:r});break;case y.default.multiLineString:for(var E=0;E<t.coordinates.length;E++)i=a.lineString(t.coordinates[E]),x.push(a.pointToLineDistance(b,i,{units:r}));x.sort(function(e,t){return e-t}),n=x[0];break;case y.default.polygon:for(var I=0;I<t.coordinates[0].length;I++)u.push(t.coordinates[0][I]);i=a.lineString(u),n=a.pointToLineDistance(b,i,{units:r});break;case y.default.multiPolygon:for(var T=0;T<t.coordinates.length;T++){u=[];for(var L=0;L<t.coordinates[T][0].length;L++)u.push(t.coordinates[T][0][L]);i=a.lineString(u),x.push(a.pointToLineDistance(b,i,{units:r}))}x.sort(function(e,t){return e-t}),n=x[0];break;case y.default.circle:o=a.polygon(t.toPolygon().coordinates);for(var P=0;P<o.geometry.coordinates[0].length;P++)u.push(o.geometry.coordinates[0][P]);i=a.lineString(u),n=a.pointToLineDistance(b,i,{units:r});break;case y.default.extent:for(var C=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]}),N=0;N<C.coordinates[0].length;N++)u.push(C.coordinates[0][N]);i=a.lineString(u),n=a.pointToLineDistance(b,i,{units:r})}return n}},b.equals=function(e,t){if((0,s.isNull)(e)&&s.Log.error("geometry1对象为空！"),(0,s.isNull)(t)&&s.Log.error("geometry2对象为空！"),e instanceof u.default||s.Log.error("geometry1对象未继承于Geometry对象！"),t instanceof u.default||s.Log.error("geometry2对象未继承于Geometry对象！"),e.type!==t.type)return!1;if(!e.spatialReference.equals(t.spatialReference))return!1;switch(e.type){case y.default.point:if(!e.equals(t))return!1;break;case y.default.polygon:return b._equalPolygon(e,t);case y.default.lineString:return b._equalLinePoint(e,t);case y.default.extent:if(e.xmin!==t.xmin||e.ymin!==t.ymin||e.xmax!==t.xmax||e.ymax!==t.ymax)return!1;break;case y.default.circle:if(e.radius!==t.radius||e.radiusUnit!==t.radiusUnit)return!1;if(e.center.length!==t.center.length)return!1;for(var r=0;r<e.center.length;r++)if(e.center[r]!==t.center[r])return!1;break;case y.default.multiPoint:return b._equalLinePoint(e,t);case y.default.multiLineString:if(e.coordinates.length!==t.coordinates.length)return!1;for(var n=0;n<e.coordinates.length;n++){var i=new f.default({coordinates:e.coordinates[n],spatialReference:e.spatialReference}),o=new f.default({coordinates:t.coordinates[n],spatialReference:t.spatialReference});if(!b.equals(i,o))return!1}break;case y.default.multiPolygon:if(e.coordinates.length!==t.coordinates.length)return!1;for(var a=0;a<e.coordinates.length;a++){var l=new c.default({coordinates:e.coordinates[a],spatialReference:e.spatialReference}),h=new c.default({coordinates:t.coordinates[a],spatialReference:t.spatialReference});if(!b.equals(l,h))return!1}}return!0},b._equalLinePoint=function(e,t){if(e.coordinates.length!==t.coordinates.length)return!1;for(var r=0;r<e.coordinates.length;r++){var n=new v.default({coordinates:e.coordinates[r]}),i=new v.default({coordinates:t.coordinates[r]});if(!n.equals(i))return!1}return!0},b._equalPolygon=function(e,t){if(e.coordinates.length!==t.coordinates.length)return!1;for(var r=0;r<e.coordinates.length;r++)if(e.coordinates[r].length!==t.coordinates[r].length)return!1;for(var n=0;n<e.coordinates.length;n++){var i=new f.default({coordinates:e.coordinates[n],spatialReference:e.spatialReference}),o=new f.default({coordinates:t.coordinates[n],spatialReference:t.spatialReference});if(!b.equals(i,o))return!1}return!0},b.disjoint=function(e,t){return!b.intersects(e,t)},b.within=function(e,t){return b.contains(t,e)},b.crosses=function(e,t){if((0,s.isNull)(e)&&s.Log.error("geometry1不能为空！"),(0,s.isNull)(t)&&s.Log.error("geometry2不能为空！"),e.spatialReference.equals(t.spatialReference)||s.Log.error("geometry1、geometry2坐标系不同！"),e instanceof f.default||e instanceof S.default)return b._crosses(e,t);if(t instanceof f.default||t instanceof S.default){var r=e;return b._crosses(e=t,t=r)}s.Log.error("geometry1和geometry2中至少有一个参数类型必须为lineString和multiLineString中的一个！")},b._crosses=function(e,t){if(t instanceof f.default||t instanceof c.default||t instanceof S.default||t instanceof h.default||t instanceof _.default||t instanceof m.default||s.Log.error("geometry2类型错误！"),e=(0,s.defaultValue)(e,void 0),t=(0,s.defaultValue)(t,void 0),e.spatialReference.isGeographic||(e=d.default.projectGeometry(e,new p.default({wkid:4326})),t=d.default.projectGeometry(t,new p.default({wkid:4326}))),!(0,s.isNull)(e)&&!(0,s.isNull)(t)){var r=void 0,n=void 0,i=void 0;switch(e.type){case y.default.lineString:switch(t.type){case y.default.lineString:if(n=b._geometryToTurf(e),i=b._geometryToTurf(t),!(r=a.booleanCrosses(n,i))&&b.intersects(e,t)){var o=[],l=new g.default({coordinates:[t.coordinates[0],t.coordinates[t.coordinates.length-1]]});if(l.coordinates[0].toString()===l.coordinates[1].toString()){var u=b.intersect(e,t);if("MultiPoint"===u.point.type)r=!0;else if("Point"===u.point.type){var x=new v.default({coordinates:e.coordinates[0]}),w=new v.default({coordinates:e.coordinates[e.coordinates.length-1]});r=!b.contains(t,x)&&!b.contains(t,w)}}else{for(var k=0;k<e.coordinates.length;k++)o.push(e.coordinates[k]);for(var M=0;M<t.coordinates.length;M++)o.push(t.coordinates[M]);var E=a.multiPoint(o);if(!(a.cleanCoords(E).geometry.coordinates.length<E.geometry.coordinates.length)){for(var I=void 0,T=0;T<e.coordinates.length;T++){if(I){r=!I;break}var L=new v.default({coordinates:e.coordinates[T]});I=b.contains(t,L)}for(var P=0;P<t.coordinates.length;P++){if(I){r=!I;break}var C=new v.default({coordinates:t.coordinates[P]});I=b.contains(e,C)}I||(r=!0);break}r=!1}}break;case y.default.multiLineString:for(var N=0;N<t.coordinates.length&&!r;N++)i=new f.default({coordinates:t.coordinates[N]}),r=b._crosses(e,i);break;case y.default.polygon:case y.default.extent:case y.default.circle:n=b._geometryToTurf(e),i=b._geometryToTurf(t),(r=a.booleanCrosses(n,i))&&"Point"===b.intersect(e,t).type&&(r=!1);break;case y.default.multiPolygon:for(var O=0;O<t.coordinates.length&&!r;O++)i=new c.default({coordinates:t.coordinates[O]}),r=b._crosses(e,i)}break;case y.default.multiLineString:for(var R=0;R<e.coordinates.length&&!r;R++)n=new f.default({coordinates:e.coordinates[R]}),r=b._crosses(n,t)}return r}},b.touches=function(e,t){if((0,s.isNull)(e)&&s.Log.error("geometry1不能为空！"),(0,s.isNull)(t)&&s.Log.error("geometry2不能为空！"),e instanceof f.default||e instanceof c.default||e instanceof S.default||e instanceof h.default||e instanceof _.default||e instanceof m.default||s.Log.error("geometry1类型错误，需要输入LineString、Polygon、MultiLineString、MultiPolygon、Circle、Extent！"),t instanceof v.default||t instanceof f.default||t instanceof c.default||t instanceof g.default||t instanceof S.default||t instanceof h.default||t instanceof _.default||t instanceof m.default||s.Log.error("geometry2类型错误！"),e.spatialReference.equals(t.spatialReference)||s.Log.error("geometry1、geometry2坐标系不同！"),e=(0,s.defaultValue)(e,void 0),t=(0,s.defaultValue)(t,void 0),e.spatialReference.isGeographic||(e=d.default.projectGeometry(e,new p.default({wkid:4326})),t=d.default.projectGeometry(t,new p.default({wkid:4326}))),!(0,s.isNull)(e)&&!(0,s.isNull)(t)){var r=!1,n=void 0,i=void 0,o=[];switch(e.type){case y.default.lineString:switch(t.type){case y.default.point:var a=new g.default({coordinates:[e.coordinates[0],e.coordinates[e.coordinates.length-1]]});b.contains(a,t)&&a.coordinates[0].toString()!==a.coordinates[1].toString()&&(r=!0);break;case y.default.multiPoint:for(var l=0;l<t.coordinates.length;l++){var u=new v.default({coordinates:t.coordinates[l]}),x=b.touches(e,u);if(x)r=x;else if(b.intersects(e,u)){r=!1;break}}break;case y.default.lineString:if(b.intersect(e,t).point){var w=new v.default({coordinates:e.coordinates[0]}),k=new v.default({coordinates:e.coordinates[e.coordinates.length-1]});if(b.contains(t,w)||b.contains(t,k))r=!b.crosses(e,t);else{var M=new v.default({coordinates:t.coordinates[0]}),E=new v.default({coordinates:t.coordinates[t.coordinates.length-1]});r=!(!b.contains(e,M)&&!b.contains(e,E)||b.crosses(e,t))}}else r=!1;break;case y.default.multiLineString:for(var I=0;I<t.coordinates.length;I++){i=new f.default({coordinates:t.coordinates[I]});var T=b.touches(e,i);if(T)r=T;else if(b.intersects(e,i)){r=!1;break}}break;case y.default.polygon:for(var L=0;L<t.coordinates[0].length;L++)o.push(t.coordinates[0][L]);i=new f.default({coordinates:o}),b.intersects(e,i)&&(b.crosses(e,i)||(r=!0));break;case y.default.multiPolygon:for(var P=0;P<t.coordinates.length;P++){i=new c.default({coordinates:t.coordinates[P]});var C=b.touches(e,i);if(C)r=C;else if(b.intersects(e,i)){r=!1;break}}break;case y.default.circle:var N=new v.default({coordinates:t.center}),O=b.nearestCoordinate(e,N),R=new f.default({coordinates:[t.center,O.geometry.coordinates]}),V=b.planarLength(R);Math.round(V)===t.radius&&(r=!0);break;case y.default.extent:var G=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});r=b.touches(e,G)}break;case y.default.multiLineString:for(var A=0;A<e.coordinates.length;A++){n=new f.default({coordinates:e.coordinates[A]});var F=b.touches(n,t);if(F)r=F;else if(b.intersects(n,t)){r=!1;break}}break;case y.default.polygon:switch(t.type){case y.default.point:if(!b.contains(e,t)){for(var D=0;D<e.coordinates.length;D++)o.push(e.coordinates[D]);n=new S.default({coordinates:o}),b.contains(n,t)&&(r=!0)}break;case y.default.multiPoint:for(var j=0;j<t.coordinates.length;j++){var B=new v.default({coordinates:t.coordinates[j]}),q=b.touches(e,B);if(q)r=q;else if(b.contains(e,B)){r=!1;break}}break;case y.default.lineString:case y.default.multiLineString:r=b.touches(t,e);break;case y.default.polygon:b.intersects(e,t)&&(b.intersect(e,t)||(r=!0));break;case y.default.multiPolygon:for(var U=0;U<t.coordinates.length;U++){i=new c.default({coordinates:t.coordinates[U]});var J=b.touches(e,i);if(J)r=J;else if(b.intersects(e,i)){r=!1;break}}break;case y.default.circle:for(var z=0;z<e.coordinates[0].length;z++)o.push(e.coordinates[0][z]);n=new f.default({coordinates:o});var W=new v.default({coordinates:t.center}),H=b.nearestCoordinate(n,W),X=new f.default({coordinates:[t.center,H.geometry.coordinates]}),Y=b.planarLength(X);Math.round(Y)===t.radius&&(b.intersect(e,t)||(r=!0));break;case y.default.extent:var Z=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});r=b.touches(e,Z)}break;case y.default.multiPolygon:switch(t.type){case y.default.point:for(var K=0;K<e.coordinates.length;K++){n=new c.default({coordinates:e.coordinates[K]});var Q=b.touches(n,t);if(Q)r=Q;else if(b.contains(n,t)){r=!1;break}}break;case y.default.multiPoint:for(var $=0;$<t.coordinates.length;$++){var ee=new v.default({coordinates:t.coordinates[$]}),te=b.touches(e,ee);if(te)r=te;else if(b.contains(e,ee)){r=!1;break}}break;case y.default.lineString:case y.default.multiLineString:case y.default.polygon:r=b.touches(t,e);break;case y.default.multiPolygon:for(var re=0;re<t.coordinates.length;re++){i=new c.default({coordinates:t.coordinates[re]});var ne=b.touches(e,i);if(ne)r=ne;else if(b.intersects(e,i)){r=!1;break}}break;case y.default.extent:var ie=new c.default({coordinates:[[[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin]]]});r=b.touches(e,ie);break;case y.default.circle:for(var oe=0;oe<e.coordinates.length;oe++){n=new c.default({coordinates:e.coordinates[oe]});var ae=b.touches(n,t);if(ae)r=ae;else if(b.intersects(n,t)){r=!1;break}}}break;case y.default.extent:var se=new c.default({coordinates:[[[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin]]]});r=b.touches(se,t);break;case y.default.circle:switch(t.type){case y.default.point:var le=new f.default({coordinates:[e.center,t.coordinates]}),ue=b.planarLength(le);Math.round(ue)===e.radius&&(r=!0);break;case y.default.multiPoint:for(var ce=0;ce<t.coordinates.length;ce++){var fe=new v.default({coordinates:t.coordinates[ce]}),he=b.touches(e,fe);if(he)r=he;else{var de=new f.default({coordinates:[e.center,fe.coordinates]}),pe=b.planarLength(de);if(Math.round(pe)<e.radius){r=!1;break}}}break;case y.default.lineString:case y.default.multiLineString:case y.default.polygon:case y.default.multiPolygon:case y.default.extent:r=b.touches(t,e);break;case y.default.circle:var ye=new f.default({coordinates:[e.center,t.center]}),ge=b.planarLength(ye);Math.round(ge)===e.radius+t.radius&&(r=!0)}}return r}},b.cut=function(e,t){if((0,s.isNull)(e)&&s.Log.error("geometry不能为空!"),(0,s.isNull)(t)&&s.Log.error("cutter不能为空!"),e instanceof f.default||e instanceof S.default||e instanceof c.default||e instanceof h.default||s.Log.error("geometry类型错误!"),t instanceof f.default||s.Log.error("cutter类型错误!"),e.spatialReference.equals(t.spatialReference)||s.Log.error("geometry对象和cutter对象的坐标系不同!"),!b.intersects(e,t))return[];var r=[],n=void 0,i=void 0;switch(e.type){case y.default.lineString:r=b._lineCutLine(e,t);break;case y.default.multiLineString:for(var o=0;o<e.coordinates.length;o++){var a=new f.default({coordinates:e.coordinates[o],spatialReference:p.default.fromJSON(e.spatialReference)});r=r.concat(b._lineCutLine(a,t))}break;case y.default.polygon:if(n=void 0,e.spatialReference.isGeographic)n=e,i=t;else{var l=b._polygonAndCutterToWGS84(e,t);n=l.polygon,i=l.cutter}if(r=b._lineCutPolygon(n,i),!e.spatialReference.isGeographic)for(var u=0;u<r.length;u++)r[u]=b._geometryToOrigin(r[u]);break;case y.default.multiPolygon:if(n=void 0,e.spatialReference.isGeographic)n=e,i=t;else{var d=b._polygonAndCutterToWGS84(e,t);n=d.polygon,i=d.cutter}for(var g=0;g<n.coordinates.length;g++){var v=new c.default({coordinates:n.coordinates[g],spatialReference:p.default.fromJSON(e.spatialReference)});r=r.concat(b._lineCutPolygon(v,i))}if(!e.spatialReference.isGeographic)for(var m=0;m<r.length;m++)r[m]=b._geometryToOrigin(r[m])}return r},b._polygonAndCutterToWGS84=function(e,t){return{polygon:e.spatialReference.isGeographic?e:b._geometryToWGS84(e),cutter:t.spatialReference.isGeographic?t:b._geometryToWGS84(t)}},b._lineCutLine=function(e,t){for(var r=[],n=a.lineString(e.coordinates),i=a.lineString(t.coordinates),o=a.lineSplit(n,i),s=0;s<o.features.length;s++)r.push(new f.default({coordinates:o.features[s].geometry.coordinates,spatialReference:p.default.fromJSON(e.spatialReference)}));return r},b._lineCutPolygon=function(e,t){var r=[],n=new f.default({coordinates:e.coordinates[0]}),i=a.lineString(n.coordinates),o=a.lineString(t.coordinates);if(a.booleanDisjoint(o,n))return e.clone();for(var s=[],l=0;l<t.coordinates.length-1;l++){var u=a.lineString([t.coordinates[l],t.coordinates[l+1]]);a.booleanDisjoint(u,n)||s.push(t.coordinates[l],t.coordinates[l+1])}o=a.lineString(s),o=a.cleanCoords(o);for(var h=a.lineSplit(i,o),d=a.lineSplit(o,i),g=[],v=new c.default({coordinates:[e.coordinates[0]]}),m=0;m<d.features.length;m++){var _=new f.default({coordinates:d.features[m].geometry.coordinates});b.contains(v,_)&&g.push(d.features[m])}h.features=h.features.concat(g);for(var S=0;S<h.features.length;S++)for(var x=0;x<h.features[S].geometry.coordinates.length;x++)h.features[S].geometry.coordinates[x][0]=h.features[S].geometry.coordinates[x][0].toFixed(7)/1,h.features[S].geometry.coordinates[x][1]=h.features[S].geometry.coordinates[x][1].toFixed(7)/1;for(var w=a.polygonize(h),k=0;k<w.features.length;k++){var M=new c.default({coordinates:w.features[k].geometry.coordinates,spatialReference:p.default.fromJSON(e.spatialReference)});r.push(M)}if(e.coordinates.length>1)for(var E=0;E<r.length;E++)for(var I=1;I<e.coordinates.length;I++){var T=new c.default({coordinates:[e.coordinates[I]]}),L=a.polygon(T.coordinates),P=a.polygon(r[E].coordinates);a.booleanDisjoint(L,P)||(r[E]=b.difference(r[E],T))}for(var C=[],N=0;N<r.length;N++)if(r[N].type===y.default.multiPolygon)for(var O=0;O<r[N].coordinates.length;O++)C.push(new c.default({coordinates:r[N].coordinates[O],spatialReference:p.default.fromJSON(e.spatialReference)}));else C.push(r[N]);return C},b._coordinateToWGS84=function(e){var t=e[0]/20037508.34*180,r=e[1]/20037508.34*180;return[t.toFixed(7)/1,r.toFixed(7)/1]},b._coordinateToOrigin=function(e){return[20037508.34*e[0]/180,20037508.34*e[1]/180]},b._geometryToWGS84=function(e){var t=void 0;switch(e.type){case y.default.polygon:t=c.default.fromJSON(e.toJSON());for(var r=0;r<t.coordinates.length;r++)for(var n=0;n<t.coordinates[r].length;n++)t.coordinates[r][n]=b._coordinateToWGS84(t.coordinates[r][n]);break;case y.default.multiPolygon:t=h.default.fromJSON(e.toJSON());for(var i=0;i<t.coordinates.length;i++)for(var o=0;o<t.coordinates[i].length;o++)for(var a=0;a<t.coordinates[i][o].length;a++)t.coordinates[i][o][a]=b._coordinateToWGS84(t.coordinates[i][o][a]);break;case y.default.lineString:t=f.default.fromJSON(e.toJSON());for(var s=0;s<t.coordinates.length;s++)t.coordinates[s]=b._coordinateToWGS84(t.coordinates[s])}return t},b._geometryToOrigin=function(e){var t=void 0;switch(e.type){case y.default.polygon:t=c.default.fromJSON(e.toJSON());for(var r=0;r<t.coordinates.length;r++)for(var n=0;n<t.coordinates[r].length;n++)t.coordinates[r][n]=b._coordinateToOrigin(t.coordinates[r][n]);break;case y.default.lineString:t=f.default.fromJSON(e.toJSON());for(var i=0;i<t.coordinates.length;i++)t.coordinates[i]=b._coordinateToOrigin(t.coordinates[i])}return t},b.isSimple=function(e){(0,s.isNull)(e)&&s.Log.error("geometry不能为空！"),e instanceof f.default||e instanceof S.default||e instanceof c.default||e instanceof h.default||s.Log.error("geometry为不支持的类型！");var t=!0;switch(e.type){case y.default.lineString:t=b._lineIsSimple(e);break;case y.default.multiLineString:t=b._multiLineIsSimple(e);break;case y.default.polygon:t=b._polygonIsSimple(e);break;case y.default.multiPolygon:t=b._multiPolygonIsSimple(e)}return t},b._lineIsSimple=function(e){var t=!0;if(e.coordinates.length>2){for(var r=[],n=0;n<e.coordinates.length-1;n++)r.push(new f.default({coordinates:[e.coordinates[n],e.coordinates[n+1]]}));for(var i=0;i<r.length-1;i++)for(var o=i+1;o<r.length;o++)if(b.contains(r[i],r[o])||b.contains(r[o],r[i])){t=!1;break}for(var s=0;s<r.length-2;s++)for(var l=s+2;l<r.length;l++)if(b.intersects(r[s],r[l])){var u=a.multiPoint([r[s].coordinates[0],r[s].coordinates[1],r[l].coordinates[0],r[l].coordinates[1]]);if(3!==(u=a.cleanCoords(u)).geometry.coordinates.length){t=!1;break}t=!0}for(var c=0;c<e.coordinates.length;c++){for(var h=!1,d=c+1;d<e.coordinates.length;d++)if(b._equalPoints(e.coordinates[c],e.coordinates[d])){h=!0;break}if(h){t=!1;break}}return t}return 2===e.coordinates.length?b._equalPoints(e.coordinates[0],e.coordinates[1]):t},b._equalPoints=function(e,t){return 2===e.length&&t.length>=2?e[0]===t[0]&&e[1]===t[1]:3===e.length&&t.length>=3&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},b._getLinesFromPolygon=function(e){for(var t=[],r=0;r<e.coordinates.length;r++)for(var n=0;n<e.coordinates[r].length-1;n++)t.push(new f.default({coordinates:[e.coordinates[r][n],e.coordinates[r][n+1]]}));return t},b._multiLineIsSimple=function(e){var t=!0;if(1===e.coordinates.length){var r=new f.default({coordinates:e.coordinates[0]});t=b._lineIsSimple(r)}else{for(var n=0;n<e.coordinates.length;n++){var i=new f.default({coordinates:e.coordinates[n]});if(b._lineIsSimple(i)){t=!1;break}}if(t)for(var o=0;o<e.coordinates.length-1;o++){var a=new f.default({coordinates:e.coordinates[o]}),s=new f.default({coordinates:e.coordinates[o+1]});if(b.intersects(a,s)){t=!1;break}}}return t},b._polygonIsSimple=function(e){var t=[],r=[];e.coordinates.forEach(function(e){t.push(e.slice(0,e.length-1));for(var n=[],i=1;i<e.length-3;i++)n.push([e[i],e[i+1]]);n.push([e[e.length-2],e[e.length-1]]),r.push(n)});for(var n=new S.default({coordinates:t}),i=b._multiLineIsSimple(n),o=!1,a=0;a<r.length;a++){for(var s=new f.default({coordinates:r[a][r[a].length-1]}),l=0;l<r[a].length-1;l++)if(o=b.intersects(new f.default({coordinates:r[a][l]}),s)){i=!1;break}if(o)break}return i},b._multiPolygonIsSimple=function(e){var t=[];e.coordinates.forEach(function(e){e.forEach(function(e){t.push(e.slice(0,e.length-1))})});var r=new S.default({coordinates:t});return b._multiLineIsSimple(r)},b.getPositionsFromArc=function(e){var t=[(e=(0,s.defaultValue)(e,{})).point1,e.point2,e.point3],r=b.getCenter(t[0],t[1],t[2]);return b._tranArcToPath({center:r,pointBegan:t[0],pointEnd:t[2],spatialReference:e.spatialReference,numberOfPoints:e.numberOfPoints})},b._tranArcToPath=function(e){var t=(0,s.defaultValue)(e.center,void 0);t=JSON.parse((0,n.default)(t));var r=(0,s.defaultValue)(e.pointBegan,void 0);r=JSON.parse((0,n.default)(r));var i=(0,s.defaultValue)(e.pointEnd,void 0);i=JSON.parse((0,n.default)(i));var o=(0,s.defaultValue)(e.numberOfPoints,360),a=(0,s.defaultValue)(e.spatialReference,new p.default({wkid:4326}));if(!(a=p.default.fromJSON(a)).isGeographic){var l=new p.default({wkid:4326});t=d.default.project(new v.default({coordinates:t,spatialReference:a}),l).coordinates,r=d.default.project(new v.default({coordinates:r,spatialReference:a}),l).coordinates,i=d.default.project(new v.default({coordinates:i,spatialReference:a}),l).coordinates}var u=new f.default({coordinates:[t,r]}),c=b.planarLength(u),h=b.getAngleFromPoints(r,t,[t[0]+10,t[1]]),y=b.getAngleFromPoints(i,t,[t[0]+10,t[1]])-h;o*=y/360,o=Math.abs(o);var g=Math.PI*(y/180)/o;h=Math.PI*(h/180);for(var m=[r],_=0;_<o-1;_++){h+=g;var S=[t[0]+c*Math.cos(h),t[1]+c*Math.sin(h)];m.push(S)}return m.push(i),this.hasZ&&m.map(function(e){return[e[0],e[1],t[2]]}),m},b.getCenter=function(e,t,r,n){var i=e[0],o=t[0],a=r[0],s=e[1],l=t[1],u=r[1],c=0*s-0*l-0*s+0*u+0*l-0*u,f=-(0*i-0*o-0*i+0*a+0*o-0*a),h=i*l-o*s-i*u+a*s+o*u-a*l,d=-(i*l*0-i*u*0-o*s*0+o*u*0+a*s*0-a*l*0),p=2*(o-i),y=2*(l-s),g=i*i+s*s+0-o*o-l*l-0,v=2*(a-i),m=2*(u-s),_=i*i+s*s+0-a*a-u*u-0,S=-(0*f*_-0*f*g-y*h*_+0*y*d+m*h*g-0*m*d)/(c*y*0-c*m*0-p*f*0+p*m*h+v*f*0-v*y*h),x=(0*c*_-0*c*g-p*h*_+0*p*d+v*h*g-0*v*d)/(c*y*0-c*m*0-p*f*0+p*m*h+v*f*0-v*y*h);return n?[S,x,e[2]]:[S,x]},b._getArcFromPath=function(e){e=(0,s.defaultValue)(e,{});var t=(0,s.defaultValue)(e.coordinates,[]),r=(0,s.defaultValue)(e.arcInfo,[]),n=(0,s.defaultValue)(e.spatialReference,new p.default({wkid:4326})),i=(0,s.defaultValue)(e.numberOfPoints,360),o=[],a=t.slice(0,r[0].centerPointIndex-1);o=o.concat(a);var l=Number(r[0].centerPointIndex),u=[t[l-1],t[l],t[l+1]],c=b.getPositionsFromArc({point1:u[0],point2:u[1],point3:u[2],spatialReference:n,numberOfPoints:i});o=o.concat(c);for(var f=1;f<r.length;f++)if(r[f].hasOwnProperty("centerPointIndex")){var h=t.slice(r[f-1].centerPointIndex+2,r[f].centerPointIndex+1);o=o.concat(h);var d=Number(r[f].centerPointIndex),y=[t[d-1],t[d],t[d+1]],g=b.getPositionsFromArc({point1:y[0],point2:y[1],point3:y[2],spatialReference:n,numberOfPoints:i});o=o.concat(g)}var v=t.slice(r[r.length-1].centerPointIndex+2,t.length);return o.concat(v)},b._getArcInfos=function(e,t,r){var n={};switch(r){case y.default.multiLineString:case y.default.polygon:for(var i=0;i<t.length;i++){n[i]=[];for(var o=0;o<e.length;o++)(r===y.default.multiLineString?e[o].lineIndex:e[o].ringIndex)===i&&n[i].push(e[o]);n[i].sort(function(e,t){return Number(e.centerPointIndex)-Number(t.centerPointIndex)})}return n;case y.default.multiPolygon:for(var a=0;a<t.length;a++){n[a]=[];for(var s=0;s<e.length;s++)e[s].polygonIndex===a&&n[a].push(e[s]);n[a]=b._getArcInfos(n[a],t[a],y.default.polygon)}return n;default:return n}},b.getAngleFromPoints=function(e,t,r){var n=e[0]-t[0],i=e[1]-t[1],o=r[0]-t[0],a=r[1]-t[1],s=(n*o+i*a)/(Math.sqrt(n*n+i*i)*Math.sqrt(o*o+a*a)),l=180*Math.acos(s)/Math.PI;return 0===Math.abs(l)||180===Math.abs(l)?Math.abs(l):e[1]<r[1]?-1*l:l},b.getArcFromGeometry=function(e){e=(0,s.defaultValue)(e,{});var t=(0,s.defaultValue)(e.geometry,void 0),r=(0,s.defaultValue)(e.numberOfPoints,360),n=(0,s.defaultValue)(e.arcInfo,[]);if(!t)return t;if(!(t instanceof u.default))return s.Log.error("geometry不是基础几何类型！"),t;if(!n)return t;if(!(n instanceof Array))return t;if(n.length<1)return t;var o=t.coordinates,a=t.spatialReference,l=void 0,d=void 0;switch(t.type){case y.default.lineString:return l=b._getArcFromPath({coordinates:o,arcInfo:n,spatialReference:a,numberOfPoints:r}),new f.default({coordinates:l,spatialReference:p.default.fromJSON(t.spatialReference)});case y.default.multiLineString:return d=b._getArcInfos(n,o,y.default.multiLineString),l=[],(0,i.default)(d).forEach(function(e){l.push(b._getArcFromPath({coordinates:o[e],arcInfo:d[e],spatialReference:a,numberOfPoints:r}))}),new S.default({coordinates:l,spatialReference:a});case y.default.polygon:return d=b._getArcInfos(n,o,y.default.polygon),l=[],(0,i.default)(d).forEach(function(e){var t=o[e].slice(0,o[e].length),n=b._getArcFromPath({coordinates:t,arcInfo:d[e],spatialReference:a,numberOfPoints:r});n.push(n[0]),l.push(n)}),new c.default({coordinates:l,spatialReference:a});case y.default.multiPolygon:d=b._getArcInfos(n,o,y.default.multiPolygon),l=[];for(var g=function(e){var t=[];(0,i.default)(d[e]).forEach(function(n){var i=o[e][n].slice(0,o[e][n].length),s=b._getArcFromPath({coordinates:i,arcInfo:d[e][n],spatialReference:a,numberOfPoints:r});s.push(s[0]),t.push(s)}),l.push(t)},v=0;v<o.length;v++)g(v);return new h.default({coordinates:l,spatialReference:a});default:return t}},b._getTurfMultiLineStringFromLines=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].coordinates);return a.multiLineString(t)},b._initIntersects=function(e){for(var t={},r=0;r<e.length;r++)e[r].id=r,t[r]={intersectPoints:[],intersectLines:[]};return t},b._pointOnLineEndPoint=function(e,t){return e.coordinates[0]===t.coordinates[0][0]&&e.coordinates[1]===t.coordinates[0][1]||e.coordinates[0]===t.coordinates[1][0]&&e.coordinates[1]===t.coordinates[1][1]},b._lineEqualLine=function(e,t){return e.coordinates[0][0]===t.coordinates[0][0]&&e.coordinates[0][1]===t.coordinates[0][1]&&e.coordinates[1][0]===t.coordinates[1][0]&&e.coordinates[1][1]===t.coordinates[1][1]||e.coordinates[0][0]===t.coordinates[1][0]&&e.coordinates[0][1]===t.coordinates[1][1]&&e.coordinates[1][0]===t.coordinates[0][0]&&e.coordinates[1][1]===t.coordinates[0][1]},b._lineEqualLineTurf=function(e,t){return e.geometry.coordinates[0][0]===t.geometry.coordinates[0][0]&&e.geometry.coordinates[0][1]===t.geometry.coordinates[0][1]&&e.geometry.coordinates[1][0]===t.geometry.coordinates[1][0]&&e.geometry.coordinates[1][1]===t.geometry.coordinates[1][1]},b._singRingSimplify=function(e){for(var t=b._getLinesFromPolygon(e),r=b._initIntersects(t),n=0;n<t.length-1;n++)for(var i=n+1;i<t.length;i++){var o=b.intersect(t[n],t[i]);o.point&&(b._pointOnLineEndPoint(o.point,t[n])||b._pointOnLineEndPoint(o.point,t[i])||(r[n].intersectPoints.push(o.point),r[i].intersectPoints.push(o.point))),o.lineString&&(r[n].intersectLines.push(o.lineString),r[i].intersectLines.push(o.lineString))}for(var s=[],l=0;l<t.length;l++){for(var u=!1,c=0;c<r[l].intersectLines.length;c++){if(b._lineEqualLine(t[l],r[l].intersectLines[c])){u=!0;break}t[l].coordinates[0][0]===r[l].intersectLines[c].coordinates[0][0]&&t[l].coordinates[0][1]===r[l].intersectLines[c].coordinates[0][1]||r[l].intersectPoints.push(new v.default({coordinates:r[l].intersectLines[c].coordinates[0]}),new v.default({coordinates:r[l].intersectLines[c].coordinates[0]})),t[l].coordinates[1][0]===r[l].intersectLines[c].coordinates[1][0]&&t[l].coordinates[1][1]===r[l].intersectLines[c].coordinates[1][1]||r[l].intersectPoints.push(new v.default({coordinates:r[l].intersectLines[c].coordinates[1]}),new v.default({coordinates:r[l].intersectLines[c].coordinates[1]}))}if(!u){r[l].intersectPoints.sort(function(e,t){return e.coordinates[0]-t.coordinates[0]}),r[l].intersectPoints.sort(function(e,t){return t.coordinates[1]-e.coordinates[1]}),r[l].intersectPoints.splice(0,0,new v.default({coordinates:t[l].coordinates[0]})),r[l].intersectPoints.push(new v.default({coordinates:t[l].coordinates[1]}));for(var f=b.union(r[l].intersectPoints),h=0;h<f.coordinates.length-1;h++)s.push(a.lineString([f.coordinates[h],f.coordinates[h+1]]))}}for(var d=0;d<s.length;d++)for(var p=d+1;p<s.length;p++)b._lineEqualLineTurf(s[d],s[p])&&(s.splice(p,1),p--);var y=a.featureCollection(s);return a.polygonize(y)},b._getPolygonsFromRings=function(e,t){for(var r=0;r<e.length;r++)e[r].isOuter=!0,e[r].innerPolygons=[];1===e.length&&t.push(e[0]);for(var n=0;n<e.length-1;n++)if(e[n].isOuter){t.push(e[n]);for(var i=n+1;i<e.length;i++)b.contains(e[n],e[i])&&(e[i].isOuter=!1,e[n].innerPolygons.push(e[i]))}e.length>1&&e[e.length-1].isOuter&&t.push(e[e.length-1]);for(var o=[],a=0;a<t.length;a++){for(var s=[],l=0;l<t[a].innerPolygons.length-1;l++)for(var u=l+1;u<t[a].innerPolygons.length;u++)b.contains(t[a].innerPolygons[l],t[a].innerPolygons[u])&&!t[a].innerPolygons[u].isOuter&&(t[a].innerPolygons[u].isOuter=!0,t[a].innerPolygons[u].innerPolygons=[],s.push(t[a].innerPolygons[u]));for(var c=0;c<t[a].innerPolygons.length;c++)t[a].innerPolygons[c].isOuter&&(t[a].innerPolygons.splice(c,1),c--);if(s.length>0){var f=b._getPolygonsFromRings(s,[]);o=o.concat(f)}}return t.concat(o)},b._singlePolygonSimplify=function(e){for(var t={largerInnerPolygon:[],intersectInnerPolygon:[],smallInnerPolygon:[]},r=new c.default({coordinates:[e.coordinates[0]],spatialReference:p.default.fromJSON(e.spatialReference)}),i=[],o=1;o<e.coordinates.length;o++){var a=new c.default({coordinates:[e.coordinates[o]],spatialReference:p.default.fromJSON(e.spatialReference)});i.push(a)}for(var s=0;s<i.length-1;s++)for(var l=s+1;l<i.length;l++){var f=b.intersect(i[s],i[l]);(f instanceof c.default||f instanceof h.default)&&(i[s]=b.difference(i[s],f),i[l]=b.difference(i[l],f))}for(var d=0;d<i.length;d++){var y=i[d];if(b.contains(r,y)){var g=b.difference(r,y),v=JSON.parse((0,n.default)(r.coordinates[0])),m=JSON.parse((0,n.default)(g.coordinates[0]));v.sort(function(e,t){return e[0]-t[0]}),v.sort(function(e,t){return e[1]-t[1]}),m.sort(function(e,t){return e[0]-t[0]}),m.sort(function(e,t){return e[1]-t[1]}),(0,n.default)(v)===(0,n.default)(m)?t.smallInnerPolygon.push(y):t.intersectInnerPolygon.push(y)}else if(b.contains(y,r)){var _=r.toJSON(),S=y.toJSON();r=u.default.fromJSON(S),y=u.default.fromJSON(_),t.smallInnerPolygon.push(y)}else b.intersects(r,y)?t.intersectInnerPolygon.push(y):b.disjoint(r,y)&&t.largerInnerPolygon.push(y)}for(var x=[],w=0;w<t.intersectInnerPolygon.length;w++){var k=b.intersect(r,t.intersectInnerPolygon[w]);if(k instanceof c.default||k instanceof h.default){r=b.difference(r,k);var M=b.difference(t.intersectInnerPolygon[w],k);x.push(M)}}for(var E=b._singRingSimplify(r),I=0;I<E.features.length;I++)x.push(new c.default({coordinates:E.features[I].geometry.coordinates}));if(t.largerInnerPolygon.length>0)for(var T=0;T<t.largerInnerPolygon.length;T++)x.push(t.largerInnerPolygon[T]);for(var L=[],P=0;P<t.smallInnerPolygon.length;P++)for(var C=b._singRingSimplify(t.smallInnerPolygon[P]),N=0;N<C.features.length;N++){var O=new c.default({coordinates:C.features[N].geometry.coordinates});O.isPicked=!1,L.push(O)}!(L=b.union(L))||L instanceof Array||(L=[L]);for(var R=0;R<x.length;R++)for(var V=0;V<L.length;V++)!L[V].isPicked&&x[R]&&L[V]&&b.contains(x[R],L[V])&&(x[R].coordinates.push(L[V].coordinates[0]),L[V].isPicked=!0);return x},b.simplify=function(e){if((0,s.isNull)(e)&&s.Log.error("geometry不能为空！"),e.type===y.default.point||e.type===y.default.multiPoint||e.type===y.default.extent||e.type===y.default.circle)return e;switch(e.type){case y.default.polygon:case y.default.multiPolygon:var t=[],r=void 0;if(e.type===y.default.polygon){r=JSON.parse((0,n.default)(e.coordinates));for(var i=0;i<r.length;i++)t.push(new c.default({coordinates:[r[i]],spatialReference:p.default.fromJSON(e.spatialReference)}))}else for(var o=JSON.parse((0,n.default)(e.coordinates)),a=0;a<o.length;a++)for(var l=0;l<o[a].length;l++)t.push(new c.default({coordinates:[o[a][l]],spatialReference:p.default.fromJSON(e.spatialReference)}));for(var u=0;u<t.length;u++)t[u].area=b.planarArea(t[u]);t.sort(function(e,t){return t.area-e.area});for(var f=b._getPolygonsFromRings(t,[]),d=0;d<f.length-1;d++)for(var g=d+1;g<f.length;g++)if(!b.contains(f[d],f[g])){var v=b.intersect(f[d],f[g]);v&&(f[d].coordinates=b.difference(f[d],v).coordinates,f[g].coordinates=b.difference(f[g],v).coordinates)}for(var m=[],_=0;_<f.length;_++){for(var S=0;S<f[_].innerPolygons.length;S++)f[_].coordinates.push(f[_].innerPolygons[S].coordinates[0]);var x=b._singlePolygonSimplify(f[_]);m=m.concat(x)}if(1===m.length)return m[0];if(m.length>1){for(var w=[],k=0;k<m.length;k++)m[k]&&w.push(m[k].coordinates);return new h.default({coordinates:w,spatialReference:p.default.fromJSON(e.spatialReference)})}break;case y.default.lineString:}},b.getEllipseCoordinates=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;if(!e||!e.coordinates||void 0===t||void 0===r)return[];for(var i=[],o=e.coordinates,a=0;a<=n;a++){var s=a/n*2*Math.PI,l=o[0]+t*Math.cos(s),u=o[1]+r*Math.sin(s);i.push([l,u])}return i.push(i[0]),i},b.getCenterOID=function(e){var t=e.type;if(t===y.default.circle)return new v.default({coordinates:[e.center[0],e.center[1],0]});if(t===y.default.extent)return new v.default({coordinates:[(e.xmin+e.xmax)/2,(e.ymin+e.ymax)/2,0]});var r=[],n=void 0;switch(t){case y.default.point:return v.default.fromJSON(e.toJSON());case y.default.multiPoint:case y.default.lineString:n=e.coordinates;break;case y.default.polygon:n=e.coordinates[0];break;default:return}for(var i=0;i<n.length;i++)r.push(a.point(n[i]));var o=a.featureCollection(r),s=a.center(o);return new v.default({coordinates:[s.geometry.coordinates[0],s.geometry.coordinates[1],0]})},t.default=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(10)),i=u(r(23)),o=u(r(410)),a=u(r(120)),s=u(r(0)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function e(){(0,s.default)(this,e)};c.getBaseUrlAndParams=function(e){var t=void 0,r={},n=e.split("?");if(0===n.length)throw new Error("url传入不合法");return 1===n.length?t=n[0]:(t=n[0],n[1].split("&").map(function(e){var t=[],n=/(\w+)=(\w+='[^']+')/;e.match(n)?(t[0]=e.match(n)[1],t[1]=e.match(n)[2]):t=e.split("="),r[t[0]]=t[1]}),n.length>=3&&l.Log.error("url有多个'?'连接符，不合法")),{baseUrl:t,params:r=(0,l.deleteNullValue)(r)}},c.completeUrlEndMark=function(e){return e.indexOf("?")>-1?"?"===e.slice(-1)||"&"===e.slice(-1)?e+="":e+="&":e+="?",e},c.getObjectFromExtensions=function(e){var t={},r=(0,l.defaultValue)(e,[]);return r instanceof Array&&(r=(0,a.default)(new o.default(r))).forEach(function(e){t[e.key]=e.value}),t},c.getStringFromObject=function(e){var t="";return(e=(0,l.defaultValue)(e,{}))instanceof Object&&(e=(0,l.deleteNullValue)(e),(0,i.default)(e).forEach(function(r){t+=r+"=",e[r]instanceof Function?t+=e[r]():e[r]instanceof Object?t+=(0,n.default)(e[r]):t+=e[r],t+="&"}),t.length>0&&(t=t.substring(0,t.length-1))),t},c.deleteNullValue=l.deleteNullValue,t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubLayer=t.VoxelFilter=t.FeatureFilter=t.S3MTilesCacheLayer=t.OverlayLayer=t.UnknownLayer=t.TileLayer=t.VectorTileLayer=t.LOD=t.getFullBaseUrl=t.appendUrlParams=t.TileInfo=t.FeatureCollection=t.getZoomOffset=t.WebTileLayer=t.ArcGISVectorTileLayer=t.VisualVariable=t.OpacityVariable=t.ColorVariable=t.SizeVariable=t.HeatmapColorStop=t.setElevationInfo=t.Layer=t.TileInfoUtil=t.getIGSDynamicLayer=t.showLayerByScale=t.isCustomSP=t.is4326=t.getUrlType=t.ArcGISTileLayer=t.ArcGISMapImageSubLayer=t.ArcGISMapImageLayer=t.LabelClass=t.Projection=t.Basemap=t.Map=t.M3DModelCacheLayer=t.BaseRenderer=t.HeatmapRenderer=t.RankRenderer=t.RandomRenderer=t.ClusterRenderer=t.SimpleRenderer=t.ClassBreakRenderer=t.UniqueValueRenderer=t.VideoLayer=t.TerrainCacheLayer=t.Cesium3DTilesCacheLayer=t.GeoJSONLayer=t.GraphicsLayer=t.GroupLayer=t.MapVLayer=t.EchartsLayer=t.ISSceneSubLayer=t.ISSceneLayer=t.IGSFeatureLayer=t.BaseScene=t.ISScene=t.Scene=t.IGSTileLayer=t.IGSSceneSubLayer=t.IGSSceneLayer=t.IGSMapImageSubLayer=t.IGSMapImageLayer=t.IGSVectorTileSubLayer=t.IGSVectorTileLayer=t.WMTSSubLayer=t.WFSLayer=t.WMSSubLayer=t.WMSLayer=t.WMTSLayer=t.OGCLayer=void 0;var n=r(39),i=r(70),o=r(550),a=function(e){return e&&e.__esModule?e:{default:e}}(r(101));t.OGCLayer=n.OGCLayer,t.WMTSLayer=n.WMTSLayer,t.WMSLayer=n.WMSLayer,t.WMSSubLayer=n.WMSSubLayer,t.WFSLayer=n.WFSLayer,t.WMTSSubLayer=n.WMTSSubLayer,t.IGSVectorTileLayer=n.IGSVectorTileLayer,t.IGSVectorTileSubLayer=n.IGSVectorTileSubLayer,t.IGSMapImageLayer=n.IGSMapImageLayer,t.IGSMapImageSubLayer=n.IGSMapImageSubLayer,t.IGSSceneLayer=n.IGSSceneLayer,t.IGSSceneSubLayer=n.IGSSceneSubLayer,t.IGSTileLayer=n.IGSTileLayer,t.Scene=n.Scene,t.ISScene=n.ISScene,t.BaseScene=n.BaseScene,t.IGSFeatureLayer=n.IGSFeatureLayer,t.ISSceneLayer=n.ISSceneLayer,t.ISSceneSubLayer=n.ISSceneSubLayer,t.EchartsLayer=n.EchartsLayer,t.MapVLayer=n.MapVLayer,t.GroupLayer=n.GroupLayer,t.GraphicsLayer=n.GraphicsLayer,t.GeoJSONLayer=n.GeoJSONLayer,t.Cesium3DTilesCacheLayer=n.Cesium3DTilesCacheLayer,t.TerrainCacheLayer=n.TerrainCacheLayer,t.VideoLayer=n.VideoLayer,t.UniqueValueRenderer=i.UniqueValueRenderer,t.ClassBreakRenderer=i.ClassBreakRenderer,t.SimpleRenderer=i.SimpleRenderer,t.ClusterRenderer=i.ClusterRenderer,t.RandomRenderer=i.RandomRenderer,t.RankRenderer=i.RankRenderer,t.HeatmapRenderer=i.HeatmapRenderer,t.BaseRenderer=i.BaseRenderer,t.M3DModelCacheLayer=n.M3DModelCacheLayer,t.Map=o.Map,t.Basemap=o.Basemap,t.Projection=n.Projection,t.LabelClass=a.default,t.ArcGISMapImageLayer=n.ArcGISMapImageLayer,t.ArcGISMapImageSubLayer=n.ArcGISMapImageSubLayer,t.ArcGISTileLayer=n.ArcGISTileLayer,t.getUrlType=n.getUrlType,t.is4326=n.is4326,t.isCustomSP=n.isCustomSP,t.showLayerByScale=n.showLayerByScale,t.getIGSDynamicLayer=i.getIGSDynamicLayer,t.TileInfoUtil=n.TileInfoUtil,t.Layer=n.Layer,t.setElevationInfo=n.setElevationInfo,t.HeatmapColorStop=i.HeatmapColorStop,t.SizeVariable=i.SizeVariable,t.ColorVariable=i.ColorVariable,t.OpacityVariable=i.OpacityVariable,t.VisualVariable=i.VisualVariable,t.ArcGISVectorTileLayer=n.ArcGISVectorTileLayer,t.WebTileLayer=n.WebTileLayer,t.getZoomOffset=n.getZoomOffset,t.FeatureCollection=n.FeatureCollection,t.TileInfo=n.TileInfo,t.appendUrlParams=n.appendUrlParams,t.getFullBaseUrl=n.getFullBaseUrl,t.LOD=n.LOD,t.VectorTileLayer=n.VectorTileLayer,t.TileLayer=n.TileLayer,t.UnknownLayer=n.UnknownLayer,t.OverlayLayer=n.OverlayLayer,t.S3MTilesCacheLayer=n.S3MTilesCacheLayer,t.FeatureFilter=n.FeatureFilter,t.VoxelFilter=n.VoxelFilter,t.SubLayer=n.SubLayer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(11)),i=h(r(3)),o=h(r(0)),a=h(r(2)),s=h(r(4)),l=h(r(5)),u=r(8),c=r(1),f=r(6);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.id=(0,c.defaultValue)(e.id,(0,c.getGUID)()),r.layer=(0,c.defaultValue)(e.layer,void 0),r.sublayers=(0,c.defaultValue)(e.sublayers,new u.Collection),r.title=(0,c.defaultValue)(e.title||e.layerName,void 0),r.extensionOptions=(0,c.defaultValue)(e.extensionOptions,{}),r.extendProps=(0,c.defaultValue)(e.extendProps,{}),r._visible=(0,c.defaultValue)(e.visible,!0),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=[];return this.sublayers.forEach(function(r){e.push((0,c.toJSON)(r,t))}),{id:this.id,sublayers:e,title:this.title,visible:this.visible,extensionOptions:this.extensionOptions,extendProps:this.extendProps}}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.Evented);(0,n.default)(d.prototype,{visible:{get:function(){return this._visible},set:function(e){if(this._visible=e,this.layer&&this.layer.refresh)switch(this.layer.type){case f.LayerType.wms:this.layer.setSubLayer(this)}}}}),t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VisualVariable=t.OpacityVariable=t.ColorVariable=t.SizeVariable=t.HeatmapColorStop=t.getIGSDynamicLayer=t.createRender=t.HeatmapRenderer=t.RankRenderer=t.RandomRenderer=t.ClusterRenderer=t.SimpleRenderer=t.ClassBreakRenderer=t.UniqueValueRenderer=t.BaseRenderer=void 0;var n=g(r(50)),i=g(r(497)),o=g(r(504)),a=g(r(505)),s=g(r(506)),l=g(r(509)),u=g(r(510)),c=g(r(511)),f=r(6),h=r(1),d=r(512),p=g(r(225)),y=r(85);function g(e){return e&&e.__esModule?e:{default:e}}t.BaseRenderer=n.default,t.UniqueValueRenderer=i.default,t.ClassBreakRenderer=o.default,t.SimpleRenderer=a.default,t.ClusterRenderer=s.default,t.RandomRenderer=l.default,t.RankRenderer=u.default,t.HeatmapRenderer=c.default,t.createRender=function(e){switch((e=(0,h.defaultValue)(e,{})).type){case f.RendererType.simple:return new a.default(e);case f.RendererType.uniqueValue:return new i.default(e);case f.RendererType.classBreak:return new o.default(e);case f.RendererType.cluster:return new s.default(e);case f.RendererType.random:return new l.default(e);case f.RendererType.rank:return new u.default(e);case f.RendererType.heatmap:return new c.default(e);default:return new a.default(e)}},t.getIGSDynamicLayer=d.getIGSDynamicLayer,t.HeatmapColorStop=p.default,t.SizeVariable=y.SizeVariable,t.ColorVariable=y.ColorVariable,t.OpacityVariable=y.OpacityVariable,t.VisualVariable=y.VisualVariable},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(0)),i=l(r(2)),o=r(1),a=l(r(103)),s=r(9);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),t=t||{},this.dpi=(0,o.defaultValue)(t.dpi,-1),this.format=(0,o.defaultValue)(t.format,"png"),this.origin=t.origin?s.Point.fromJSON(t.origin):void 0;for(var r=[],i=(0,o.defaultValue)(t.lods,[]),l=0;l<i.length;l++)r.push(a.default.fromJSON(i[l]));this.lods=r,this.size=t.size,this.spatialReference=t.spatialReference}return(0,i.default)(e,[{key:"toJSON",value:function(){return{dpi:this.dpi,format:this.format,origin:this.origin?this.origin.toJSON():void 0,lods:this.lods.map(function(e){return e.toJSON()}),size:this.size?[this.size[0],this.size[1]]:void 0,spatialReference:this.spatialReference&&this.spatialReference.toJSON()}}},{key:"scaleToZoom",value:function(e){return 0}},{key:"zoomToScale",value:function(e){return 0}},{key:"getTileSize",value:function(){return Array.isArray(this.size)&&this.size.length>=2?Math.max(this.size[0],this.size[1]):256}},{key:"clone",value:function(){return e.fromJSON(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=u},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t){e.exports=!0},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){var n=r(27).f,i=r(33),o=r(21)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){r(256);for(var n=r(20),i=r(45),o=r(64),a=r(21)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<s.length;l++){var u=s[l],c=n[u],f=c&&c.prototype;f&&!f[a]&&i(f,a,u),o[u]=o.Array}},function(e,t,r){var n=r(34),i=r(155),o=r(156),a=r(28),s=r(88),l=r(117),u={},c={};(t=e.exports=function(e,t,r,f,h){var d,p,y,g,v=h?function(){return e}:l(e),m=n(r,f,t?2:1),_=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(d=s(e.length);d>_;_++)if((g=t?m(a(p=e[_])[0],p[1]):m(e[_]))===u||g===c)return g}else for(y=v.call(e);!(p=y.next()).done;)if((g=i(y,m,p.value,t))===u||g===c)return g}).BREAK=u,t.RETURN=c},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){var n=r(78),i=r(62),o=r(44),a=r(113),s=r(33),l=r(150),u=Object.getOwnPropertyDescriptor;t.f=r(26)?u:function(e,t){if(e=o(e),t=a(t,!0),l)try{return u(e,t)}catch(e){}if(s(e,t))return i(!n.f.call(e,t),e[t])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=f(r(53)),i=f(r(297)),o=f(r(300)),a=f(r(0)),s=f(r(2)),l=r(1),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(303)),c=r(46);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(){return(0,a.default)(this,e),this._createEventedProxy()}return(0,s.default)(e,[{key:"_createEventedProxy",value:function(){this._decorateParents=[],this._decorateProperties={};var e=this;return new Proxy(this,{set:function(t,r,n,a){if(e._decorateProperties[r]){var s=e._decorateProperties[r],l=s.type,u=s.createInstance;l&&n instanceof l||(n=u(n)),Array.isArray(n._decorateParents)&&-1===n._decorateParents.findIndex(function(t){return t.instance===e})&&n._decorateParents.push({instance:e,key:r})}if(t[r]===n)return!0;var c={target:t,key:r,value:n,oldValue:(0,o.default)(t,r),receiver:a},f=(0,i.default)(t,r,n,a);return/^_[^_].*/.test(r)?f:(e._decorateEventFire(e,e,[],"set",c,c),f)},get:function(e,t,r){return(0,o.default)(e,t,r)}})}},{key:"_decorateEventFire",value:function(e,t,r,n,i,o){for(var a=i.key,s=i.value,l=i.oldValue,u=[a],f=0;f<r.length;f++)u.push(r[f]);var h={key:a,value:s,oldValue:l},d=new c.ProxyEvent({eventName:n,target:e,eventData:h,eventPath:u,sourceTarget:t,sourceEventData:o});e.fire(n,d,!1);var p=e._decorateParents||[];if(0!==p.length)for(var y=0;y<p.length;y++){var g=p[y],v=g.instance,m={key:g.key,value:e,oldValue:e};this._decorateEventFire(v,t,u,n,m,o)}}},{key:"_decorate",value:function(e,t,r,n){n=(0,l.defaultValue)(n,function(e){return e});var i=t;return r&&t instanceof r||(i=n((0,l.defaultValue)(t,{}))),this._decorateProperties[e]={type:r,createInstance:n},i}},{key:"on",value:function(e,t,r){if("object"===(void 0===e?"undefined":(0,n.default)(e)))for(var i in e)this._on(i,e[i],t);else for(var o=0,a=(e=u.splitWords(e)).length;o<a;o++)this._on(e[o],t,r);return this}},{key:"off",value:function(e,t,r){if(e)if("object"===(void 0===e?"undefined":(0,n.default)(e)))for(var i in e)this._off(i,e[i],t);else for(var o=0,a=(e=u.splitWords(e)).length;o<a;o++)this._off(e[o],t,r);else delete this._Evented;return this}},{key:"_on",value:function(e,t,r){this._Evented=this._Evented||{};var n=this._Evented[e];n||(n=[],this._Evented[e]=n),r===this&&(r=void 0);for(var i={fn:t,ctx:r},o=n,a=0,s=o.length;a<s;a++)if(o[a].fn===t&&o[a].ctx===r)return;o.push(i)}},{key:"_off",value:function(e,t,r){var n=void 0,i=void 0,o=void 0;if(this._Evented&&(n=this._Evented[e]))if(t){if(r===this&&(r=void 0),n)for(i=0,o=n.length;i<o;i++){var a=n[i];if(a.ctx===r&&a.fn===t)return a.fn=u.falseFn,this._firingCount&&(this._Evented[e]=n=n.slice()),void n.splice(i,1)}}else{for(i=0,o=n.length;i<o;i++)n[i].fn=u.falseFn;delete this._Evented[e]}}},{key:"fire",value:function(e,t,r){if(!this.listens(e,r))return this;var n=t;if(n&&(n.type=e,n.target=this,n.sourceTarget=t&&t.sourceTarget||this),this._Evented){var i=this._Evented[e];if(i){this._firingCount=this._firingCount+1||1;for(var o=0,a=i.length;o<a;o++){var s=i[o];s.fn.call(s.ctx||this,n)}this._firingCount--}}return r&&this._propagateEvent(n),this}},{key:"listens",value:function(e,t){var r=this._Evented&&this._Evented[e];if(r&&r.length)return!0;if(t)for(var n in this._eventParents)if(this._eventParents[n].listens(e,t))return!0;return!1}},{key:"once",value:function(e,t,r){var i=this;if("object"===(void 0===e?"undefined":(0,n.default)(e))){for(var o in e)this.once(o,e[o],t);return this}var a=u.bind(function(){i.off(e,t,r).off(e,a,r)},this);return this.on(e,t,r).on(e,a,r)}},{key:"addEventParent",value:function(e){return this._eventParents=this._eventParents||{},this._eventParents[u.stamp(e)]=e,this}},{key:"removeEventParent",value:function(e){return this._eventParents&&delete this._eventParents[u.stamp(e)],this}},{key:"_propagateEvent",value:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,u.extend({layer:e.target,propagatedFrom:e.target},e),!0)}}]),e}();t.default=h,h.addEventListener=h.on,h.removeEventListener=h.clearAllEventListeners=h.off,h.addOneTimeEventListener=h.once,h.fireEvent=h.fire,h.hasEventListeners=h.listens},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(0)),i=h(r(245)),o=h(r(126)),a=r(1),s=r(9),l=h(r(95)),u=h(r(192)),c=h(r(193)),f=h(r(132));function h(e){return e&&e.__esModule?e:{default:e}}var d=function e(){(0,n.default)(this,e)};d.projectMercatorToLonLat=function(e){var t={longitude:0,latitude:0},r=e.x/20037508.34*180,n=e.y/20037508.34*180;return n=180/Math.PI*(2*Math.atan(Math.exp(n*Math.PI/180))-Math.PI/2),t.longitude=r,t.latitude=n,t},d.projectToGeographyPoints=function(e){e=(0,a.defaultValue)(e,{});var t=(0,a.defaultValue)(e.points,[]),r=(0,a.defaultValue)(e.wkid,-1),n=(0,a.defaultValue)(e.proj4Defs,void 0),o=[],s=void 0;if(n)s=n;else{var l=d.getEPSGByWKID(r);l&&(s=l.strProject)}if(s)for(var u=0;u<t.length;u++)o.push((0,i.default)(s,"+proj=longlat +datum=WGS84 +no_defs +type=crs",t[u]));return o},d.projectPoints=function(e){e=(0,a.defaultValue)(e,{});var t=(0,a.defaultValue)(e.points,[]),r=(0,a.defaultValue)(e.originWKID,-1),n=(0,a.defaultValue)(e.originDefs,void 0),o=(0,a.defaultValue)(e.targetWKID,-1),s=(0,a.defaultValue)(e.targetDefs,void 0),l=void 0,u=void 0,c=[];try{if(n)l=n;else{var f=d.getEPSGByWKID(r);f&&(l=f.strProject)}if(s)u=s;else{var h=d.getEPSGByWKID(o);h&&(u=h.strProject)}for(var p=[],y=[],g=0;g<t.length;g++)p=t[g],y=l&&u?(0,i.default)(l,u,p):l&&!u?d._toCustomWkidPoint(l,o,p):!l&&u?d._fromCustomWkidPoint(r,u,p):d._CustomWkidToCustomWkidPoint(r,o,p),c.push(y);return c}catch(e){a.Log.error("proj4投影报错",e)}return c},d.getEPSGByWKID=function(e){for(var t=void 0,r=0;r<o.default.length;r++)if(String(o.default[r].id)===String(e)){t=o.default[r];break}return t||a.Log.info("epsg未定义wkid为"+e+"的坐标系信息"),t},d.projectGeometry=function(e,t){var r=[],n={originWKID:e.spatialReference.wkid,originDefs:e.spatialReference.wkt,targetWKID:t.wkid,targetDefs:t.wkt};switch(e.type){case l.default.point:return r=[e.coordinates],n.points=r,r=d.projectPoints(n),new s.Point({coordinates:r[0],spatialReference:new s.SpatialReference(t)});case l.default.multiPoint:return r=e.coordinates,n.points=r,r=d.projectPoints(n),new s.MultiPoint({coordinates:r,spatialReference:new s.SpatialReference(t)});case l.default.lineString:return r=e.coordinates,n.points=r,r=d.projectPoints(n),new s.LineString({coordinates:r,spatialReference:new s.SpatialReference(t)});case l.default.multiLineString:r=e.coordinates;for(var i=[],o=0;o<r.length;o++)n.points=r[o],i.push(d.projectPoints(n));return new s.MultiLineString({coordinates:i,spatialReference:new s.SpatialReference(t)});case l.default.polygon:r=e.coordinates;for(var a=[],u=0;u<r.length;u++)n.points=r[u],a.push(d.projectPoints(n));return new s.Polygon({coordinates:a,spatialReference:new s.SpatialReference(t)});case l.default.multiPolygon:r=e.coordinates;for(var c=[],f=0;f<r.length;f++){for(var h=[],p=0;p<r[f].length;p++)n.points=r[f][p],h.push(d.projectPoints(n));c.push(h)}return new s.MultiPolygon({coordinates:c,spatialReference:new s.SpatialReference(t)});case l.default.circle:return r=[e.clone().center],n.points=r,r=d.projectPoints(n),new s.Circle({center:r[0],radius:e.radius,radiusUnit:e.radiusUnit,spatialReference:new s.SpatialReference(t)});case l.default.extent:return r=[[e.xmin,e.ymin,e.zmin],[e.xmax,e.ymax,e.zmax]],n.points=r,r=d.projectPoints(n),new s.Extent({xmin:r[0][0],ymin:r[0][1],zmin:r[0][2],xmax:r[1][0],ymax:r[1][1],zmax:r[1][2],spatialReference:new s.SpatialReference(t)});default:return e}},d.project=function(e,t){if(e instanceof Array){for(var r=[],n=0;n<e.length;n++)r.push(d.projectGeometry(e[n],t));return r}if(e.spatialReference.isGeographic){var i=function(e){return e>89.99999999?e=89.99999999:e<-89.99999999&&(e=-89.99999999),e};e.coordinates&&e.coordinates.length>1&&(e.coordinates[1]=i(e.coordinates[1])),e.ymax=i(e.ymax),e.ymin=i(e.ymin)}return d.projectGeometry(e,t)},d.isCustomWKID=function(e){return e===f.default.gcj02ll||e===f.default.gcj02mc||e===f.default.bd09ll||e===f.default.bd09mc},d._toCustomWkidPoint=function(e,t,r){var n=void 0,o=d.getEPSGByWKID(4326).strProject,s=(0,i.default)(e,o,r);if(t===f.default.bd09ll)n=u.default.wgs84tobd09(s[0],s[1]);else if(t===f.default.bd09mc){var l=u.default.wgs84tobd09(s[0],s[1]);l[0]=Math.min(l[0],180),l[0]=Math.max(l[0],-180),l[1]=Math.min(l[1],74.000022),l[1]=Math.max(l[1],-71.988531);var h=(new c.default).convertLL2MC({lng:l[0],lat:l[1]});n=[h.lng,h.lat]}else if(t===f.default.gcj02ll)n=u.default.wgs84togcj02(s[0],s[1]);else if(t===f.default.gcj02mc){var p=u.default.wgs84togcj02(s[0],s[1]);n=(0,i.default)(o,d.getEPSGByWKID(3857).strProject,p)}else a.Log.error("wkid为"+t+"的投影方式未定义！");return n},d._fromCustomWkidPoint=function(e,t,r){var n=void 0,o=d.getEPSGByWKID(4326).strProject;if(e===f.default.bd09ll){var s=u.default.bd09towgs84(r[0],r[1]);n=(0,i.default)(o,t,s)}else if(e===f.default.bd09mc){var l=(new c.default).convertMC2LL({lng:r[0],lat:r[1]});n=u.default.bd09towgs84(l.lng,l.lat)}else if(e===f.default.gcj02ll){var h=u.default.gcj02towgs84(r[0],r[1]);n=(0,i.default)(o,t,h)}else if(e===f.default.gcj02mc){var p=(0,i.default)(d.getEPSGByWKID(3857).strProject,o,r),y=u.default.gcj02towgs84(p[0],p[1]);n=(0,i.default)(d.getEPSGByWKID(4326).strProject,t,y)}else a.Log.error("wkid为"+e+"的投影方式未定义！");return n},d._CustomWkidToCustomWkidPoint=function(e,t,r){var n=void 0,i=d.getEPSGByWKID(4326).strProject;if(e===f.default.bd09ll){var o=d._fromCustomWkidPoint(e,i,r);n=d._toCustomWkidPoint(i,t,o)}else a.Log.error("wkid为"+e+"的投影方式未定义！");return n},d.getProj=function(e,t){return i.default.defs(e,t),(0,i.default)(e)},t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(5)),l=r(1),u=h(r(124)),c=h(r(56)),f=r(176);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,l.defaultValue)(e,{}),r.styleOrigin=void 0,r.symbolLayers=new u.default,(0,l.defaultValue)(e.symbolLayers,[]).forEach(function(e){r.symbolLayers.add((0,f.createSymbol3DLayer)(e))}),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=[];return this.symbolLayers.forEach(function(t){e.push(t.toJSON())}),{type:this.type,styleOrigin:this.styleOrigin,symbolLayers:e}}}]),t}(c.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(r(11)),i=m(r(10)),o=m(r(3)),a=m(r(0)),s=m(r(2)),l=m(r(4)),u=m(r(7)),c=m(r(5)),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(35)),h=m(r(29)),d=r(1),p=r(6),y=m(r(37)),g=m(r(58)),v=r(36);function m(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));if(e=(0,d.defaultValue)(e,{}),r.coordinates=(0,d.defaultValue)(e.coordinates,[]),r.type=p.GeometryType.polygon,!Array.isArray(r.coordinates))throw new Error("坐标必须为数组");for(var n=0;n<r.coordinates.length;n++){var i=r.coordinates[n];if(i.length<4)throw new Error("每个环至少有四个点");if(i[i.length-1].length!==i[0].length)throw new Error("首尾点维度不相等");for(var s=0;s<i[i.length-1].length;s++)if(i[i.length-1][s]!==i[0][s])throw new Error("第一个位置和最后一个位置不相等")}return 3===r.coordinates[0][0].length&&(r.hasZ=!0),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"addRing",value:function(e){if(!Array.isArray(e))throw new Error("传入参数错误");var t=[];return e.forEach(function(e){t.push(y.default.toCoordinates(e))}),this.coordinates.push(t),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"removeRing",value:function(e){if(e=Number(e),!this._isValidate(e,0))return null;var t=JSON.parse((0,i.default)(this._cloneCoordinates()[e]));this.coordinates.splice(e,1),this.coordinates=JSON.parse((0,i.default)(this.coordinates));for(var r=[],n=0;n<t.length;n++){var o=new y.default({coordinates:t[n]});r.push(o)}return r}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.coordinates=JSON.parse((0,i.default)(this.coordinates)),e.extent=this.extent.toJSON(),e.centroid=this.centroid.toJSON(),e}},{key:"contains",value:function(e){if(!e)throw new Error("传入参数错误");var t=f.polygon(this._cloneCoordinates()),r=f.point(y.default.toCoordinates(e));return f.booleanPointInPolygon(r,t)}},{key:"getPoint",value:function(e,t){if(!this._isValidate(e,t))return null;var r=this._cloneCoordinates()[e];return new y.default({coordinates:r[t]})}},{key:"insertPoint",value:function(e,t,r){if(!this._isValidate(e,t))return null;var n=this.coordinates[e];return Array.isArray(n)&&n.splice(t,0,r._cloneCoordinates()),this.coordinates[e]=n,this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"removePoint",value:function(e,t){if(!this._isValidate(e,t))return null;var r=this.clone(),n=r.coordinates[e],o=new y.default({coordinates:n[t]});return Array.isArray(n)&&n.splice(t,1),this.coordinates=r.coordinates,this.coordinates=JSON.parse((0,i.default)(this.coordinates)),o}},{key:"setPoint",value:function(e,t,r){if(!this._isValidate(e,t))return this;r instanceof y.default&&(r=r._cloneCoordinates());var n=this.coordinates[e];return Array.isArray(n)&&n.splice(t,1,r),this.coordinates[e]=n,this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"toXMl",value:function(){return""}},{key:"toString",value:function(){for(var e="",t=0;t<this.coordinates.length;t++){for(var r=this.coordinates[t],n=0;n<r.length;n++)for(var i=r[n],o=0;o<i.length;o++)e+=i[o]+",";e=e.substring(0,e.length-1),e+="|"}return e.substring(0,e.length-1)}},{key:"toOldIGSGeometry",value:function(){for(var e=[],t={Rings:[],GID:0},r={},n=this.coordinates,i=0;i<n.length;i++){r={Arcs:[]};for(var o=[],a=0;a<n[i].length;a++){var s=n[i][a];o.push({x:s[0],y:s[1]})}r.Arcs.push({Dots:o,ArcID:i}),t.Rings.push(r)}return e.push(t),{RegGeom:e}}},{key:"getIGSType",value:function(){return p.IGSGeometryType.polygon}},{key:"toDots",value:function(){for(var e=[],t=this.coordinates[0],r=0;r<t.length;r++)e.push({x:t[r][0],y:t[r][1]});return e}},{key:"isClockwise",value:function(e){var t=[];if(!(e instanceof Array))throw new Error("ring不是数组类型！");for(var r=0;r<e.length;r++)if(e[r]instanceof y.default)t.push(e[r].coordinates);else{if(!(e[r]instanceof Array&&e[r].length>=2))throw new Error("ring中的点不是数组或Point类型！");t.push(e[r])}var n=f.lineString(t);return f.booleanClockwise(n)}},{key:"_isValidate",value:function(e,t){var r=this.coordinates.length;if(!(0,d.isNumber)(e)||e<0||e>=r)return!1;var n=this.coordinates[e].length;return!(!(0,d.isNumber)(t)||t<0||t>=n)}},{key:"_cloneCoordinates",value:function(){return JSON.parse((0,i.default)(this.coordinates))}},{key:"_calcExtent",value:function(e,t){return(0,v.calcExtent)(e,t,p.GeometryType.polygon,this.spatialReference)}},{key:"_isSelfIntersecting",value:function(){var e=f.polygon(this.coordinates);return f.kinks(e).features.length>0}},{key:"_setCentroid",value:function(){var e=f.polygon(this.coordinates),t=f.centroid(e);if(this.hasZ){for(var r=0,n=0,i=0;i<this.coordinates.length;i++){r+=this.coordinates[i].length;for(var o=0;o<this.coordinates[i].length;o++)n+=this.coordinates[i][o][2]}return n/=r,new y.default({coordinates:[t.geometry.coordinates[0],t.geometry.coordinates[1],n],spatialReference:this.spatialReference})}return new y.default({coordinates:[t.geometry.coordinates[0],t.geometry.coordinates[1]],spatialReference:this.spatialReference})}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromExtent",value:function(e){var r=[];if(e instanceof g.default){var n=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];if(e&&e.hasZ){var i=e.zmin+.5*(e.zmax-e.zmin);n.forEach(function(e){i.push(e)})}r.push(n)}return new t({coordinates:r,spatialReference:e.spatialReference.clone()})}},{key:"fromJSON",value:function(e){return new t(e=(0,d.defaultValue)(e,{}))}}]),t}(h.default);(0,n.default)(_.prototype,{extent:{configurable:!1,get:function(){return this._calcExtent(this.coordinates,this.hasZ)}},isSelfIntersecting:{configurable:!1,get:function(){return this._isSelfIntersecting()}},centroid:{configurable:!1,get:function(){return this._setCentroid()}}}),t.default=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),t=(0,i.defaultValue)(t,{}),(0,i.extend)(this,t),this.Caption=void 0!==t.Caption?t.Caption:null,this.IsVisible=void 0===t.IsVisible||t.IsVisible,this.MaxScale=void 0!==t.MaxScale?parseFloat(t.MaxScale):0,this.MinScale=void 0!==t.MinScale?parseFloat(t.MinScale):0,this.RegInfo=void 0!==t.RegInfo?t.RegInfo:null,this.LinInfo=void 0!==t.LinInfo?t.LinInfo:null,this.PntInfo=void 0!==t.PntInfo?t.PntInfo:null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createVisualVariable=t.OpacityVariable=t.SizeVariable=t.ColorVariable=t.VisualVariable=void 0;var n=r(1),i=u(r(55)),o=u(r(102)),a=u(r(498)),s=u(r(500)),l=u(r(502));function u(e){return e&&e.__esModule?e:{default:e}}t.VisualVariable=o.default,t.ColorVariable=a.default,t.SizeVariable=s.default,t.OpacityVariable=l.default,t.createVisualVariable=function(e){switch((e=(0,n.defaultValue)(e,{})).type){case i.default.color:return new a.default(e);case i.default.size:return new s.default(e);case i.default.opacity:return new l.default(e);default:n.Log.error("视觉变量传入type类型参数有误!")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=f(r(0)),i=f(r(2)),o=r(9),a=r(1),s=f(r(103)),l=f(r(71)),u=r(6),c=r(8);function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t,r){var n=e.findIndex(function(e){return e.level===t}),i=e.findIndex(function(e){return e.level===r});return-1===t||-1===i?e:e.slice(n,i+1)}var d=function(){function e(){(0,n.default)(this,e)}return(0,i.default)(e,null,[{key:"parseTileInfo1",value:function(e){e||a.Log.error("tileInfo未定义");var t=e.tileWidth,r=e.tileHeight,n=e.lods,i=e.originX,u=e.originY,c=e.startLevel,f=e.endLevel;return new l.default({origin:new o.Point({coordinates:[i,u]}),lods:h(n,c,f).map(function(e){return s.default.fromJSON(e)}),size:[t,r]})}},{key:"parseTileInfo2",value:function(e){e||a.Log.error("tileInfo未定义");var t=e.cols,r=e.rows,n=e.dpi,i=e.format,u=e.origin,c=e.lods,f=e.spatialReference,d=e.startLevel,p=e.endLevel;return new l.default({dpi:n,format:i,origin:new o.Point({coordinates:[u.x,u.y],spatialReference:new o.SpatialReference(f)}),lods:h(c,d,p).map(function(e){return s.default.fromJSON(e)}),size:[t,r],spatialReference:new o.SpatialReference(f)})}},{key:"parseArcgisTileInfo",value:function(e){e||a.Log.error("tileInfo未定义");var t=e.cols,r=e.rows,n=e.dpi,i=e.format,u=e.origin,c=e.lods,f=e.spatialReference;return new l.default({dpi:n,format:i,origin:new o.Point({coordinates:[u.x,u.y],spatialReference:new o.SpatialReference({wkid:f.latestWkid||f.wkid})}),lods:c.map(function(e){return s.default.fromJSON(e)}),size:[t,r],spatialReference:new o.SpatialReference({wkid:f.latestWkid||f.wkid})})}},{key:"parseWMSTileInfo",value:function(t){t||a.Log.error("wmsLayer未定义");var r=t.extent,n=Math.max(t.imageWidth,t.imageHeight),i=t.spatialReferences[0];return e.generateTileInfo(r,n,i)}},{key:"generateTileInfo",value:function(e,t,r){e&&t||a.Log.error("动态计算tileInfo传入参数不合法");var n=Math.max(e.ymax-e.ymin,e.xmax-e.xmin)/t,i=[];i.push(n);for(var u=0;u<20;u++)i.push(i[u]/2);var c=new o.Point({coordinates:[e.xmin,e.ymax],spatialReference:r}),f=1;return r.isGeographic&&(f=111319490.79327358),new l.default({origin:c,lods:i.map(function(e,t){return s.default.fromJSON({level:t,resolution:e,scale:f*(96*e)/.0254})}),size:[t,t],spatialReference:r})}},{key:"parseWebTileLayerInfo",value:function(e,t,r){e||a.Log.error("IGSMapImageLayer未定义"),r=(0,a.defaultValue)(r,2);var n=e.tileSize,i=(t.xmax-t.xmin)/r/n,u=[];u.push(i);for(var c=0;c<19;c++)u.push(u[c]/2);var f=new o.Point({coordinates:[t.xmin,t.ymax],spatialReference:e.spatialReference}),h=1;return e.spatialReference.isGeographic&&(h=111319490.79327358),new l.default({origin:f,lods:u.map(function(e,t){return s.default.fromJSON({level:t,resolution:e,scale:h*(96*e)/.0254})}),size:[n,n],spatialReference:e.spatialReference})}},{key:"createCommonTileInfo",value:function(e){if(e&&e.extent){var t=e.extent,r=t.spatialReference,n=(0,a.defaultValue)(e.origin,new o.Point({coordinates:[t.xmin,t.ymax],spatialReference:r})),i=(0,a.defaultValue)(e.tileSize,256),u=(0,a.defaultValue)(e.minLevel,0),c=(0,a.defaultValue)(e.maxLevel,19),f=(0,a.defaultValue)(e.numberOfMinLevelTilesX,1),h=((0,a.defaultValue)(e.numberOfMinLevelTilesY,1),(t.xmax-t.xmin)/f/i),d=[];d.push(h);for(var p=u;p<c;p++)d.push(d[p]/2);var y=1;return r.isGeographic&&(y=111319490.79327358),new l.default({origin:n,lods:d.map(function(e,t){return s.default.fromJSON({level:t,resolution:e,scale:y*(96*e)/.0254})}),size:[i,i],spatialReference:r})}}},{key:"getLods",value:function(e,t,r){for(var n=Math.max(0,r),i=[],o=2*Math.PI*6378137/360,a=0;a<n;a++){var l,u=e/Math.pow(2,a);l="degree"===t?o*u:96*u/.0254,i.push(new s.default({level:a,resolution:u,scale:l}))}return i}},{key:"getReferenceLayer",value:function(e){for(var t=null,r=null,n=0;n<e.length;n++){var i=e[n];if(i.loaded&&(i.type===u.LayerType.igsTile||i.type===u.LayerType.arcgisTile||i.type===u.LayerType.wmts||i.type===u.LayerType.igsVectorTile||i.type===u.LayerType.arcgisVectorTile||i.type===u.LayerType.webTileLayer)){r=i,t=i.spatialReference;break}}if(!t)for(var o=0;o<e.length;o++){var a=e[o];if(a.loaded&&(a.type===u.LayerType.igsMapImage||a.type===u.LayerType.arcgisMapImage||a.type===u.LayerType.wms||a.type===u.LayerType.igsFeature||a.type===u.LayerType.wfs||a.type===u.LayerType.geojson)){r=a,t=a.spatialReference;break}}return r}},{key:"setLayerSpatialReference",value:function(e,t){t&&e.forEach(function(e){if((e.type===u.LayerType.igsMapImage||e.type===u.LayerType.arcgisMapImage||e.type===u.LayerType.feature)&&e.loaded){var r=!1;e.spatialReference?void 0!==e.spatialReference.wkid&&void 0!==t.wkid?e.spatialReference.wkid!==t.wkid&&(r=!0):e.spatialReference.wkt!==t.wkt&&(r=!0):r=!0,r&&(e.spatialReference=t,e._extentSrc=c.Projection.project(e._extentSrc,t))}})}},{key:"isSameSpatialReference",value:function(e,t){var r=!1,n=void 0,i=void 0,a=void 0,s=void 0,l=void 0,u=void 0;return void 0!==e&&void 0!==t&&(e instanceof o.SpatialReference?(n=e.wkt?e.wkt.toString():void 0,i=e.wkid?e.wkid.toString():void 0):a=e.toString(),t instanceof o.SpatialReference?(s=t.wkt?t.wkt.toString():void 0,l=t.wkid?t.wkid.toString():void 0):u=t.toString()),n&&s&&n===s?r=!0:i&&l&&(i===l||["4326","4490","4610","4214"].indexOf(i)>-1&&["4326","4490","4610","4214"].indexOf(l)>-1||["102113","102100","900913","3857"].indexOf(i)>-1&&["102113","102100","900913","3857"].indexOf(l)>-1)?r=!0:a&&u&&a===u&&(r=!0),r}},{key:"getLevelRangeByTileInfo",value:function(e){if(!e||!Array.isArray(e.lods)||0===e.lods.length)return[0,22];var t=e.lods;return[t[0].level,t[t.length-1].level]}},{key:"getTileInfoByLayer",value:function(t){var r=t.tileInfo;if(t.type===u.LayerType.wmts)r=t.getCurrentTileInfo();else if(t.type===u.LayerType.wms)r=e.parseWMSTileInfo(t,t.extent);else if(t.type===u.LayerType.igsMapImage||t.type===u.LayerType.arcgisMapImage||t.type===u.LayerType.igsFeature||t.type===u.LayerType.wfs||t.type===u.LayerType.geojson){var n=256;t.imageWidth&&t.imageHeight&&(n=Math.max(t.imageWidth,t.imageHeight)),r=e.generateTileInfo(t.extent,n,t.spatialReference)}return r}}]),e}();t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(11)),i=h(r(3)),o=h(r(0)),a=h(r(2)),s=h(r(4)),l=h(r(5)),u=r(8),c=r(1),f=r(39);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this)),n=(0,c.defaultValue)(e,{});return r.view=n.view,r.view||c.Log.error("视图对象不存在！"),r.layer=n.layer,r.layer||c.Log.error("图层对象不存在！"),r.innerLayer=null,r.id=r.layer.id,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"onAdd",value:function(e){}},{key:"onRemove",value:function(e){}},{key:"onUpdate",value:function(e){}},{key:"_getLayerViewVisible",value:function(e){var t=void 0;if(void 0===e&&(e=void 0===this.layer.visible||this.layer.visible),e){var r=(0,f.getLayerViewScaleVisible)(this);t=e&&r}else t=e;return t}}]),t}(u.Evented);(0,n.default)(d.prototype,{innerView:{get:function(){return this.view.getInnerView()}}}),t.default=d},function(e,t,r){var n=r(108),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(18),i=r(12),o=r(52);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],a={};a[e]=t(r),n(n.S+n.F*o(function(){r(1)}),"Object",a)}},function(e,t,r){var n=r(28),i=r(151),o=r(111),a=r(109)("IE_PROTO"),s=function(){},l=function(){var e,t=r(112)("iframe"),n=o.length;for(t.style.display="none",r(153).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;n--;)delete l.prototype[o[n]];return l()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=l(),void 0===t?r:i(r,t)}},function(e,t,r){var n=r(33),i=r(51),o=r(109)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){var n=r(72),i=r(21)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,r){var n=r(89)("meta"),i=r(24),o=r(33),a=r(27).f,s=0,l=Object.isExtensible||function(){return!0},u=!r(52)(function(){return l(Object.preventExtensions({}))}),c=function(e){a(e,n,{value:{i:"O"+ ++s,w:{}}})},f=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,n)){if(!l(e))return"F";if(!t)return"E";c(e)}return e[n].i},getWeak:function(e,t){if(!o(e,n)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[n].w},onFreeze:function(e){return u&&f.NEED&&l(e)&&!o(e,n)&&c(e),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={geometry:"Geometry",point:"Point",lineString:"LineString",polygon:"Polygon",multiPoint:"MultiPoint",multiLineString:"MultiLineString",multiPolygon:"MultiPolygon",circle:"Circle",extent:"Extent"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(6);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){(0,n.default)(this,e)}return(0,i.default)(e,null,[{key:"info",value:function(){if([o.LogType.info,o.LogType.all,o.LogType.infoAndError].indexOf(window.zondy.LOGTYPE)>-1){var e=Array.prototype.slice.call(arguments);e.unshift("%c info ","color:rgb(255,128,0);background-color: wheat;border: 1px solid rgb(255,128,0);border-radius: 3px;"),console.log.apply(console,e)}}},{key:"error",value:function(){if([o.LogType.error,o.LogType.all,o.LogType.infoAndError,o.LogType.warningAndError].indexOf(window.zondy.LOGTYPE)>-1){var e=Array.prototype.slice.call(arguments);e.unshift("%c error ","color:rgb(255,0,0);background-color: rgb(250,181,181);border: 1px solid rgb(255,0,0);border-radius: 3px;"),console.error.apply(console,e)}}},{key:"warning",value:function(){if([o.LogType.warning,o.LogType.warningAndError,o.LogType.all].indexOf(window.zondy.LOGTYPE)>-1){var e=Array.prototype.slice.call(arguments);e.unshift("%c warning ","color:rgb(230 162 60);background-color: rgb(253 246 236);border: 1px solid rgb(230 162 60);border-radius: 3px;"),console.log.apply(console,e)}}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.allSettled=t.inOrderPromise=t.debouncePromise=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(14));t.debouncePromise=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=void 0,o=void 0,a=void 0,s=[];return function(){var l=function(e){return"function"==typeof e?e():e}(t),u=(new Date).getTime(),c=!i||u-i>l;i=u;for(var f=arguments.length,h=Array(f),d=0;d<f;d++)h[d]=arguments[d];if(c&&r.leading)return r.accumulate?n.default.resolve(e.call(this,[h])).then(function(e){return e[0]}):n.default.resolve(e.call.apply(e,[this].concat(h)));if(o?clearTimeout(a):o=function(){var e={};return e.promise=new n.default(function(t,r){e.resolve=t,e.reject=r}),e}(),s.push(h),a=setTimeout(function(){var t=o;clearTimeout(a),n.default.resolve(r.accumulate?e.call(this,s):e.apply(this,s[s.length-1])).then(t.resolve,t.reject),s=[],o=null}.bind(this),l),r.accumulate){var p=s.length-1;return o.promise.then(function(e){return e[p]})}return o.promise}},t.inOrderPromise=async function(e){for(var t=[],r=0;r<e.length;r++)try{var n=await e[r]();t.push(n)}catch(e){}return t},t.allSettled=function(e){var t=function(e){return{status:"rejected",reason:e}},r=function(e){return{status:"fulfilled",value:e}},i=e.map(function(e){return n.default.resolve(e).then(r,t)});return n.default.all(i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(6),o=window.fetch,a={commit:function(e,t,r,n){switch(e=e?e.toUpperCase():e){case"GET":return this._get(t,n);case"POST":return this._post(t,r,n);case"PUT":return this._put(t,r,n);case"DELETE":return this._delete(t,r,n);default:return this._get(t,n)}},_get:function(e,t){return t=(0,n.defaultValue)(t,{}),this._fetch(e,void 0,t,i.FetchMethod.get)},_delete:function(e,t,r){return r=(0,n.defaultValue)(r,{}),this._fetch(e,t,r,i.FetchMethod.delete)},_post:function(e,t,r){return r=(0,n.defaultValue)(r,{}),this._fetch(e,t,r,i.FetchMethod.post)},_put:function(e,t,r){return r=(0,n.defaultValue)(r,{}),this._fetch(e,t,r,i.FetchMethod.put)},_fetch:function(e,t,r,a){if((r=(0,n.defaultValue)(r,{})).headers=(0,n.defaultValue)(r.headers,{}),r.requestTimeout=(0,n.defaultValue)(r.requestTimeout,45e3),r.headers["Content-Type"]||(r.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),!(0,n.isNull)(r.tokenKey)&&!(0,n.isNull)(r.tokenValue)){var s=function(){"string"==typeof t?"&"===t.slice(-1)?t+=r.tokenKey+"="+r.tokenValue:t+="&"+r.tokenKey+"="+r.tokenValue:t instanceof Object&&(t[r.tokenKey]=r.tokenValue)},l=function(){e.indexOf("?")<0?e+="?"+r.tokenKey+"="+r.tokenValue:"&"===e.slice(-1)||"?"===e.slice(-1)?e+=r.tokenKey+"="+r.tokenValue:e+="&"+r.tokenKey+"="+r.tokenValue};switch((0,n.defaultValue)(r.tokenAttachType,i.TokenAttachType.normal)){case i.TokenAttachType.normal:default:a===i.FetchMethod.post?s():l();break;case i.TokenAttachType.url:l();break;case i.TokenAttachType.header:r.headers[r.tokenKey]=r.tokenValue;break;case i.TokenAttachType.body:s()}}var u={method:a,body:t,headers:r.headers,credentials:r.withCredentials?"include":"omit",mode:"cors",timeout:r.requestTimeout};return r.responseType&&(u.responseType=r.responseType),o(e,u).then(function(e){return e}).catch(function(e){return e})}};t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEncoded=t.convertIGSClippingString=t.ServiceConfigResponseInterceptors=t.ServiceConfigRequestInterceptors=t.ServiceConfigToken=t.formatBaseUrl=t.getWFSFeature=t.getParametersObject=t.getWFSInfoFromXML=t.getWMTSInfoFromXML=t.getDoc=t.getWMSInfoFromXML=t.checkPathParameters=t.getParameters=t.checkParam=t.fromQueryResult=void 0;var n=c(r(10)),i=c(r(23)),o=r(9),a=c(r(96)),s=r(1),l=r(8),u=r(59);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t,r){for(var a="",l=function(l){var u=(0,s.defaultValue)(t[e[l]],r[e[l]].default);if(void 0!==u){var c="";if((0,s.isNull)(r[e[l]].process))switch(r[e[l]].type){case"String":case"Number":case"Boolean":a+="&"+(r[e[l]].alias||e[l])+"="+encodeURIComponent(u);break;case"Geometry":case"Point":case"MultiPoint":case"Extent":case"Circle":case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":a+="&"+e[l]+"="+encodeURIComponent(u.toString())+"&geometryType="+encodeURIComponent(u.getIGSType());break;case"layerDefs":c="[";for(var f=function(e){u[e]instanceof Object&&!(u[e]instanceof Array)&&(c+="{",(0,i.default)(u[e]).forEach(function(t){u[e].hasOwnProperty(t)&&(c+='"'+t+'":"'+u[e][t]+'",')}),c=c.substring(0,c.length-1),c+="},")},h=0;h<u.length;h++)f(h);u.length>0&&(c=c.substring(0,c.length-1)),"[]"!=(c+="]")&&(a+="&"+e[l]+"="+encodeURIComponent(c));break;case"OutStatistics":c+="[";for(var d=function(e){u[e]instanceof Object&&!(u[e]instanceof Array)&&(c+="{",(0,i.default)(u[e]).forEach(function(t){u[e].hasOwnProperty(t)&&("statisticType"!==t&&"onStatisticField"!==t&&"outStatisticFieldName"!==t||(c+='"'+t+'":"'+u[e][t]+'",'))}),c=c.substring(0,c.length-1),c+="},")},p=0;p<u.length;p++)d(p);u.length>0&&(c=c.substring(0,c.length-1)),"[]"!=(c+="]")&&(a+="&"+e[l]+"="+encodeURIComponent(c));break;case"FeatureSet":c="&"+e[l]+"="+encodeURIComponent((0,n.default)(t[e[l]].toGeoJSON())),a+=c;break;case"FeatureCollection":case"Array":case"Object":a+="&"+e[l]+"="+encodeURIComponent((0,n.default)(t[e[l]]));break;default:a+="&"+e[l]+"="+encodeURIComponent(u)}else if("string"==typeof r[e[l]].process)switch(r[e[l]].process){case"igsGeometryServer":a+="&"+e[l]+"="+encodeURIComponent((0,n.default)(u.toGeoJSON()))+"&srs=",u.spatialReference?u.spatialReference instanceof o.SpatialReference?a+=encodeURIComponent(u.spatialReference.toString()):u.spatialReference instanceof Object&&!(u.spatialReference instanceof Array)?a+=encodeURIComponent(u.spatialReference.wkt?u.spatialReference.wkt:"EPSG:4326"):"string"==typeof u.spatialReference&&(a+=encodeURIComponent(u.spatialReference)):a+=encodeURIComponent("EPSG:4326");break;case"igsGeometryServerNoSRS":a+="&"+e[l]+"="+encodeURIComponent((0,n.default)(u.toGeoJSON()));break;case"igsRange$":a+="&"+(r[e[l]].alias||e[l])+"="+encodeURIComponent(u.toIGSOldString());break;case"igsGeometryOld":"Point"===u.type||"LineString"===u.type?"Point"===u.type&&!0===u.hasZ?a+="&"+e[l]+"="+encodeURIComponent(u.toString()+","+(t.distance||r.distance.default))+"&geometryType="+encodeURIComponent(u.getIGSType()):a+="&"+e[l]+"="+encodeURIComponent(u.toString()+";"+(t.distance||r.distance.default))+"&geometryType="+encodeURIComponent(u.getIGSType()):a+="&"+e[l]+"="+encodeURIComponent(u.toString())+"&geometryType="+encodeURIComponent(u.getIGSType());break;default:a+="&"+e[l]+"="+encodeURIComponent(u.toString())+"&geometryType="+encodeURIComponent(u.getIGSType())}else r[e[l]].process instanceof Function&&(a+=r[e[l]].process(t[e[l]],r[e[l]].default))}},u=0;u<e.length;u++)l(u);return a&&(a=a.substring(1,a.length)),a}function h(e,t,r){for(var i={},o=0;o<e.length;o++){var a=(0,s.defaultValue)(t[e[o]],r[e[o]].default);if(void 0!==a)if((0,s.isNull)(r[e[o]].process))switch(r[e[o]].type){case"String":case"Number":case"Boolean":default:i[r[e[o]].alias||e[o]]=a;break;case"Geometry":case"Point":case"MultiPoint":case"Extent":case"Circle":case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":i[r[e[o]].alias||e[o]]=a.toString()+"&geometryType="+a.getIGSType()}else if("string"==typeof r[e[o]].process)switch(r[e[o]].process){case"igsDots":i[r[e[o]].alias||"Dots"]=a.toDots();break;case"toOldIGSGeometry":switch(a.type){case"Point":i[r[e[o]].alias||"Pnt"]=a.toOldIGSGeometry().PntGeom[0];break;case"LineString":i[r[e[o]].alias||"Line"]=a.toOldIGSGeometry().LinGeom[0];break;case"Polygon":i[r[e[o]].alias||"Reg"]=a.toOldIGSGeometry().RegGeom[0]}break;default:i[r[e[o]].alias||e[o]]=a}else r[e[o]].process instanceof Function&&(i[e[o]]=r[e[o]].process(t[e[o]],r[e[o]].default))}return encodeURIComponent((0,n.default)(i))}function d(e,t){if("function"==typeof e)return e(t);var r=void 0;switch(e){case"String":r=(0,s.isString)(t);break;case"Number":r=(0,s.isNumber)(t);break;case"Boolean":r=(0,s.isBoolean)(t);break;case"Extent":r=t instanceof o.Extent;break;case"Geometry":r=t instanceof o.Geometry;break;case"Point":r=t instanceof o.Point;break;case"Polygon":r=t instanceof o.Polygon;break;case"MultiPolygon":r=t instanceof o.MultiPolygon;break;case"Circle":r=t instanceof o.Circle;break;case"LineString":r=t instanceof o.LineString;break;case"MultiLineString":r=t instanceof o.MultiLineString;break;case"LineString | MultiLineString":r=t instanceof o.LineString||t instanceof o.MultiLineString;break;case"Polygon | Extent":r=t instanceof o.Polygon||t instanceof o.Extent;break;case"Array":r=t instanceof Array;break;case"Object":r=t instanceof Object;break;case"OutStatistics":r=function(e){if(!(e instanceof Array))return!1;for(var t=0;t<e.length;t++){if(!(e[t]instanceof Object))return!1;if(e[t]instanceof Object&&e[t]instanceof Array)return!1;if(!e[t].hasOwnProperty("statisticType")||!e[t].hasOwnProperty("onStatisticField")||!e[t].hasOwnProperty("outStatisticFieldName"))return!1;if((0,s.isNull)(e[t].statisticType)||(0,s.isNull)(e[t].onStatisticField)||(0,s.isNull)(e[t].outStatisticFieldName))return!1;if(!(0,s.isString)(e[t].statisticType)||!(0,s.isString)(e[t].onStatisticField)||!(0,s.isString)(e[t].outStatisticFieldName))return!1}return!0}(t);break;case"FeatureSet":r=t instanceof l.FeatureSet;break;case"FeatureCollection":r=t instanceof Object&&!(t instanceof Array)&&t.hasOwnProperty("features")&&"FeatureCollection"===t.type;break;case"Color":r=t instanceof l.Color;break;default:r=(0,s.isString)(t)}return r}function p(e,t){var r=void 0;if("1.1.1"===t)(r={minx:e.attributes.minx.value,miny:e.attributes.miny.value,maxx:e.attributes.maxx.value,maxy:e.attributes.maxy.value}).crs=e.attributes.SRS.value;else{var n=e.attributes.CRS.value,i=Number(n.split(":")[1]);(r=i>=2327&&i<=2442||i>=4491&&i<=4554||i>=21413&&i<=21423||i>=21473&&i<=21483?{minx:e.attributes.miny.value,miny:e.attributes.minx.value,maxx:e.attributes.maxy.value,maxy:e.attributes.maxx.value}:4326===i||4214===i||4490===i||4610===i?{minx:e.attributes.miny.value,miny:e.attributes.minx.value,maxx:e.attributes.maxy.value,maxy:e.attributes.maxx.value}:{minx:e.attributes.minx.value,miny:e.attributes.miny.value,maxx:e.attributes.maxx.value,maxy:e.attributes.maxy.value}).crs=e.attributes.CRS.value}return r}function y(e,t,r){if("Name"===e.nodeName)t.name=e.innerHTML;else if("Abstract"===e.nodeName)t.abstract=e.innerHTML;else if("Title"===e.nodeName){var n=e.innerHTML;n.indexOf(":")>-1&&(n=n.split(":")[1]),t.title=n}else if("SRS"===e.nodeName)t.crs.push(e.innerHTML);else if("CRS"===e.nodeName)t.crs.push(e.innerHTML);else if("BoundingBox"===e.nodeName){var i;i=r.corporation===l.WMTSCorporation.corporationZD?p(e,r.version):(r.corporation,l.WMTSCorporation.corporationArcGIS,p(e,r.version)),t.boundingBox.push(i)}else"LatLonBoundingBox"===e.nodeName?t.latLonBoundingBox={minx:e.attributes.miny.value,miny:e.attributes.minx.value,maxx:e.attributes.maxy.value,maxy:e.attributes.maxx.value}:"EX_GeographicBoundingBox"===e.nodeName&&(t.geographicBoundingBox={westBoundLongitude:e.childNodes[0].innerHTML,eastBoundLongitude:e.childNodes[1].innerHTML,southBoundLatitude:e.childNodes[2].innerHTML,northBoundLatitude:e.childNodes[3].innerHTML})}function g(e){var t={attributes:{}};if(e.attributes)for(var r=0;r<e.attributes.length;r++)t.attributes[e.attributes[r].nodeName]=e.attributes[r].value;if(t.children={},e.childNodes){for(var n=0;n<e.childNodes.length;n++)t.children[e.childNodes[n].nodeName]=g(e.childNodes[n]);0===e.childNodes.length&&(t[e.nodeName]=e.textContent)}return t}function v(e){var t="EPSG:4326";if(!e)return t;var r=e.getAttribute("srsName");if(!r)return t;var n=r.match(/EPSG::\d+/);return n[0]&&(t="EPSG:"+n[0].replace("EPSG::","")),t}t.fromQueryResult=function(e){function t(e){if(!e.hasOwnProperty("SFEleArray")||!e.hasOwnProperty("AttStruct")||e.hasOwnProperty("SFEleArray")&&!e.SFEleArray||e.hasOwnProperty("AttStruct")&&!e.AttStruct)return[];for(var t=e.SFEleArray,r=e.AttStruct,n=new l.FeatureSet({spatialReference:new o.SpatialReference("EPSG:0000")}),i=void 0,a=void 0,s=void 0,u=0;u<t.length;u++){for(var c={},f=0;f<t[u].AttValue.length;f++)""!==t[u].AttValue[f]&&(c[r.FldName[f]]=t[u].AttValue[f]);if(t[u].fGeom)switch(t[u].ftype){case 1:var h=t[u].fGeom.PntGeom;s=[];for(var d=0;d<h.length;d++){var p=h[d].Dot;s.push([p.x,p.y])}a=new o.MultiPoint({coordinates:s});break;case 2:var y=t[u].fGeom.LinGeom;s=[];for(var g=0;g<y.length;g++){for(var v=y[g].Line.Arcs[0].Dots,m=[],_=0;_<v.length;_++)m.push([v[_].x,v[_].y]);s.push(m)}a=new o.MultiLineString({coordinates:s});break;case 3:default:var S=t[u].fGeom.RegGeom;s=[];for(var x=0;x<S.length;x++){for(var b=S[x].Rings[0].Arcs[0].Dots,w=[],k=0;k<b.length;k++)w.push([b[k].x,b[k].y]);for(var M=[w],E=1;E<S[x].Rings.length;E++){for(var I=S[x].Rings[E].Arcs[0].Dots,T=[],L=0;L<I.length;L++)T.push([I[L].x,I[L].y]);M.push(T)}s.push(M)}a=new o.MultiPolygon({coordinates:s})}var P=void 0;if(t[u].GraphicInfo){var C=t[u].GraphicInfo;switch(C.InfoType){case 1:P=C.PntInfo;break;case 2:P=C.LinInfo;break;case 3:default:P=C.RegInfo}}i=new l.Feature({id:t[u].FID,attributes:c,geometry:a,symbol:P}),n.features.push(i)}return n}if(e instanceof Array){for(var r=[],n=0;n<e.length;n++)r.push(t(e[n]));return r}return[t(e)]},t.checkParam=function(e,t){var r=!0,n="",o="",l=void 0,u="";try{var c=!0;if((0,i.default)(t).forEach(function(r){if(e.hasOwnProperty(r)&&t.hasOwnProperty(r)||t.hasOwnProperty(r)&&t[r].required){if(t[r].required)if((0,s.isNull)(t[r].oneOf)){if((0,s.isNull)(e[r]))throw l=r,new Error("isNull")}else{var n=!1;(0,s.isNull)(e[r])&&(n=!0);for(var i=0;i<t[r].oneOf.length;i++)if(!(0,s.isNull)(e[t[r].oneOf[i]])){n=!1;break}if(n)throw l=r+","+t[r].oneOf.toString(),new Error("isNull")}if((0,s.isNull)(e[r])||(c=d(t[r].type,e[r])),!c)throw l=r,new Error("wrongType")}}),c){var p=[];(0,i.default)(t).forEach(function(e){t.hasOwnProperty(e)&&p.push(e)}),u=e.useObject?h(p,e,t):f(p,e,t)}}catch(e){switch(r=!1,e.message){case"isNull":n=l+"值不能为空！",o="isNull",a.default.error(n);break;case"wrongType":n=l+"类型错误！",o="isWrongType",a.default.error(n);break;default:n=l+"值不能为空！",o="isNull",a.default.error(n)}}return{isChecked:r,errorMessage:n,errorType:o,queryString:u}},t.getParameters=f,t.checkPathParameters=function(e,t){var r="",n="",o=!0;try{(0,i.default)(e).forEach(function(n){if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n))throw r="isNull",o=!1,new Error(n+"不能为空！");var i=t[n];if((0,s.isNull)(i))throw r="isNull",o=!1,new Error(n+"不能为空！");if(!d(e[n].type,t[n]))throw r="isWrongType",o=!1,new Error(n+"类型错误！")}})}catch(e){return a.default.error(e),{isChecked:o,errorMessage:n=e,errorType:r}}return{isChecked:o,errorMessage:n,errorType:r}},t.getWMSInfoFromXML=function(e,t,r){var n=(0,u.initCorporationType)(r),i="1.0";n===l.WMTSCorporation.corporationZD&&r.indexOf("igs/rest/ogc/doc")<0&&(i="2.0");for(var o={boundingBox:[],layer:[],crs:[]},a=e.childNodes,s=0;s<a.length;s++)if(("WMT_MS_Capabilities"===a[s].nodeName||"WMS_Capabilities"===a[s].nodeName)&&a[s].childNodes.length>0){for(var c=a[s].childNodes,f=0;f<c.length;f++)if("Capability"===c[f].nodeName){for(var h=c[f].childNodes,d=0;d<h.length;d++)if("Layer"===h[d].nodeName){for(var p=h[d].childNodes,g=0;g<p.length;g++)if("Layer"===p[g].nodeName){for(var v=p[g].childNodes,m={boundingBox:[],crs:[]},_=0;_<v.length;_++)y(v[_],m,{corporation:n,version:t,igsVersion:i});o.layer.push(m)}else y(p[g],o,{corporation:n,version:t,igsVersion:i});break}break}break}return o},t.getDoc=function(e){var t=null;return window.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)),t},t.getWMTSInfoFromXML=function(e){for(var t=e.childNodes,r={layers:[],tileMatrixSets:[],XMLInfo:{}},n=0;n<t.length;n++)if("Capabilities"===t[n].nodeName){for(var i=t[n].childNodes,o=0;o<i.length;o++){if("Contents"===i[o].nodeName)for(var a=i[o].childNodes,s=0;s<a.length;s++)if("Layer"===a[s].nodeName){for(var l={infoFormat:[],tileMatrixSetLink:[]},u=a[s].childNodes,c=0;c<u.length;c++)if("ows:Title"===u[c].nodeName)l.title=u[c].innerHTML;else if("ows:Identifier"===u[c].nodeName)l.identifier=u[c].innerHTML;else if("ows:BoundingBox"===u[c].nodeName){for(var f={},h=0;h<u[c].childNodes.length;h++)"ows:LowerCorner"===u[c].childNodes[h].nodeName&&(f.lowerCorner=u[c].childNodes[h].innerHTML),"ows:UpperCorner"===u[c].childNodes[h].nodeName&&(f.upperCorner=u[c].childNodes[h].innerHTML);l.boundingBox=f}else if("Style"===u[c].nodeName){for(var d={},p=0;p<u[c].childNodes.length;p++)"ows:Identifier"===u[c].childNodes[p].nodeName&&(d.identifier=u[c].childNodes[p].innerHTML),"ows:Title"===u[c].childNodes[p].nodeName&&(d.title=u[c].childNodes[p].innerHTML);l.Style=d}else if("Format"===u[c].nodeName)l.format=u[c].innerHTML;else if("InfoFormat"===u[c].nodeName)l.infoFormat.push(u[c].innerHTML);else if("TileMatrixSetLink"===u[c].nodeName){for(var y=u[c].childNodes,v={tileMatrixSetLimits:[]},m=0;m<y.length;m++)if("TileMatrixSet"===y[m].nodeName)v.tileMatrixSet=y[m].innerHTML;else if("TileMatrixSetLimits"===y[m].nodeName)for(var _=y[m].childNodes,S=0;S<_.length;S++){for(var x=_[S].childNodes,b={},w=0;w<x.length;w++)"TileMatrix"===x[w].nodeName?b.tileMatrix=x[w].innerHTML:"MinTileRow"===x[w].nodeName?b.minTileRow=x[w].innerHTML:"MaxTileRow"===x[w].nodeName?b.maxTileRow=x[w].innerHTML:"MinTileCol"===x[w].nodeName?b.minTileCol=x[w].innerHTML:"MaxTileCol"===x[w].nodeName&&(b.maxTileCol=x[w].innerHTML);v.tileMatrixSetLimits.push(b)}l.tileMatrixSetLink.push(v)}r.layers.push(l)}else if("TileMatrixSet"===a[s].nodeName){for(var k=a[s].childNodes,M={tileMatrix:[]},E=0;E<k.length;E++)if("ows:Title"===k[E].nodeName)M.title=k[E].innerHTML;else if("ows:Abstract"===k[E].nodeName)M.abstract=k[E].innerHTML;else if("ows:Identifier"===k[E].nodeName)M.identifier=k[E].innerHTML;else if("ows:SupportedCRS"===k[E].nodeName)M.supportedCRS=k[E].innerHTML;else if("TileMatrix"===k[E].nodeName){for(var I=k[E].childNodes,T={},L=0;L<I.length;L++)"ows:Identifier"===I[L].nodeName?T.identifier=I[L].innerHTML:"ScaleDenominator"===I[L].nodeName?T.scaleDenominator=I[L].innerHTML:"TopLeftCorner"===I[L].nodeName?T.topLeftCorner=I[L].innerHTML:"TileWidth"===I[L].nodeName?T.tileWidth=I[L].innerHTML:"TileHeight"===I[L].nodeName?T.tileHeight=I[L].innerHTML:"MatrixWidth"===I[L].nodeName?T.matrixWidth=I[L].innerHTML:"MatrixHeight"===I[L].nodeName&&(T.matrixHeight=I[L].innerHTML);M.tileMatrix.push(T)}r.tileMatrixSets.push(M)}r.XMLInfo[i[o].nodeName]=g(i[o])}break}return r},t.getWFSInfoFromXML=function(e){for(var t=e.childNodes,r={featureTypeList:[],version:"1.0.0"},n=e.firstChild.attributes,i=0;i<n.length;i++)if(n[i].name&&"version"===n[i].name.toLowerCase()){r.version=n[i].nodeValue;break}for(var o=0;o<t.length;o++)if("wfs:WFS_Capabilities"===t[o].nodeName)for(var a=t[o].childNodes,s=0;s<a.length;s++)if("FeatureTypeList"===a[s].nodeName){for(var l=a[s].childNodes,u=0;u<l.length;u++)if("FeatureType"===l[u].nodeName){for(var c={},f=l[u].childNodes,h=0;h<f.length;h++)"name"===f[h].nodeName.toLowerCase()?c.name=f[h].innerHTML:"title"===f[h].nodeName.toLowerCase()?c.title=f[h].innerHTML:"abstract"===f[h].nodeName.toLowerCase()?c.abstract=f[h].innerHTML:"defaultsrs"===f[h].nodeName.toLowerCase()?c.defaultSRS=f[h].innerHTML:"ows:wgs84boundingbox"===f[h].nodeName.toLowerCase()&&(c.WGS84BoundingBox={lowerCorner:f[h].childNodes[0].innerHTML,UpperCorner:f[h].childNodes[1].innerHTML});r.featureTypeList.push(c)}break}return r},t.getParametersObject=h,t.getWFSFeature=function(e,t){var r=e.childNodes[0].childNodes,n=new l.FeatureSet;t=(0,s.defaultValue)(t,"2.0.0");for(var i=0;i<r.length;i++){for(var a=r[i].childNodes[0].childNodes,u={},c=void 0,f=0;f<a.length;f++)if(a[f].nodeName.indexOf(":the_geom")>-1){var h=a[f],d=v(h.childNodes[0]),p=Number(d.split(":")[1]);if(n.spatialReference=new o.SpatialReference(d),h.childNodes[0].nodeName.indexOf("MultiSurface")>-1){var y=h.childNodes[0].childNodes;if(1===y.length){for(var g=y[0].childNodes[0].childNodes,m=0;m<g.length;m++)if(g[m].nodeName.indexOf("exterior")>-1){var _=g[m].childNodes[0].childNodes[0].innerHTML.split(" "),S=[];switch(t){case"2.0.0":case"1.1.0":default:for(var x=0;x<_.length;x+=2)[4326,4490,4610,4214].indexOf(p)>-1||p>=2327&&p<=2442||p>=4491&&p<=4554||p>=21413&&p<=21423||p>=21473&&p<=21483?S.push([Number(_[x+1]),Number(_[x])]):S.push([Number(_[x]),Number(_[x+1])]);break;case"1.0.0":for(var b=0;b<_.length;b+=2)S.push([Number(_[b]),Number(_[b+1])])}c=new o.Polygon({coordinates:[S],spatialReference:new o.SpatialReference(d)})}}else y.length}else if(h.childNodes[0].nodeName.indexOf("MultiCurve")>-1){var w=h.childNodes[0].childNodes;if(1===w.length){for(var k=w[0].childNodes[0].childNodes,M=0;M<k.length;M++)if(k[M].nodeName.indexOf("posList")>-1){var E=k[M].innerHTML.split(" "),I=[];switch(t){case"2.0.0":case"1.1.0":default:if([4326,4490,4610,4214].indexOf(p)>-1||p>=2327&&p<=2442||p>=4491&&p<=4554||p>=21413&&p<=21423||p>=21473&&p<=21483)for(var T=0;T<E.length;T+=2)I.push([Number(E[T+1]),Number(E[T])]);else for(var L=0;L<E.length;L+=2)I.push([Number(E[L]),Number(E[L+1])]);break;case"1.0.0":for(var P=0;P<E.length;P+=2)I.push([Number(E[P]),Number(E[P+1])])}c=new o.LineString({coordinates:I,spatialReference:new o.SpatialReference(d)})}}else w.length}else if(h.childNodes[0].nodeName.indexOf("MultiPoint")>-1){var C=h.childNodes[0].childNodes;if(1===C.length){var N=C[0].childNodes[0].childNodes[0].innerHTML.split(" "),O=void 0;switch(t){case"2.0.0":case"1.1.0":default:O=[4326,4490,4610,4214].indexOf(p)>-1||p>=2327&&p<=2442||p>=4491&&p<=4554||p>=21413&&p<=21423||p>=21473&&p<=21483?[Number(N[1]),Number(N[0])]:[Number(N[0]),Number(N[1])];break;case"1.0.0":O=[Number(N[0]),Number(N[1])]}c=new o.Point({coordinates:O,spatialReference:new o.SpatialReference(d)})}else C.length}}else{var R=a[f].nodeName;u[R=R.split(":")[1]]=a[f].innerHTML}var V=new l.Feature({geometry:c,attributes:u});n.features.push(V)}return n},t.formatBaseUrl=function(e){var t=e.indexOf("?");if(t<0)return{baseUrl:e,params:{}};var r=e.substring(0,t),n=e.substring(t+1,e.length);return{baseUrl:r,paramString:n?"&"+n:""}},t.ServiceConfigToken=function(e){var t="";return e&&e.tokenKey&&e.tokenValue&&(t=e.tokenKey+"="+e.tokenValue),t},t.ServiceConfigRequestInterceptors=function(e,t){t=(0,s.defaultValue)(t,"");var r=e.request.interceptors,n=decodeURI(t);if(r&&r instanceof Array)for(var i="",o=0;o<r.length;o++){var a=r[o].urls,l=r[o].before;if(a){if("string"==typeof a){var u=decodeURI(a);if(n.indexOf(u)>-1&&l&&l instanceof Function){var c=l(t);c&&(i+=c)}}else if(a instanceof Array)for(var f=0;f<a.length;f++){var h=decodeURI(a[f]);if(n.indexOf(h)>-1&&l&&l instanceof Function){var d=l(t);d&&(i+=d)}}}else if(l&&l instanceof Function){var p=l(t);p&&(i+=p)}i&&(t=i)}return t},t.ServiceConfigResponseInterceptors=function(e,t,r){t=(0,s.defaultValue)(t,"");var n=e.request.interceptors,i=decodeURI(t);if(n&&n instanceof Array)for(var o=0;o<n.length;o++){var a=n[o].urls,l=n[o].after;if(!a||a instanceof Array&&0===a.length){if(l&&l instanceof Function){var u=l(r);if(u)return u}}else if("string"==typeof a){var c=decodeURI(a);if(i.indexOf(c)>-1&&l&&l instanceof Function){var f=l(r);if(f)return f}}else if(a instanceof Array)for(var h=0;h<a.length;h++){var d=decodeURI(a[h]);if(i.indexOf(d)>-1&&l&&l instanceof Function){var p=l(r);if(p)return p}}}return r},t.convertIGSClippingString=function(e){if(!Array.isArray(e)||0===e.length)return"";var t=[];return e.forEach(function(e){var r="";e.forEach(function(e){r+=e[0]+","+e[1]+","}),r=r.substring(0,r.length-1),t.push(r)}),1===t.length?t[0]:t.join("|")},t.isEncoded=function(e){try{return decodeURI(e),!0}catch(e){return!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.default=function(e){var t=(0,n.defaultValue)(e,{});(0,n.extend)(this,t),this.FldNumber=(0,n.defaultValue)(t.FldNumber,0),this.FldName=(0,n.defaultValue)(t.FldName,null),this.FldType=(0,n.defaultValue)(t.FldType,null)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(0)),i=l(r(2)),o=r(8),a=r(1),s=r(22);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),t=(0,a.defaultValue)(t,{}),this.symbol=new s.MapGISTextSymbol(t.symbol),this.renderMode=(0,a.defaultValue)(t.renderMode,"canvas"),this.deconflictionStrategy=(0,a.defaultValue)(t.deconflictionStrategy,"static"),this.maxScale=t.maxScale,this.minScale=t.minScale,this.elevationInfo=new o.ElevationInfo(t.elevationInfo),this.labelPlacement=t.labelPlacement,this.currentAttributeName=t.currentAttributeName,this.labelExpression=t.labelExpression,this.repeatLabel=(0,a.defaultValue)(t.repeatLabel,!0),this.repeatLabelDistance=(0,a.defaultValue)(t.repeatLabelDistance,6e3),this.repeatStartRate=(0,a.defaultValue)(t.repeatStartRate,.3),this.repeatEndRate=(0,a.defaultValue)(t.repeatEndRate,.7),this.lineLabelSpread=(0,a.defaultValue)(t.lineLabelSpread,"auto-spread"),this.labelPositionAlong=(0,a.defaultValue)(t.labelPositionAlong,"middle"),this.skeletonLineStartRate=(0,a.defaultValue)(t.skeletonLineStartRate,.4),this.skeletonLineEndRate=(0,a.defaultValue)(t.skeletonLineEndRate,.6),this.groundScale=(0,a.defaultValue)(t.groundScale,20),this.onScreenLabelCount=(0,a.defaultValue)(t.onScreenLabelCount,4e3),this.extensionOptions=(0,a.defaultValue)(t.extensionOptions,{})}return(0,i.default)(e,[{key:"toJSON",value:function(){return{symbol:this.symbol.toJSON(),renderMode:this.renderMode,deconflictionStrategy:this.deconflictionStrategy,maxScale:this.maxScale,minScale:this.minScale,elevationInfo:this.elevationInfo.toJSON(),labelPlacement:this.labelPlacement,currentAttributeName:this.currentAttributeName,labelExpression:this.labelExpression,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,repeatStartRate:this.repeatStartRate,repeatEndRate:this.repeatEndRate,lineLabelSpread:this.lineLabelSpread,labelPositionAlong:this.labelPositionAlong,skeletonLineStartRate:this.skeletonLineStartRate,skeletonLineEndRate:this.skeletonLineEndRate,groundScale:this.groundScale,onScreenLabelCount:this.onScreenLabelCount,extensionOptions:(0,a.cloneObject)(this.extensionOptions)}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,a.defaultValue)(t,{}))}}]),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(0)),i=l(r(2)),o=l(r(55)),a=r(1),s=r(85);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),t=(0,a.defaultValue)(t,{}),this.type=o.default.default,this.field=(0,a.defaultValue)(t.field,""),this.valueExpression=(0,a.defaultValue)(t.valueExpression,""),this.valueExpressionTitle=(0,a.defaultValue)(t.valueExpressionTitle,"")}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.field=this.field,e.valueExpression=this.valueExpression,e.valueExpressionTitle=this.valueExpressionTitle,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(e){return e=(0,a.defaultValue)(e,{}),(0,s.createVisualVariable)(e)}}]),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(0)),i=o(r(2));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){(0,n.default)(this,e),t=t||{},this.level=t.level,this.resolution=t.resolution,this.scale=t.scale}return(0,i.default)(e,[{key:"toJSON",value:function(){return{level:this.level,resolution:this.resolution,scale:this.scale}}},{key:"clone",value:function(){return e.fromJSON(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(10)),i=f(r(3)),o=f(r(0)),a=f(r(2)),s=f(r(4)),l=f(r(7)),u=f(r(5)),c=r(1);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.version=(0,c.defaultValue)(e.version,""),r.customParameters=(0,c.defaultValue)(e.customParameters,{}),r.customLayerParameters=(0,c.defaultValue)(e.customLayerParameters,{}),r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return e.version=this.version,e.customParameters=JSON.parse((0,n.default)(this.customParameters)),e.customLayerParameters=JSON.parse((0,n.default)(this.customLayerParameters)),e}}]),t}(r(15).Layer);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayerBaseUrlRegExp=t.ServerBaseUrlRegExp=t.BaseRegExp=t.deleteNullValue=t.ServerUtil=t.UrlUtil=t.getFunctionArguments=t.TimeInterval=t.TimeInfo=t.TimeExtent=t.NormalizationType=t.TemporalUnit=t.getLayersExtent=t.getCrsOptions=t.getLayerViewsGeographicExtent=t.getValidLayers=t.isLayerViewValid=t.ExpressionParser=t.VectorTileLayer=t.TileSliceType=t.TDTLayerType=t.VisualVariableType=t.SeverVectorTileSubLayerType=t.ColorNameToHexMap=t.GeometryFilter=t.SceneSubLayerType=t.convertIGSClippingString=t.VoxelFilter=t.LOD=t.getFullBaseUrl=t.appendUrlParams=t.TileInfo=t.FetchRequest=t.ArcType=t.AreaUnits=t.LinearUnits=t.allSettled=t.inOrderPromise=t.debouncePromise=t.compareObject=t.throttle=t.convertImageSourceToBase64=t.isWMSReverse=t.getProjectionSrs=t.OGCLayer=t.OverlayLayer=t.UnknownLayer=t.RequestConfig=void 0,t.BaseServer=t.TileLayer=t.WorkFlowServer=t.Interceptor=t.CAttStruct=t.CAttDataRow=t.FeatureCollection=t.getZoomOffset=t.WebTileLayer=t.ArcGISVectorTileLayer=t.StylePattern3D=t.ColorMaterial=t.MaterialType=t.WaveStrength=t.WaterbodySize=t.WaterSymbol3DLayer=t.TextHalo=t.TextSymbol3DLayer=t.Edges3D=t.ExtrudeSymbol3DLayer=t.ObjectSymbol3DLayer=t.IconResource=t.PointSymbol3DOutline=t.IconSymbol3DLayer=t.PatternStyle=t.FillSymbol3DOutline=t.FillSymbol3DLayer=t.ProfileType=t.AnchorType=t.PathSymbol3DLayer=t.LineSymbol3DLayer=t.LineStylePattern3D=t.LinePatternStyle=t.LineStyleMarker3D=t.LineMarkerStyle=t.LineMarkerPlacement=t.LineJoinType=t.LineCapType=t.Symbol3DLayerType=t.Symbol3DLayer=t.Symbol3DVerticalOffset=t.Callout3D=t.LineCallout3D=t.PolygonSymbol3D=t.PointSymbol3D=t.LineSymbol3D=t.LabelSymbol3D=t.Symbol3D=t.RendererUtil=t.VisualVariable=t.OpacityVariable=t.ColorVariable=t.SizeVariable=t.HeatmapColorStop=t.LabelClass=t.setElevationInfo=t.WMTSCorporation=t.TileInfoUtil=t.BaseFeatureLayerView=t.createSimpleFillSymbolCanvas=t.createSimpleMarkerSymbolCanvas=t.ServiceConfigRequestInterceptors=t.ServiceConfigToken=t.Config=t.editGeometryByArc3=t.editFeatureByArc3=t.Geometry=t.RadiusUnit=t.formatBaseUrl=t.showLayerByScale=t.T=t.proj4=t.EPSG=t.isCustomSP=t.is4326=t.getUrlType=t.PictureFormat=t.UrlServerType=t.SpatialReference=t.LayerView=t.GroupLayerView=t.BaseRendererLayerView=t.BaseGraphicsLayerView=t.SceneView=t.MapView=t.BaseView=t.inputCss=t.getBaseUrl=t.toJSON=t.getVideoType=t.isObject=t.notNULL=t.cloneObject=t.returnPoint=t.formatPoints=t.newGuid=t.extendDeep=t.isBoolean=t.deepClone=t.isString=void 0,t.Log=t.getOutStatisticsParameter=t.getGeometryParameter=t.isNull=t.createGeometry=t.normalize=t.defined=t.defaultValue=t.getGUID=t.bind=t.getParameterString=t.urlAppend=t.transformResult=t.isInTheSameDomain=t.isNumber=t.isArray=t.extend=t.getIGSDynamicLayer=t.BaseRenderer=t.HeatmapRenderer=t.RankRenderer=t.RandomRenderer=t.ClusterRenderer=t.SimpleRenderer=t.ClassBreakRenderer=t.UniqueValueRenderer=t.MapGISTextSymbol=t.PictureFillSymbol=t.PictureMarkerSymbol=t.Symbol=t.TextSymbol=t.SimpleMarkerSymbol=t.SimpleLineSymbol=t.SimpleFillSymbol=t.ShadowMode=t.SceneMode=t.VerticalAlignment=t.HorizontalAlignment=t.FeatureExpressionInfo=t.ProjectInfoBySrsID=t.TileMatrixSet=t.OutStatistic=t.ProjectInfo=t.ElevationInfo=t.ElevationMode=t.IGSSymbolType=t.SymbolType=t.IGSRendererType=t.SketchEditorToolEventType=t.SketchEditorState=t.SketchEditorEventType=t.SketchEditMode=t.SketchDataType=t.VideoSourceType=t.VectorTileGeometryType=t.RendererType=t.AngleUnit=t.LengthUnit=t.ViewEventType=t.LoadStatus=t.LogType=t.IGSGeometryType=t.TokenAttachType=t.LayerType=t.GeometryType=t.CustomWKID=t.SpatialRelation=t.StatisticType=t.MapEventType=t.LayerEventType=t.FetchMethod=t.ReturnFormat=t.getFeaturesFromFeatureSet=t.Feature=t.FeatureSet=t.Collection=t.ErrorEvent=t.FeatureRender=t.Evented=t.zondy=t.Zondy=t.Event=t.LayerEvent=t.Font=t.Color=t.GeometryEngine=t.MultiPoint=t.MultiLineString=t.MultiPolygon=t.Circle=t.Point=t.LineString=t.Polygon=t.Extent=t.SketchEditorEvent=t.SketchStyle=t.SketchFreehandPolygonDrawTool=t.SketchFreehandPolylineDrawTool=t.SketchExtentDrawTool=t.SketchCircleDrawTool=void 0,t.SketchPolygonDrawTool=t.SketchPolylineDrawTool=t.SketchPointDrawTool=t.SketchBaseDrawTool=t.SketchEditor3D=t.SketchEditor=t.CoordnateTransform=t.WMTSStyle=t.Projection=t.Layer=t.S3MTilesCacheLayer=t.VideoLayer=t.TerrainCacheLayer=t.Cesium3DTilesCacheLayer=t.GeoJSONLayer=t.GraphicsLayer=t.GroupLayer=t.MapVLayer=t.EchartsLayer=t.SubLayer=t.ISSceneSubLayer=t.ISSceneLayer=t.FeatureFilter=t.IGSFeatureLayer=t.BaseScene=t.ISScene=t.Scene=t.IGSTileLayer=t.IGSSceneSubLayer=t.IGSSceneLayer=t.IGSMapImageSubLayer=t.IGSMapImageLayer=t.IGSVectorTileSubLayer=t.IGSVectorTileLayer=t.WMTSSubLayer=t.WFSLayer=t.WMSSubLayer=t.WMSLayer=t.WMTSLayer=t.ArcGISTileLayer=t.ArcGISMapImageSubLayer=t.M3DModelCacheLayer=t.ArcGISMapImageLayer=t.Basemap=t.Map=t.ArcGISVectorTileServer=t.ArcGISFeatureServer=t.ArcGISGeometryServer=t.ThemesInfo=t.ThemeServer=t.ItemValue=t.FolderInfoAttribute=t.FolderInfo=t.ExpInfo=t.CUniqueThemeInfo=t.CUniqueTheme=t.CThemeInfo=t.CTheme=t.CSimpleTheme=t.CRegInfo=t.CRangeThemeInfo=t.CRangeTheme=t.CRandomTheme=t.CPntInfo=t.CMultiClassTheme=t.CLinInfo=t.CGraduatedSymbolTheme=t.CFourColorTheme=t.CDotDensityTheme=t.CChartType=t.CChartThemeRepresentInfo=t.CChartThemeInfo=t.CChartTheme=t.CChartLabelFormat=t.CAnnInfo=t.CAllOtherDataItemInfoSource=t.ISSceneServer=t.ArcGISMapServer=t.WFSServer=t.WMTSServer=t.WMSServer=t.SceneServer=t.ResourceServer=t.PlotServer=t.VectorTileServer=t.TileServer=t.RootServer=t.SecurityServer=t.TerrainServer=t.PoiServer=t.Cesium3DTilesServer=t.AddressServer=t.GeometryServer=t.ImageServer=t.M3DServer=t.FeatureServer=t.MapServer=t.ResponseInterceptor=t.RequestInterceptor=t.FetchServer=void 0;var n=v(r(23)),i=v(r(245)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(35)),a=r(25),s=r(141),l=r(68),u=r(9),c=r(8),f=r(1),h=r(6),d=r(22),p=r(552),y=r(564),g=r(572);function v(e){return e&&e.__esModule?e:{default:e}}window.zondy={};var m=window.zondy;m.service={},m.geometry={},m.layer={},m.enum={},m.symbol={},m.widget={},m.tool={},m.renderer={},m.renderer.visualvariable={},m.themelayer={},m.util={},m.video={},m.LOGTYPE="warningAndError",m.VERSION="17.6.5",m.service.FetchServer=a.FetchServer,m.service.RequestInterceptor=a.RequestInterceptor,m.service.ResponseInterceptor=a.ResponseInterceptor,m.service.MapServer=a.MapServer,m.service.FeatureServer=a.FeatureServer,m.service.M3DServer=a.M3DServer,m.service.ImageServer=a.ImageServer,m.service.GeometryServer=a.GeometryServer,m.service.AddressServer=a.AddressServer,m.service.Cesium3DTilesServer=a.Cesium3DTilesServer,m.service.PoiServer=a.PoiServer,m.service.TerrainServer=a.TerrainServer,m.service.SecurityServer=a.SecurityServer,m.service.RootServer=a.RootServer,m.service.TileServer=a.TileServer,m.service.VectorTileServer=a.VectorTileServer,m.service.PlotServer=a.PlotServer,m.service.ResourceServer=a.ResourceServer,m.service.SceneServer=a.SceneServer,m.service.WMSServer=a.WMSServer,m.service.WMTSServer=a.WMTSServer,m.service.WFSServer=a.WFSServer,m.service.ArcGISMapServer=a.ArcGISMapServer,m.service.ThemeServer=a.ThemeServer,m.service.ArcGISGeometryServer=a.ArcGISGeometryServer,m.service.ArcGISFeatureServer=a.ArcGISFeatureServer,m.service.ArcGISVectorTileServer=a.ArcGISVectorTileServer,m.service.Config=a.Config,m.service.FetchRequest=a.FetchRequest,m.service.GeometryFilter=a.GeometryFilter,m.service.Interceptor=a.Interceptor,m.service.WorkFlowServer=a.WorkFlowServer,m.service.BaseServer=a.BaseServer,m.service.RequestConfig=a.RequestConfig,m.service.ISSceneServer=a.ISSceneServer,m.themelayer.CAllOtherDataItemInfoSource=a.CAllOtherDataItemInfoSource,m.themelayer.CAnnInfo=a.CAnnInfo,m.themelayer.CChartLabelFormat=a.CChartLabelFormat,m.themelayer.CChartTheme=a.CChartTheme,m.themelayer.CChartThemeInfo=a.CChartThemeInfo,m.themelayer.CChartThemeRepresentInfo=a.CChartThemeRepresentInfo,m.themelayer.CChartType=a.CChartType,m.themelayer.CDotDensityTheme=a.CDotDensityTheme,m.themelayer.CFourColorTheme=a.CFourColorTheme,m.themelayer.CGraduatedSymbolTheme=a.CGraduatedSymbolTheme,m.themelayer.CLinInfo=a.CLinInfo,m.themelayer.CMultiClassTheme=a.CMultiClassTheme,m.themelayer.CPntInfo=a.CPntInfo,m.themelayer.CRandomTheme=a.CRandomTheme,m.themelayer.CRangeTheme=a.CRangeTheme,m.themelayer.CRangeThemeInfo=a.CRangeThemeInfo,m.themelayer.CRegInfo=a.CRegInfo,m.themelayer.CSimpleTheme=a.CSimpleTheme,m.themelayer.CTheme=a.CTheme,m.themelayer.CThemeInfo=a.CThemeInfo,m.themelayer.CUniqueTheme=a.CUniqueTheme,m.themelayer.CUniqueThemeInfo=a.CUniqueThemeInfo,m.themelayer.ExpInfo=a.ExpInfo,m.themelayer.FolderInfo=a.FolderInfo,m.themelayer.FolderInfoAttribute=a.FolderInfoAttribute,m.themelayer.ItemValue=a.ItemValue,m.themelayer.ThemesInfo=a.ThemesInfo,m.layer.WMTSLayer=l.WMTSLayer,m.layer.WMSLayer=l.WMSLayer,m.layer.WMSSubLayer=l.WMSSubLayer,m.layer.WFSLayer=l.WFSLayer,m.layer.WMTSSubLayer=l.WMTSSubLayer,m.layer.VectorTileLayer=l.VectorTileLayer,m.layer.IGSVectorTileLayer=l.IGSVectorTileLayer,m.layer.IGSVectorTileSubLayer=l.IGSVectorTileSubLayer,m.layer.IGSMapImageLayer=l.IGSMapImageLayer,m.layer.IGSMapImageSubLayer=l.IGSMapImageSubLayer,m.layer.IGSSceneLayer=l.IGSSceneLayer,m.layer.IGSSceneSubLayer=l.IGSSceneSubLayer,m.layer.IGSTileLayer=l.IGSTileLayer,m.layer.Scene=l.Scene,m.layer.ISScene=l.ISScene,m.layer.BaseScene=l.BaseScene,m.layer.IGSFeatureLayer=l.IGSFeatureLayer,m.layer.FeatureFilter=l.FeatureFilter,m.layer.EchartsLayer=l.EchartsLayer,m.layer.MapVLayer=l.MapVLayer,m.layer.GroupLayer=l.GroupLayer,m.layer.GraphicsLayer=l.GraphicsLayer,m.layer.GeoJSONLayer=l.GeoJSONLayer,m.layer.Cesium3DTilesCacheLayer=l.Cesium3DTilesCacheLayer,m.layer.TerrainCacheLayer=l.TerrainCacheLayer,m.layer.VideoLayer=l.VideoLayer,m.layer.LabelClass=l.LabelClass,m.layer.ArcGISMapImageLayer=l.ArcGISMapImageLayer,m.layer.ArcGISMapImageSubLayer=l.ArcGISMapImageSubLayer,m.layer.M3DModelCacheLayer=l.M3DModelCacheLayer,m.layer.ArcGISTileLayer=l.ArcGISTileLayer,m.layer.Layer=l.Layer,m.layer.ArcGISVectorTileLayer=l.ArcGISVectorTileLayer,m.layer.WebTileLayer=l.WebTileLayer,m.layer.TileInfo=l.TileInfo,m.layer.LOD=l.LOD,m.layer.VoxelFilter=l.VoxelFilter,m.layer.TileLayer=l.TileLayer,m.layer.UnknownLayer=l.UnknownLayer,m.layer.OverlayLayer=l.OverlayLayer,m.layer.OGCLayer=l.OGCLayer,m.layer.ISSceneLayer=l.ISSceneLayer,m.layer.ISSceneSubLayer=l.ISSceneSubLayer,m.layer.SubLayer=l.SubLayer,m.layer.S3MTilesCacheLayer=l.S3MTilesCacheLayer,m.Map=l.Map,m.Basemap=l.Basemap,m.SpatialReference=u.SpatialReference,m.Color=c.Color,m.Collection=c.Collection,m.FeatureSet=c.FeatureSet,m.Feature=c.Feature,m.ElevationInfo=c.ElevationInfo,m.ProjectInfo=c.ProjectInfo,m.OutStatistic=c.OutStatistic,m.TileMatrixSet=c.TileMatrixSet,m.ProjectInfoBySrsID=c.ProjectInfoBySrsID,m.FeatureExpressionInfo=c.FeatureExpressionInfo,m.BaseView=p.BaseView,m.MapView=p.MapView,m.SceneView=p.SceneView,m.BaseFeatureLayerView=p.BaseFeatureLayerView,m.BaseRendererLayerView=p.BaseRendererLayerView,m.GroupLayerView=p.GroupLayerView,m.WMTSStyle=c.WMTSStyle,m.CAttDataRow=a.CAttDataRow,m.CAttStruct=a.CAttStruct,m.TimeExtent=c.TimeExtent,m.TimeInfo=c.TimeInfo,m.TimeInterval=c.TimeInterval,m.renderer.UniqueValueRenderer=l.UniqueValueRenderer,m.renderer.ClassBreakRenderer=l.ClassBreakRenderer,m.renderer.SimpleRenderer=l.SimpleRenderer,m.renderer.ClusterRenderer=l.ClusterRenderer,m.renderer.RandomRenderer=l.RandomRenderer,m.renderer.RankRenderer=l.RankRenderer,m.renderer.HeatmapRenderer=l.HeatmapRenderer,m.renderer.BaseRenderer=l.BaseRenderer,m.renderer.HeatmapColorStop=l.HeatmapColorStop,m.renderer.visualvariable.SizeVariable=l.SizeVariable,m.renderer.visualvariable.ColorVariable=l.ColorVariable,m.renderer.visualvariable.OpacityVariable=l.OpacityVariable,m.renderer.visualvariable.VisualVariable=l.VisualVariable,m.geometry.Extent=u.Extent,m.geometry.Polygon=u.Polygon,m.geometry.MultiPolygon=u.MultiPolygon,m.geometry.LineString=u.LineString,m.geometry.MultiLineString=u.MultiLineString,m.geometry.Point=u.Point,m.geometry.MultiPoint=u.MultiPoint,m.geometry.Circle=u.Circle,m.geometry.GeometryEngine=u.GeometryEngine,m.geometry.Geometry=u.Geometry,m.geometry.Projection=c.Projection,m.geometry.Proj4=i.default,m.geometry.T=o,m.enum.ReturnFormat=h.ReturnFormat,m.enum.FetchMethod=h.FetchMethod,m.enum.LayerEventType=h.LayerEventType,m.enum.MapEventType=h.MapEventType,m.enum.StatisticType=h.StatisticType,m.enum.SpatialRelation=h.SpatialRelation,m.enum.CustomWKID=h.CustomWKID,m.enum.LayerType=h.LayerType,m.enum.TokenAttachType=h.TokenAttachType,m.enum.IGSGeometryType=h.IGSGeometryType,m.enum.LogType=h.LogType,m.enum.LoadStatus=h.LoadStatus,m.enum.ViewEventType=h.ViewEventType,m.enum.LengthUnit=h.LengthUnit,m.enum.AngleUnit=h.AngleUnit,m.enum.RendererType=h.RendererType,m.enum.VectorTileGeometryType=h.VectorTileGeometryType,m.enum.VideoSourceType=h.VideoSourceType,m.enum.SketchDataType=h.SketchDataType,m.enum.SketchEditMode=h.SketchEditMode,m.enum.SketchEditorEventType=h.SketchEditorEventType,m.enum.SketchEditorState=h.SketchEditorState,m.enum.SketchEditorToolEventType=h.SketchEditorToolEventType,m.enum.IGSRendererType=h.IGSRendererType,m.enum.SymbolType=h.SymbolType,m.enum.IGSSymbolType=h.IGSSymbolType,m.enum.ElevationMode=h.ElevationMode,m.enum.HorizontalAlignment=h.HorizontalAlignment,m.enum.VerticalAlignment=h.VerticalAlignment,m.enum.SceneMode=h.SceneMode,m.enum.ShadowMode=h.ShadowMode,m.enum.UrlServerType=h.UrlServerType,m.enum.PictureFormat=h.PictureFormat,m.enum.RadiusUnit=h.RadiusUnit,m.enum.WMTSCorporation=h.WMTSCorporation,m.enum.Symbol3DLayerType=h.Symbol3DLayerType,m.enum.LineCapType=h.LineCapType,m.enum.LineJoinType=h.LineJoinType,m.enum.LineMarkerPlacement=h.LineMarkerPlacement,m.enum.LineMarkerStyle=h.LineMarkerStyle,m.enum.LinePatternStyle=h.LinePatternStyle,m.enum.AnchorType=h.AnchorType,m.enum.ProfileType=h.ProfileType,m.enum.PatternStyle=h.PatternStyle,m.enum.WaterbodySize=h.WaterbodySize,m.enum.WaveStrength=h.WaveStrength,m.enum.MaterialType=h.MaterialType,m.enum.LinearUnits=h.LinearUnits,m.enum.AreaUnits=h.AreaUnits,m.enum.ArcType=h.ArcType,m.enum.SceneSubLayerType=h.SceneSubLayerType,m.enum.ColorNameToHexMap=h.ColorNameToHexMap,m.enum.SeverVectorTileSubLayerType=h.SeverVectorTileSubLayerType,m.enum.GeometryType=h.GeometryType,m.enum.VisualVariableType=h.VisualVariableType,m.enum.TDTLayerType=h.TDTLayerType,m.enum.TileSliceType=h.TileSliceType,m.enum.TemporalUnit=h.TemporalUnit,m.enum.NormalizationType=h.NormalizationType,m.util.formatBaseUrl=a.formatBaseUrl,m.util.ServiceConfigToken=a.ServiceConfigToken,m.util.ServiceConfigRequestInterceptors=a.ServiceConfigRequestInterceptors,m.util.convertIGSClippingString=a.convertIGSClippingString,m.util.getUrlType=l.getUrlType,m.util.is4326=l.is4326,m.util.isCustomSP=l.isCustomSP,m.util.showLayerByScale=l.showLayerByScale,m.util.getIGSDynamicLayer=l.getIGSDynamicLayer,m.util.setElevationInfo=l.setElevationInfo,m.util.TileInfoUtil=l.TileInfoUtil,m.util.getZoomOffset=l.getZoomOffset,m.util.appendUrlParams=l.appendUrlParams,m.util.getFullBaseUrl=l.getFullBaseUrl,m.util.editFeatureByArc3=u.editFeatureByArc3,m.util.editGeometryByArc3=u.editGeometryByArc3,m.util.CoordnateTransform=c.CoordnateTransform,m.util.getFeaturesFromFeatureSet=c.getFeaturesFromFeatureSet,m.util.EPSG=c.EPSG,m.util.extend=f.extend,m.util.isArray=f.isArray,m.util.isNumber=f.isNumber,m.util.isInTheSameDomain=f.isInTheSameDomain,m.util.transformResult=f.transformResult,m.util.urlAppend=f.urlAppend,m.util.getParameterString=f.getParameterString,m.util.bind=f.bind,m.util.getGUID=f.getGUID,m.util.defaultValue=f.defaultValue,m.util.defined=f.defined,m.util.normalize=f.normalize,m.util.createGeometry=f.createGeometry,m.util.isNull=f.isNull,m.util.getGeometryParameter=f.getGeometryParameter,m.util.getOutStatisticsParameter=f.getOutStatisticsParameter,m.util.Log=f.Log,m.util.isString=f.isString,m.util.deepClone=f.deepClone,m.util.isBoolean=f.isBoolean,m.util.extendDeep=f.extendDeep,m.util.newGuid=f.newGuid,m.util.formatPoints=f.formatPoints,m.util.returnPoint=f.returnPoint,m.util.cloneObject=f.cloneObject,m.util.notNULL=f.notNULL,m.util.isObject=f.isObject,m.util.getVideoType=f.getVideoType,m.util.toJSON=f.toJSON,m.util.getBaseUrl=f.getBaseUrl,m.util.inputCss=f.inputCss,m.util.getProjectionSrs=f.getProjectionSrs,m.util.isWMSReverse=f.isWMSReverse,m.util.convertImageSourceToBase64=f.convertImageSourceToBase64,m.util.throttle=f.throttle,m.util.compareObject=f.compareObject,m.util.debouncePromise=f.debouncePromise,m.util.inOrderPromise=f.inOrderPromise,m.util.allSettled=f.allSettled,m.util.ExpressionParser=f.ExpressionParser,m.util.RendererUtil=p.RendererUtil,m.util.createSimpleMarkerSymbolCanvas=g.createSimpleMarkerSymbolCanvas,m.util.createSimpleFillSymbolCanvas=g.createSimpleFillSymbolCanvas,m.util.getValidLayers=s.getValidLayers,m.util.getLayerViewsGeographicExtent=s.getLayerViewsGeographicExtent,m.util.getCrsOptions=s.getCrsOptions,m.util.getLayersExtent=s.getLayersExtent,m.util.getFunctionArguments=f.getFunctionArguments,m.util.deleteNullValue=f.deleteNullValue,m.util.ServerUtil=a.ServerUtil,m.util.UrlUtil=a.UrlUtil,m.util.BaseRegExp=a.BaseRegExp,m.util.ServerBaseUrlRegExp=a.ServerBaseUrlRegExp,m.util.LayerBaseUrlRegExp=a.LayerBaseUrlRegExp,m.symbol.SimpleFillSymbol=d.SimpleFillSymbol,m.symbol.SimpleLineSymbol=d.SimpleLineSymbol,m.symbol.SimpleMarkerSymbol=d.SimpleMarkerSymbol,m.symbol.TextSymbol=d.TextSymbol,m.symbol.Symbol=d.Symbol,m.symbol.PictureMarkerSymbol=d.PictureMarkerSymbol,m.symbol.PictureFillSymbol=d.PictureFillSymbol,m.symbol.MapGISTextSymbol=d.MapGISTextSymbol,m.symbol.Symbol3D=d.Symbol3D,m.symbol.LabelSymbol3D=d.LabelSymbol3D,m.symbol.LineSymbol3D=d.LineSymbol3D,m.symbol.PointSymbol3D=d.PointSymbol3D,m.symbol.PolygonSymbol3D=d.PolygonSymbol3D,m.symbol.LineCallout3D=d.LineCallout3D,m.symbol.Callout3D=d.Callout3D,m.symbol.Symbol3DVerticalOffset=d.Symbol3DVerticalOffset,m.symbol.Symbol3DLayer=d.Symbol3DLayer,m.symbol.LineStyleMarker3D=d.LineStyleMarker3D,m.symbol.LineStylePattern3D=d.LineStylePattern3D,m.symbol.LineSymbol3DLayer=d.LineSymbol3DLayer,m.symbol.PathSymbol3DLayer=d.PathSymbol3DLayer,m.symbol.FillSymbol3DLayer=d.FillSymbol3DLayer,m.symbol.FillSymbol3DOutline=d.FillSymbol3DOutline,m.symbol.IconSymbol3DLayer=d.IconSymbol3DLayer,m.symbol.PointSymbol3DOutline=d.PointSymbol3DOutline,m.symbol.IconResource=d.IconResource,m.symbol.ObjectSymbol3DLayer=d.ObjectSymbol3DLayer,m.symbol.ExtrudeSymbol3DLayer=d.ExtrudeSymbol3DLayer,m.symbol.Edges3D=d.Edges3D,m.symbol.TextSymbol3DLayer=d.TextSymbol3DLayer,m.symbol.TextHalo=d.TextHalo,m.symbol.WaterSymbol3DLayer=d.WaterSymbol3DLayer,m.symbol.ColorMaterial=d.ColorMaterial,m.symbol.StylePattern3D=d.StylePattern3D,m.symbol.Font=c.Font,m.tool.sketch={},m.tool.sketch.SketchStyle=y.SketchStyle,m.tool.sketch.SketchEditorEvent=y.SketchEditorEvent,m.tool.sketch.SketchEditor=y.SketchEditor,m.tool.sketch.SketchEditor3D=y.SketchEditor3D,m.tool.sketch.SketchBaseDrawTool=y.SketchBaseDrawTool,m.tool.sketch.SketchPointDrawTool=y.SketchPointDrawTool,m.tool.sketch.SketchPolylineDrawTool=y.SketchPolylineDrawTool,m.tool.sketch.SketchPolygonDrawTool=y.SketchPolygonDrawTool,m.tool.sketch.SketchCircleDrawTool=y.SketchCircleDrawTool,m.tool.sketch.SketchExtentDrawTool=y.SketchExtentDrawTool,m.tool.sketch.SketchFreehandPolylineDrawTool=y.SketchFreehandPolylineDrawTool,m.tool.sketch.SketchFreehandPolygonDrawTool=y.SketchFreehandPolygonDrawTool,window.Zondy={};var _=window.Zondy;_.Service=m.service,_.Geometry=m.geometry,_.Layer=m.layer,_.Enum=m.enum,_.Symbol=m.symbol,_.Widget=m.widget,_.Tool={},_.Tool.Sketch=m.widget.sketch,_.Renderer={},(0,n.default)(m.renderer).forEach(function(e){"visualvariable"!==e&&(_.Renderer[e]=m.renderer[e])}),_.Renderer.VisualVariable=m.renderer.visualvariable,_.Object={},_.Object.Theme={},_.Object.Theme.CAllOtherDataItemInfoSource=a.CAllOtherDataItemInfoSource,_.Object.Theme.CAnnInfo=a.CAnnInfo,_.Object.Theme.CChartLabelFormat=a.CChartLabelFormat,_.Object.Theme.CChartTheme=a.CChartTheme,_.Object.Theme.CChartThemeInfo=a.CChartThemeInfo,_.Object.Theme.CChartThemeRepresentInfo=a.CChartThemeRepresentInfo,_.Object.Theme.CChartType=a.CChartType,_.Object.Theme.CDotDensityTheme=a.CDotDensityTheme,_.Object.Theme.CFourColorTheme=a.CFourColorTheme,_.Object.Theme.CGraduatedSymbolTheme=a.CGraduatedSymbolTheme,_.Object.Theme.CLinInfo=a.CLinInfo,_.Object.Theme.CMultiClassTheme=a.CMultiClassTheme,_.Object.Theme.CPntInfo=a.CPntInfo,_.Object.Theme.CRandomTheme=a.CRandomTheme,_.Object.Theme.CRangeTheme=a.CRangeTheme,_.Object.Theme.CRangeThemeInfo=a.CRangeThemeInfo,_.Object.Theme.CRegInfo=a.CRegInfo,_.Object.Theme.CSimpleTheme=a.CSimpleTheme,_.Object.Theme.CTheme=a.CTheme,_.Object.Theme.CThemeInfo=a.CThemeInfo,_.Object.Theme.CUniqueTheme=a.CUniqueTheme,_.Object.Theme.CUniqueThemeInfo=a.CUniqueThemeInfo,_.Object.Theme.ExpInfo=a.ExpInfo,_.Object.Theme.FolderInfo=a.FolderInfo,_.Object.Theme.FolderInfoAttribute=a.FolderInfoAttribute,_.Object.Theme.ItemValue=a.ItemValue,_.Object.Theme.ThemesInfo=a.ThemesInfo,_.Object.CAttDataRow=a.CAttDataRow,_.Object.CAttStruct=a.CAttStruct,_.Utils=m.util,_.Map=l.Map,_.Basemap=l.Basemap,_.SpatialReference=u.SpatialReference,_.Color=c.Color,_.Font=c.Font,_.Collection=c.Collection,_.FeatureSet=c.FeatureSet,_.Feature=c.Feature,_.ElevationInfo=c.ElevationInfo,_.ProjectInfo=c.ProjectInfo,_.OutStatistic=c.OutStatistic,_.TileMatrixSet=c.TileMatrixSet,_.ProjectInfoBySrsID=c.ProjectInfoBySrsID,_.FeatureExpressionInfo=c.FeatureExpressionInfo,_.BaseView=p.BaseView,_.MapView=p.MapView,_.SceneView=p.SceneView,_.BaseFeatureLayerView=p.BaseFeatureLayerView,_.BaseRendererLayerView=p.BaseRendererLayerView,_.GroupLayerView=p.GroupLayerView,_.WMTSStyle=c.WMTSStyle,_.SketchPolygonDrawTool=y.SketchPolygonDrawTool,_.SketchStyle=y.SketchStyle,_.LogType=m.LOGTYPE,_.Version=m.VERSION;var S={FetchServer:a.FetchServer,RequestInterceptor:a.RequestInterceptor,ResponseInterceptor:a.ResponseInterceptor,MapServer:a.MapServer,FeatureServer:a.FeatureServer,M3DServer:a.M3DServer,ImageServer:a.ImageServer,GeometryServer:a.GeometryServer,AddressServer:a.AddressServer,Cesium3DTilesServer:a.Cesium3DTilesServer,PoiServer:a.PoiServer,TerrainServer:a.TerrainServer,SecurityServer:a.SecurityServer,RootServer:a.RootServer,TileServer:a.TileServer,VectorTileServer:a.VectorTileServer,PlotServer:a.PlotServer,ResourceServer:a.ResourceServer,SceneServer:a.SceneServer,WMSServer:a.WMSServer,WMTSServer:a.WMTSServer,WFSServer:a.WFSServer,ArcGISMapServer:a.ArcGISMapServer,ISSceneServer:a.ISSceneServer,CAllOtherDataItemInfoSource:a.CAllOtherDataItemInfoSource,CAnnInfo:a.CAnnInfo,CChartLabelFormat:a.CChartLabelFormat,CChartTheme:a.CChartTheme,CChartThemeInfo:a.CChartThemeInfo,CChartThemeRepresentInfo:a.CChartThemeRepresentInfo,CChartType:a.CChartType,CDotDensityTheme:a.CDotDensityTheme,CFourColorTheme:a.CFourColorTheme,CGraduatedSymbolTheme:a.CGraduatedSymbolTheme,CLinInfo:a.CLinInfo,CMultiClassTheme:a.CMultiClassTheme,CPntInfo:a.CPntInfo,CRandomTheme:a.CRandomTheme,CRangeTheme:a.CRangeTheme,CRangeThemeInfo:a.CRangeThemeInfo,CRegInfo:a.CRegInfo,CSimpleTheme:a.CSimpleTheme,CTheme:a.CTheme,CThemeInfo:a.CThemeInfo,CUniqueTheme:a.CUniqueTheme,CUniqueThemeInfo:a.CUniqueThemeInfo,ExpInfo:a.ExpInfo,FolderInfo:a.FolderInfo,FolderInfoAttribute:a.FolderInfoAttribute,ItemValue:a.ItemValue,ThemeServer:a.ThemeServer,ThemesInfo:a.ThemesInfo,ArcGISGeometryServer:a.ArcGISGeometryServer,ArcGISFeatureServer:a.ArcGISFeatureServer,ArcGISVectorTileServer:a.ArcGISVectorTileServer,Map:l.Map,Basemap:l.Basemap,ArcGISMapImageLayer:l.ArcGISMapImageLayer,M3DModelCacheLayer:l.M3DModelCacheLayer,ArcGISMapImageSubLayer:l.ArcGISMapImageSubLayer,ArcGISTileLayer:l.ArcGISTileLayer,WMTSLayer:l.WMTSLayer,WMSLayer:l.WMSLayer,WMSSubLayer:l.WMSSubLayer,WFSLayer:l.WFSLayer,WMTSSubLayer:l.WMTSSubLayer,IGSVectorTileLayer:l.IGSVectorTileLayer,IGSVectorTileSubLayer:l.IGSVectorTileSubLayer,IGSMapImageLayer:l.IGSMapImageLayer,IGSMapImageSubLayer:l.IGSMapImageSubLayer,IGSSceneLayer:l.IGSSceneLayer,IGSSceneSubLayer:l.IGSSceneSubLayer,IGSTileLayer:l.IGSTileLayer,Scene:l.Scene,ISScene:l.ISScene,BaseScene:l.BaseScene,IGSFeatureLayer:l.IGSFeatureLayer,FeatureFilter:l.FeatureFilter,ISSceneLayer:l.ISSceneLayer,ISSceneSubLayer:l.ISSceneSubLayer,SubLayer:l.SubLayer,EchartsLayer:l.EchartsLayer,MapVLayer:l.MapVLayer,GroupLayer:l.GroupLayer,GraphicsLayer:l.GraphicsLayer,GeoJSONLayer:l.GeoJSONLayer,Cesium3DTilesCacheLayer:l.Cesium3DTilesCacheLayer,TerrainCacheLayer:l.TerrainCacheLayer,VideoLayer:l.VideoLayer,S3MTilesCacheLayer:l.S3MTilesCacheLayer,Layer:l.Layer,Projection:c.Projection,WMTSStyle:c.WMTSStyle,CoordnateTransform:c.CoordnateTransform,SketchEditor:y.SketchEditor,SketchEditor3D:y.SketchEditor3D,SketchBaseDrawTool:y.SketchBaseDrawTool,SketchPointDrawTool:y.SketchPointDrawTool,SketchPolylineDrawTool:y.SketchPolylineDrawTool,SketchPolygonDrawTool:y.SketchPolygonDrawTool,SketchCircleDrawTool:y.SketchCircleDrawTool,SketchExtentDrawTool:y.SketchExtentDrawTool,SketchFreehandPolylineDrawTool:y.SketchFreehandPolylineDrawTool,SketchFreehandPolygonDrawTool:y.SketchFreehandPolygonDrawTool,SketchStyle:y.SketchStyle,SketchEditorEvent:y.SketchEditorEvent,Extent:u.Extent,Polygon:u.Polygon,LineString:u.LineString,Point:u.Point,Circle:u.Circle,MultiPolygon:u.MultiPolygon,MultiLineString:u.MultiLineString,MultiPoint:u.MultiPoint,GeometryEngine:u.GeometryEngine,Color:c.Color,Font:c.Font,LayerEvent:c.LayerEvent,Event:c.Event,Zondy:_,zondy:m,Evented:c.Evented,FeatureRender:c.FeatureRender,ErrorEvent:c.ErrorEvent,Collection:c.Collection,FeatureSet:c.FeatureSet,Feature:c.Feature,getFeaturesFromFeatureSet:c.getFeaturesFromFeatureSet,ReturnFormat:h.ReturnFormat,FetchMethod:h.FetchMethod,LayerEventType:h.LayerEventType,MapEventType:h.MapEventType,StatisticType:h.StatisticType,SpatialRelation:h.SpatialRelation,CustomWKID:h.CustomWKID,GeometryType:h.GeometryType,LayerType:h.LayerType,TokenAttachType:h.TokenAttachType,IGSGeometryType:h.IGSGeometryType,LogType:h.LogType,LoadStatus:h.LoadStatus,ViewEventType:h.ViewEventType,LengthUnit:h.LengthUnit,AngleUnit:h.AngleUnit,RendererType:h.RendererType,VectorTileGeometryType:h.VectorTileGeometryType,VideoSourceType:h.VideoSourceType,SketchDataType:h.SketchDataType,SketchEditMode:h.SketchEditMode,SketchEditorEventType:h.SketchEditorEventType,SketchEditorState:h.SketchEditorState,SketchEditorToolEventType:h.SketchEditorToolEventType,IGSRendererType:h.IGSRendererType,SymbolType:h.SymbolType,IGSSymbolType:h.IGSSymbolType,ElevationMode:h.ElevationMode,ElevationInfo:c.ElevationInfo,ProjectInfo:c.ProjectInfo,OutStatistic:c.OutStatistic,TileMatrixSet:c.TileMatrixSet,ProjectInfoBySrsID:c.ProjectInfoBySrsID,FeatureExpressionInfo:c.FeatureExpressionInfo,HorizontalAlignment:h.HorizontalAlignment,VerticalAlignment:h.VerticalAlignment,SceneMode:h.SceneMode,ShadowMode:h.ShadowMode,SimpleFillSymbol:d.SimpleFillSymbol,SimpleLineSymbol:d.SimpleLineSymbol,SimpleMarkerSymbol:d.SimpleMarkerSymbol,TextSymbol:d.TextSymbol,Symbol:d.Symbol,PictureMarkerSymbol:d.PictureMarkerSymbol,PictureFillSymbol:d.PictureFillSymbol,MapGISTextSymbol:d.MapGISTextSymbol,UniqueValueRenderer:l.UniqueValueRenderer,ClassBreakRenderer:l.ClassBreakRenderer,SimpleRenderer:l.SimpleRenderer,ClusterRenderer:l.ClusterRenderer,RandomRenderer:l.RandomRenderer,RankRenderer:l.RankRenderer,HeatmapRenderer:l.HeatmapRenderer,BaseRenderer:l.BaseRenderer,getIGSDynamicLayer:l.getIGSDynamicLayer,extend:f.extend,isArray:f.isArray,isNumber:f.isNumber,isInTheSameDomain:f.isInTheSameDomain,transformResult:f.transformResult,urlAppend:f.urlAppend,getParameterString:f.getParameterString,bind:f.bind,getGUID:f.getGUID,defaultValue:f.defaultValue,defined:f.defined,normalize:f.normalize,createGeometry:f.createGeometry,isNull:f.isNull,getGeometryParameter:f.getGeometryParameter,getOutStatisticsParameter:f.getOutStatisticsParameter,Log:f.Log,isString:f.isString,deepClone:f.deepClone,isBoolean:f.isBoolean,extendDeep:f.extendDeep,newGuid:f.newGuid,formatPoints:f.formatPoints,returnPoint:f.returnPoint,cloneObject:f.cloneObject,notNULL:f.notNULL,isObject:f.isObject,getVideoType:f.getVideoType,toJSON:f.toJSON,getBaseUrl:f.getBaseUrl,inputCss:f.inputCss,BaseView:p.BaseView,MapView:p.MapView,SceneView:p.SceneView,BaseGraphicsLayerView:p.BaseGraphicsLayerView,BaseRendererLayerView:p.BaseRendererLayerView,GroupLayerView:p.GroupLayerView,LayerView:p.LayerView,SpatialReference:u.SpatialReference,UrlServerType:h.UrlServerType,PictureFormat:h.PictureFormat,getUrlType:l.getUrlType,is4326:l.is4326,isCustomSP:l.isCustomSP,EPSG:c.EPSG,proj4:i.default,T:o,showLayerByScale:l.showLayerByScale,formatBaseUrl:a.formatBaseUrl,RadiusUnit:h.RadiusUnit,Geometry:u.Geometry,editFeatureByArc3:u.editFeatureByArc3,editGeometryByArc3:u.editGeometryByArc3,Config:a.Config,ServiceConfigToken:a.ServiceConfigToken,ServiceConfigRequestInterceptors:a.ServiceConfigRequestInterceptors,createSimpleMarkerSymbolCanvas:g.createSimpleMarkerSymbolCanvas,createSimpleFillSymbolCanvas:g.createSimpleFillSymbolCanvas,BaseFeatureLayerView:p.BaseFeatureLayerView,TileInfoUtil:l.TileInfoUtil,WMTSCorporation:h.WMTSCorporation,setElevationInfo:l.setElevationInfo,LabelClass:l.LabelClass,HeatmapColorStop:l.HeatmapColorStop,SizeVariable:l.SizeVariable,ColorVariable:l.ColorVariable,OpacityVariable:l.OpacityVariable,VisualVariable:l.VisualVariable,RendererUtil:p.RendererUtil,Symbol3D:d.Symbol3D,LabelSymbol3D:d.LabelSymbol3D,LineSymbol3D:d.LineSymbol3D,PointSymbol3D:d.PointSymbol3D,PolygonSymbol3D:d.PolygonSymbol3D,LineCallout3D:d.LineCallout3D,Callout3D:d.Callout3D,Symbol3DVerticalOffset:d.Symbol3DVerticalOffset,Symbol3DLayer:d.Symbol3DLayer,Symbol3DLayerType:h.Symbol3DLayerType,LineCapType:h.LineCapType,LineJoinType:h.LineJoinType,LineMarkerPlacement:h.LineMarkerPlacement,LineMarkerStyle:h.LineMarkerStyle,LineStyleMarker3D:d.LineStyleMarker3D,LinePatternStyle:h.LinePatternStyle,LineStylePattern3D:d.LineStylePattern3D,LineSymbol3DLayer:d.LineSymbol3DLayer,PathSymbol3DLayer:d.PathSymbol3DLayer,AnchorType:h.AnchorType,ProfileType:h.ProfileType,FillSymbol3DLayer:d.FillSymbol3DLayer,FillSymbol3DOutline:d.FillSymbol3DOutline,PatternStyle:h.PatternStyle,IconSymbol3DLayer:d.IconSymbol3DLayer,PointSymbol3DOutline:d.PointSymbol3DOutline,IconResource:d.IconResource,ObjectSymbol3DLayer:d.ObjectSymbol3DLayer,ExtrudeSymbol3DLayer:d.ExtrudeSymbol3DLayer,Edges3D:d.Edges3D,TextSymbol3DLayer:d.TextSymbol3DLayer,TextHalo:d.TextHalo,WaterSymbol3DLayer:d.WaterSymbol3DLayer,WaterbodySize:h.WaterbodySize,WaveStrength:h.WaveStrength,MaterialType:h.MaterialType,ColorMaterial:d.ColorMaterial,StylePattern3D:d.StylePattern3D,ArcGISVectorTileLayer:l.ArcGISVectorTileLayer,WebTileLayer:l.WebTileLayer,getZoomOffset:l.getZoomOffset,FeatureCollection:l.FeatureCollection,CAttDataRow:a.CAttDataRow,CAttStruct:a.CAttStruct,Interceptor:a.Interceptor,WorkFlowServer:a.WorkFlowServer,TileLayer:l.TileLayer,BaseServer:a.BaseServer,RequestConfig:a.RequestConfig,OverlayLayer:l.OverlayLayer,OGCLayer:l.OGCLayer,UnknownLayer:l.UnknownLayer,getProjectionSrs:f.getProjectionSrs,isWMSReverse:f.isWMSReverse,convertImageSourceToBase64:f.convertImageSourceToBase64,throttle:f.throttle,compareObject:f.compareObject,debouncePromise:f.debouncePromise,inOrderPromise:f.inOrderPromise,allSettled:f.allSettled,LinearUnits:h.LinearUnits,AreaUnits:h.AreaUnits,ArcType:h.ArcType,FetchRequest:a.FetchRequest,TileInfo:l.TileInfo,appendUrlParams:l.appendUrlParams,getFullBaseUrl:l.getFullBaseUrl,LOD:l.LOD,VoxelFilter:l.VoxelFilter,SceneSubLayerType:h.SceneSubLayerType,VectorTileLayer:l.VectorTileLayer,SeverVectorTileSubLayerType:h.SeverVectorTileSubLayerType,ExpressionParser:f.ExpressionParser,VisualVariableType:h.VisualVariableType,TDTLayerType:h.TDTLayerType,TileSliceType:h.TileSliceType,getValidLayers:s.getValidLayers,getLayerViewsGeographicExtent:s.getLayerViewsGeographicExtent,getCrsOptions:s.getCrsOptions,getLayersExtent:s.getLayersExtent,TemporalUnit:h.TemporalUnit,NormalizationType:h.NormalizationType,TimeExtent:c.TimeExtent,TimeInfo:c.TimeInfo,TimeInterval:c.TimeInterval,getFunctionArguments:f.getFunctionArguments,UrlUtil:a.UrlUtil,ServerUtil:a.ServerUtil,deleteNullValue:f.deleteNullValue,BaseRegExp:a.BaseRegExp,ServerBaseUrlRegExp:a.ServerBaseUrlRegExp,LayerBaseUrlRegExp:a.LayerBaseUrlRegExp};window.MapGISCommon=S,t.FetchServer=a.FetchServer,t.RequestInterceptor=a.RequestInterceptor,t.ResponseInterceptor=a.ResponseInterceptor,t.MapServer=a.MapServer,t.FeatureServer=a.FeatureServer,t.M3DServer=a.M3DServer,t.ImageServer=a.ImageServer,t.GeometryServer=a.GeometryServer,t.AddressServer=a.AddressServer,t.Cesium3DTilesServer=a.Cesium3DTilesServer,t.PoiServer=a.PoiServer,t.TerrainServer=a.TerrainServer,t.SecurityServer=a.SecurityServer,t.RootServer=a.RootServer,t.TileServer=a.TileServer,t.VectorTileServer=a.VectorTileServer,t.PlotServer=a.PlotServer,t.ResourceServer=a.ResourceServer,t.SceneServer=a.SceneServer,t.WMSServer=a.WMSServer,t.WMTSServer=a.WMTSServer,t.WFSServer=a.WFSServer,t.ArcGISMapServer=a.ArcGISMapServer,t.ISSceneServer=a.ISSceneServer,t.CAllOtherDataItemInfoSource=a.CAllOtherDataItemInfoSource,t.CAnnInfo=a.CAnnInfo,t.CChartLabelFormat=a.CChartLabelFormat,t.CChartTheme=a.CChartTheme,t.CChartThemeInfo=a.CChartThemeInfo,t.CChartThemeRepresentInfo=a.CChartThemeRepresentInfo,t.CChartType=a.CChartType,t.CDotDensityTheme=a.CDotDensityTheme,t.CFourColorTheme=a.CFourColorTheme,t.CGraduatedSymbolTheme=a.CGraduatedSymbolTheme,t.CLinInfo=a.CLinInfo,t.CMultiClassTheme=a.CMultiClassTheme,t.CPntInfo=a.CPntInfo,t.CRandomTheme=a.CRandomTheme,t.CRangeTheme=a.CRangeTheme,t.CRangeThemeInfo=a.CRangeThemeInfo,t.CRegInfo=a.CRegInfo,t.CSimpleTheme=a.CSimpleTheme,t.CTheme=a.CTheme,t.CThemeInfo=a.CThemeInfo,t.CUniqueTheme=a.CUniqueTheme,t.CUniqueThemeInfo=a.CUniqueThemeInfo,t.ExpInfo=a.ExpInfo,t.FolderInfo=a.FolderInfo,t.FolderInfoAttribute=a.FolderInfoAttribute,t.ItemValue=a.ItemValue,t.ThemeServer=a.ThemeServer,t.ThemesInfo=a.ThemesInfo,t.ArcGISGeometryServer=a.ArcGISGeometryServer,t.ArcGISFeatureServer=a.ArcGISFeatureServer,t.ArcGISVectorTileServer=a.ArcGISVectorTileServer,t.Map=l.Map,t.Basemap=l.Basemap,t.ArcGISMapImageLayer=l.ArcGISMapImageLayer,t.M3DModelCacheLayer=l.M3DModelCacheLayer,t.ArcGISMapImageSubLayer=l.ArcGISMapImageSubLayer,t.ArcGISTileLayer=l.ArcGISTileLayer,t.WMTSLayer=l.WMTSLayer,t.WMSLayer=l.WMSLayer,t.WMSSubLayer=l.WMSSubLayer,t.WFSLayer=l.WFSLayer,t.WMTSSubLayer=l.WMTSSubLayer,t.IGSVectorTileLayer=l.IGSVectorTileLayer,t.IGSVectorTileSubLayer=l.IGSVectorTileSubLayer,t.IGSMapImageLayer=l.IGSMapImageLayer,t.IGSMapImageSubLayer=l.IGSMapImageSubLayer,t.IGSSceneLayer=l.IGSSceneLayer,t.IGSSceneSubLayer=l.IGSSceneSubLayer,t.IGSTileLayer=l.IGSTileLayer,t.Scene=l.Scene,t.ISScene=l.ISScene,t.BaseScene=l.BaseScene,t.IGSFeatureLayer=l.IGSFeatureLayer,t.FeatureFilter=l.FeatureFilter,t.ISSceneLayer=l.ISSceneLayer,t.ISSceneSubLayer=l.ISSceneSubLayer,t.SubLayer=l.SubLayer,t.EchartsLayer=l.EchartsLayer,t.MapVLayer=l.MapVLayer,t.GroupLayer=l.GroupLayer,t.GraphicsLayer=l.GraphicsLayer,t.GeoJSONLayer=l.GeoJSONLayer,t.Cesium3DTilesCacheLayer=l.Cesium3DTilesCacheLayer,t.TerrainCacheLayer=l.TerrainCacheLayer,t.VideoLayer=l.VideoLayer,t.S3MTilesCacheLayer=l.S3MTilesCacheLayer,t.Layer=l.Layer,t.Projection=c.Projection,t.WMTSStyle=c.WMTSStyle,t.CoordnateTransform=c.CoordnateTransform,t.SketchEditor=y.SketchEditor,t.SketchEditor3D=y.SketchEditor3D,t.SketchBaseDrawTool=y.SketchBaseDrawTool,t.SketchPointDrawTool=y.SketchPointDrawTool,t.SketchPolylineDrawTool=y.SketchPolylineDrawTool,t.SketchPolygonDrawTool=y.SketchPolygonDrawTool,t.SketchCircleDrawTool=y.SketchCircleDrawTool,t.SketchExtentDrawTool=y.SketchExtentDrawTool,t.SketchFreehandPolylineDrawTool=y.SketchFreehandPolylineDrawTool,t.SketchFreehandPolygonDrawTool=y.SketchFreehandPolygonDrawTool,t.SketchStyle=y.SketchStyle,t.SketchEditorEvent=y.SketchEditorEvent,t.Extent=u.Extent,t.Polygon=u.Polygon,t.LineString=u.LineString,t.Point=u.Point,t.Circle=u.Circle,t.MultiPolygon=u.MultiPolygon,t.MultiLineString=u.MultiLineString,t.MultiPoint=u.MultiPoint,t.GeometryEngine=u.GeometryEngine,t.Color=c.Color,t.Font=c.Font,t.LayerEvent=c.LayerEvent,t.Event=c.Event,t.Zondy=_,t.zondy=m,t.Evented=c.Evented,t.FeatureRender=c.FeatureRender,t.ErrorEvent=c.ErrorEvent,t.Collection=c.Collection,t.FeatureSet=c.FeatureSet,t.Feature=c.Feature,t.getFeaturesFromFeatureSet=c.getFeaturesFromFeatureSet,t.ReturnFormat=h.ReturnFormat,t.FetchMethod=h.FetchMethod,t.LayerEventType=h.LayerEventType,t.MapEventType=h.MapEventType,t.StatisticType=h.StatisticType,t.SpatialRelation=h.SpatialRelation,t.CustomWKID=h.CustomWKID,t.GeometryType=h.GeometryType,t.LayerType=h.LayerType,t.TokenAttachType=h.TokenAttachType,t.IGSGeometryType=h.IGSGeometryType,t.LogType=h.LogType,t.LoadStatus=h.LoadStatus,t.ViewEventType=h.ViewEventType,t.LengthUnit=h.LengthUnit,t.AngleUnit=h.AngleUnit,t.RendererType=h.RendererType,t.VectorTileGeometryType=h.VectorTileGeometryType,t.VideoSourceType=h.VideoSourceType,t.SketchDataType=h.SketchDataType,t.SketchEditMode=h.SketchEditMode,t.SketchEditorEventType=h.SketchEditorEventType,t.SketchEditorState=h.SketchEditorState,t.SketchEditorToolEventType=h.SketchEditorToolEventType,t.IGSRendererType=h.IGSRendererType,t.SymbolType=h.SymbolType,t.IGSSymbolType=h.IGSSymbolType,t.ElevationMode=h.ElevationMode,t.ElevationInfo=c.ElevationInfo,t.ProjectInfo=c.ProjectInfo,t.OutStatistic=c.OutStatistic,t.TileMatrixSet=c.TileMatrixSet,t.ProjectInfoBySrsID=c.ProjectInfoBySrsID,t.FeatureExpressionInfo=c.FeatureExpressionInfo,t.HorizontalAlignment=h.HorizontalAlignment,t.VerticalAlignment=h.VerticalAlignment,t.SceneMode=h.SceneMode,t.ShadowMode=h.ShadowMode,t.SimpleFillSymbol=d.SimpleFillSymbol,t.SimpleLineSymbol=d.SimpleLineSymbol,t.SimpleMarkerSymbol=d.SimpleMarkerSymbol,t.TextSymbol=d.TextSymbol,t.Symbol=d.Symbol,t.PictureMarkerSymbol=d.PictureMarkerSymbol,t.PictureFillSymbol=d.PictureFillSymbol,t.MapGISTextSymbol=d.MapGISTextSymbol,t.UniqueValueRenderer=l.UniqueValueRenderer,t.ClassBreakRenderer=l.ClassBreakRenderer,t.SimpleRenderer=l.SimpleRenderer,t.ClusterRenderer=l.ClusterRenderer,t.RandomRenderer=l.RandomRenderer,t.RankRenderer=l.RankRenderer,t.HeatmapRenderer=l.HeatmapRenderer,t.BaseRenderer=l.BaseRenderer,t.getIGSDynamicLayer=l.getIGSDynamicLayer,t.extend=f.extend,t.isArray=f.isArray,t.isNumber=f.isNumber,t.isInTheSameDomain=f.isInTheSameDomain,t.transformResult=f.transformResult,t.urlAppend=f.urlAppend,t.getParameterString=f.getParameterString,t.bind=f.bind,t.getGUID=f.getGUID,t.defaultValue=f.defaultValue,t.defined=f.defined,t.normalize=f.normalize,t.createGeometry=f.createGeometry,t.isNull=f.isNull,t.getGeometryParameter=f.getGeometryParameter,t.getOutStatisticsParameter=f.getOutStatisticsParameter,t.Log=f.Log,t.isString=f.isString,t.deepClone=f.deepClone,t.isBoolean=f.isBoolean,t.extendDeep=f.extendDeep,t.newGuid=f.newGuid,t.formatPoints=f.formatPoints,t.returnPoint=f.returnPoint,t.cloneObject=f.cloneObject,t.notNULL=f.notNULL,t.isObject=f.isObject,t.getVideoType=f.getVideoType,t.toJSON=f.toJSON,t.getBaseUrl=f.getBaseUrl,t.inputCss=f.inputCss,t.BaseView=p.BaseView,t.MapView=p.MapView,t.SceneView=p.SceneView,t.BaseGraphicsLayerView=p.BaseGraphicsLayerView,t.BaseRendererLayerView=p.BaseRendererLayerView,t.GroupLayerView=p.GroupLayerView,t.LayerView=p.LayerView,t.SpatialReference=u.SpatialReference,t.UrlServerType=h.UrlServerType,t.PictureFormat=h.PictureFormat,t.getUrlType=l.getUrlType,t.is4326=l.is4326,t.isCustomSP=l.isCustomSP,t.EPSG=c.EPSG,t.proj4=i.default,t.T=o,t.showLayerByScale=l.showLayerByScale,t.formatBaseUrl=a.formatBaseUrl,t.RadiusUnit=h.RadiusUnit,t.Geometry=u.Geometry,t.editFeatureByArc3=u.editFeatureByArc3,t.editGeometryByArc3=u.editGeometryByArc3,t.Config=a.Config,t.ServiceConfigToken=a.ServiceConfigToken,t.ServiceConfigRequestInterceptors=a.ServiceConfigRequestInterceptors,t.createSimpleMarkerSymbolCanvas=g.createSimpleMarkerSymbolCanvas,t.createSimpleFillSymbolCanvas=g.createSimpleFillSymbolCanvas,t.BaseFeatureLayerView=p.BaseFeatureLayerView,t.TileInfoUtil=l.TileInfoUtil,t.WMTSCorporation=h.WMTSCorporation,t.setElevationInfo=l.setElevationInfo,t.LabelClass=l.LabelClass,t.HeatmapColorStop=l.HeatmapColorStop,t.SizeVariable=l.SizeVariable,t.ColorVariable=l.ColorVariable,t.OpacityVariable=l.OpacityVariable,t.VisualVariable=l.VisualVariable,t.RendererUtil=p.RendererUtil,t.Symbol3D=d.Symbol3D,t.LabelSymbol3D=d.LabelSymbol3D,t.LineSymbol3D=d.LineSymbol3D,t.PointSymbol3D=d.PointSymbol3D,t.PolygonSymbol3D=d.PolygonSymbol3D,t.LineCallout3D=d.LineCallout3D,t.Callout3D=d.Callout3D,t.Symbol3DVerticalOffset=d.Symbol3DVerticalOffset,t.Symbol3DLayer=d.Symbol3DLayer,t.Symbol3DLayerType=h.Symbol3DLayerType,t.LineCapType=h.LineCapType,t.LineJoinType=h.LineJoinType,t.LineMarkerPlacement=h.LineMarkerPlacement,t.LineMarkerStyle=h.LineMarkerStyle,t.LineStyleMarker3D=d.LineStyleMarker3D,t.LinePatternStyle=h.LinePatternStyle,t.LineStylePattern3D=d.LineStylePattern3D,t.LineSymbol3DLayer=d.LineSymbol3DLayer,t.PathSymbol3DLayer=d.PathSymbol3DLayer,t.AnchorType=h.AnchorType,t.ProfileType=h.ProfileType,t.FillSymbol3DLayer=d.FillSymbol3DLayer,t.FillSymbol3DOutline=d.FillSymbol3DOutline,t.PatternStyle=h.PatternStyle,t.IconSymbol3DLayer=d.IconSymbol3DLayer,t.PointSymbol3DOutline=d.PointSymbol3DOutline,t.IconResource=d.IconResource,t.ObjectSymbol3DLayer=d.ObjectSymbol3DLayer,t.ExtrudeSymbol3DLayer=d.ExtrudeSymbol3DLayer,t.Edges3D=d.Edges3D,t.TextSymbol3DLayer=d.TextSymbol3DLayer,t.TextHalo=d.TextHalo,t.WaterSymbol3DLayer=d.WaterSymbol3DLayer,t.WaterbodySize=h.WaterbodySize,t.WaveStrength=h.WaveStrength,t.MaterialType=h.MaterialType,t.ColorMaterial=d.ColorMaterial,t.StylePattern3D=d.StylePattern3D,t.ArcGISVectorTileLayer=l.ArcGISVectorTileLayer,t.WebTileLayer=l.WebTileLayer,t.getZoomOffset=l.getZoomOffset,t.FeatureCollection=l.FeatureCollection,t.CAttDataRow=a.CAttDataRow,t.CAttStruct=a.CAttStruct,t.Interceptor=a.Interceptor,t.WorkFlowServer=a.WorkFlowServer,t.TileLayer=l.TileLayer,t.BaseServer=a.BaseServer,t.RequestConfig=a.RequestConfig,t.UnknownLayer=l.UnknownLayer,t.OverlayLayer=l.OverlayLayer,t.OGCLayer=l.OGCLayer,t.getProjectionSrs=f.getProjectionSrs,t.isWMSReverse=f.isWMSReverse,t.convertImageSourceToBase64=f.convertImageSourceToBase64,t.throttle=f.throttle,t.compareObject=f.compareObject,t.debouncePromise=f.debouncePromise,t.inOrderPromise=f.inOrderPromise,t.allSettled=f.allSettled,t.LinearUnits=h.LinearUnits,t.AreaUnits=h.AreaUnits,t.ArcType=h.ArcType,t.FetchRequest=a.FetchRequest,t.TileInfo=l.TileInfo,t.appendUrlParams=l.appendUrlParams,t.getFullBaseUrl=l.getFullBaseUrl,t.LOD=l.LOD,t.VoxelFilter=l.VoxelFilter,t.convertIGSClippingString=a.convertIGSClippingString,t.SceneSubLayerType=h.SceneSubLayerType,t.GeometryFilter=a.GeometryFilter,t.ColorNameToHexMap=h.ColorNameToHexMap,t.SeverVectorTileSubLayerType=h.SeverVectorTileSubLayerType,t.VisualVariableType=h.VisualVariableType,t.TDTLayerType=h.TDTLayerType,t.TileSliceType=h.TileSliceType,t.VectorTileLayer=l.VectorTileLayer,t.ExpressionParser=f.ExpressionParser,t.isLayerViewValid=s.isLayerViewValid,t.getValidLayers=s.getValidLayers,t.getLayerViewsGeographicExtent=s.getLayerViewsGeographicExtent,t.getCrsOptions=s.getCrsOptions,t.getLayersExtent=s.getLayersExtent,t.TemporalUnit=h.TemporalUnit,t.NormalizationType=h.NormalizationType,t.TimeExtent=c.TimeExtent,t.TimeInfo=c.TimeInfo,t.TimeInterval=c.TimeInterval,t.getFunctionArguments=f.getFunctionArguments,t.UrlUtil=a.UrlUtil,t.ServerUtil=a.ServerUtil,t.deleteNullValue=f.deleteNullValue,t.BaseRegExp=a.BaseRegExp,t.ServerBaseUrlRegExp=a.ServerBaseUrlRegExp,t.LayerBaseUrlRegExp=a.LayerBaseUrlRegExp},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(72);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){var n=r(110)("keys"),i=r(89);e.exports=function(e){return n[e]||(n[e]=i(e))}},function(e,t,r){var n=r(12),i=r(20),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(73)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(24),i=r(20).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,r){var n=r(24);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){},function(e,t,r){"use strict";var n=r(73),i=r(18),o=r(152),a=r(45),s=r(64),l=r(255),u=r(75),c=r(92),f=r(21)("iterator"),h=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,r,p,y,g,v){l(r,t,p);var m,_,S,x=function(e){if(!h&&e in M)return M[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},b=t+" Iterator",w="values"==y,k=!1,M=e.prototype,E=M[f]||M["@@iterator"]||y&&M[y],I=E||x(y),T=y?w?x("entries"):I:void 0,L="Array"==t&&M.entries||E;if(L&&(S=c(L.call(new e)))!==Object.prototype&&S.next&&(u(S,b,!0),n||"function"==typeof S[f]||a(S,f,d)),w&&E&&"values"!==E.name&&(k=!0,I=function(){return E.call(this)}),n&&!v||!h&&!k&&M[f]||a(M,f,I),s[t]=I,s[b]=d,y)if(m={values:w?I:x("values"),keys:g?I:x("keys"),entries:T},v)for(_ in m)_ in M||o(M,_,m[_]);else i(i.P+i.F*(h||k),t,m);return m}},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(93),i=r(21)("iterator"),o=r(64);e.exports=r(12).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[n(e)]}},function(e,t,r){"use strict";var n=r(74);e.exports.f=function(e){return new function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=n(t),this.reject=n(r)}(e)}},function(e,t,r){var n=r(45);e.exports=function(e,t,r){for(var i in t)r&&e[i]?e[i]=t[i]:n(e,i,t[i]);return e}},function(e,t,r){e.exports={default:r(267),__esModule:!0}},function(e,t,r){t.f=r(21)},function(e,t,r){var n=r(20),i=r(12),o=r(73),a=r(121),s=r(27).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(11)),i=p(r(23)),o=p(r(53)),a=p(r(3)),s=p(r(0)),l=p(r(2)),u=p(r(4)),c=p(r(5)),f=r(1),h=p(r(80)),d=r(46);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,s.default)(this,t);var r=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return r.type="collection",e instanceof t?r._items=e.all():Array.isArray(e)?r._items=e:r._items=[],r._items=r._items.map(function(e){return r.createInstance(e)}),r}return(0,c.default)(t,e),(0,l.default)(t,[{key:"add",value:function(e,t){return this._add(e,t),this._fireCollectionChangeEvent({added:[e],target:this,sourceTarget:this}),this}},{key:"addMany",value:function(e,t){var r=this;if(Array.isArray(e)){var n=e.map(function(e){return r.createInstance(e)}),i=this._getNextIndex(t);n.forEach(function(e,t){r._items.splice(i+t,0,e)}),this._fireCollectionChangeEvent({target:this,sourceTarget:this,added:n})}}},{key:"at",value:function(e){return(e=Number(e))>=0?this._items[e]:this._items[this._items.length-1+e]}},{key:"clone",value:function(){for(var e=[],r=0;r<this._items.length;r++)e.push((0,f.cloneObject)(this.items[r]));return new t(e)}},{key:"concat",value:function(e){var t=e;e instanceof this.constructor?t=e.all():e instanceof Array?t=e:"object"===(void 0===e?"undefined":(0,o.default)(e))&&(t=[],(0,i.default)(e).forEach(function(r){t.push(e[r])}));var r=this._items;return t.forEach(function(e){r.push(e)}),new this.constructor(r)}},{key:"every",value:function(e){var t=!0;if(!(e instanceof Function))return!1;for(var r=0;r<this._items.length;r++)if(!e(this._items[r])){t=!1;break}return t}},{key:"filter",value:function(e){if(e instanceof Function){for(var r=[],n=0;n<this._items.length;n++)e(this._items[n])&&r.push(this._items[n]);return new t(r)}}},{key:"find",value:function(e){if(e instanceof Function){for(var t=void 0,r=0;r<this._items.length;r++)if(e(this._items[r])){t=this._items[r];break}return t}}},{key:"findIndex",value:function(e){return this._items.findIndex(e)}},{key:"flatten",value:function(e){if(e instanceof Function){for(var r=[],n=0;n<this._items.length;n++)r.push(this._items[n]);for(var i=0;i<r.length;i++)r=r.concat(o(r[i],e));return new t(r)}function o(e,r){var n=r(e);if(n){if(n instanceof Array)return n;if(n instanceof t){for(var i=n.toArray(),a=0;a<n._items.length;a++)i=i.concat(o(n._items[a],r));return i}return[n]}return[]}}},{key:"forEach",value:function(e){return this._items.forEach(e)}},{key:"getItemAt",value:function(e){return this._items[e]}},{key:"includes",value:function(e){return this._items.includes(e)}},{key:"indexOf",value:function(e,t){return this._items.indexOf(e,t)}},{key:"join",value:function(e){for(var t="",r=0;r<this._items.length-1;r++)t+=this._items[r]+e;return t+this._items[this._items.length-1]}},{key:"lastIndexOf",value:function(e,t){for(var r=-1,n=t=(0,f.defaultValue)(t,this._items.length-1);n>=0;n--)if(this._items[n]===e){r=n;break}return r}},{key:"map",value:function(e){var t=this;if(Array.isArray(this._items))return new this.constructor(this._items.map(e));var r={};return(0,i.default)(this._items).forEach(function(n){r[n]=e(t._items[n],n)}),new this.constructor(r)}},{key:"pop",value:function(){return this._items.pop()}},{key:"push",value:function(e){return this.add(e)}},{key:"reduce",value:function(e,t){var r=this,n=null;return void 0!==t&&(n=t),Array.isArray(this._items)?this._items.forEach(function(t){n=e(n,t)}):(0,i.default)(this._items).forEach(function(t){n=e(n,r._items[t],t)}),n}},{key:"reduceRight",value:function(e,r){for(var n=[],i=this._items.length-1;i>=0;i--)n.push(this._items[i]);return new t(n).reduce(e,r)}},{key:"remove",value:function(e){var t=this._remove(e);return t&&this._fireCollectionChangeEvent({removed:[e],target:this,sourceTarget:this}),t}},{key:"removeAll",value:function(){this._items=[],this._fireCollectionChangeEvent({target:this,sourceTarget:this})}},{key:"removeAt",value:function(e){var t=this._items.splice(e,1);return this._fireCollectionChangeEvent({target:this,sourceTarget:this}),t}},{key:"removeMany",value:function(e){var t=this;if(Array.isArray(e)){for(var r=[],n=[],i=function(i){var o=t._items.findIndex(function(t){return t===e[i]});o>-1&&(n.push(o),r.push(e[i]))},o=0;o<e.length;o++)i(o);return r.length>0&&(this._items=this._items.filter(function(e,t){return n.every(function(e){return e!==t})}),this._fireCollectionChangeEvent({removed:r,target:this,sourceTarget:this})),r}}},{key:"reorder",value:function(e,t){this._reorder(e,t)&&this._fireCollectionChangeEvent({moved:[e],target:this,sourceTarget:this})}},{key:"reverse",value:function(){var e=[].concat(this._items).reverse();return new this.constructor(e)}},{key:"shift",value:function(){return this._items.shift()}},{key:"slice",value:function(e,t){var r=this._items.slice(e);return void 0!==t&&(r=r.slice(0,t)),new this.constructor(r)}},{key:"some",value:function(e){if(!(e instanceof Function))return!1;for(var t=!1,r=0;r<this._items.length;r++)if(e(this._items[r])){t=!0;break}return t}},{key:"sort",value:function(e){var t=[].concat(this._items);return void 0===e?this.every(function(e){return"number"==typeof e})?t.sort(function(e,t){return e-t}):t.sort():t.sort(e),new this.constructor(t)}},{key:"splice",value:function(e,r){for(var n,i=arguments.length,o=Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];return new t((n=this._items).splice.apply(n,[e,r].concat(o)))}},{key:"toArray",value:function(){for(var e=[],t=0;t<this._items.length;t++)e.push(this.items[t]);return e}},{key:"unshift",value:function(){var e;(e=this._items).unshift.apply(e,arguments)}},{key:"all",value:function(){return this.toArray()}},{key:"unique",value:function(e){var t=void 0;if(void 0===e)t=this._items.filter(function(e,t,r){return r.indexOf(e)===t});else{t=[];for(var r=[],n=0,i=this._items.length;n<i;n+=1){var o;o=e instanceof Function?e(this._items[n]):this._items[n][e],-1===r.indexOf(o)&&(t.push(this._items[n]),r.push(o))}}return new this.constructor(t)}},{key:"createInstance",value:function(e){return e}},{key:"_fireCollectionChangeEvent",value:function(e){if(this.fire("change",new d.CollectionChangeEvent(e),!1),this.fire("collection-refresh",new d.CollectionChangeEvent(e),!1),this._parentCollection)for(var t=this._parentCollection;t;)t.fire("collection-refresh",new d.CollectionChangeEvent(e),!1),t=t._parentCollection}},{key:"_addParentCollection",value:function(e){this._parentCollection=e}},{key:"_removeParentCollection",value:function(){this._parentCollection=void 0}},{key:"_getNextIndex",value:function(e){return e=(0,f.defaultValue)(e,this._items.length),Math.max(0,Math.min(this._items.length,e))}},{key:"_add",value:function(e,t){var r=this.createInstance(e);this._items.splice(this._getNextIndex(t),0,r)}},{key:"_remove",value:function(e){var t=this._items.indexOf(e);return t>-1&&(this._items.splice(t,1),!0)}},{key:"_reorder",value:function(e,t){var r=this._items.length;t=(0,f.defaultValue)(t,r-1);var n=this._items.indexOf(e);return n>-1&&(t=Math.min(Math.max(0,t),r-1))!==n&&(this._items.splice(n,1),this._items.splice(t,0,e),!0)}}],[{key:"isCollection",value:function(e){return e instanceof t}}]),t}(h.default);(0,n.default)(y.prototype,{items:{get:function(){return this._items},set:function(e){var t=this;this._items=e;var r=e.map(function(e){return t.createInstance(e)});this._fireCollectionChangeEvent({target:this,sourceTarget:this,added:r})}},length:{get:function(){return this._items.length}}}),t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.family=(0,o.defaultValue)(t.family,"微软雅黑"),this.size=(0,o.defaultValue)(t.size,12),this.style=(0,o.defaultValue)(t.style,"normal"),this.weight=(0,o.defaultValue)(t.weight,"normal"),this.decoration=(0,o.defaultValue)(t.decoration,"none")}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.family=this.family,e.size=this.size,e.style=this.style,e.weight=this.weight,e.decoration=this.decoration,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{id:2348,name:"高斯大地坐标系_西安80_23带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=135 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2347,name:"高斯大地坐标系_西安80_22带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=129 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2346,name:"高斯大地坐标系_西安80_21带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=123 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2345,name:"高斯大地坐标系_西安80_20带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2344,name:"高斯大地坐标系_西安80_19带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2343,name:"高斯大地坐标系_西安80_18带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2342,name:"高斯大地坐标系_西安80_17带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2341,name:"高斯大地坐标系_西安80_16带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2340,name:"高斯大地坐标系_西安80_15带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2339,name:"高斯大地坐标系_西安80_14带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2338,name:"高斯大地坐标系_西安80_13带6_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2390,name:"高斯大地坐标系_西安80_45带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=135 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2389,name:"高斯大地坐标系_西安80_44带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=132 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2388,name:"高斯大地坐标系_西安80_43带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=129 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2387,name:"高斯大地坐标系_西安80_42带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=126 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2386,name:"高斯大地坐标系_西安80_41带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=123 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2385,name:"高斯大地坐标系_西安80_40带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=120 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2384,name:"高斯大地坐标系_西安80_39带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2383,name:"高斯大地坐标系_西安80_38带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=114 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2382,name:"高斯大地坐标系_西安80_37带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2381,name:"高斯大地坐标系_西安80_36带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=108 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2380,name:"高斯大地坐标系_西安80_35带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2379,name:"高斯大地坐标系_西安80_34带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=102 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2378,name:"高斯大地坐标系_西安80_33带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2377,name:"高斯大地坐标系_西安80_32带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=96 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2376,name:"高斯大地坐标系_西安80_31带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2375,name:"高斯大地坐标系_西安80_30带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=90 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2374,name:"高斯大地坐标系_西安80_29带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2373,name:"高斯大地坐标系_西安80_28带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=84 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2372,name:"高斯大地坐标系_西安80_27带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=81 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2371,name:"高斯大地坐标系_西安80_26带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=78 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2370,name:"高斯大地坐标系_西安80_25带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2327,name:"高斯大地坐标系_西安80_13带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=13500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2328,name:"高斯大地坐标系_西安80_14带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=81 +k=1 +x_0=14500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2329,name:"高斯大地坐标系_西安80_15带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=15500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2330,name:"高斯大地坐标系_西安80_16带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=16500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2331,name:"高斯大地坐标系_西安80_17带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=17500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2332,name:"高斯大地坐标系_西安80_18带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=18500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2333,name:"高斯大地坐标系_西安80_19带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=19500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2334,name:"高斯大地坐标系_西安80_20带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=20500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2335,name:"高斯大地坐标系_西安80_21带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=123 +k=1 +x_0=21500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2336,name:"高斯大地坐标系_西安80_22带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=129 +k=1 +x_0=22500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2337,name:"高斯大地坐标系_西安80_23带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=135 +k=1 +x_0=23500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2403,name:"高斯大地坐标系_西安80_27带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=81 +k=1 +x_0=27500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2404,name:"高斯大地坐标系_西安80_28带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=84 +k=1 +x_0=28500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2405,name:"高斯大地坐标系_西安80_29带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=29500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2406,name:"高斯大地坐标系_西安80_30带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=90 +k=1 +x_0=30500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2407,name:"高斯大地坐标系_西安80_31带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=31500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2408,name:"高斯大地坐标系_西安80_32带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=96 +k=1 +x_0=32500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2409,name:"高斯大地坐标系_西安80_33带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=33500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2410,name:"高斯大地坐标系_西安80_34带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=102 +k=1 +x_0=34500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2411,name:"高斯大地坐标系_西安80_35带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=35500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2412,name:"高斯大地坐标系_西安80_36带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=108 +k=1 +x_0=36500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2413,name:"高斯大地坐标系_西安80_37带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=37500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2414,name:"高斯大地坐标系_西安80_38带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=114 +k=1 +x_0=38500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2415,name:"高斯大地坐标系_西安80_39带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=39500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2416,name:"高斯大地坐标系_西安80_40带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=120 +k=1 +x_0=40500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2417,name:"高斯大地坐标系_西安80_41带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=123 +k=1 +x_0=41500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2418,name:"高斯大地坐标系_西安80_42带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=126 +k=1 +x_0=42500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2419,name:"高斯大地坐标系_西安80_43带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=129 +k=1 +x_0=43500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2420,name:"高斯大地坐标系_西安80_44带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=132 +k=1 +x_0=44500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2421,name:"高斯大地坐标系_西安80_45带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=135 +k=1 +x_0=45500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2349,name:"高斯大地坐标系_西安80_25带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=25500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2350,name:"高斯大地坐标系_西安80_26带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=78 +k=1 +x_0=26500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2351,name:"高斯大地坐标系_西安80_27带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=81 +k=1 +x_0=27500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2352,name:"高斯大地坐标系_西安80_28带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=84 +k=1 +x_0=28500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2353,name:"高斯大地坐标系_西安80_29带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=29500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2354,name:"高斯大地坐标系_西安80_30带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=90 +k=1 +x_0=30500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2355,name:"高斯大地坐标系_西安80_31带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=31500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2356,name:"高斯大地坐标系_西安80_32带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=96 +k=1 +x_0=32500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2357,name:"高斯大地坐标系_西安80_33带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=33500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2358,name:"高斯大地坐标系_西安80_34带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=102 +k=1 +x_0=34500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2359,name:"高斯大地坐标系_西安80_35带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=35500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2360,name:"高斯大地坐标系_西安80_36带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=108 +k=1 +x_0=36500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2361,name:"高斯大地坐标系_西安80_37带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=37500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2362,name:"高斯大地坐标系_西安80_38带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=114 +k=1 +x_0=38500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2363,name:"高斯大地坐标系_西安80_39带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=39500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2364,name:"高斯大地坐标系_西安80_40带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=120 +k=1 +x_0=40500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2365,name:"高斯大地坐标系_西安80_41带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=123 +k=1 +x_0=41500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2366,name:"高斯大地坐标系_西安80_42带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=126 +k=1 +x_0=42500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2367,name:"高斯大地坐标系_西安80_43带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=129 +k=1 +x_0=43500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2368,name:"高斯大地坐标系_西安80_44带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=132 +k=1 +x_0=44500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:2369,name:"高斯大地坐标系_西安80_45带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=135 +k=1 +x_0=45500000 +y_0=0 +a=6378140 +b=6356755.288157528 +units=m +no_defs"},{id:21413,name:"高斯大地坐标系_北京54_13带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=13500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21414,name:"高斯大地坐标系_北京54_14带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=81 +k=1 +x_0=14500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21415,name:"高斯大地坐标系_北京54_15带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=15500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21416,name:"高斯大地坐标系_北京54_16带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=16500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21417,name:"高斯大地坐标系_北京54_17带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=17500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21418,name:"高斯大地坐标系_北京54_18带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=18500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21419,name:"高斯大地坐标系_北京54_19带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=19500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21420,name:"高斯大地坐标系_北京54_20带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=20500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21421,name:"高斯大地坐标系_北京54_21带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=123 +k=1 +x_0=21500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21422,name:"高斯大地坐标系_北京54_22带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=129 +k=1 +x_0=22500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:21423,name:"高斯大地坐标系_北京54_23带6_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=135 +k=1 +x_0=23500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2431,name:"高斯大地坐标系_北京54_34带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=102 +k=1 +x_0=500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2401,name:"高斯大地坐标系_北京54_25带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=25500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:2402,name:"高斯大地坐标系_北京54_26带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=78 +k=1 +x_0=26500000 +y_0=0 +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +units=m +no_defs"},{id:32646,name:"Beijing 1954 / 3-degree Gauss-Kruger CM 102E",type:1,strProject:"+proj=utm +zone=46 +datum=WGS84 +units=m +no_defs"},{id:4502,name:"高斯大地坐标系_中国2000_13带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4503,name:"高斯大地坐标系_中国2000_14带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=81 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4504,name:"高斯大地坐标系_中国2000_15带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4505,name:"高斯大地坐标系_中国2000_16带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4506,name:"高斯大地坐标系_中国2000_17带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4507,name:"高斯大地坐标系_中国2000_18带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4508,name:"高斯大地坐标系_中国2000_19带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4509,name:"高斯大地坐标系_中国2000_20带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4510,name:"高斯大地坐标系_中国2000_21带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=123 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4511,name:"高斯大地坐标系_中国2000_22带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=129 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4512,name:"高斯大地坐标系_中国2000_23带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=135 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4513,name:"高斯大地坐标系_中国2000_25带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=25500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4514,name:"高斯大地坐标系_中国2000_26带6_北",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=78 +k=1 +x_0=26500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4515,name:"高斯大地坐标系_中国2000_27带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=81 +k=1 +x_0=27500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4516,name:"高斯大地坐标系_中国2000_28带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=84 +k=1 +x_0=28500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4517,name:"高斯大地坐标系_中国2000_29带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=29500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4518,name:"高斯大地坐标系_中国2000_30带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=90 +k=1 +x_0=30500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4519,name:"高斯大地坐标系_中国2000_31带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=31500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4520,name:"高斯大地坐标系_中国2000_32带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=96 +k=1 +x_0=32500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4521,name:"高斯大地坐标系_中国2000_33带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=33500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4522,name:"高斯大地坐标系_中国2000_34带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=102 +k=1 +x_0=34500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4523,name:"高斯大地坐标系_中国2000_35带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=35500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4524,name:"高斯大地坐标系_中国2000_36带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=108 +k=1 +x_0=36500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4525,name:"高斯大地坐标系_中国2000_37带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=37500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4526,name:"高斯大地坐标系_中国2000_38带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=114 +k=1 +x_0=38500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4527,name:"高斯大地坐标系_中国2000_39带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=39500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4528,name:"高斯大地坐标系_中国2000_40带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=120 +k=1 +x_0=40500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4529,name:"高斯大地坐标系_中国2000_41带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=123 +k=1 +x_0=41500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4530,name:"高斯大地坐标系_中国2000_42带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=126 +k=1 +x_0=42500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4531,name:"高斯大地坐标系_中国2000_43带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=129 +k=1 +x_0=43500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4532,name:"高斯大地坐标系_中国2000_44带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=132 +k=1 +x_0=44500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4533,name:"高斯大地坐标系_中国2000_45带3_北2",type:0,strProject:"+proj=tmerc +lat_0=0 +lon_0=135 +k=1 +x_0=45500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4546,name:"高斯大地坐标系_中国2000_37带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4547,name:"高斯大地坐标系_中国2000_38带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=114 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:4545,name:"高斯大地坐标系_中国2000_36带3_北",type:1,strProject:"+proj=tmerc +lat_0=0 +lon_0=108 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs"},{id:3857,name:"Web墨卡托_WGS1984",type:1,strProject:"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"},{id:900913,name:"天地图3857",type:1,strProject:"+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs +type=crs"},{id:4610,name:"地理坐标系(西安)_度",type:0,strProject:"+proj=longlat +a=6378140 +b=6356755.288157528 +units=degrees +no_defs"},{id:4214,name:"地理坐标系(北京)_度",type:0,strProject:"+proj=longlat +ellps=krass +towgs84=15.8,-154.4,-82.3,0,0,0,0 +no_defs"},{id:4490,name:"中国2000国家大地坐标系_度",type:0,strProject:"+proj=longlat +ellps=GRS80 +units=degrees +no_defs"},{id:4326,name:"WGS1984_度",type:0,strProject:"+proj=longlat +datum=WGS84 +no_defs +type=crs"}]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={default:"default",line:"simple-line",simpleLine:"simple-line",fill:"simple-fill",simpleFill:"simple-fill",marker:"simple-marker",simpleMarker:"simple-marker",pictureMarker:"picture-marker",text:"text",pictureFill:"picture-fill",mapgisText:"mapgis-text",point3D:"point-3d",polygon3D:"polygon-3d",line3D:"line-3d",label3D:"label-3d"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={left:"left",right:"right",center:"center"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={baseline:"baseline",top:"top",middle:"middle",bottom:"bottom"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={butt:"butt",round:"round",square:"square"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={bevel:"bevel",miter:"miter",round:"round"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={gcj02ll:20010201,gcj02mc:20010202,bd09ll:20020901,bd09mc:20020902}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFeaturesFromFeatureSet=t.FeatureSet=t.Feature=void 0;var n=a(r(175)),i=a(r(387)),o=r(389);function a(e){return e&&e.__esModule?e:{default:e}}t.Feature=n.default,t.FeatureSet=i.default,t.getFeaturesFromFeatureSet=o.getFeaturesFromFeatureSet},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=r(1),c=r(6),f=d(r(377)),h=d(r(378));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));e=(0,u.defaultValue)(e,{}),r.type=c.SymbolType.simpleLine,r.cap=(0,u.defaultValue)(e.cap,"round"),r.join=(0,u.defaultValue)(e.join,"round"),r.miterLimit=(0,u.defaultValue)(e.miterLimit,2),r.style=(0,u.defaultValue)(e.style,"solid");var o=(0,u.defaultValue)(e.marker,null);return o?(o.color=(0,u.defaultValue)(o.color,r.color.clone()),r.marker=h.default.fromJSON(o)):r.marker=null,r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e.style=this.style,e.marker=this.marker?this.marker.toJSON():null,e}}],[{key:"fromJSON",value:function(e){return new t(e=(0,u.defaultValue)(e,{}))}}]),t}(f.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(0)),i=o(r(2));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(){(0,n.default)(this,e)}return(0,i.default)(e,[{key:"drawFeature",value:function(e,t){}},{key:"updateFeature",value:function(e,t,r){}},{key:"clearFeature",value:function(e,t){}},{key:"clear",value:function(e){}}]),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),t=(0,i.defaultValue)(t,{}),this.before=(0,i.defaultValue)(t.success,void 0),this.failure=(0,i.defaultValue)(t.failure,void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),t=(0,i.defaultValue)(t,{}),this.success=(0,i.defaultValue)(t.success,void 0),this.failure=(0,i.defaultValue)(t.failure,void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(23)),i=s(r(0)),o=s(r(2)),a=r(1);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){(0,i.default)(this,e)}return(0,o.default)(e,null,[{key:"matchString",value:function(e){this.regExps||this.initRegExps();for(var t=(0,n.default)(this.regExps),r=0;r<t.length;r++)if(this.regExps[t[r]].test(e)){var i=e.match(this.regExps[t[r]]);return"MapServerV1"===t[r]?i[0].replace("/igs/rest/mrcs/docs/","/igs/rest/mrms/docs/"):i[0]}return e}},{key:"testByRegExpNames",value:function(e,t){this.regExps||this.initRegExps();for(var r=!1,n=0;n<t.length;n++)if(r=this.regExps[t[n]].test(e))return r;return r}},{key:"matchStringByRegExpNames",value:function(e,t){t=(0,a.defaultValue)(t,[]),this.regExps||this.initRegExps();for(var r=0;r<t.length;r++){var n=this.regExps[t[r]];if(n.test(e)){var i=e.match(n);return"MapServerV1Wrong"===t[r]?i[0].replace("/igs/rest/mrcs/docs/","/igs/rest/mrms/docs/"):i[0]}}return e}},{key:"initRegExps",value:function(){}}]),e}();l.regExps=null,l.requestWordRegExp="[一-龟\\w:_-]+",t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CAttStruct=t.CAttDataRow=t.ArcGISVectorTileServer=t.ArcGISFeatureServer=t.ArcGISGeometryServer=t.ThemesInfo=t.ThemeServer=t.ItemValue=t.FolderInfoAttribute=t.FolderInfo=t.ExpInfo=t.CUniqueThemeInfo=t.CUniqueTheme=t.CThemeInfo=t.CTheme=t.CSimpleTheme=t.CRegInfo=t.CRangeThemeInfo=t.CRangeTheme=t.CRandomTheme=t.CPntInfo=t.CMultiClassTheme=t.CLinInfo=t.CGraduatedSymbolTheme=t.CFourColorTheme=t.CDotDensityTheme=t.CChartType=t.CChartThemeRepresentInfo=t.CChartThemeInfo=t.CChartTheme=t.CChartLabelFormat=t.CAnnInfo=t.CAllOtherDataItemInfoSource=t.ArcGISMapServer=t.WorkFlowServer=t.WFSServer=t.WMTSServer=t.WMSServer=t.SceneServer=t.ResourceServer=t.PlotServer=t.VectorTileServer=t.TileServer=t.RootServer=t.SecurityServer=t.TerrainServer=t.PoiServer=t.Cesium3DTilesServer=t.AddressServer=t.GeometryServer=t.ImageServer=t.M3DServer=t.FeatureServer=t.MapServer=void 0;var n=M(r(429)),i=M(r(430)),o=M(r(431)),a=M(r(432)),s=M(r(433)),l=M(r(434)),u=M(r(435)),c=M(r(436)),f=M(r(199)),h=M(r(437)),d=M(r(438)),p=M(r(439)),y=M(r(440)),g=M(r(441)),v=M(r(442)),m=M(r(443)),_=M(r(140)),S=M(r(100)),x=r(444),b=r(450),w=r(454),k=r(218);function M(e){return e&&e.__esModule?e:{default:e}}t.MapServer=n.default,t.FeatureServer=i.default,t.M3DServer=o.default,t.ImageServer=a.default,t.GeometryServer=s.default,t.AddressServer=l.default,t.Cesium3DTilesServer=u.default,t.PoiServer=c.default,t.TerrainServer=f.default,t.SecurityServer=h.default,t.RootServer=d.default,t.TileServer=p.default,t.VectorTileServer=y.default,t.PlotServer=g.default,t.ResourceServer=v.default,t.SceneServer=m.default,t.WMSServer=x.WMSServer,t.WMTSServer=x.WMTSServer,t.WFSServer=x.WFSServer,t.WorkFlowServer=k.WorkFlowServer,t.ArcGISMapServer=b.ArcGISMapServer,t.CAllOtherDataItemInfoSource=w.CAllOtherDataItemInfoSource,t.CAnnInfo=w.CAnnInfo,t.CChartLabelFormat=w.CChartLabelFormat,t.CChartTheme=w.CChartTheme,t.CChartThemeInfo=w.CChartThemeInfo,t.CChartThemeRepresentInfo=w.CChartThemeRepresentInfo,t.CChartType=w.CChartType,t.CDotDensityTheme=w.CDotDensityTheme,t.CFourColorTheme=w.CFourColorTheme,t.CGraduatedSymbolTheme=w.CGraduatedSymbolTheme,t.CLinInfo=w.CLinInfo,t.CMultiClassTheme=w.CMultiClassTheme,t.CPntInfo=w.CPntInfo,t.CRandomTheme=w.CRandomTheme,t.CRangeTheme=w.CRangeTheme,t.CRangeThemeInfo=w.CRangeThemeInfo,t.CRegInfo=w.CRegInfo,t.CSimpleTheme=w.CSimpleTheme,t.CTheme=w.CTheme,t.CThemeInfo=w.CThemeInfo,t.CUniqueTheme=w.CUniqueTheme,t.CUniqueThemeInfo=w.CUniqueThemeInfo,t.ExpInfo=w.ExpInfo,t.FolderInfo=w.FolderInfo,t.FolderInfoAttribute=w.FolderInfoAttribute,t.ItemValue=w.ItemValue,t.ThemeServer=w.ThemeServer,t.ThemesInfo=w.ThemesInfo,t.ArcGISGeometryServer=b.ArcGISGeometryServer,t.ArcGISFeatureServer=b.ArcGISFeatureServer,t.ArcGISVectorTileServer=b.ArcGISVectorTileServer,t.CAttDataRow=_.default,t.CAttStruct=S.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.default=function(e,t,r){var i=(0,n.defaultValue)(r,{});(0,n.extend)(this,i),this.FID=(0,n.defaultValue)(t,0),this.Values=(0,n.defaultValue)(e,null)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLayersExtent=t.getCrsOptions=t.getLayerViewsGeographicExtent=t.getValidLayers=t.isLayerViewValid=void 0;var n=r(9),i=r(6),o=r(8),a=r(1),s=r(68);function l(e,t){var r=!1;if(t&&t.spatialReference&&e){var o=e;o instanceof n.SpatialReference||(o=n.SpatialReference.fromJSON(o)),r=!i.LayerType.isTileLayer(t.type)||o.equals(t.spatialReference)||o.isGeographic&&t.spatialReference.isGeographic||o.isWebMercator&&t.spatialReference.isWebMercator}return r}t.isLayerViewValid=l,t.getValidLayers=function(e,t){var r=e.spatialReference,n=[];return t.forEach(function(e){l(r,e)&&n.push(e)}),n},t.getLayerViewsGeographicExtent=function(e,t,r){var i=e.extent,a=r._getLayersExtent(t);return a||(a=n.Extent.fromJSON(i.toJSON())),o.Projection.project(a,new n.SpatialReference("EPSG:4326"))},t.getCrsOptions=function(e,t,r){r=(0,a.defaultValue)(r,{});var o=(0,a.defaultValue)(r.fullExtent,void 0),l=(0,a.defaultValue)(r.mergeLevelRatio,1.05),u=(0,a.defaultValue)(r.maxScale,void 0),c=(0,a.defaultValue)(r.minScale,void 0),f=e.tileInfo,h=e.spatialReference;if(e.type===i.LayerType.wmts)f=e.getCurrentTileInfo();else if(e.type===i.LayerType.wms)f=s.TileInfoUtil.parseWMSTileInfo(e,o);else if(e.type===i.LayerType.igsMapImage||e.type===i.LayerType.arcgisMapImage||e.type===i.LayerType.igsFeature||e.type===i.LayerType.wfs||e.type===i.LayerType.geojson){var d=256;e.imageWidth&&e.imageHeight&&(d=Math.max(e.imageWidth,e.imageHeight)),f=s.TileInfoUtil.generateTileInfo(o,d,h)}var p=n.Point.toCoordinates(f.origin),y=[];if(t.forEach(function(e){var t=[];for(e.tileInfo?t=e.tileInfo.lods.map(function(e){return e.clone()}):e.type===i.LayerType.wmts&&(t=e.getCurrentTileInfo().lods.map(function(e){return e.clone()}));t.length>0&&0!==t[0].level;){var r=t[0];t.unshift(s.LOD.fromJSON({level:r.level-1,resolution:2*r.resolution,scale:2*r.scale}))}y=y.concat(t)}),0===y.length&&(y=f.lods),y.sort(function(e,t){return t.resolution-e.resolution}),(0,a.defined)(c))for(;y[0].scale<c;){var g=y[0],v={level:g.level-1,resolution:2*g.resolution,scale:2*g.scale};2*g.scale>c&&g.scale<c&&(v={level:g.level-1,resolution:c/g.scale*g.resolution,scale:c}),y.unshift(s.LOD.fromJSON(v))}if((0,a.defined)(u))for(;y[y.length-1].scale>u;){var m=y[y.length-1],_={level:m.level+1,resolution:m.resolution/2,scale:m.scale/2};m.scale/2<u&&m.scale>u&&(_={level:m.level+1,resolution:u/m.scale*m.resolution,scale:u}),y.push(s.LOD.fromJSON(_))}for(var S=[y[0]],x=1;x<y.length;x++){var b=y[x];S[S.length-1].resolution/b.resolution<=l||S.push(b)}return S.forEach(function(e,t){e.level=t}),{spatialReference:h,resolutions:S.map(function(e){return e.resolution}),origin:p,extent:o,lods:S,tileSize:f.getTileSize(),tileSliceType:e.tileSliceType}},t.getLayersExtent=function(e,t){var r=void 0;return e.forEach(function(e){if(e.extent){var i=void 0;i=s.TileInfoUtil.isSameSpatialReference(e.spatialReference,t)?e.extent:o.Projection.project(e.extent,t),e.spatialReference&&t&&e.loaded&&(r?(r.xmin>i.xmin&&(r.xmin=i.xmin),r.ymin>i.ymin&&(r.ymin=i.ymin),r.xmax<i.xmax&&(r.xmax=i.xmax),r.ymax<i.ymax&&(r.ymax=i.ymax)):r=n.Extent.fromJSON(i.toJSON()))}}),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(11)),i=y(r(16)),o=y(r(3)),a=y(r(0)),s=y(r(2)),l=y(r(4)),u=y(r(7)),c=y(r(5)),f=r(8),h=r(15),d=r(1),p=r(9);function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));e=(0,d.defaultValue)(e,{}),r.id=(0,d.defaultValue)(e.id,(0,d.getGUID)()),r.layerIndex=(0,d.defaultValue)(e.layerIndex,0),r.layerRenderIndex=(0,d.defaultValue)(e.layerRenderIndex,0),r.type=(0,d.defaultValue)(e.layerType,void 0),r.renderType=(0,d.defaultValue)(e.layerRenderType,void 0),r._labelingInfo=(0,d.defaultValue)(e.labelingInfo,[]),r.beginLevel=(0,d.defaultValue)(e.beginLevel,-1),r.endLevel=(0,d.defaultValue)(e.endLevel,-1),r._renderer=(0,d.defaultValue)(e.renderer,void 0),e.originalPoints?r.originPoint=new p.Point({coordinates:[e.originalPoints.x,e.originalPoints.y]}):r.originPoint=void 0,e.frameSizes?r.maxFrameSize=e.frameSizes[0]:r.maxFrameSize=void 0,r.url=(0,d.defaultValue)(e.url||e.configUrl,void 0),e.range?r.range=new p.Extent({xmin:e.range.xMin,ymin:e.range.yMin,xmax:e.range.xMax,ymax:e.range.yMax}):r.range=void 0,e.range3D?r.range3D=new p.Extent({xmin:e.range3D.xMin,ymin:e.range3D.yMin,xmax:e.range3D.xMax,ymax:e.range3D.yMax,zmin:e.range3D.zMin,zmax:e.range3D.zMax}):r.range3D=void 0,r.layer=(0,d.defaultValue)(e.layer,void 0),r.spatialReference=(0,d.defaultValue)(e.spatialReference,void 0);var n=e.sublayers;if(r.sublayers=new f.Collection,n instanceof Array)for(var i=0;i<n.length;i++)r.sublayers.add(new t(n[i]));else n instanceof f.Collection&&n.forEach(function(e){r.sublayers.add(new t(e))});return r.elevationScale=(0,d.defaultValue)(e.elevationScale,void 0),r.requestVertexNormals=(0,d.defaultValue)(e.requestVertexNormals,!1),r.labelLayer=(0,d.defaultValue)(e.labelLayer,void 0),r.layerName=(0,d.defaultValue)(e.layerName,void 0),r._opacity=(0,d.defaultValue)(e.opacity,1),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"reset",value:function(){this.layer&&this.layer._fireUpdateEvent("重置视角",[{name:"reset",params:[this.id],dataChanged:!0,operationType:"method"}])}},{key:"toJSON",value:function(){for(var e=[],r=0;r<this.sublayers.length;r++)e.push((0,d.toJSON)(this.sublayers[r],t));var n=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return(0,i.default)(n,{sublayers:e,layerIndex:this.layerIndex,type:this.type,renderType:this.renderType,beginLevel:this.beginLevel,endLevel:this.endLevel,originPoint:this.originPoint,maxFrameSize:this.maxFrameSize})}}]),t}(h.SubLayer);g.fromJSON=function(e){return new g(e)},(0,n.default)(g.prototype,{renderer:{get:function(){return this._renderer},set:function(e){this._renderer=e,this.layer&&this.layer._fireUpdateEvent("设置专题图",[{name:"renderer",params:[this._renderer,this.id],dataChanged:!0,operationType:"property"}])}},visible:{get:function(){return this._visible},set:function(e){this._visible=e,this.layer&&this.layer._fireUpdateEvent("设置子图层可见性",[{name:"sbuLayerVisible",params:[this._visible,this.id],dataChanged:!0,operationType:"property"}])}},opacity:{get:function(){return this._opacity},set:function(e){this._opacity=e,this.layer&&this.layer._fireUpdateEvent("设置子图层透明度",[{name:"subLayerOpacity",params:[this._opacity,this.id],dataChanged:!0,operationType:"property"}])}},labelingInfo:{get:function(){return this._labelingInfo},set:function(e){this._labelingInfo=e,this.layer&&this.layer._fireUpdateEvent("设置注记图层样式",[{name:"labelingInfo",params:[],dataChanged:!0,operationType:"property"}])}}}),t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),t=(0,i.defaultValue)(t,{}),this.sceneIndex=(0,i.defaultValue)(t.sceneIndex,0),this.sceneName=void 0,this.layer=(0,i.defaultValue)(t.layer,void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(7)),l=h(r(5)),u=r(15),c=r(1),f=r(6);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.LayerType.overlay,r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this)}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.Layer);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(7)),l=c(r(5)),u=r(8);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,o.default)(t,[{key:"createInstance",value:function(e){var t=e;return e instanceof u.Feature||(t=u.Feature.fromJSON(e)),Array.isArray(t._decorateParents)||(t._decorateParents=[]),t._decorateParents.push({instance:this,key:t.id}),t}},{key:"getFeatureById",value:function(e){var t=this.findIndex(function(t){return t.id===e});if(t>-1)return this.items[t]}},{key:"removeFeatureById",value:function(e){var t=this.findIndex(function(t){return t.id===e});return t>-1&&(this._removeEventParent(this.items[t]),this.items.splice(t,1),!0)}},{key:"remove",value:function(e){return this._removeEventParent(e),(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"remove",this).call(this,e)}},{key:"removeMany",value:function(e){var r=this;return e.forEach(function(e){r._removeEventParent(e)}),(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"removeMany",this).call(this,e)}},{key:"removeAll",value:function(){var e=this;this._items.forEach(function(t){e._removeEventParent(t)}),this._items=[],this._fireCollectionChangeEvent({target:this,sourceTarget:this})}},{key:"removeAt",value:function(e){return e<this._items.length&&this._removeEventParent(this._items[e]),(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_removeAt",this).call(this,e)}},{key:"_removeEventParent",value:function(e){var t=this;if(e&&Array.isArray(e._decorateParents)){var r=e._decorateParents.findIndex(function(e){return e.instance===t});r>-1&&e._decorateParents.splice(r,1)}}}],[{key:"collect",value:function(e){return new t(e)}}]),t}(u.Collection);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(r(11)),i=_(r(14)),o=_(r(3)),a=_(r(0)),s=_(r(2)),l=_(r(4)),u=_(r(5)),c=r(8),f=r(1),h=r(6),d=_(r(87)),p=r(9),y=_(r(236)),g=_(r(147)),v=_(r(553)),m=r(68);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this));return e=(0,f.defaultValue)(e,{}),r._map=null,r._id=(0,f.getGUID)(),r._cursor=(0,f.defaultValue)(e.cursor,void 0),r.scale=(0,f.defaultValue)(e.scale,void 0),r.minScale=void 0,r.maxScale=void 0,r.rotation=0,r.center=(0,f.defaultValue)(e.center,[0,0]),r.minZoom=(0,f.defaultValue)(e.minZoom,0),r.maxZoom=(0,f.defaultValue)(e.maxZoom,19),r.zoom=(0,f.defaultValue)(e.zoom,1),r.extensionOptions=(0,f.defaultValue)(e.extensionOptions,{}),r.extendProps=(0,f.defaultValue)(e.extendProps,{}),r.popup=void 0,r.stationary=!0,r._spatialReference=new p.SpatialReference("EPSG:4326"),r.layerViews=new c.Collection,r.basemapLayerViews=new c.Collection,r._viewLayersMap=new y.default,r._graphicsLayers=r._viewLayersMap.groupLayer,r._viewLayersGroupLayerView=void 0,r._setViewLayers(r._graphicsLayers),r.allLayerViews=new c.CollectionFlattener({getCollections:function(){return[r.basemapLayerViews,r.layerViews,r._viewLayersGroupLayerView.layerViews]},getChildrenFunction:function(e){return e.layerViews}}),r._initMapEventHandlers(),r.setMap(e.map),r._viewId=(0,f.defaultValue)(e.viewId,""),r._innerView=null,r._initCursor(),r}return(0,u.default)(t,e),(0,s.default)(t,[{key:"setMap",value:function(e){this._map||(this._map=e instanceof y.default?e:y.default.fromJSON(e),this._linkMapEvent(this._map),this._linkLayerEvent(this._map),this._map._loadLayers(),this.groupLayerView=new g.default({layer:this._map.groupLayer,layerViews:this.layerViews,view:this}),this._map.basemap&&this._setBasemapLayerView())}},{key:"getInnerView",value:function(){return this._innerView}},{key:"getInnerLayer",value:function(e){if(e){var t="string"==typeof e?e:e.id;return(this._findLayerViewById(t)||{}).innerLayer}}},{key:"getLayer",value:function(e){return(this._findLayerViewById(e)||{}).layer}},{key:"_setBasemapLayerView",value:function(){this._basemapView=new v.default({baseGroupLayer:this._map.basemap._baseGroupLayer,baseLayerViews:this.basemapLayerViews,view:this}),this.basemapGroupLayerView=this._basemapView.groupLayerView}},{key:"_removeBasemapLayerView",value:function(){this._basemapView=null,this.basemapGroupLayerView=null}},{key:"_linkLayerEvent",value:function(e){var t=this;if(e){var r=function(r){var n=t;e.on(h.LayerEventType[r],function(e){var t=e;t instanceof c.Event?t.addProperty("view",n):t&&(t.view=n),n.fire(h.LayerEventType[r],t)},e)};for(var n in h.LayerEventType)r(n)}}},{key:"_linkMapEvent",value:function(e){var t=this;if(e){var r=function(r){var n=t;e.on(h.MapEventType[r],function(e){var t=e;t instanceof c.Event?t.addProperty("view",n):t&&(t.view=n),n.fire(h.MapEventType[r],t)})};for(var n in h.MapEventType)r(n)}}},{key:"_getLayerView",value:function(e){if(e)return this._findLayerViewById(e.id)}},{key:"_initMapEventHandlers",value:function(){this.on(h.MapEventType.layerLoaded,this._processEvent,this),this.on(h.MapEventType.layerChange,this._processEvent,this),this.on(h.LayerEventType.layerUpdate,this._processEvent,this),this.on(h.MapEventType.basemapChange,this._processEvent,this)}},{key:"_processEvent",value:function(e){e.type===h.MapEventType.layerChange&&this._processLayerChange(e),e.type===h.MapEventType.layerLoaded&&this._processLayerLoad(e),e.type===h.LayerEventType.layerUpdate&&e.layer instanceof m.Layer&&this._updateLayerView(e.layer,e),e.type===h.MapEventType.basemapChange&&e.detail&&(e.detail.find(function(e){return"baseLayers-destroy"===e.action})?this._removeBasemapLayerView(e):e.detail.find(function(e){return"basemap-create"===e.action})&&(this._basemapView||this._setBasemapLayerView(e)))}},{key:"_processLayerLoad",value:function(e){var t=this;if(e){var r=e.addDetail;this._prePromise||(this._prePromise=i.default.resolve()),this._prePromise=this._prePromise.then(function(){return t._loadViewSpatialReference().then(function(e){if(!1!==e){var n=i.default.resolve();return r.forEach(function(e){n=n.then(function(){var r=e.added,n=e.sourceTarget,i=t._findGroupLayerViewById(n.id);if(i)return i.addMany(r).then(function(e){i._fireLayerViewCreatedByLayerViews(e),Array.isArray(e)&&e.forEach(function(e){i._reorderLayerView(e)})})})}),n}}).catch(function(e){f.Log.error(e)})})}}},{key:"_processLayerChange",value:function(e){var t=this;if(e&&this.groupLayerView){var r=e.added,n=e.removed,i=e.moved,o=e.sourceTarget,a=this._findGroupLayerViewById(o.id);if(a){var s=void 0;0===n.length&&0===r.length&&0===i.length?s=a.removeAll():n.length>0&&(s=a.removeMany(n)),s&&s.then(function(){return t._loadViewSpatialReference().then().catch(function(e){f.Log.info(e)})}),i.length>0&&i.forEach(function(e){a.reorder(e)})}}}},{key:"_findGroupLayerViewById",value:function(e){var t=void 0;return e===this.groupLayerView.id?t=this.groupLayerView:this.basemapGroupLayerView&&e===this.basemapGroupLayerView.id?t=this.basemapGroupLayerView:this._viewLayersMap&&this._viewLayersGroupLayerView&&e===this._viewLayersGroupLayerView.id?t=this._viewLayersGroupLayerView:!(t=this.groupLayerView._findFlatLayerViewById(e))&&this.basemapGroupLayerView&&(t=this.basemapGroupLayerView._findFlatLayerViewById(e)),t}},{key:"_loadViewSpatialReference",value:function(){var e=this;return new i.default(function(t,r){e._map._setSpatialReference(e._spatialReference),e._map.getFullExtent(),e._spatialReference?t(!0):r()})}},{key:"_loadLayerViews",value:function(){var e=this;return new i.default(function(t){e._map._spatialReference=e._spatialReference,e._map._fullExtent=e._fullExtent,t()})}},{key:"_getFlyToCenter",value:function(e){var t=void 0;if(e.center){if(Array.isArray(e.center)&&e.center.length>1){var r=e.center.length>2?[e.center[0],e.center[1],e.center[2]]:[e.center[0],e.center[1]],n=this._innerView.options&&this._innerView.options.crs?this._innerView.options.crs.code:"EPSG:4326";t=new p.Point({coordinates:r,spatialReference:new p.SpatialReference(n)})}else e.center instanceof p.Point?t=p.Point.fromJSON(e.center):e.center instanceof p.Point||f.Log.error("center类型为不支持的类型!");t.spatialReference.isGeographic||(t=c.Projection.project(t,new p.SpatialReference({wkid:4326})))}return t}},{key:"_getFlyToExtent",value:function(e){var t=void 0;return e.extent&&(e.extent instanceof p.Extent?(t=p.Extent.fromJSON(e.extent)).spatialReference.isGeographic||(t=c.Projection.project(t,new p.SpatialReference({wkid:4326}))):f.Log.error("extent类型为不支持的类型!")),t}},{key:"_updateLayerView",value:function(e,t){var r=this,n=this._findLayerViewById(e.id);return n instanceof d.default?n.onUpdate(t).then(function(){return n}).then(function(n){f.Log.info("更新图层",e),t&&(t.addProperty("view",self),t.addProperty("layerView",n)),r.dispatchEvent(h.LayerEventType.layerViewUpdate,t)}):(f.Log.info("图层更新失败,未找到该类型的视图!"),i.default.resolve())}},{key:"dispatchEvent",value:function(e,t,r){return t instanceof c.LayerEvent&&t.layer&&t.layer.fire(e,t,r),this._map&&this._map.dispatchEvent(e,t,r),this._map&&this._map.basemap&&t.layer&&t.layer._isBasemapLayer&&this._map.basemap.dispatchEvent(e,t,r),this}},{key:"_findLayerViewById",value:function(e){var t=this.allLayerViews.items.find(function(t){return t.id===e});return t||(t=this._viewLayersGroupLayerView.allLayerViews.items.find(function(t){return t.id===e})),t}},{key:"_removeLayerViewById",value:function(e){var t=this._findLayerViewById(e);if(t){var r=t.layer.parent;if(r===this._map.groupLayer)this.layerViews.remove(t);else if(r){var n=this._findLayerViewById(r.id);n instanceof g.default&&n.layerViews.remove(t)}}}},{key:"_showLayerByScale",value:function(){var e=this;this._map.allLayers.forEach(function(t){(0,m.showLayerByScale)(e,t)})}},{key:"_orderLayerView",value:function(e,t){if(e instanceof g.default)this._moveGroupLayerView(e,t);else if(t instanceof g.default){var r=this._getLastLayerView(t);this._moveLayerView(e,r)}else if(t instanceof g.default&&e instanceof g.default){var n=this._getLastLayerView(t);this._moveGroupLayerView(e,n)}else this._moveLayerView(e,t)}},{key:"_isLayerViewSupportReorder",value:function(e){return!(e.layer instanceof m.IGSFeatureLayer||e.layer instanceof m.M3DModelCacheLayer||e.layer instanceof m.IGSSceneLayer||e.layer instanceof m.TerrainCacheLayer||e.layer instanceof m.Cesium3DTilesCacheLayer||e.layer instanceof m.GeoJSONLayer||e.layer instanceof m.WFSLayer||e.layer instanceof m.GroupLayer||e.layer instanceof m.EchartsLayer||e.layer instanceof m.MapVLayer||e.layer instanceof m.S3MTilesCacheLayer||e.layer instanceof m.ISSceneLayer)}},{key:"_moveGroupLayerView",value:function(e,t){var r=this;e.allLayerViews.forEach(function(e){e instanceof g.default?r._moveGroupLayerView(e,t):r._moveLayerView(e,t)})}},{key:"_moveLayerView",value:function(e,t){}},{key:"_getLastLayerView",value:function(e){var t=e.toArray(),r=t[t.length-1];return r instanceof g.default?this._getLastLayerView(r):r}},{key:"_createLayerView",value:function(e){return null}},{key:"_initCursor",value:function(){this._setCursor(this.cursor)}},{key:"_setCursor",value:function(e){this._innerView&&(e&&null!==e?this._innerView._container.style.cursor=e:this._innerView._container.style.removeProperty("cursor"),this._cursor=e)}},{key:"_getTargetExtent",value:function(e){var t=void 0;if(e instanceof p.Geometry)e instanceof p.Extent?t=this._getFlyToExtent({extent:e}):e.extent&&(t=this._getFlyToExtent({extent:e.extent}));else{var r=[],n=void 0;Array.isArray(e)?r=e:e instanceof c.Collection&&(r=e.items),r.forEach(function(e){var t=void 0;e instanceof p.Extent?t=e:e instanceof p.Geometry&&e.extent&&(t=e.extent),t.spatialReference.isGeographic||(t=c.Projection.project(t.clone(),new p.SpatialReference("EPSG:4326"))),n?(n.xmin>t.xmin&&(n.xmin=t.xmin),n.xmax<t.xmax&&(n.xmax=t.xmax),n.ymin>t.ymin&&(n.ymin=t.ymin),n.ymax<t.ymax&&(n.ymax=t.ymax)):n=t}),t=this._getFlyToExtent({extent:n})}return t}},{key:"_setViewLayers",value:function(e){this._linkMapEvent(this._viewLayersMap),this._linkLayerEvent(this._viewLayersMap),this._viewLayersGroupLayerView=new g.default({layer:this._viewLayersMap.groupLayer,view:this})}},{key:"_processGraphicsLayersChange",value:function(e){var t=e.added,r=e.removed;t&&t.length>0&&this._viewLayersMap.addMany(t),r&&r.length>0&&this._viewLayersMap.removeMany(r)}},{key:"toJSON",value:function(){return{map:this._map?this._map.toJSON():[],viewId:this.viewId,cursor:this.cursor,scale:this.scale,center:(0,f.toJSON)(this._center,p.Point),minZoom:this.minZoom,maxZoom:this.maxZoom,zoom:this.zoom,extensionOptions:this.extensionOptions,extendProps:this.extendProps}}}]),t}(c.Evented);(0,n.default)(S.prototype,{map:{get:function(){return this._map},set:function(e){this._map=e}},cursor:{get:function(){return this._cursor},set:function(e){this._setCursor(e)}},spatialReference:{get:function(){return this._spatialReference},set:function(){}}}),t.default=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(14)),i=p(r(3)),o=p(r(0)),a=p(r(2)),s=p(r(4)),l=p(r(5)),u=p(r(87)),c=r(8),f=r(6),h=r(97),d=r(1);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r.layerViews=e.layerViews||new c.Collection,r.allLayerViews=new c.CollectionFlattener({getCollections:function(){return[r.layerViews]},getChildrenFunction:function(e){return e.layerViews}}),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"onAdd",value:function(e){var t=this;return this.addMany(this.layer.layers.items).then(function(){return t})}},{key:"add",value:function(e,t){return this.addMany([e],t)}},{key:"remove",value:function(e){return this.removeMany([e])}},{key:"addMany",value:function(e,t){var r=this;if(!e||!this.layerViews)return n.default.resolve([]);var i=this.view,o=this.layer,a=e.filter(function(e){return e&&(e.loaded||e.type===f.LayerType.group)&&o.findLayerById(e.id)&&!r._findLayerViewById(e.id)}).map(function(e){return i._createLayerView(e)}).filter(function(e){return e}),s=(0,h.inOrderPromise)(a.map(function(e){return function(){return e.onAdd().catch(function(t){d.Log.error(t),r._fireLayerCreatedError(e.layer,e,t)}).then(function(e){return e||void 0})}}));return s.catch(function(e){r._fireLayerCreatedError(r.layer,r,e)}),s.then(function(e){var n=e.filter(function(e){return e instanceof u.default});return n.length>0&&(r._setItemParent(n,r),r.layerViews.addMany(n,t)),n})}},{key:"removeMany",value:function(e){var t=this;if(!e||!this.layerViews)return n.default.resolve([]);var r=e.map(function(e){return t._findLayerViewById(e.id)}).filter(function(e){return e});return 0===r.length?n.default.resolve([]):this._removeLayerViews(r)}},{key:"_removeLayerViews",value:function(e){var t=this,r=e.map(function(e){return e.onRemove().then(function(e){return t._fireLayerViewRemove(e.layer,e),e}).catch(function(e){d.Log.error(e)})});return(0,h.allSettled)(r).then(function(e){var r=e.filter(function(e){return"fulfilled"===e.status}).map(function(e){return e.value});t.layerViews.removeMany(r),t._setItemParent(r,null)})}},{key:"removeAll",value:function(){this.layerViews&&this._removeLayerViews(this.layerViews.items.map(function(e){return e}))}},{key:"reorder",value:function(e){var t=this;if(this.layerViews&&e&&e.parent){var r=e.parent,n=this.layerViews.items.findIndex(function(t){return t.id===e.id}),i=r.layers.items.filter(function(e){return t.layerViews.items.some(function(t){return t.id===e.id})}),o=i.findIndex(function(t){return t.id===e.id});if(n!==o&&-1!==n&&-1!==o){var a=this.layerViews.items[n];this.layerViews.reorder(a,o),o===i.length-1?i.slice(0,o).reverse().forEach(function(e){var r=t._findLayerViewById(e.id);r&&t._reorderLayerView(r)}):this._reorderLayerView(a)}}}},{key:"onRemove",value:function(e){var t=this;return this.removeMany(this.layer.layers.items).then(function(){return t})}},{key:"onUpdate",value:function(e){var t=this,r=this.layerViews.items;return n.default.all(r.map(function(t){return t.onUpdate(e)})).then(function(){return t})}},{key:"_setItemParent",value:function(e,t){(e instanceof c.Collection?e._items:Array.isArray(e)?e:[e]).forEach(function(e){e&&(e.parent=t)})}},{key:"_fireLayerViewCreatedByLayerViews",value:function(e){if(Array.isArray(e))for(var r=0;r<e.length;r++){var n=e[r];if(n instanceof u.default){if(n instanceof t){var i=n.layerViews.items;this._fireLayerViewCreatedByLayerViews(i)}this._fireLayerViewCreated(n.layer,n)}}}},{key:"_fireLayerViewCreated",value:function(e,t){var r=new c.LayerEvent({type:f.LayerEventType.layerViewCreated,message:"图层在视图中创建完毕",layer:e});r.addProperty("view",this.view),r.addProperty("layerView",t),e.fire(f.LayerEventType.layerViewCreated,r),this.view.fire(f.LayerEventType.layerViewCreated,r)}},{key:"_fireLayerCreatedError",value:function(e,t,r){var n=new c.LayerEvent({type:f.LayerEventType.layerViewCreatedError,target:e,error:r||"图层在视图中创建失败",layer:e});n.addProperty("view",this.view),n.addProperty("layerView",t),e.fire(f.LayerEventType.layerViewCreatedError,n),this.view.fire(f.LayerEventType.layerViewCreatedError,n)}},{key:"_fireLayerViewRemove",value:function(e,t){var r=new c.LayerEvent({type:f.LayerEventType.layerViewRemove,message:"移除图层视图",layer:e});r.addProperty("view",this.view),r.addProperty("layerView",t),e.fire(f.LayerEventType.layerViewRemove,r),this.view.fire(f.LayerEventType.layerViewRemove,r)}},{key:"_findLayerViewById",value:function(e){return this.layerViews.items.find(function(t){return t.id===e})}},{key:"_findFlatLayerViewById",value:function(e){return this.allLayerViews.items.find(function(t){return t.id===e})}},{key:"_findLastLayerViewById",value:function(e){var r=this.view;if(e&&r){var n=this._findLayerViewById(e);if(n){var i=n;if(n instanceof t){var o=n.allLayerViews.items.filter(function(e){return!(e instanceof t)});if(0===o.length)return;i=o[o.length-1]}var a=r.allLayerViews.items.findIndex(function(e){return e.id===i.id});if(-1!==a){var s=r.allLayerViews.items.slice(a+1).filter(function(e){return!(e instanceof t)});if(0!==s.length)return s[0]}}}}},{key:"_reorderLayerView",value:function(e){var t=this._findLastLayerViewById(e.id);t&&this.view._orderLayerView(e,t)}}]),t}(u.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SketchEditorEvent=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.SketchEditorEvent=function e(t){(0,n.default)(this,e);var r=(0,i.defaultValue)(t,{});this.type=(0,i.defaultValue)(r.type,""),this.toolEventInfo=(0,i.defaultValue)(r.toolEventInfo,null),this.state=(0,i.defaultValue)(r.state,null),this.feature=(0,i.defaultValue)(r.feature,null)}},function(e,t,r){var n=r(33),i=r(44),o=r(248)(!1),a=r(109)("IE_PROTO");e.exports=function(e,t){var r,s=i(e),l=0,u=[];for(r in s)r!=a&&n(s,r)&&u.push(r);for(;t.length>l;)n(s,r=t[l++])&&(~o(u,r)||u.push(r));return u}},function(e,t,r){e.exports=!r(26)&&!r(52)(function(){return 7!=Object.defineProperty(r(112)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(27),i=r(28),o=r(61);e.exports=r(26)?Object.defineProperties:function(e,t){i(e);for(var r,a=o(t),s=a.length,l=0;s>l;)n.f(e,r=a[l++],t[r]);return e}},function(e,t,r){e.exports=r(45)},function(e,t,r){var n=r(20).document;e.exports=n&&n.documentElement},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){var n=r(28);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},function(e,t,r){var n=r(64),i=r(21)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},function(e,t,r){var n=r(28),i=r(74),o=r(21)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||void 0==(r=n(a)[o])?t:i(r)}},function(e,t,r){var n,i,o,a=r(34),s=r(259),l=r(153),u=r(112),c=r(20),f=c.process,h=c.setImmediate,d=c.clearImmediate,p=c.MessageChannel,y=c.Dispatch,g=0,v={},m=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},_=function(e){m.call(e.data)};h&&d||(h=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),t)},n(g),g},d=function(e){delete v[e]},"process"==r(72)(f)?n=function(e){f.nextTick(a(m,e,1))}:y&&y.now?n=function(e){y.now(a(m,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=_,n=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(e){c.postMessage(e+"","*")},c.addEventListener("message",_,!1)):n="onreadystatechange"in u("script")?function(e){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),e.exports={set:h,clear:d}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){var n=r(28),i=r(24),o=r(118);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){"use strict";var n=r(20),i=r(12),o=r(27),a=r(26),s=r(21)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:n[e];a&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(21)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},e(o)}catch(e){}return r}},function(e,t,r){var n=r(72);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){var n=r(149),i=r(111).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){e.exports={default:r(290),__esModule:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(2)),a=u(r(4)),s=u(r(7)),l=u(r(5));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,o.default)(t,[{key:"initPropertys",value:function(e){var r=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"initPropertys",this).call(this,e);return this.layer=r.layer,this.message=r.message,this.layerView=r.layerView,this.view=r.view,r}}]),t}(u(r(47)).default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayerViewUpdateEvent=t.LayerViewUpdateContent=void 0;var n=c(r(3)),i=c(r(2)),o=c(r(4)),a=c(r(7)),s=c(r(5)),l=c(r(0)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,i.default)(t,[{key:"initPropertys",value:function(e){var r=(0,a.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"initPropertys",this).call(this,e);return this.updateContent=(0,u.defaultValue)(r.updateContent,[]),r}}]),t}(c(r(166)).default);t.LayerViewUpdateContent=function e(t){(0,l.default)(this,e);var r=(0,u.defaultValue)(t,{});this.dataChanged=(0,u.defaultValue)(r.dataChanged,!1),this.name=(0,u.defaultValue)(r.name,""),this.operationType=(0,u.defaultValue)(r.operationType,"method"),this.params=(0,u.defaultValue)(r.params,[]),this.extendProps=(0,u.defaultValue)(r.extendProps,{})},t.LayerViewUpdateEvent=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",auqamarin:"#7fffaa",azure:"#f0ffff",beige:"#6b8e23",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",brulywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornislk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkvoilet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",doderblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e1ffff",lightgoldenrodyellow:"#fafad2",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#00fa9a",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumslateblue:"#7b68ee",mediumspringgreen:"#f5fffa",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#00ff7f",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#556b2f",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegodenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#3cb371",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={backwardDiagonal:"backward-diagonal",cross:"cross",diagonalCross:"diagonal-cross",forwardDiagonal:"forward-diagonal",horizontal:"horizontal",none:"none",solid:"solid",vertical:"vertical"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={small:"small",medium:"medium",large:"large"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={calm:"calm",rippled:"rippled",slight:"slight",moderate:"moderate"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={field:"field",log:"log",percentOfTotal:"percent-of-total"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.extent=(0,o.defaultValue)(t.extent,void 0),this.id=(0,o.defaultValue)(t.id,(0,o.getGUID)()),this.tileInfo=t.tileInfo,this.layer=(0,o.defaultValue)(t.layer,void 0),this.tileMatrix=(0,o.defaultValue)(t.tileMatrix,[]),this.identifier=(0,o.defaultValue)(t.identifier,void 0),this.supportedCRS=(0,o.defaultValue)(t.supportedCRS,void 0)}return(0,i.default)(e,[{key:"getTileResolution",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.28,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=0;n<this.tileMatrix.length;n++){var i=t?Number(this.tileMatrix[n].scaleDenominator)*e/111319490.7932735:Number(this.tileMatrix[n].scaleDenominator)*e/1e3;r.push(i)}return r}},{key:"toJSON",value:function(){return{extent:this.extent&&this.extent.toJSON(),id:this.id,tileInfo:this.tileInfo&&this.tileInfo.toJSON(),tileMatrix:this.tileMatrix,identifier:this.identifier,supportedCRS:this.supportedCRS}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e);var r=(0,o.defaultValue)(t,{});this.expression=(0,o.defaultValue)(r.expression,"")}return(0,i.default)(e,[{key:"clone",value:function(){return new e({expression:this.expression})}},{key:"toJSON",value:function(){return{expression:this.expression}}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(23)),i=y(r(10)),o=y(r(3)),a=y(r(0)),s=y(r(2)),l=y(r(4)),u=y(r(5)),c=y(r(80)),f=r(1),h=r(9),d=r(22),p=r(6);function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,f.defaultValue)(e,{}),r.id=(0,f.defaultValue)(e.id,(0,f.getGUID)()),r.attributes=(0,f.defaultValue)(e.attributes,{}),(0,f.defined)(e.geometry)?r.geometry=r._decorate("geometry",e.geometry,h.Geometry,h.Geometry.fromJSON):(r.geometry=null,f.Log.warning("要素几何信息缺失，依赖几何对象的功能将无法使用！")),r.symbol=r._decorate("symbol",e.symbol,d.Symbol,r._getSymbol.bind(r)),r.visible=(0,f.defaultValue)(e.visible,!0),r.type="Feature",r.elevationInfo=(0,f.defaultValue)(e.elevationInfo,null),r.additional=(0,f.defaultValue)(e.additional,{}),r.styleInfo=(0,f.defaultValue)(e.styleInfo,{}),r}return(0,u.default)(t,e),(0,s.default)(t,[{key:"_getSymbol",value:function(e){if(!(0,f.defined)(this.geometry))return d.Symbol.fromJSON(e);var t=e?e.type:"undefine",r=this.geometry.type,n=e instanceof d.Symbol?e:d.Symbol.fromJSON(e);switch(r){case p.GeometryType.multiPoint:case p.GeometryType.point:var i=[p.SymbolType.simpleMarker,p.SymbolType.text,p.SymbolType.mapgisText,p.SymbolType.pictureMarker,p.SymbolType.point3D,p.SymbolType.label3D];(0,f.defined)(e)||(n=new d.SimpleMarkerSymbol),i.some(function(e){return e===t})||(f.Log.info("图元几何和符号不匹配"),n=new d.SimpleMarkerSymbol({color:n.color.clone()}));break;case p.GeometryType.multiLineString:case p.GeometryType.lineString:var o=[p.SymbolType.simpleLine,p.SymbolType.line3D];(0,f.defined)(e)||(n=new d.SimpleLineSymbol),o.some(function(e){return e===t})||(f.Log.info("图元几何和符号不匹配"),n=new d.SimpleLineSymbol({color:n.color.clone()}));break;case p.GeometryType.polygon:case p.GeometryType.extent:case p.GeometryType.circle:case p.GeometryType.multiPolygon:var a=[p.SymbolType.simpleFill,p.SymbolType.simpleMarker,p.SymbolType.text,p.SymbolType.mapgisText,p.SymbolType.pictureMarker,p.SymbolType.pictureFill,p.SymbolType.polygon3D];(0,f.defined)(e)||(n=new d.SimpleFillSymbol),a.some(function(e){return e===t})||(f.Log.info("图元几何和符号不匹配"),n=new d.SimpleFillSymbol({color:n.color.clone()}))}return n}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toJSON",value:function(){var e={};return e.id=this.id,e.attributes=JSON.parse((0,i.default)(this.attributes)),e.geometry=(0,f.toJSON)(this.geometry,h.Geometry),e.symbol=(0,f.toJSON)(this.symbol,d.Symbol),e.visible=this.visible,e.type=this.type,e.elevationInfo=this.elevationInfo,e}},{key:"fromGeoJSON",value:function(e){var t=this;e=(0,f.defaultValue)(e,{});var r=(0,f.defaultValue)(e.geometry,null);(0,f.defined)(r)&&(this.geometry=h.Geometry.fromGeoJSON(r));var i=(0,f.defaultValue)(e.properties,{});(0,n.default)(i).forEach(function(e){i.hasOwnProperty(e)&&(t.attributes[e]=i[e])})}},{key:"toGeoJSON",value:function(){var e=JSON.parse((0,i.default)(this.attributes));return e.id=this.id,{type:"Feature",geometry:(0,f.toJSON)(this.geometry,h.Geometry),properties:e,style:(0,f.toJSON)(this.geometry,d.Symbol),id:this.id}}},{key:"toIGSFeature",value:function(){var e=null;this.styleInfo instanceof Object&&"{}"!==(0,i.default)(this.styleInfo)&&(e=JSON.parse((0,i.default)(this.styleInfo)));var t=this.geometry.toJSON();return{type:"Feature",geometry:{type:t.type,coordinates:t.coordinates},attributes:JSON.parse((0,i.default)(this.attributes)),styleInfo:e}}},{key:"toOldIGSFeature",value:function(){return{fGeom:this.geometry.toOldIGSGeometry(),GraphicInfo:this.toGraphicInfo(),AttValue:this.toAttValue(),FID:this.id,bound:null,ftype:this.toFType()}}},{key:"toGraphicInfo",value:function(){var e=void 0;switch(this.geometry.type){case"Point":case"MultiPoint":e={InfoType:1,PntInfo:this.symbol};break;case"LineString":case"MultiLineString":e={InfoType:2,LinInfo:this.symbol};break;case"Polygon":case"MultiPolygon":default:e={InfoType:3,RegInfo:this.symbol}}return e}},{key:"toAttValue",value:function(){var e=[],t=this;return(0,n.default)(this.attributes).forEach(function(r){t.attributes.hasOwnProperty(r)&&e.push(t.attributes[r])}),e}},{key:"toFType",value:function(){var e=void 0;switch(this.geometry.type){case"Point":case"MultiPoint":e=1;break;case"LineString":case"MultiLineString":e=2;break;case"Polygon":case"MultiPolygon":default:e=3}return e}}],[{key:"fromJSON",value:function(e){return new t(e=(0,f.defaultValue)(e,{}))}}]),t}(c.default);t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSymbol3DLayer=t.WaterSymbol3DLayer=t.TextSymbol3DLayer=t.ExtrudeSymbol3DLayer=t.ObjectSymbol3DLayer=t.IconSymbol3DLayer=t.FillSymbol3DLayer=t.LineSymbol3DLayer=t.PathSymbol3DLayer=t.Symbol3DLayer=void 0;var n=d(r(48)),i=d(r(358)),o=d(r(369)),a=d(r(370)),s=d(r(371)),l=d(r(372)),u=d(r(373)),c=d(r(374)),f=d(r(375)),h=r(6);function d(e){return e&&e.__esModule?e:{default:e}}t.Symbol3DLayer=n.default,t.PathSymbol3DLayer=i.default,t.LineSymbol3DLayer=o.default,t.FillSymbol3DLayer=a.default,t.IconSymbol3DLayer=s.default,t.ObjectSymbol3DLayer=l.default,t.ExtrudeSymbol3DLayer=u.default,t.TextSymbol3DLayer=c.default,t.WaterSymbol3DLayer=f.default,t.createSymbol3DLayer=function(e){var t=e||{},r=null;switch(t.type){case h.Symbol3DLayerType.line:r=new o.default(t);break;case h.Symbol3DLayerType.path:r=new i.default(t);break;case h.Symbol3DLayerType.fill:r=new a.default(t);break;case h.Symbol3DLayerType.icon:r=new s.default(t);break;case h.Symbol3DLayerType.object:r=new l.default(t);break;case h.Symbol3DLayerType.extrude:r=new u.default(t);break;case h.Symbol3DLayerType.text:r=new c.default(t);break;case h.Symbol3DLayerType.water:r=new f.default(t)}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(0)),i=o(r(2));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(){(0,n.default)(this,e)}return(0,i.default)(e,[{key:"toJSON",value:function(){}},{key:"clone",value:function(){}}],[{key:"fromJSON",value:function(){}}]),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=r(8);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.color=t.color?a.Color.fromJSON(t.color):new a.Color,this.size=(0,o.defaultValue)(t.size,0)}return(0,i.default)(e,[{key:"toJSON",value:function(){return{color:(0,o.toJSON)(this.color,a.Color),size:this.size}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=r(6);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.style=(0,o.defaultValue)(t.style,a.LinePatternStyle.solid),this.type="style"}return(0,i.default)(e,[{key:"toJSON",value:function(){return{style:this.style,type:this.type}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(3)),i=g(r(0)),o=g(r(2)),a=g(r(4)),s=g(r(7)),l=g(r(5)),u=g(r(56)),c=r(1),f=r(6),h=g(r(54)),d=g(r(128)),p=g(r(129)),y=g(r(125));function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.SymbolType.text,r.angle=(0,c.defaultValue)(e.angle,0),r.backgroundColor=(0,c.defined)(e.backgroundColor)?h.default.fromColor((0,c.defaultValue)(e.backgroundColor,new h.default(255,255,255,.25))):void 0,r.borderLineColor=h.default.fromColor((0,c.defaultValue)(e.borderLineColor,new h.default(0,0,0,1))),r.borderLineSize=(0,c.defaultValue)(e.borderLineSize,0),r.color=h.default.fromColor((0,c.defaultValue)(e.color,new h.default)),r.font=y.default.fromJSON((0,c.defaultValue)(e.font,{})),r.haloColor=h.default.fromColor((0,c.defaultValue)(e.haloColor,new h.default)),r.haloSize=(0,c.defaultValue)(e.haloSize,0),r.horizontalAlignment=(0,c.defaultValue)(e.horizontalAlignment,d.default.center),r.kerning=(0,c.defaultValue)(e.kerning,!1),r.lineHeight=(0,c.defaultValue)(e.lineHeight,1.1),r.lineWidth=(0,c.defaultValue)(e.lineWidth,192),r.rotated=(0,c.defaultValue)(e.rotated,!1),r.text=(0,c.defaultValue)(e.text,""),r.verticalAlignment=(0,c.defaultValue)(e.verticalAlignment,p.default.baseline),r.xoffset=(0,c.defaultValue)(e.xoffset,0),r.yoffset=(0,c.defaultValue)(e.yoffset,0),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.angle=this.angle,e.backgroundColor=(0,c.toJSON)(this.backgroundColor,h.default),e.borderLineColor=(0,c.toJSON)(this.borderLineColor,h.default),e.borderLineSize=this.borderLineSize,e.color=(0,c.toJSON)(this.color,h.default),e.font=(0,c.toJSON)(this.font,y.default),e.haloColor=(0,c.toJSON)(this.haloColor,h.default),e.haloSize=this.haloSize,e.horizontalAlignment=this.horizontalAlignment,e.kerning=this.kerning,e.lineHeight=this.lineHeight,e.lineWidth=this.lineWidth,e.rotated=this.rotated,e.text=this.text,e.verticalAlignment=this.verticalAlignment,e.xoffset=this.xoffset,e.yoffset=this.yoffset,e}}],[{key:"fromJSON",value:function(e){return new t(e=(0,c.defaultValue)(e,{}))}}]),t}(u.default);t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(7)),l=f(r(5)),u=r(1),c=r(6);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.type=c.SymbolType.simpleMarker,r.xoffset=(0,u.defaultValue)(e.xoffset,0),r.yoffset=(0,u.defaultValue)(e.yoffset,0),r.angle=(0,u.defaultValue)(e.angle,0),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.angle=this.angle,e.xoffset=this.xoffset,e.yoffset=this.yoffset,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(f(r(56)).default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=r(1),c=d(r(56)),f=d(r(134)),h=r(6);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.type=h.SymbolType.simpleFill,r.outline=r._decorate("outline",e.outline,f.default,f.default.fromJSON),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.outline=this.outline.toJSON(),e}}]),t}(c.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDataSource=t.getFeaturesFromFeatureSet=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(10)),i=r(133),o=r(1),a=r(9),s=r(8),l=r(36),u=r(388),c={"urn:ogc:def:crs:OGC:1.3:CRS84":"EPSG:4326","EPSG:4326":"EPSG:4326","urn:ogc:def:crs:EPSG::4326":"EPSG:4326"},f={},h={},d={Feature:y,FeatureCollection:function(e,t,r,n){for(var i=t.features,o=0,a=i.length;o<a;o++)y(e,i[o],void 0,n)},GeometryCollection:g,LineString:m,MultiLineString:_,MultiPoint:S,MultiPolygon:x,Point:b,Polygon:w,Topology:k},p={GeometryCollection:g,LineString:m,MultiLineString:_,MultiPoint:S,MultiPolygon:x,Point:b,Polygon:w,Topology:k};function y(e,t,r,n){if(null!==t.geometry){if(!(0,o.defined)(t.geometry))throw new Error("feature.geometry is required.");var i=t.geometry.type,a=p[i];if(!(0,o.defined)(a))throw new Error("Unknown geometry type: "+i);a(e,t,t.geometry,n)}}function g(e,t,r,n){for(var i=r.geometries,a=0,s=i.length;a<s;a++){var l=i[a],u=l.type,c=p[u];if(!(0,o.defined)(c))throw new Error("Unknown geometry type: "+u);c(e,t,l,n)}}function v(e,t,r){var n={};e&&"Feature"===e.type&&(n=e.properties||{});var o=(0,l.createGeometryByGeoJSON)(t,r);return new i.Feature({geometry:o,attributes:n})}function m(e,t,r,n){e.features.push(v(t,r,n))}function _(e,t,r,n){e.features.push(v(t,r,n))}function S(e,t,r,n){e.features.push(v(t,r,n))}function x(e,t,r,n){e.features.push(v(t,r,n))}function b(e,t,r,n){e.features.push(v(t,r,n))}function w(e,t,r,n){e.features.push(v(t,r,n))}function k(e,t,r,n){for(var i in r.objects)if(r.objects.hasOwnProperty(i)){var o=(0,u.feature)(r,r.objects[i]);(0,d[o.type])(e,o,o,n)}}t.getFeaturesFromFeatureSet=function(e){var t=[];e instanceof i.FeatureSet?t=e.features:Array.isArray(e)&&e.every(function(e){return e instanceof i.Feature})?t=e:o.Log.info("传入要素集错误");for(var r=[],n=0;n<t.length;n++)r[n]=i.Feature.fromJSON(t[n].toJSON());return r},t.convertDataSource=function(e){var t=(e=e||{}).type,r=d[t];if(!r)throw new Error("无法解析type为"+t+"的数据类型，请检查输入参数的类型是否合法");var l=e.crs,u=new a.SpatialReference("EPSG:4326");if((0,o.defined)(l)){if(!(0,o.defined)(l.properties))throw new Error("crs.properties is undefined.");var p=l.properties;if("name"===l.type){var y=c[p.name];u=y?new a.SpatialReference(y):new a.SpatialReference({wkt:p.name})}else if("link"===l.type){if(u=f[p.href],(0,o.defined)(u)||(u=h[p.type]),!(0,o.defined)(u))throw new Error("Unable to resolve crs link: "+(0,n.default)(p))}else{if("EPSG"!==l.type)throw new Error("Unknown crs type: "+l.type);if(!s.EPSG.some(function(e){return e.id===parseInt(p.code)}))throw new Error("Unknown crs EPSG code: "+p.code);u=new a.SpatialReference("EPSG:"+p.code)}}var g=new i.FeatureSet({spatialReference:u});return r(g,e,e,g.spatialReference),g}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProjUnitWkidMap={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5e4,15e4],2000:0,2001:0,2002:0,2003:0,2004:0,2005:0,2006:0,2007:0,2008:0,2009:0,2010:0,2011:0,2012:0,2013:0,2014:0,2015:0,2016:0,2017:0,2018:0,2019:0,2020:0,2021:0,2022:0,2023:0,2024:0,2025:0,2026:0,2027:0,2028:0,2029:0,2030:0,2031:0,2032:0,2033:0,2034:0,2035:0,2036:0,2037:0,2038:0,2039:0,2040:0,2041:0,2042:0,2043:0,2044:0,2045:0,2056:0,2057:0,2058:0,2059:0,2060:0,2061:0,2062:0,2063:0,2064:0,2065:0,2066:5,2067:0,2068:0,2069:0,2070:0,2071:0,2072:0,2073:0,2074:0,2075:0,2076:0,2077:0,2078:0,2079:0,2080:0,2081:0,2082:0,2083:0,2084:0,2085:0,2086:0,2087:0,2088:0,2089:0,2090:0,2091:0,2092:0,2093:0,2094:0,2095:0,2096:0,2097:0,2098:0,2099:0,2100:0,2101:0,2102:0,2103:0,2104:0,2105:0,2106:0,2107:0,2108:0,2109:0,2110:0,2111:0,2112:0,2113:0,2114:0,2115:0,2116:0,2117:0,2118:0,2119:0,2120:0,2121:0,2122:0,2123:0,2124:0,2125:0,2126:0,2127:0,2128:0,2129:0,2130:0,2131:0,2132:0,2133:0,2134:0,2135:0,2136:12,2137:0,2138:0,2139:0,2140:0,2141:0,2142:0,2143:0,2144:0,2145:0,2146:0,2147:0,2148:0,2149:0,2150:0,2151:0,2152:0,2153:0,2154:0,2155:2,2157:0,2158:0,2159:12,2160:12,2161:0,2162:0,2163:0,2164:0,2165:0,2166:0,2167:0,2168:0,2169:0,2170:0,2172:0,2173:0,2174:0,2175:0,2176:0,2177:0,2178:0,2179:0,2180:0,2181:0,2182:0,2183:0,2184:0,2185:0,2186:0,2187:0,2188:0,2189:0,2190:0,2191:0,2192:0,2193:0,2195:0,2196:0,2197:0,2198:0,2200:0,2201:0,2202:0,2203:0,2204:2,2205:0,2206:0,2207:0,2208:0,2209:0,2210:0,2211:0,2212:0,2213:0,2214:0,2215:0,2216:0,2217:0,2219:0,2220:0,2222:1,2223:1,2224:1,2225:2,2226:2,2227:2,2228:2,2229:2,2230:2,2231:2,2232:2,2233:2,2234:2,2235:2,2236:2,2237:2,2238:2,2239:2,2240:2,2241:2,2242:2,2243:2,2244:2,2245:2,2246:2,2247:2,2248:2,2249:2,2250:2,2251:1,2252:1,2253:1,2254:2,2255:2,2256:1,2257:2,2258:2,2259:2,2260:2,2261:2,2262:2,2263:2,2264:2,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2274:2,2275:2,2276:2,2277:2,2278:2,2279:2,2280:1,2281:1,2282:1,2283:2,2284:2,2285:2,2286:2,2287:2,2288:2,2289:2,2290:0,2291:0,2292:0,2294:0,2295:0,2308:0,2309:0,2310:0,2311:0,2312:0,2313:0,2314:3,2315:0,2316:0,2317:0,2318:0,2319:0,2320:0,2321:0,2322:0,2323:0,2324:0,2325:0,2326:0,2327:0,2328:0,2329:0,2330:0,2331:0,2332:0,2333:0,2334:0,2335:0,2336:0,2337:0,2338:0,2339:0,2340:0,2341:0,2342:0,2343:0,2344:0,2345:0,2346:0,2347:0,2348:0,2349:0,2350:0,2351:0,2352:0,2353:0,2354:0,2355:0,2356:0,2357:0,2358:0,2359:0,2360:0,2361:0,2362:0,2363:0,2364:0,2365:0,2366:0,2367:0,2368:0,2369:0,2370:0,2371:0,2372:0,2373:0,2374:0,2375:0,2376:0,2377:0,2378:0,2379:0,2380:0,2381:0,2382:0,2383:0,2384:0,2385:0,2386:0,2387:0,2388:0,2389:0,2390:0,2391:0,2392:0,2393:0,2394:0,2395:0,2396:0,2397:0,2398:0,2399:0,2400:0,2401:0,2402:0,2403:0,2404:0,2405:0,2406:0,2407:0,2408:0,2409:0,2410:0,2411:0,2412:0,2413:0,2414:0,2415:0,2416:0,2417:0,2418:0,2419:0,2420:0,2421:0,2422:0,2423:0,2424:0,2425:0,2426:0,2427:0,2428:0,2429:0,2430:0,2431:0,2432:0,2433:0,2434:0,2435:0,2436:0,2437:0,2438:0,2439:0,2440:0,2441:0,2442:0,2443:0,2444:0,2445:0,2446:0,2447:0,2448:0,2449:0,2450:0,2451:0,2452:0,2453:0,2454:0,2455:0,2456:0,2457:0,2458:0,2459:0,2460:0,2461:0,2462:0,2523:0,2524:0,2525:0,2526:0,2527:0,2528:0,2529:0,2530:0,2531:0,2532:0,2533:0,2534:0,2535:0,2536:0,2537:0,2538:0,2539:0,2540:0,2541:0,2542:0,2543:0,2544:0,2545:0,2546:0,2547:0,2548:0,2549:0,2550:0,2551:0,2552:0,2553:0,2554:0,2555:0,2556:0,2557:0,2558:0,2559:0,2560:0,2561:0,2562:0,2563:0,2564:0,2565:0,2566:0,2567:0,2568:0,2569:0,2570:0,2571:0,2572:0,2573:0,2574:0,2575:0,2576:0,2577:0,2578:0,2579:0,2580:0,2581:0,2582:0,2583:0,2584:0,2585:0,2586:0,2587:0,2588:0,2589:0,2590:0,2591:0,2592:0,2593:0,2594:0,2595:0,2596:0,2597:0,2598:0,2599:0,2600:0,2601:0,2602:0,2603:0,2604:0,2605:0,2606:0,2607:0,2608:0,2609:0,2610:0,2611:0,2612:0,2613:0,2614:0,2615:0,2616:0,2617:0,2618:0,2619:0,2620:0,2621:0,2622:0,2623:0,2624:0,2625:0,2626:0,2627:0,2628:0,2629:0,2630:0,2631:0,2632:0,2633:0,2634:0,2635:0,2636:0,2637:0,2638:0,2639:0,2640:0,2641:0,2642:0,2643:0,2644:0,2645:0,2646:0,2647:0,2648:0,2649:0,2650:0,2651:0,2652:0,2653:0,2654:0,2655:0,2656:0,2657:0,2658:0,2659:0,2660:0,2661:0,2662:0,2663:0,2664:0,2665:0,2666:0,2667:0,2668:0,2669:0,2670:0,2671:0,2672:0,2673:0,2674:0,2675:0,2676:0,2677:0,2678:0,2679:0,2680:0,2681:0,2682:0,2683:0,2684:0,2685:0,2686:0,2687:0,2688:0,2689:0,2690:0,2691:0,2692:0,2693:0,2694:0,2695:0,2696:0,2697:0,2698:0,2699:0,2700:0,2701:0,2702:0,2703:0,2704:0,2705:0,2706:0,2707:0,2708:0,2709:0,2710:0,2711:0,2712:0,2713:0,2714:0,2715:0,2716:0,2717:0,2718:0,2719:0,2720:0,2721:0,2722:0,2723:0,2724:0,2725:0,2726:0,2727:0,2728:0,2729:0,2730:0,2731:0,2732:0,2733:0,2734:0,2735:0,2736:0,2737:0,2738:0,2739:0,2740:0,2741:0,2742:0,2743:0,2744:0,2745:0,2746:0,2747:0,2748:0,2749:0,2750:0,2751:0,2752:0,2753:0,2754:0,2755:0,2756:0,2757:0,2758:0,2759:0,2760:0,2761:0,2762:0,2763:0,2764:0,2765:0,2766:0,2767:0,2768:0,2769:0,2770:0,2771:0,2772:0,2773:0,2774:0,2775:0,2776:0,2777:0,2778:0,2779:0,2780:0,2781:0,2782:0,2783:0,2784:0,2785:0,2786:0,2787:0,2788:0,2789:0,2790:0,2791:0,2792:0,2793:0,2794:0,2795:0,2796:0,2797:0,2798:0,2799:0,2800:0,2801:0,2802:0,2803:0,2804:0,2805:0,2806:0,2807:0,2808:0,2809:0,2810:0,2811:0,2812:0,2813:0,2814:0,2815:0,2816:0,2817:0,2818:0,2819:0,2820:0,2821:0,2822:0,2823:0,2824:0,2825:0,2826:0,2827:0,2828:0,2829:0,2830:0,2831:0,2832:0,2833:0,2834:0,2835:0,2836:0,2837:0,2838:0,2839:0,2840:0,2841:0,2842:0,2843:0,2844:0,2845:0,2846:0,2847:0,2848:0,2849:0,2850:0,2851:0,2852:0,2853:0,2854:0,2855:0,2856:0,2857:0,2858:0,2859:0,2860:0,2861:0,2862:0,2863:0,2864:0,2865:0,2866:0,2867:1,2868:1,2869:1,2870:2,2871:2,2872:2,2873:2,2874:2,2875:2,2876:2,2877:2,2878:2,2879:2,2880:2,2881:2,2882:2,2883:2,2884:2,2885:2,2886:2,2887:2,2888:2,2891:2,2892:2,2893:2,2894:2,2895:2,2896:1,2897:1,2898:1,2899:2,2900:2,2901:1,2902:2,2903:2,2904:2,2905:2,2906:2,2907:2,2908:2,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2915:2,2916:2,2917:2,2918:2,2919:2,2920:2,2921:1,2922:1,2923:1,2924:2,2925:2,2926:2,2927:2,2928:2,2929:2,2930:2,2931:0,2932:0,2933:0,2934:0,2935:0,2936:0,2937:0,2938:0,2939:0,2940:0,2941:0,2942:0,2943:0,2944:0,2945:0,2946:0,2947:0,2948:0,2949:0,2950:0,2951:0,2952:0,2953:0,2954:0,2955:0,2956:0,2957:0,2958:0,2959:0,2960:0,2961:0,2962:0,2964:2,2965:2,2966:2,2967:2,2968:2,2969:0,2970:0,2971:0,2972:0,2973:0,2975:0,2976:0,2977:0,2978:0,2979:0,2980:0,2981:0,2982:0,2983:0,2984:0,2985:0,2986:0,2987:0,2988:0,2989:0,2990:0,2991:0,2992:1,2993:0,2994:1,2995:0,2996:0,2997:0,2998:0,2999:0,3000:0,3001:0,3002:0,3003:0,3004:0,3005:0,3006:0,3007:0,3008:0,3009:0,3010:0,3011:0,3012:0,3013:0,3014:0,3015:0,3016:0,3017:0,3018:0,3019:0,3020:0,3021:0,3022:0,3023:0,3024:0,3025:0,3026:0,3027:0,3028:0,3029:0,3030:0,3031:0,3032:0,3033:0,3034:0,3035:0,3036:0,3037:0,3038:0,3039:0,3040:0,3041:0,3042:0,3043:0,3044:0,3045:0,3046:0,3047:0,3048:0,3049:0,3050:0,3051:0,3054:0,3055:0,3056:0,3057:0,3058:0,3059:0,3060:0,3061:0,3062:0,3063:0,3064:0,3065:0,3066:0,3067:0,3068:0,3069:0,3070:0,3071:0,3072:0,3073:0,3074:0,3075:0,3076:0,3077:0,3078:0,3079:0,3080:1,3081:0,3082:0,3083:0,3084:0,3085:0,3086:0,3087:0,3088:0,3089:2,3090:0,3091:2,3092:0,3093:0,3094:0,3095:0,3096:0,3097:0,3098:0,3099:0,3100:0,3101:0,3102:2,3106:0,3107:0,3108:0,3109:0,3110:0,3111:0,3112:0,3113:0,3114:0,3115:0,3116:0,3117:0,3118:0,3119:0,3120:0,3121:0,3122:0,3123:0,3124:0,3125:0,3126:0,3127:0,3128:0,3129:0,3130:0,3131:0,3132:0,3133:0,3134:0,3135:0,3136:0,3137:0,3138:0,3141:0,3142:0,3146:0,3147:0,3148:0,3149:0,3150:0,3151:0,3153:0,3154:0,3155:0,3156:0,3157:0,3158:0,3159:0,3160:0,3161:0,3162:0,3163:0,3164:0,3165:0,3166:0,3167:13,3168:0,3169:0,3170:0,3171:0,3172:0,3174:0,3175:0,3176:0,3177:0,3178:0,3179:0,3180:0,3181:0,3182:0,3183:0,3184:0,3185:0,3186:0,3187:0,3188:0,3189:0,3190:0,3191:0,3192:0,3193:0,3194:0,3195:0,3196:0,3197:0,3198:0,3199:0,3200:0,3201:0,3202:0,3203:0,3294:0,3295:0,3296:0,3297:0,3298:0,3299:0,3300:0,3301:0,3302:0,3303:0,3304:0,3305:0,3306:0,3307:0,3308:0,3309:0,3310:0,3311:0,3312:0,3313:0,3314:0,3315:0,3316:0,3317:0,3318:0,3319:0,3320:0,3321:0,3322:0,3323:0,3324:0,3325:0,3326:0,3327:0,3328:0,3329:0,3330:0,3331:0,3332:0,3333:0,3334:0,3335:0,3336:0,3337:0,3338:0,3339:0,3340:0,3341:0,3342:0,3343:0,3344:0,3345:0,3346:0,3347:0,3348:0,3349:0,3350:0,3351:0,3352:0,3353:0,3354:0,3355:0,3356:0,3357:0,3358:0,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3367:0,3368:0,3369:0,3370:0,3371:0,3372:0,3373:0,3374:0,3375:0,3376:0,3377:0,3378:0,3379:0,3380:0,3381:0,3382:0,3383:0,3384:0,3385:0,3386:0,3387:0,3388:0,3389:0,3390:0,3391:0,3392:0,3393:0,3394:0,3395:0,3396:0,3397:0,3398:0,3399:0,3400:0,3401:0,3402:0,3403:0,3404:2,3405:0,3406:0,3407:3,3408:0,3409:0,3410:0,3411:0,3412:0,3413:0,3414:0,3415:0,3416:0,3417:2,3418:2,3419:2,3420:2,3421:2,3422:2,3423:2,3424:2,3425:2,3426:2,3427:2,3428:2,3429:2,3430:2,3431:2,3432:2,3433:2,3434:2,3435:2,3436:2,3437:2,3438:2,3439:0,3440:0,3441:2,3442:2,3443:2,3444:2,3445:2,3446:2,3447:0,3448:0,3449:0,3450:0,3451:2,3452:2,3453:2,3454:2,3455:2,3456:2,3457:2,3458:2,3459:2,3460:0,3461:0,3462:0,3463:0,3464:0,3465:0,3466:0,3467:0,3468:0,3469:0,3470:0,3471:0,3472:0,3473:0,3474:0,3475:0,3476:0,3477:0,3478:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3554:0,3555:0,3556:0,3557:0,3558:0,3559:0,3560:2,3561:2,3562:2,3563:2,3564:2,3565:2,3566:2,3567:2,3568:2,3569:2,3570:2,3571:0,3572:0,3573:0,3574:0,3575:0,3576:0,3577:0,3578:0,3579:0,3580:0,3581:0,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3594:0,3595:0,3596:0,3597:0,3598:2,3599:0,3600:2,3601:0,3602:0,3603:0,3604:0,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3637:0,3638:0,3639:0,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3665:0,3666:0,3667:0,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3693:0,3694:0,3695:0,3696:2,3697:0,3698:2,3699:0,3700:2,3701:0,3702:0,3703:0,3704:0,3705:0,3706:0,3707:0,3708:0,3709:0,3710:0,3711:0,3712:0,3713:0,3714:0,3715:0,3716:0,3717:0,3718:0,3719:0,3720:0,3721:0,3722:0,3723:0,3724:0,3725:0,3726:0,3727:0,3728:2,3729:2,3730:2,3731:2,3732:2,3733:2,3734:2,3735:2,3736:2,3737:2,3738:2,3739:2,3740:0,3741:0,3742:0,3743:0,3744:0,3745:0,3746:0,3747:0,3748:0,3749:0,3750:0,3751:0,3753:2,3754:2,3755:2,3756:2,3757:2,3758:2,3759:2,3760:2,3761:0,3762:0,3763:0,3764:0,3765:0,3766:0,3767:0,3768:0,3769:0,3770:0,3771:0,3772:0,3773:0,3775:0,3776:0,3777:0,3779:0,3780:0,3781:0,3783:0,3784:0,3785:0,3788:0,3789:0,3790:0,3791:0,3793:0,3794:0,3797:0,3798:0,3799:0,3800:0,3801:0,3802:0,3812:0,3814:0,3815:0,3816:0,3825:0,3826:0,3827:0,3828:0,3829:0,3832:0,3833:0,3834:0,3835:0,3836:0,3837:0,3838:0,3839:0,3840:0,3841:0,3844:0,3845:0,3846:0,3847:0,3848:0,3849:0,3850:0,3851:0,3852:0,3854:0,3857:0,3873:0,3874:0,3875:0,3876:0,3877:0,3878:0,3879:0,3880:0,3881:0,3882:0,3883:0,3884:0,3885:0,3890:0,3891:0,3892:0,3893:0,3907:0,3908:0,3909:0,3910:0,3911:0,3912:0,3920:0,3942:0,3943:0,3944:0,3945:0,3946:0,3947:0,3948:0,3949:0,3950:0,3968:0,3969:0,3970:0,3973:0,3974:0,3975:0,3976:0,3978:0,3979:0,3986:0,3987:0,3988:0,3989:0,3991:2,3992:2,3994:0,3995:0,3996:0,3997:0,4026:0,4037:0,4038:0,4048:0,4049:0,4050:0,4051:0,4056:0,4057:0,4058:0,4059:0,4060:0,4061:0,4062:0,4063:0,4071:0,4082:0,4083:0,4093:0,4094:0,4095:0,4096:0,4217:2,4399:2,4400:2,4401:2,4402:2,4403:2,4404:2,4405:2,4406:2,4407:2,4408:2,4409:2,4410:2,4411:2,4412:2,4413:2,4414:0,4415:0,4417:0,4418:2,4419:2,4420:2,4421:2,4422:2,4423:2,4424:2,4425:2,4426:2,4427:2,4428:2,4429:2,4430:2,4431:2,4432:2,4433:2,4434:0,4437:0,4438:2,4439:2,4455:2,4456:2,4457:2,4462:0,4467:0,4471:0,4474:0,4484:0,4485:0,4486:0,4487:0,4488:0,4489:0,4491:0,4492:0,4493:0,4494:0,4495:0,4496:0,4497:0,4498:0,4499:0,4500:0,4501:0,4502:0,4503:0,4504:0,4505:0,4506:0,4507:0,4508:0,4509:0,4510:0,4511:0,4512:0,4513:0,4514:0,4515:0,4516:0,4517:0,4518:0,4519:0,4520:0,4521:0,4522:0,4523:0,4524:0,4525:0,4526:0,4527:0,4528:0,4529:0,4530:0,4531:0,4532:0,4533:0,4534:0,4535:0,4536:0,4537:0,4538:0,4539:0,4540:0,4541:0,4542:0,4543:0,4544:0,4545:0,4546:0,4547:0,4548:0,4549:0,4550:0,4551:0,4552:0,4553:0,4554:0,4559:0,4568:0,4569:0,4570:0,4571:0,4572:0,4573:0,4574:0,4575:0,4576:0,4577:0,4578:0,4579:0,4580:0,4581:0,4582:0,4583:0,4584:0,4585:0,4586:0,4587:0,4588:0,4589:0,4647:0,4652:0,4653:0,4654:0,4655:0,4656:0,4766:0,4767:0,4768:0,4769:0,4770:0,4771:0,4772:0,4773:0,4774:0,4775:0,4776:0,4777:0,4778:0,4779:0,4780:0,4781:0,4782:0,4783:0,4784:0,4785:0,4786:0,4787:0,4788:0,4789:0,4790:0,4791:0,4792:0,4793:0,4794:0,4795:0,4796:0,4797:0,4798:0,4799:0,4800:0,4822:0,4826:0,4839:0,5014:0,5015:0,5016:0,5018:0,5048:0,5069:0,5070:0,5071:0,5072:0,5105:0,5106:0,5107:0,5108:0,5109:0,5110:0,5111:0,5112:0,5113:0,5114:0,5115:0,5116:0,5117:0,5118:0,5119:0,5120:0,5121:0,5122:0,5123:0,5124:0,5125:0,5126:0,5127:0,5128:0,5129:0,5130:0,5167:0,5168:0,5173:0,5174:0,5175:0,5176:0,5177:0,5178:0,5179:0,5180:0,5181:0,5182:0,5183:0,5184:0,5185:0,5186:0,5187:0,5188:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5253:0,5254:0,5255:0,5256:0,5257:0,5258:0,5259:0,5266:0,5269:0,5270:0,5271:0,5272:0,5273:0,5274:0,5275:0,5292:0,5293:0,5294:0,5295:0,5296:0,5297:0,5298:0,5299:0,5300:0,5301:0,5302:0,5303:0,5304:0,5305:0,5306:0,5307:0,5308:0,5309:0,5310:0,5311:0,5316:0,5320:0,5321:0,5325:0,5329:0,5330:0,5331:0,5337:0,5343:0,5344:0,5345:0,5346:0,5347:0,5348:0,5349:0,5355:0,5356:0,5357:0,5361:0,5362:0,5367:0,5382:0,5383:0,5387:0,5388:0,5389:0,5396:0,5456:0,5457:0,5459:0,5460:0,5461:0,5462:0,5463:0,5469:0,5472:4,5479:0,5480:0,5481:0,5482:0,5490:0,5513:0,5514:0,5518:0,5519:0,5520:0,5523:0,5530:0,5531:0,5532:0,5533:0,5534:0,5535:0,5536:0,5537:0,5538:0,5539:0,5550:0,5551:0,5552:0,5559:0,5562:0,5563:0,5564:0,5565:0,5566:0,5567:0,5568:0,5569:0,5570:0,5571:0,5572:0,5573:0,5574:0,5575:0,5576:0,5577:0,5578:0,5579:0,5580:0,5581:0,5582:0,5583:0,5588:1,5589:3,5596:0,5623:2,5624:2,5625:2,5627:0,5629:0,5631:0,5632:0,5633:0,5634:0,5635:0,5636:0,5637:0,5638:0,5639:0,5641:0,5643:0,5644:0,5646:2,5649:0,5650:0,5651:0,5652:0,5653:0,5654:2,5655:2,5659:0,5663:0,5664:0,5665:0,5666:0,5667:0,5668:0,5669:0,5670:0,5671:0,5672:0,5673:0,5674:0,5675:0,5676:0,5677:0,5678:0,5679:0,5680:0,5682:0,5683:0,5684:0,5685:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5875:0,5876:0,5877:0,5879:0,5880:0,5887:0,5890:0,5921:0,5922:0,5923:0,5924:0,5925:0,5926:0,5927:0,5928:0,5929:0,5930:0,5931:0,5932:0,5933:0,5934:0,5935:0,5936:0,5937:0,5938:0,5939:0,5940:0,6050:0,6051:0,6052:0,6053:0,6054:0,6055:0,6056:0,6057:0,6058:0,6059:0,6060:0,6061:0,6062:0,6063:0,6064:0,6065:0,6066:0,6067:0,6068:0,6069:0,6070:0,6071:0,6072:0,6073:0,6074:0,6075:0,6076:0,6077:0,6078:0,6079:0,6080:0,6081:0,6082:0,6083:0,6084:0,6085:0,6086:0,6087:0,6088:0,6089:0,6090:0,6091:0,6092:0,6093:0,6094:0,6095:0,6096:0,6097:0,6098:0,6099:0,6100:0,6101:0,6102:0,6103:0,6104:0,6105:0,6106:0,6107:0,6108:0,6109:0,6110:0,6111:0,6112:0,6113:0,6114:0,6115:0,6116:0,6117:0,6118:0,6119:0,6120:0,6121:0,6122:0,6123:0,6124:0,6125:0,6128:1,6129:1,6141:1,6210:0,6211:0,6244:0,6245:0,6246:0,6247:0,6248:0,6249:0,6250:0,6251:0,6252:0,6253:0,6254:0,6255:0,6256:0,6257:0,6258:0,6259:0,6260:0,6261:0,6262:0,6263:0,6264:0,6265:0,6266:0,6267:0,6268:0,6269:0,6270:0,6271:0,6272:0,6273:0,6274:0,6275:0,6316:0,6328:0,6329:0,6330:0,6331:0,6332:0,6333:0,6334:0,6335:0,6336:0,6337:0,6338:0,6339:0,6340:0,6341:0,6342:0,6343:0,6344:0,6345:0,6346:0,6347:0,6348:0,6350:0,6351:0,6352:0,6353:0,6354:0,6391:1,20002:0,20003:0,20004:0,20005:0,20006:0,20007:0,20008:0,20009:0,20010:0,20011:0,20012:0,20013:0,20014:0,20015:0,20016:0,20017:0,20018:0,20019:0,20020:0,20021:0,20022:0,20023:0,20024:0,20025:0,20026:0,20027:0,20028:0,20029:0,20030:0,20031:0,20032:0,20062:0,20063:0,20064:0,20065:0,20066:0,20067:0,20068:0,20069:0,20070:0,20071:0,20072:0,20073:0,20074:0,20075:0,20076:0,20077:0,20078:0,20079:0,20080:0,20081:0,20082:0,20083:0,20084:0,20085:0,20086:0,20087:0,20088:0,20089:0,20090:0,20091:0,20092:0,20135:0,20136:0,20137:0,20138:0,20248:0,20249:0,20250:0,20251:0,20252:0,20253:0,20254:0,20255:0,20256:0,20257:0,20258:0,20348:0,20349:0,20350:0,20351:0,20352:0,20353:0,20354:0,20355:0,20356:0,20357:0,20358:0,20436:0,20437:0,20438:0,20439:0,20440:0,20499:0,20538:0,20539:0,20790:0,20791:0,20822:0,20823:0,20824:0,20934:0,20935:0,20936:0,21035:0,21036:0,21037:0,21095:0,21096:0,21097:0,21148:0,21149:0,21150:0,21291:0,21292:0,21413:0,21414:0,21415:0,21416:0,21417:0,21418:0,21419:0,21420:0,21421:0,21422:0,21423:0,21473:0,21474:0,21475:0,21476:0,21477:0,21478:0,21479:0,21480:0,21481:0,21482:0,21483:0,21500:0,21780:0,21781:0,21782:0,21817:0,21818:0,21891:0,21892:0,21893:0,21894:0,21896:0,21897:0,21898:0,21899:0,22032:0,22033:0,22091:0,22092:0,22171:0,22172:0,22173:0,22174:0,22175:0,22176:0,22177:0,22181:0,22182:0,22183:0,22184:0,22185:0,22186:0,22187:0,22191:0,22192:0,22193:0,22194:0,22195:0,22196:0,22197:0,22234:0,22235:0,22236:0,22332:0,22391:0,22392:0,22521:0,22522:0,22523:0,22524:0,22525:0,22700:0,22770:0,22780:0,22832:0,22991:0,22992:0,22993:0,22994:0,23028:0,23029:0,23030:0,23031:0,23032:0,23033:0,23034:0,23035:0,23036:0,23037:0,23038:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,23830:0,23831:0,23832:0,23833:0,23834:0,23835:0,23836:0,23837:0,23838:0,23839:0,23840:0,23841:0,23842:0,23843:0,23844:0,23845:0,23846:0,23847:0,23848:0,23849:0,23850:0,23851:0,23852:0,23853:0,23866:0,23867:0,23868:0,23869:0,23870:0,23871:0,23872:0,23877:0,23878:0,23879:0,23880:0,23881:0,23882:0,23883:0,23884:0,23886:0,23887:0,23888:0,23889:0,23890:0,23891:0,23892:0,23893:0,23894:0,23946:0,23947:0,23948:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24311:0,24312:0,24313:0,24342:0,24343:0,24344:0,24345:0,24346:0,24347:0,24370:10,24371:10,24372:10,24373:10,24374:10,24375:0,24376:0,24377:0,24378:0,24379:0,24380:0,24381:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,24718:0,24719:0,24720:0,24721:0,24817:0,24818:0,24819:0,24820:0,24821:0,24877:0,24878:0,24879:0,24880:0,24881:0,24882:0,24891:0,24892:0,24893:0,25000:0,25231:0,25391:0,25392:0,25393:0,25394:0,25395:0,25828:0,25829:0,25830:0,25831:0,25832:0,25833:0,25834:0,25835:0,25836:0,25837:0,25838:0,25884:0,25932:0,26191:0,26192:0,26193:0,26194:0,26195:0,26237:0,26331:0,26332:0,26391:0,26392:0,26393:0,26432:0,26591:0,26592:0,26632:0,26692:0,26701:0,26702:0,26703:0,26704:0,26705:0,26706:0,26707:0,26708:0,26709:0,26710:0,26711:0,26712:0,26713:0,26714:0,26715:0,26716:0,26717:0,26718:0,26719:0,26720:0,26721:0,26722:0,26729:2,26730:2,26731:2,26732:2,26733:2,26734:2,26735:2,26736:2,26737:2,26738:2,26739:2,26740:2,26741:2,26742:2,26743:2,26744:2,26745:2,26746:2,26747:2,26748:2,26749:2,26750:2,26751:2,26752:2,26753:2,26754:2,26755:2,26756:2,26757:2,26758:2,26759:2,26760:2,26761:2,26762:2,26763:2,26764:2,26765:2,26766:2,26767:2,26768:2,26769:2,26770:2,26771:2,26772:2,26773:2,26774:2,26775:2,26776:2,26777:2,26778:2,26779:2,26780:2,26781:2,26782:2,26783:2,26784:2,26785:2,26786:2,26787:2,26788:2,26789:2,26790:2,26791:2,26792:2,26793:2,26794:2,26795:2,26796:2,26797:2,26798:2,26799:2,26801:2,26802:2,26803:2,26811:2,26812:2,26813:2,26847:2,26848:2,26849:2,26850:2,26851:2,26852:2,26853:2,26854:2,26855:2,26856:2,26857:2,26858:2,26859:2,26860:2,26861:2,26862:2,26863:2,26864:2,26865:2,26866:2,26867:2,26868:2,26869:2,26870:2,26891:0,26892:0,26893:0,26894:0,26895:0,26896:0,26897:0,26898:0,26899:0,26901:0,26902:0,26903:0,26904:0,26905:0,26906:0,26907:0,26908:0,26909:0,26910:0,26911:0,26912:0,26913:0,26914:0,26915:0,26916:0,26917:0,26918:0,26919:0,26920:0,26921:0,26922:0,26923:0,26929:0,26930:0,26931:0,26932:0,26933:0,26934:0,26935:0,26936:0,26937:0,26938:0,26939:0,26940:0,26941:0,26942:0,26943:0,26944:0,26945:0,26946:0,26948:0,26949:0,26950:0,26951:0,26952:0,26953:0,26954:0,26955:0,26956:0,26957:0,26958:0,26959:0,26960:0,26961:0,26962:0,26963:0,26964:0,26965:0,26966:0,26967:0,26968:0,26969:0,26970:0,26971:0,26972:0,26973:0,26974:0,26975:0,26976:0,26977:0,26978:0,26979:0,26980:0,26981:0,26982:0,26983:0,26984:0,26985:0,26986:0,26987:0,26988:0,26989:0,26990:0,26991:0,26992:0,26993:0,26994:0,26995:0,26996:0,26997:0,26998:0,27037:0,27038:0,27039:0,27040:0,27120:0,27200:0,27205:0,27206:0,27207:0,27208:0,27209:0,27210:0,27211:0,27212:0,27213:0,27214:0,27215:0,27216:0,27217:0,27218:0,27219:0,27220:0,27221:0,27222:0,27223:0,27224:0,27225:0,27226:0,27227:0,27228:0,27229:0,27230:0,27231:0,27232:0,27258:0,27259:0,27260:0,27291:6,27292:6,27391:0,27392:0,27393:0,27394:0,27395:0,27396:0,27397:0,27398:0,27429:0,27492:0,27493:0,27500:0,27561:0,27562:0,27563:0,27564:0,27571:0,27572:0,27573:0,27574:0,27581:0,27582:0,27583:0,27584:0,27591:0,27592:0,27593:0,27594:0,27700:0,28191:0,28192:0,28193:0,28232:0,28348:0,28349:0,28350:0,28351:0,28352:0,28353:0,28354:0,28355:0,28356:0,28357:0,28358:0,28402:0,28403:0,28404:0,28405:0,28406:0,28407:0,28408:0,28409:0,28410:0,28411:0,28412:0,28413:0,28414:0,28415:0,28416:0,28417:0,28418:0,28419:0,28420:0,28421:0,28422:0,28423:0,28424:0,28425:0,28426:0,28427:0,28428:0,28429:0,28430:0,28431:0,28432:0,28462:0,28463:0,28464:0,28465:0,28466:0,28467:0,28468:0,28469:0,28470:0,28471:0,28472:0,28473:0,28474:0,28475:0,28476:0,28477:0,28478:0,28479:0,28480:0,28481:0,28482:0,28483:0,28484:0,28485:0,28486:0,28487:0,28488:0,28489:0,28490:0,28491:0,28492:0,28600:0,28991:0,28992:0,29100:0,29101:0,29118:0,29119:0,29120:0,29121:0,29122:0,29168:0,29169:0,29170:0,29171:0,29172:0,29177:0,29178:0,29179:0,29180:0,29181:0,29182:0,29183:0,29184:0,29185:0,29187:0,29188:0,29189:0,29190:0,29191:0,29192:0,29193:0,29194:0,29195:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29900:0,29901:0,29902:0,29903:0,30161:0,30162:0,30163:0,30164:0,30165:0,30166:0,30167:0,30168:0,30169:0,30170:0,30171:0,30172:0,30173:0,30174:0,30175:0,30176:0,30177:0,30178:0,30179:0,30200:5,30339:0,30340:0,30491:0,30492:0,30493:0,30494:0,30591:0,30592:0,30729:0,30730:0,30731:0,30732:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31251:0,31252:0,31253:0,31254:0,31255:0,31256:0,31257:0,31258:0,31259:0,31265:0,31266:0,31267:0,31268:0,31275:0,31276:0,31277:0,31278:0,31279:0,31281:0,31282:0,31283:0,31284:0,31285:0,31286:0,31287:0,31288:0,31289:0,31290:0,31291:0,31292:0,31293:0,31294:0,31295:0,31296:0,31297:0,31370:0,31461:0,31462:0,31463:0,31464:0,31465:0,31466:0,31467:0,31468:0,31469:0,31491:0,31492:0,31493:0,31494:0,31495:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,31917:0,31918:0,31919:0,31920:0,31921:0,31922:0,31965:0,31966:0,31967:0,31968:0,31969:0,31970:0,31971:0,31972:0,31973:0,31974:0,31975:0,31976:0,31977:0,31978:0,31979:0,31980:0,31981:0,31982:0,31983:0,31984:0,31985:0,31986:0,31987:0,31988:0,31989:0,31990:0,31991:0,31992:0,31993:0,31994:0,31995:0,31996:0,31997:0,31998:0,31999:0,32000:0,32001:2,32002:2,32003:2,32005:2,32006:2,32007:2,32008:2,32009:2,32010:2,32011:2,32012:2,32013:2,32014:2,32015:2,32016:2,32017:2,32018:2,32019:2,32020:2,32021:2,32022:2,32023:2,32024:2,32025:2,32026:2,32027:2,32028:2,32029:2,32030:2,32031:2,32033:2,32034:2,32035:2,32036:2,32037:2,32038:2,32039:2,32040:2,32041:2,32042:2,32043:2,32044:2,32045:2,32046:2,32047:2,32048:2,32049:2,32050:2,32051:2,32052:2,32053:2,32054:2,32055:2,32056:2,32057:2,32058:2,32059:2,32060:2,32061:0,32062:0,32064:2,32065:2,32066:2,32067:2,32074:2,32075:2,32076:2,32077:2,32081:0,32082:0,32083:0,32084:0,32085:0,32086:0,32098:0,32099:2,32100:0,32104:0,32107:0,32108:0,32109:0,32110:0,32111:0,32112:0,32113:0,32114:0,32115:0,32116:0,32117:0,32118:0,32119:0,32120:0,32121:0,32122:0,32123:0,32124:0,32125:0,32126:0,32127:0,32128:0,32129:0,32130:0,32133:0,32134:0,32135:0,32136:0,32137:0,32138:0,32139:0,32140:0,32141:0,32142:0,32143:0,32144:0,32145:0,32146:0,32147:0,32148:0,32149:0,32150:0,32151:0,32152:0,32153:0,32154:0,32155:0,32156:0,32157:0,32158:0,32161:0,32164:2,32165:2,32166:2,32167:2,32180:0,32181:0,32182:0,32183:0,32184:0,32185:0,32186:0,32187:0,32188:0,32189:0,32190:0,32191:0,32192:0,32193:0,32194:0,32195:0,32196:0,32197:0,32198:0,32199:0,32201:0,32202:0,32203:0,32204:0,32205:0,32206:0,32207:0,32208:0,32209:0,32210:0,32211:0,32212:0,32213:0,32214:0,32215:0,32216:0,32217:0,32218:0,32219:0,32220:0,32221:0,32222:0,32223:0,32224:0,32225:0,32226:0,32227:0,32228:0,32229:0,32230:0,32231:0,32232:0,32233:0,32234:0,32235:0,32236:0,32237:0,32238:0,32239:0,32240:0,32241:0,32242:0,32243:0,32244:0,32245:0,32246:0,32247:0,32248:0,32249:0,32250:0,32251:0,32252:0,32253:0,32254:0,32255:0,32256:0,32257:0,32258:0,32259:0,32260:0,32301:0,32302:0,32303:0,32304:0,32305:0,32306:0,32307:0,32308:0,32309:0,32310:0,32311:0,32312:0,32313:0,32314:0,32315:0,32316:0,32317:0,32318:0,32319:0,32320:0,32321:0,32322:0,32323:0,32324:0,32325:0,32326:0,32327:0,32328:0,32329:0,32330:0,32331:0,32332:0,32333:0,32334:0,32335:0,32336:0,32337:0,32338:0,32339:0,32340:0,32341:0,32342:0,32343:0,32344:0,32345:0,32346:0,32347:0,32348:0,32349:0,32350:0,32351:0,32352:0,32353:0,32354:0,32355:0,32356:0,32357:0,32358:0,32359:0,32360:0,32601:0,32602:0,32603:0,32604:0,32605:0,32606:0,32607:0,32608:0,32609:0,32610:0,32611:0,32612:0,32613:0,32614:0,32615:0,32616:0,32617:0,32618:0,32619:0,32620:0,32621:0,32622:0,32623:0,32624:0,32625:0,32626:0,32627:0,32628:0,32629:0,32630:0,32631:0,32632:0,32633:0,32634:0,32635:0,32636:0,32637:0,32638:0,32639:0,32640:0,32641:0,32642:0,32643:0,32644:0,32645:0,32646:0,32647:0,32648:0,32649:0,32650:0,32651:0,32652:0,32653:0,32654:0,32655:0,32656:0,32657:0,32658:0,32659:0,32660:0,32661:0,32662:0,32664:2,32665:2,32666:2,32667:2,32701:0,32702:0,32703:0,32704:0,32705:0,32706:0,32707:0,32708:0,32709:0,32710:0,32711:0,32712:0,32713:0,32714:0,32715:0,32716:0,32717:0,32718:0,32719:0,32720:0,32721:0,32722:0,32723:0,32724:0,32725:0,32726:0,32727:0,32728:0,32729:0,32730:0,32731:0,32732:0,32733:0,32734:0,32735:0,32736:0,32737:0,32738:0,32739:0,32740:0,32741:0,32742:0,32743:0,32744:0,32745:0,32746:0,32747:0,32748:0,32749:0,32750:0,32751:0,32752:0,32753:0,32754:0,32755:0,32756:0,32757:0,32758:0,32759:0,32760:0,32761:0,32766:0,53001:0,53002:0,53003:0,53004:0,53008:0,53009:0,53010:0,53011:0,53012:0,53013:0,53014:0,53015:0,53016:0,53017:0,53018:0,53019:0,53021:0,53022:0,53023:0,53024:0,53025:0,53026:0,53027:0,53028:0,53029:0,53030:0,53031:0,53032:0,53034:0,53042:0,53043:0,53044:0,53045:0,53046:0,53048:0,53049:0,54001:0,54002:0,54003:0,54004:0,54008:0,54009:0,54010:0,54011:0,54012:0,54013:0,54014:0,54015:0,54016:0,54017:0,54018:0,54019:0,54021:0,54022:0,54023:0,54024:0,54025:0,54026:0,54027:0,54028:0,54029:0,54030:0,54031:0,54032:0,54034:0,54042:0,54043:0,54044:0,54045:0,54046:0,54048:0,54049:0,54050:0,54051:0,54052:0,54053:0,65061:2,65062:2,65161:0,65163:0,102001:0,102002:0,102003:0,102004:0,102005:0,102006:0,102007:0,102008:0,102009:0,102010:0,102011:0,102012:0,102013:0,102014:0,102015:0,102016:0,102017:0,102018:0,102019:0,102020:0,102021:0,102022:0,102023:0,102024:0,102025:0,102026:0,102027:0,102028:0,102029:0,102030:0,102031:0,102032:0,102033:0,102034:0,102035:0,102036:0,102037:0,102038:0,102039:0,102040:0,102041:2,102042:0,102043:0,102044:0,102045:0,102046:0,102047:0,102048:0,102049:0,102050:0,102051:0,102052:0,102053:0,102054:0,102055:0,102056:0,102057:0,102058:0,102059:0,102060:0,102061:0,102062:0,102063:0,102064:11,102065:0,102066:0,102067:0,102068:14,102069:15,102070:0,102071:0,102072:0,102073:0,102074:0,102075:0,102076:0,102077:0,102078:0,102079:0,102080:0,102081:0,102082:0,102083:0,102084:0,102085:0,102086:0,102087:0,102088:0,102089:0,102090:0,102091:0,102092:0,102093:0,102094:0,102095:0,102096:0,102097:0,102098:0,102099:0,102100:0,102101:0,102102:0,102103:0,102104:0,102105:0,102106:0,102107:0,102108:0,102109:0,102110:0,102111:0,102112:0,102113:0,102114:0,102115:0,102116:0,102117:0,102118:2,102119:1,102120:2,102121:2,102122:0,102123:0,102124:0,102125:0,102126:0,102127:0,102128:0,102129:0,102130:0,102131:0,102132:0,102133:0,102134:0,102135:0,102136:0,102137:0,102138:0,102139:0,102140:0,102141:0,102142:0,102143:0,102144:0,102145:0,102146:0,102147:0,102148:0,102149:0,102150:0,102151:0,102152:0,102153:0,102154:0,102155:0,102156:0,102157:0,102158:0,102159:0,102160:0,102161:0,102162:0,102163:0,102164:0,102165:0,102166:0,102167:0,102168:0,102169:0,102170:0,102171:0,102172:0,102173:0,102174:0,102175:0,102176:0,102177:0,102178:0,102179:0,102180:0,102181:0,102182:0,102183:0,102184:0,102185:0,102186:0,102187:0,102188:0,102189:0,102190:0,102191:0,102192:0,102193:0,102194:0,102195:0,102196:0,102197:0,102198:0,102199:0,102200:0,102201:0,102202:0,102203:0,102204:0,102205:0,102206:0,102207:0,102208:0,102209:0,102210:0,102211:0,102212:0,102213:0,102214:0,102215:0,102216:0,102217:2,102218:0,102219:2,102220:2,102221:0,102222:0,102223:0,102224:0,102225:0,102226:0,102227:0,102228:0,102229:0,102230:0,102231:0,102232:0,102233:0,102234:0,102235:0,102236:0,102237:0,102238:0,102239:0,102240:0,102241:0,102242:0,102243:0,102244:0,102245:0,102246:0,102247:0,102248:0,102249:0,102250:0,102251:0,102252:0,102253:0,102254:0,102255:0,102256:0,102257:0,102258:0,102259:0,102260:0,102261:0,102262:0,102263:0,102264:0,102265:0,102266:0,102267:0,102268:0,102269:0,102270:0,102271:0,102272:0,102273:0,102274:0,102275:0,102276:0,102277:0,102278:0,102279:0,102280:0,102281:0,102282:0,102283:0,102284:0,102285:0,102286:0,102287:0,102288:0,102289:0,102290:0,102291:0,102292:0,102293:0,102294:0,102295:0,102296:0,102297:0,102298:0,102299:0,102300:0,102301:0,102302:0,102303:0,102304:0,102305:0,102306:0,102307:0,102308:0,102309:0,102310:0,102311:0,102312:0,102313:0,102314:0,102315:0,102316:0,102317:0,102318:0,102319:0,102320:0,102321:0,102322:0,102323:0,102324:0,102325:0,102326:0,102327:0,102328:0,102329:0,102330:0,102331:0,102332:0,102333:0,102334:0,102335:0,102336:0,102337:0,102338:0,102339:0,102340:0,102341:0,102342:0,102343:0,102344:0,102345:0,102346:0,102347:0,102348:0,102349:0,102350:0,102351:0,102352:0,102353:0,102354:0,102355:0,102356:0,102357:0,102358:0,102359:0,102360:0,102361:0,102362:0,102363:0,102364:0,102365:0,102366:0,102367:0,102368:0,102369:0,102370:0,102371:0,102372:0,102373:0,102374:0,102375:0,102376:0,102377:0,102378:1,102379:1,102380:0,102381:1,102382:0,102383:0,102384:0,102385:0,102386:0,102387:0,102388:0,102389:2,102390:2,102391:2,102392:2,102393:2,102394:2,102395:2,102396:2,102397:2,102398:2,102401:0,102402:0,102403:0,102404:0,102405:0,102406:0,102407:0,102408:0,102409:0,102410:0,102411:0,102412:0,102413:0,102414:0,102415:0,102416:0,102417:0,102418:0,102419:0,102420:0,102421:0,102422:0,102423:0,102424:0,102425:0,102426:0,102427:0,102428:0,102429:0,102430:0,102431:0,102432:0,102433:0,102434:0,102435:0,102436:0,102437:0,102438:0,102439:0,102440:0,102441:0,102442:0,102443:0,102444:0,102445:2,102446:2,102447:2,102450:0,102451:0,102452:0,102461:2,102462:2,102463:2,102464:2,102465:2,102466:2,102467:2,102468:2,102469:0,102470:0,102471:0,102472:0,102473:0,102474:0,102475:0,102476:0,102477:0,102478:0,102479:0,102480:0,102481:0,102482:0,102483:0,102484:0,102485:0,102486:0,102487:0,102488:0,102489:0,102490:0,102491:0,102492:0,102493:0,102494:0,102495:0,102496:0,102500:1,102501:1,102502:1,102503:1,102504:1,102505:1,102506:1,102507:1,102508:1,102509:1,102510:1,102511:1,102512:1,102513:1,102514:1,102515:1,102516:1,102517:1,102518:1,102519:1,102520:0,102521:0,102522:0,102523:0,102524:0,102525:2,102526:2,102527:2,102528:2,102529:2,102530:0,102531:0,102532:0,102533:0,102534:0,102535:0,102536:0,102537:0,102538:0,102539:0,102540:0,102541:0,102542:0,102543:0,102544:0,102545:0,102546:0,102547:0,102548:0,102549:0,102570:0,102571:0,102572:0,102573:0,102574:0,102575:0,102576:0,102577:0,102578:0,102579:0,102580:0,102581:0,102582:0,102583:0,102584:0,102585:0,102586:0,102587:0,102588:0,102589:2,102590:0,102591:0,102592:0,102593:0,102594:0,102595:0,102596:0,102597:0,102598:0,102599:2,102600:2,102601:0,102602:0,102603:0,102604:2,102605:0,102606:0,102607:0,102608:0,102609:0,102610:0,102611:0,102612:0,102613:0,102614:0,102615:0,102616:0,102617:0,102618:0,102619:0,102620:0,102621:0,102622:0,102623:0,102624:0,102625:0,102626:0,102627:0,102628:0,102629:2,102630:2,102631:2,102632:2,102633:2,102634:2,102635:2,102636:2,102637:2,102638:2,102639:2,102640:2,102641:2,102642:2,102643:2,102644:2,102645:2,102646:2,102647:0,102648:2,102649:2,102650:2,102651:2,102652:2,102653:2,102654:2,102655:2,102656:2,102657:2,102658:2,102659:2,102660:2,102661:2,102662:2,102663:2,102664:2,102665:2,102666:2,102667:2,102668:2,102669:2,102670:2,102671:2,102672:2,102673:2,102674:2,102675:2,102676:2,102677:2,102678:2,102679:2,102680:2,102681:2,102682:2,102683:2,102684:2,102685:2,102686:2,102687:2,102688:2,102689:2,102690:2,102691:2,102692:2,102693:2,102694:2,102695:2,102696:2,102697:2,102698:2,102699:2,102700:2,102701:0,102702:0,102703:0,102704:2,102705:2,102707:2,102708:2,102709:2,102710:2,102711:2,102712:2,102713:2,102714:2,102715:2,102716:2,102717:2,102718:2,102719:2,102720:2,102721:2,102722:2,102723:2,102724:2,102725:2,102726:2,102727:2,102728:2,102729:2,102730:2,102733:2,102734:2,102735:2,102736:2,102737:2,102738:2,102739:2,102740:2,102741:2,102742:2,102743:2,102744:2,102745:2,102746:2,102747:2,102748:2,102749:2,102750:2,102751:2,102752:2,102753:2,102754:2,102755:2,102756:2,102757:2,102758:2,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102767:0,102768:0,102769:0,102770:0,102771:0,102772:0,102773:0,102774:0,102775:0,102776:0,102777:0,102778:0,102779:0,102780:0,102781:0,102782:0,102783:0,102784:0,102785:0,102786:0,102787:0,102788:0,102789:0,102790:0,102791:0,102792:0,102793:0,102794:0,102795:0,102796:0,102797:0,102798:0,102962:0,102963:0,102964:0,102965:0,102966:0,102967:0,102968:0,102969:0,102970:1,102971:0,102972:0,102973:0,102974:2,102975:0,102976:0,102977:0,102978:0,102979:0,102980:0,102981:0,102982:0,102983:0,102984:0,102985:0,102986:0,102987:0,102988:0,102989:0,102990:1,102991:1,102992:1,102993:0,102994:0,102995:2,102996:2,102997:0,102998:0,102999:0,103000:0,103001:0,103002:0,103003:2,103004:2,103005:2,103006:2,103007:2,103008:2,103009:0,103010:0,103011:0,103012:2,103013:2,103014:2,103015:0,103016:2,103017:0,103018:2,103019:0,103020:0,103021:0,103022:2,103023:2,103024:2,103025:0,103026:0,103027:2,103028:2,103029:0,103030:0,103031:0,103032:2,103033:2,103034:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103065:0,103066:0,103067:0,103068:0,103069:2,103070:0,103071:0,103072:2,103073:2,103074:0,103075:0,103076:0,103077:1,103078:1,103079:1,103080:0,103081:0,103082:0,103083:2,103084:2,103085:2,103086:0,103087:0,103088:2,103089:2,103090:0,103091:0,103092:0,103093:0,103094:1,103095:0,103096:2,103097:0,103098:0,103099:0,103100:2,103101:2,103102:2,103103:0,103104:2,103105:0,103106:2,103107:0,103108:0,103109:0,103110:2,103111:2,103112:2,103113:0,103114:0,103115:0,103116:0,103117:2,103118:2,103119:2,103120:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103153:0,103154:0,103155:0,103156:0,103157:0,103158:2,103159:2,103160:2,103161:2,103162:2,103163:0,103164:0,103165:0,103166:1,103167:1,103168:1,103169:2,103170:2,103171:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103186:0,103187:0,103188:0,103189:2,103190:2,103191:2,103192:0,103193:0,103194:0,103195:0,103196:2,103197:2,103198:2,103199:2,103200:0,103201:0,103202:0,103203:0,103204:0,103205:0,103206:0,103207:0,103208:0,103209:0,103210:0,103211:0,103212:0,103213:0,103214:0,103215:0,103216:0,103217:0,103218:0,103219:0,103220:0,103221:0,103222:0,103223:0,103224:0,103225:1,103226:1,103227:1,103228:0,103229:0,103230:2,103231:2,103232:0,103233:0,103234:0,103235:0,103236:0,103237:0,103238:2,103239:2,103240:2,103241:2,103242:2,103243:2,103244:0,103245:0,103246:0,103247:2,103248:2,103249:2,103250:0,103251:2,103252:0,103253:2,103254:0,103255:0,103256:0,103257:2,103258:2,103259:2,103260:0,103261:0,103262:2,103263:2,103264:0,103265:0,103266:0,103267:2,103268:2,103269:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103300:0,103301:0,103302:0,103303:0,103304:0,103305:0,103306:0,103307:0,103308:0,103309:0,103310:0,103311:0,103312:0,103313:0,103314:0,103315:0,103316:0,103317:0,103318:0,103319:0,103320:0,103321:0,103322:0,103323:0,103324:0,103325:0,103326:0,103327:0,103328:0,103329:0,103330:0,103331:0,103332:0,103333:0,103334:0,103335:0,103336:0,103337:0,103338:0,103339:0,103340:0,103341:0,103342:0,103343:0,103344:0,103345:0,103346:0,103347:0,103348:0,103349:0,103350:0,103351:0,103352:0,103353:0,103354:0,103355:0,103356:0,103357:0,103358:0,103359:0,103360:0,103361:0,103362:0,103363:0,103364:0,103365:0,103366:0,103367:0,103368:0,103369:0,103370:0,103371:0,103372:0,103373:0,103374:0,103375:0,103376:2,103377:0,103378:0,103379:2,103380:2,103381:0,103382:0,103383:0,103384:1,103385:1,103386:1,103387:0,103388:0,103389:0,103390:2,103391:2,103392:2,103393:0,103394:0,103395:2,103396:2,103397:0,103398:0,103399:0,103400:2,103401:2,103402:2,103403:2,103404:2,103405:2,103406:2,103407:2,103408:2,103409:2,103410:2,103411:2,103412:2,103413:2,103414:2,103415:2,103416:2,103417:2,103418:2,103419:2,103420:2,103421:2,103422:2,103423:2,103424:2,103425:2,103426:2,103427:2,103428:2,103429:2,103430:2,103431:2,103432:2,103433:2,103434:2,103435:2,103436:2,103437:2,103438:2,103439:2,103440:2,103441:2,103442:2,103443:2,103444:2,103445:2,103446:2,103447:2,103448:2,103449:2,103450:2,103451:2,103452:2,103453:2,103454:2,103455:2,103456:2,103457:2,103458:2,103459:2,103460:2,103461:2,103462:2,103463:2,103464:2,103465:2,103466:2,103467:2,103468:2,103469:2,103470:2,103471:2,103472:0,103473:1,103474:0,103475:2,103476:0,103477:0,103478:0,103479:2,103480:2,103481:2,103482:0,103483:2,103484:0,103485:2,103486:0,103487:0,103488:0,103489:2,103490:2,103491:2,103492:0,103493:0,103494:0,103495:0,103496:2,103497:2,103498:2,103499:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103528:0,103529:0,103530:0,103531:0,103532:0,103533:0,103534:0,103535:0,103536:0,103537:0,103538:0,103539:0,103540:0,103541:0,103542:0,103543:0,103544:2,103545:2,103546:2,103547:2,103548:2,103549:0,103550:0,103551:0,103552:1,103553:1,103554:1,103555:2,103556:2,103557:2,103558:0,103559:0,103560:0,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103571:0,103572:0,103573:0,103574:2,103575:2,103576:2,103577:0,103578:0,103579:0,103580:0,103581:2,103582:2,103583:2,103584:0,103585:2,103600:0,103601:0,103602:0,103603:0,103604:0,103605:0,103606:0,103607:0,103608:0,103609:0,103610:0,103611:0,103612:0,103613:0,103614:0,103615:0,103616:0,103617:0,103618:0,103619:0,103620:0,103621:0,103622:0,103623:0,103624:0,103625:0,103626:0,103627:0,103628:0,103629:0,103630:0,103631:0,103632:0,103633:0,103634:0,103635:0,103636:0,103637:0,103638:0,103639:0,103640:0,103641:0,103642:0,103643:0,103644:0,103645:0,103646:0,103647:0,103648:0,103649:0,103650:0,103651:0,103652:0,103653:0,103654:0,103655:0,103656:0,103657:0,103658:0,103659:0,103660:0,103661:0,103662:0,103663:0,103664:0,103665:0,103666:0,103667:0,103668:0,103669:0,103670:0,103671:0,103672:0,103673:0,103674:0,103675:0,103676:0,103677:0,103678:0,103679:0,103680:0,103681:0,103682:0,103683:0,103684:0,103685:0,103686:0,103687:0,103688:0,103689:0,103690:0,103691:0,103692:0,103693:0,103694:0,103695:2,103700:2,103701:2,103702:2,103703:2,103704:2,103705:2,103706:2,103707:2,103708:2,103709:2,103710:2,103711:2,103712:2,103713:2,103714:2,103715:2,103716:2,103717:2,103718:2,103719:2,103720:2,103721:2,103722:2,103723:2,103724:2,103725:2,103726:2,103727:2,103728:2,103729:2,103730:2,103731:2,103732:2,103733:2,103734:2,103735:2,103736:2,103737:2,103738:2,103739:2,103740:2,103741:2,103742:2,103743:2,103744:2,103745:2,103746:2,103747:2,103748:2,103749:2,103750:2,103751:2,103752:2,103753:2,103754:2,103755:2,103756:2,103757:2,103758:2,103759:2,103760:2,103761:2,103762:2,103763:2,103764:2,103765:2,103766:2,103767:2,103768:2,103769:2,103770:2,103771:2,103772:2,103773:2,103774:2,103775:2,103776:2,103777:2,103778:2,103779:2,103780:2,103781:2,103782:2,103783:2,103784:2,103785:2,103786:2,103787:2,103788:2,103789:2,103790:2,103791:2,103792:2,103793:2,103794:0,103795:0,103796:0,103797:0,103798:0,103799:0,103800:0,103801:0,103802:0,103803:0,103804:0,103805:0,103806:0,103807:0,103808:0,103809:0,103810:0,103811:0,103812:0,103813:0,103814:0,103815:0,103816:0,103817:0,103818:0,103819:0,103820:0,103821:0,103822:0,103823:0,103824:0,103825:0,103826:0,103827:0,103828:0,103829:0,103830:0,103831:0,103832:0,103833:0,103834:0,103835:0,103836:0,103837:0,103838:0,103839:0,103840:0,103841:0,103842:0,103843:0,103844:0,103845:0,103846:0,103847:0,103848:0,103849:0,103850:0,103851:0,103852:0,103853:0,103854:0,103855:0,103856:0,103857:0,103858:0,103859:0,103860:0,103861:0,103862:0,103863:0,103864:0,103865:0,103866:0,103867:0,103868:0,103869:0,103870:0,103871:0,103900:2,103901:2,103902:2,103903:2,103904:2,103905:2,103906:2,103907:2,103908:2,103909:2,103910:2,103911:2,103912:2,103913:2,103914:2,103915:2,103916:2,103917:2,103918:2,103919:2,103920:2,103921:2,103922:2,103923:2,103924:2,103925:2,103926:2,103927:2,103928:2,103929:2,103930:2,103931:2,103932:2,103933:2,103934:2,103935:2,103936:2,103937:2,103938:2,103939:2,103940:2,103941:2,103942:2,103943:2,103944:2,103945:2,103946:2,103947:2,103948:2,103949:2,103950:2,103951:2,103952:2,103953:2,103954:2,103955:2,103956:2,103957:2,103958:2,103959:2,103960:2,103961:2,103962:2,103963:2,103964:2,103965:2,103966:2,103967:2,103968:2,103969:2,103970:2,103971:2,900913:0,20010201:0,20010202:0,20020901:0,20020902:0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(11)),i=g(r(10)),o=g(r(3)),a=g(r(0)),s=g(r(2)),l=g(r(4)),u=g(r(7)),c=g(r(5)),f=g(r(29)),h=r(1),d=r(6),p=g(r(37)),y=r(36);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));if(e=(0,h.defaultValue)(e,{}),r.type=d.GeometryType.lineString,r.coordinates=(0,h.defaultValue)(e.coordinates,[]),!Array.isArray(r.coordinates))throw new Error("坐标必须为数组");if(r.coordinates.length<2)throw new Error("坐标必须是两个或多个位置的数组");return 3===r.coordinates[0].length&&(r.hasZ=!0),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"getPoint",value:function(e){return e=Number(e),this._isValidate(e)?new p.default({coordinates:this._cloneCoordinates()[e]}):null}},{key:"insertPoint",value:function(e,t){return this._isValidate(e)?(Array.isArray(this.coordinates)&&this.coordinates.splice(e,0,p.default.toCoordinates(t)),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this):null}},{key:"removePoint",value:function(e){if(e=Number(e),!this._isValidate(e))return this;var t=this._cloneCoordinates()[e];return this.coordinates.splice(e,1),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),new p.default({coordinates:t})}},{key:"setPoint",value:function(e,t){return this._isValidate(e)?(Array.isArray(this.coordinates)&&this.coordinates.splice(e,1,p.default.toCoordinates(t)),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this):this}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.coordinates=JSON.parse((0,i.default)(this.coordinates)),e.extent=this.extent.toJSON(),e}},{key:"toString",value:function(){for(var e="",t=0;t<this.coordinates.length;t++)for(var r=this.coordinates[t],n=0;n<r.length;n++)e+=r[n]+",";return e.substring(0,e.length-1)}},{key:"toXMl",value:function(){}},{key:"toOldIGSGeometry",value:function(){for(var e=[],t=0;t<this.coordinates.length;t++)e.push({x:this.coordinates[t][0],y:this.coordinates[t][1]});return{LinGeom:[{Line:{Arcs:[{Dots:e,ArcID:0}]},GID:0}],GID:parseInt(String(1e7*Math.random()))}}},{key:"getIGSType",value:function(){return d.IGSGeometryType.lineString}},{key:"toDots",value:function(){for(var e=[],t=this.coordinates,r=0;r<t.length;r++)e.push({x:t[r][0],y:t[r][1]});return e}},{key:"_isValidate",value:function(e){var t=this.coordinates.length;return!(!(0,h.isNumber)(e)||e<0||e>=t)}},{key:"_cloneCoordinates",value:function(){return JSON.parse((0,i.default)(this.coordinates))}},{key:"_calcExtent",value:function(e,t){return(0,y.calcExtent)(e,t,d.GeometryType.lineString,this.spatialReference)}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,h.defaultValue)(e,{}))}}]),t}(f.default);(0,n.default)(v.prototype,{extent:{configurable:!1,get:function(){return this._calcExtent(this.coordinates,this.hasZ)}}}),t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=x(r(11)),i=x(r(10)),o=x(r(187)),a=x(r(3)),s=x(r(0)),l=x(r(2)),u=x(r(4)),c=x(r(7)),f=x(r(5)),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(35)),d=x(r(29)),p=r(1),y=r(6),g=x(r(83)),v=x(r(37)),m=x(r(57)),_=x(r(96)),S=r(36);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){(0,s.default)(this,t);var r=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));if(e=(0,p.defaultValue)(e,{}),r.coordinates=(0,p.defaultValue)(e.coordinates,[]),r.isSelfIntersecting=(0,p.defaultValue)(e.isSelfIntersecting,!1),r.type=y.GeometryType.multiPolygon,!Array.isArray(r.coordinates))throw new Error("坐标必须为数组");for(var n=0;n<r.coordinates.length;n++){var i=r.coordinates[n],l=!0,c=!1,f=void 0;try{for(var h,d=(0,o.default)(i);!(l=(h=d.next()).done);l=!0){var g=h.value;if(g.length<4)throw new Error("每个环至少有四个点");if(g[g.length-1].length!==g[0].length)throw new Error("首尾点维度不相等");for(var v=0;v<g[g.length-1].length;v++)if(g[g.length-1][v]!==g[0][v])throw new Error("第一个位置和最后一个位置不相等")}}catch(e){c=!0,f=e}finally{try{!l&&d.return&&d.return()}finally{if(c)throw f}}}return 3===r.coordinates[0][0][0].length&&(r.hasZ=!0),r}return(0,f.default)(t,e),(0,l.default)(t,[{key:"addPolygon",value:function(e,t){if(t=(0,p.defaultValue)(t,"add"),e instanceof g.default||_.default.error("polygon类型不是Polygon对象类型！"),"add"===t)this.coordinates.push(e._cloneCoordinates());else{for(var r=[],n=0;n<this.coordinates.length;n++){var o=h.polygon(this.coordinates[n]),a=h.polygon(e.coordinates);h.booleanDisjoint(o,a)||(r.push(o),this.coordinates[n]=void 0)}for(var s=0;s<this.coordinates.length;s++)this.coordinates[s]||this.coordinates.splice(s,1);for(var l=h.polygon(e.coordinates),u=0;u<r.length;u++)l=h.union(l,r[u]).geometry;this.coordinates.push(l.coordinates)}return this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"removePolygon",value:function(e){if(!this._isValidate(e))return null;var t=JSON.parse((0,i.default)(this._cloneCoordinates()[e]));return this.coordinates.splice(e,1),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),new g.default({coordinates:t})}},{key:"toXMl",value:function(){return""}},{key:"contains",value:function(e){if(!e)throw new Error("传入参数错误");var t=h.multiPolygon(this._cloneCoordinates()),r=h.point(v.default.toCoordinates(e));return h.booleanPointInPolygon(r,t)}},{key:"toJSON",value:function(){var e=(0,c.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"toJSON",this).call(this);return e.coordinates=JSON.parse((0,i.default)(this.coordinates)),e.extent=this.extent.toJSON(),e}},{key:"toString",value:function(){for(var e="",t=0;t<this.coordinates.length;t++){for(var r=this.coordinates[t],n=0;n<r.length;n++){for(var i=r[n],o=0;o<i.length;o++)for(var a=i[o],s=0;s<a.length;s++)e+=a[s]+",";e=e.substring(0,e.length-1),e+="|"}e=e.substring(0,e.length-1),e+=";"}return e.substring(0,e.length-1)}},{key:"toOldIGSGeometry",value:function(){for(var e=[],t={},r={},n=0;n<this.coordinates.length;n++){var i=this.coordinates[n];t={Rings:[],GID:n};for(var o=0;o<i.length;o++){r={Arcs:[]};for(var a=[],s=0;s<i[o].length;s++){var l=i[o][s];a.push({x:l[0],y:l[1]})}r.Arcs.push({Dots:a,ArcID:o}),t.Rings.push(r)}e.push(t)}return{RegGeom:e}}},{key:"_cloneCoordinates",value:function(){return JSON.parse((0,i.default)(this.coordinates))}},{key:"_isValidate",value:function(e){var t=this.coordinates.length;return!(!(0,p.isNumber)(e)||e<0||e>=t)}},{key:"_calcExtent",value:function(e,t){return(0,S.calcExtent)(e,t,y.GeometryType.multiPolygon,this.spatialReference)}},{key:"getIGSType",value:function(){return y.IGSGeometryType.multiPolygon}},{key:"toPolygonArray",value:function(){for(var e=[],t=0;t<this.coordinates.length;t++)e.push(new g.default({coordinates:this.coordinates[t],spatialReference:m.default.fromJSON(this.spatialReference)}));return e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,p.defaultValue)(e,{}))}}]),t}(d.default);(0,n.default)(b.prototype,{extent:{configurable:!1,get:function(){return this._calcExtent(this.coordinates,this.hasZ)}}}),t.default=b},function(e,t,r){e.exports={default:r(390),__esModule:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(11)),i=v(r(10)),o=v(r(3)),a=v(r(0)),s=v(r(2)),l=v(r(4)),u=v(r(7)),c=v(r(5)),f=r(1),h=v(r(29)),d=r(6),p=v(r(37)),y=v(r(96)),g=r(36);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));if(e=(0,f.defaultValue)(e,{}),r.coordinates=(0,f.defaultValue)(e.coordinates,[]),!Array.isArray(r.coordinates))throw new Error("坐标必须是数组");for(var n=0;n<r.coordinates.length;n++){if(r.coordinates[n].length<2||r.coordinates[n].length>3)throw new Error("多点的数组长度必须在合理范围内(2或者3)");3===r.coordinates[n].length?r.hasZ=!0:r.hasZ=!1}return r.type=d.GeometryType.multiPoint,r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"addPoint",value:function(e,t){if(t=(0,f.defaultValue)(t,"add"),e instanceof p.default)this._addPoint(e,t);else if(e instanceof Array)if(this._isNumberArray(e))this._addPoint(new p.default({coordinates:e}),t);else for(var r=0;r<e.length;r++)e[r]instanceof p.default?this._addPoint(e[r],t):e[r]instanceof Array?this._isNumberArray(e[r])?this._addPoint(new p.default({coordinates:e[r]}),t):e instanceof p.default?this._addPoint(e[r],t):y.default.error("point的子元素类型不是点几何对象或者点坐标数组！"):y.default.error("point的类型不是点几何对象或者点坐标数组！");else y.default.error("point的类型不是点几何对象或者点坐标数组！");return this.coordinates.length>=2&&(this.extent=this._calcExtent(this.coordinates,this.hasZ)),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"_addPoint",value:function(e,t){"add"===t?this.coordinates.push(e.coordinates):this.contains(e)||this.coordinates.push(e.coordinates)}},{key:"_isNumberArray",value:function(e){if(!(e instanceof Array))return!1;var t=!0;if(2===e.length||3===e.length){for(var r=0;r<e.length;r++)if("number"!=typeof e[r]){t=!1;break}}else t=!1;return t}},{key:"contains",value:function(e){if(e instanceof p.default){for(var t=0;t<this.coordinates.length;t++)if(e.equals(this.coordinates[t]))return!0}else if(e instanceof Array&&(2===e.length||3===e.length)){for(var r=0;r<this.coordinates.length;r++)if(new p.default({coordinates:e}).equals(this.coordinates[r]))return!0}else y.default.error("必须为点对象或坐标数组才能比较是否相等!");return!1}},{key:"getPoint",value:function(e){if(e=Number(e),!this._isValidate(e))throw new Error("未找到指定索引，请输入正确的索引");var t=this._cloneCoordinates();return new p.default({coordinates:t[e]})}},{key:"removePoint",value:function(e){if(e=Number(e),!this._isValidate(e))return null;var t=this._cloneCoordinates();return this.coordinates.splice(e,1),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),new p.default({coordinates:t[e]})}},{key:"setPoint",value:function(e,t){if(!this._isValidate(e))throw new Error("未找到指定索引，请输入正确的索引");var r=this._cloneCoordinates();return Array.isArray(r)&&(r.splice(e,1,p.default.toCoordinates(t)),this.coordinates=r),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"getIGSType",value:function(){return d.IGSGeometryType.multiPoint}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.coordinates=JSON.parse((0,i.default)(this.coordinates)),e.extent=this.extent?this.extent.toJSON():void 0,e}},{key:"toOldIGSGeometry",value:function(){for(var e=[],t=0;t<this.coordinates.length;t++){var r;r={x:this.coordinates[t][0],y:this.coordinates[t][1]},e.push({Dot:r,GID:t})}return{PntGeom:e}}},{key:"toString",value:function(){for(var e="",t=0;t<this.coordinates.length;t++)for(var r=this.coordinates[t],n=0;n<r.length;n++)e+=r[n]+",";return e.substring(0,e.length-1)}},{key:"toDots",value:function(){for(var e=[],t=this.coordinates,r=0;r<t.length;r++)e.push({x:t[r][0],y:t[r][1]});return e}},{key:"_isValidate",value:function(e){var t=this.coordinates.length;return!(!(0,f.isNumber)(e)||e<0||e>=t)}},{key:"_cloneCoordinates",value:function(){return JSON.parse((0,i.default)(this.coordinates))}},{key:"_calcExtent",value:function(e,t){if(e.length>1)return(0,g.calcExtent)(e,t,d.GeometryType.lineString,this.spatialReference)}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,f.defaultValue)(e,{}))}}]),t}(h.default);(0,n.default)(m.prototype,{extent:{configurable:!1,get:function(){return this._calcExtent(this.coordinates,this.hasZ)}}}),t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(r(11)),i=_(r(10)),o=_(r(3)),a=_(r(0)),s=_(r(2)),l=_(r(4)),u=_(r(7)),c=_(r(5)),f=_(r(29)),h=r(1),d=r(6),p=_(r(83)),y=_(r(37)),g=_(r(57)),v=r(36),m=r(190);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));if(e=(0,h.defaultValue)(e,{}),r.center=(0,h.defaultValue)(e.center,void 0),!r.center)throw new Error("缺少圆心坐标");if(r.center=y.default.toCoordinates(r.center),r.radius=(0,h.defaultValue)(e.radius,1e3),!(0,h.isNumber)(r.radius))throw new Error("半径必须为数字");if(r.geodesic=(0,h.defaultValue)(e.geodesic,!1),r.radiusUnit=(0,h.defaultValue)(e.radiusUnit,d.RadiusUnit.meters),r.numberOfPoints=(0,h.defaultValue)(e.numberOfPoints,40),!(0,h.isNumber)(r.numberOfPoints))throw new Error("圆曲线上点的数量必须为数字");return r.type=d.GeometryType.circle,3===r.center.length&&(r.hasZ=!0),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.center=JSON.parse((0,i.default)(this.center)),e.radius=this.radius,e.radiusUnit=this.radiusUnit,e.numberOfPoints=this.numberOfPoints,e.extent=this.extent.toJSON(),e}},{key:"toPolygon",value:function(){var e=this.spatialReference,t=this.geodesic,r=m.RadiusUnitToMeter[this.radiusUnit]||1,n=this.radius*r,i="geographic";if(e.isWebMercator)i="webMercator";else if(e.wkid&&(0,h.defined)(m.ProjUnitWkidMap[e.wkid]))i="proj";else if(e.wkt){var o=e.wkt;["PROJS","proj4","PROJCRS","+proj"].some(function(e){return 0===o.indexOf(e)})&&(i="proj")}if(!t){"geographic"===i&&(n/=m.RadiusUnitToMeter.degrees);var a=this._tranCircleToPath(this.center,n,this.numberOfPoints);return new p.default({coordinates:a,spatialReference:g.default.fromJSON(this.spatialReference)})}switch(i){case"proj":h.Log.error("暂时仅支持墨卡托投影坐标系和地理坐标系使用geodesic属性");break;case"webMercator":case"geographic":var s=6378137,l=Math.PI/180,u={latitude:this.center[1],longitude:this.center[0]};"webMercator"===i&&(u={longitude:180*u.longitude/Math.PI/s,latitude:180*(2*Math.atan(Math.exp(u.latitude/s))-Math.PI/2)/Math.PI});for(var c=n/1e3,f=c/(111.32*Math.cos(u.latitude*Math.PI/180)),d=c/110.574,y=[],v=0;v<this.numberOfPoints;v+=1){var _=v/this.numberOfPoints*(2*Math.PI),S=f*Math.cos(_),x=d*Math.sin(_),b=u.longitude+S,w=u.latitude+x;if("webMercator"===i){var k=Math.max(Math.min(85.0511287798,w),-85.0511287798),M=Math.sin(k*l);y.push([s*b*l,s*Math.log((1+M)/(1-M))/2])}else y.push([b,w])}return y.length<=3&&h.Log.error("生成圆几何点个数不能小于3"),y.push(y[0]),new p.default({coordinates:[y],spatialReference:g.default.fromJSON(this.spatialReference)})}}},{key:"toString",value:function(){return this.hasZ?this.center[0]+","+this.center[1]+","+this.center[2]+","+this.radius:this.center[0]+","+this.center[1]+","+this.radius}},{key:"toXMl",value:function(){return""}},{key:"getIGSType",value:function(){return d.IGSGeometryType.circle}},{key:"_tranCircleToPath",value:function(e,t,r){for(var n=2*Math.PI/r,i=0,o=[],a=[],s=0;s<r;s++){i-=n;var l=[e[0]+t*Math.cos(i),e[1]+t*Math.sin(i)];a.push(l)}var u=a[a.length-1],c=a[0];return Math.abs(u[0]-c[0])>1e-15&&Math.abs(u[1]-c[1])>1e-15&&a.push([c[0],c[1]]),o.push(a),this.hasZ&&(o=o.map(function(t){return t.map(function(t){return[t[0],t[1],e[2]]})})),o}},{key:"_calcExtent",value:function(e){var t=this.toPolygon();return(0,v.calcExtent)(t._cloneCoordinates(),e,d.GeometryType.polygon,this.spatialReference)}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toGeoJSON",value:function(){return this.toPolygon().toGeoJSON()}}],[{key:"fromJSON",value:function(e){return new t(e=(0,h.defaultValue)(e,{}))}}]),t}(f.default);(0,n.default)(S.prototype,{extent:{configurable:!1,get:function(){return this._calcExtent(this.hasZ)}}}),t.default=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProjUnitWkidMap=t.getMetersPerSpatialReference=t.LengthUnitToMeter=t.RadiusUnitToMeter=t.DegreesUnitToMeter=void 0;var n=r(184),i={degrees:111320},o={degrees:i.degrees,miles:1609.34,"nautical-miles":1852,yard:.9144,meters:1,kilometers:1e3};t.DegreesUnitToMeter=i,t.RadiusUnitToMeter=o,t.LengthUnitToMeter={kilometers:1e3,meters:1,miles:1609.34},t.getMetersPerSpatialReference=function(e){if(e.isGeographic)return i.degrees;var t=e.wkid;return n.ProjUnitWkidMap[t]?n.ProjUnitWkidMap.values[n.ProjUnitWkidMap[t]]:1},t.ProjUnitWkidMap=n.ProjUnitWkidMap},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(11)),i=g(r(10)),o=g(r(3)),a=g(r(0)),s=g(r(2)),l=g(r(4)),u=g(r(7)),c=g(r(5)),f=g(r(29)),h=r(1),d=r(6),p=g(r(37)),y=r(36);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));if(e=(0,h.defaultValue)(e,{}),r.coordinates=(0,h.defaultValue)(e.coordinates,[]),r.type=d.GeometryType.multiLineString,!Array.isArray(r.coordinates))throw new Error("坐标必须为数组");for(var n=0;n<r.coordinates.length;n++)if(r.coordinates[n].length<2)throw new Error("坐标必须是两个或多个位置的数组");return 3===r.coordinates[0][0].length&&(r.hasZ=!0),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"addPath",value:function(e){if(!Array.isArray(e))throw new Error("传入参数错误");var t=[];return e.forEach(function(e){t.push(p.default.toCoordinates(e))}),this.coordinates.push(t),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"removePath",value:function(e){if(!this._isValidate(e,0))return null;var t=JSON.parse((0,i.default)(this._cloneCoordinates()[e]));return this.coordinates.splice(e,1),this.coordinates=JSON.parse((0,i.default)(this.coordinates)),t.map(function(e){return new p.default({coordinates:e})})}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.coordinates=JSON.parse((0,i.default)(this.coordinates)),e.extent=this.extent.toJSON(),e}},{key:"getPoint",value:function(e,t){if(!this._isValidate(e,t))return null;var r=this._cloneCoordinates()[e];return new p.default({coordinates:r[t]})}},{key:"insertPoint",value:function(e,t,r){if(!this._isValidate(e,t))return null;var n=this.coordinates[e];return Array.isArray(n)&&n.splice(t,0,p.default.toCoordinates(r)),this.coordinates[e]=n,this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"removePoint",value:function(e,t){if(!this._isValidate(e,t))return null;var r=this.coordinates[e];return Array.isArray(r)&&r.splice(t,1),this.coordinates=r,this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"setPoint",value:function(e,t,r){if(!this._isValidate(e,t))return this;var n=this.coordinates[e];return Array.isArray(n)&&n.splice(t,1,p.default.toCoordinates(r)),this.coordinates[e]=n,this.coordinates=JSON.parse((0,i.default)(this.coordinates)),this}},{key:"toString",value:function(){return""}},{key:"toXMl",value:function(){return""}},{key:"getIGSType",value:function(){return d.IGSGeometryType.multiLineString}},{key:"toOldIGSGeometry",value:function(){for(var e=[],t=0;t<this.coordinates.length;t++){for(var r=[],n=0;n<this.coordinates[t].length;n++)r.push({x:this.coordinates[t][n][0],y:this.coordinates[t][n][1]});e.push({Line:{Arcs:[{Dots:r,ArcID:0}]},GID:t})}return{LinGeom:e}}},{key:"_isValidate",value:function(e,t){var r=this.coordinates.length;if(!(0,h.isNumber)(e)||e<0||e>=r)return!1;var n=this.coordinates[e].length;return!(!(0,h.isNumber)(t)||t<0||t>=n)}},{key:"_cloneCoordinates",value:function(){return JSON.parse((0,i.default)(this.coordinates))}},{key:"_calcExtent",value:function(e,t){return(0,y.calcExtent)(e,t,d.GeometryType.multiLineString,this.spatialReference)}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"clone",value:function(e){return new t(e.toJSON())}},{key:"fromJSON",value:function(e){return new t(e=(0,h.defaultValue)(e,{}))}}]),t}(f.default);(0,n.default)(v.prototype,{extent:{configurable:!1,get:function(){return this._calcExtent(this.coordinates,this.hasZ)}}}),t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={},i=52.35987755982988,o=3.141592653589793,a=6378245,s=.006693421622965943;n.transformlat=function(e,t){var r=2*(e=+e)-100+3*(t=+t)+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return r+=2*(20*Math.sin(6*e*o)+20*Math.sin(2*e*o))/3,(r+=2*(20*Math.sin(t*o)+40*Math.sin(t/3*o))/3)+2*(160*Math.sin(t/12*o)+320*Math.sin(t*o/30))/3},n.transformlng=function(e,t){var r=300+(e=+e)+2*(t=+t)+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return r+=2*(20*Math.sin(6*e*o)+20*Math.sin(2*e*o))/3,(r+=2*(20*Math.sin(e*o)+40*Math.sin(e/3*o))/3)+2*(150*Math.sin(e/12*o)+300*Math.sin(e/30*o))/3},n.out_of_china=function(e,t){return t=+t,!((e=+e)>73.66&&e<135.05&&t>3.86&&t<53.55)},n.bd09togcj02=function(e,t){var r=(e=+e)-.0065,n=(t=+t)-.006,o=Math.sqrt(r*r+n*n)-2e-5*Math.sin(n*i),a=Math.atan2(n,r)-3e-6*Math.cos(r*i);return[o*Math.cos(a),o*Math.sin(a)]},n.bd09towgs84=function(e,t){var r=n.bd09togcj02(e,t);return n.gcj02towgs84(r[0],r[1])},n.wgs84tobd09=function(e,t){var r=n.wgs84togcj02(e,t);return n.gcj02tobd09(r[0],r[1])},n.gcj02tobd09=function(e,t){t=+t,e=+e;var r=Math.sqrt(e*e+t*t)+2e-5*Math.sin(t*i),n=Math.atan2(t,e)+3e-6*Math.cos(e*i);return[r*Math.cos(n)+.0065,r*Math.sin(n)+.006]},n.wgs84togcj02=function(e,t){var r=[e=+e,t=+t];if(!this.out_of_china(e,t)){var n=this.transformlat(e-105,t-35),i=this.transformlng(e-105,t-35),l=t/180*o,u=Math.sin(l);u=1-s*u*u;var c=Math.sqrt(u);n=180*n/(a*(1-s)/(u*c)*o),r=[e+(i=180*i/(a/c*Math.cos(l)*o)),t+n]}return r},n.gcj02towgs84=function(e,t){var r=[e=+e,t=+t];if(!this.out_of_china(e,t)){var n=this.transformlat(e-105,t-35),i=this.transformlng(e-105,t-35),l=t/180*o,u=Math.sin(l);u=1-s*u*u;var c=Math.sqrt(u);n=180*n/(a*(1-s)/(u*c)*o),r=[2*e-(e+(i=180*i/(a/c*Math.cos(l)*o))),2*t-(t+n)]}return r},t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],i=[75,60,45,30,15,0],o=[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],a=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]];function s(e){e=e||{},this._isWgs84=e.isWgs84}(0,function(e){return e&&e.__esModule?e:{default:e}}(r(11)).default)(s.prototype,{isWgs84:{get:function(){return this._isWgs84},set:function(e){this._isWgs84=e}}}),s.prototype.getDistanceByMC=function(e,t){if(!e||!t)return 0;if(!(e=this.convertMC2LL(e)))return 0;var r=this.toRadians(e.lng),n=this.toRadians(e.lat);if(!(t=this.convertMC2LL(t)))return 0;var i=this.toRadians(t.lng),o=this.toRadians(t.lat);return this.getDistance(r,i,n,o)},s.prototype.getDistanceByLL=function(e,t){if(!e||!t)return 0;e.lng=this.getLoop(e.lng,-180,180),e.lat=this.getRange(e.lat,-74,74),t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74);var r=this.toRadians(e.lng),n=this.toRadians(e.lat),i=this.toRadians(t.lng),o=this.toRadians(t.lat);return this.getDistance(r,i,n,o)},s.prototype.convertMC2LL=function(e){if(!e)return{lng:0,lat:0};var t={};if(this.isWgs84){t.lng=e.lng/20037508.34*180;var r=e.lat/20037508.34*180;return t.lat=180/Math.PI*(2*Math.atan(Math.exp(r*Math.PI/180))-Math.PI/2),{lng:t.lng.toFixed(6),lat:t.lat.toFixed(6)}}Math.abs(e.lng);for(var i=Math.abs(e.lat),a=void 0,s=0;s<n.length;s++)if(i>=n[s]){a=o[s];break}return{lng:(t=this.convertor(e,a)).lng.toFixed(6),lat:t.lat.toFixed(6)}},s.prototype.convertLL2MC=function(e){if(!e)return{lng:0,lat:0};if(e.lng>180||e.lng<-180||e.lat>90||e.lat<-90)return e;if(this.isWgs84){var t={};t.lng=e.lng*Math.PI/180*6378137;var r=e.lat*Math.PI/180;return t.lat=3189068.5*Math.log((1+Math.sin(r))/(1-Math.sin(r))),{lng:parseFloat(t.lng.toFixed(2)),lat:parseFloat(t.lat.toFixed(2))}}e.lng=this.getLoop(e.lng,-180,180),e.lat=this.getRange(e.lat,-74,74),e.lng;for(var n=e.lat,o=void 0,s=0;s<i.length;s++)if(n>=i[s]){o=a[s];break}if(!o)for(var l=0;l<i.length;l++)if(n<=-i[l]){o=a[l];break}var u=this.convertor(e,o);return{lng:parseFloat(u.lng.toFixed(2)),lat:parseFloat(u.lat.toFixed(2))}},s.prototype.convertor=function(e,t){if(!e||!t)return{lng:0,lat:0};var r=t[0]+t[1]*Math.abs(e.lng),n=Math.abs(e.lat)/t[9],i=t[2]+t[3]*n+t[4]*n*n+t[5]*n*n*n+t[6]*n*n*n*n+t[7]*n*n*n*n*n+t[8]*n*n*n*n*n*n;return{lng:r*=e.lng<0?-1:1,lat:i*=e.lat<0?-1:1}},s.prototype.getDistance=function(e,t,r,n){return 6370996.81*Math.acos(Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos(t-e))},s.prototype.toRadians=function(e){return Math.PI*e/180},s.prototype.toDegrees=function(e){return 180*e/Math.PI},s.prototype.getRange=function(e,t,r){return null!==t&&(e=Math.max(e,t)),null!==r&&(e=Math.min(e,r)),e},s.prototype.getLoop=function(e,t,r){for(;e>r;)e-=r-t;for(;e<t;)e+=r-t;return e},s.prototype.lngLatToMercator=function(e){return this.convertLL2MC(e)},s.prototype.lngLatToPoint=function(e){var t=this.convertLL2MC(e);return{x:t.lng,y:t.lat}},s.prototype.mercatorToLngLat=function(e){return this.convertMC2LL(e)},s.prototype.pointToLngLat=function(e){var t={lng:e.x,lat:e.y};return this.convertMC2LL(t)},s.prototype.pointToPixel=function(e,t,r,n){if(!e)return{x:0,y:0};e=this.lngLatToMercator(e);var i=this.getZoomUnits(t);return{x:Math.round((e.lng-r.lng)/i+n.width/2),y:Math.round((r.lat-e.lat)/i+n.height/2)}},s.prototype.pixelToPoint=function(e,t,r,n){if(!e)return{lng:0,lat:0};var i=this.getZoomUnits(t),o={lng:r.lng+i*(e.x-n.width/2),lat:r.lat-i*(e.y-n.height/2)};return this.mercatorToLngLat(o)},s.prototype.getZoomUnits=function(e){return Math.pow(2,18-e)},t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.start=(0,o.toDate)(t.start),this.end=(0,o.toDate)(t.end)}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.start=this.start?this.start.toString():null,e.end=this.end?this.end.toString():null,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.unit=t.unit,this.value=t.value}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.unit=this.unit,e.value=this.value,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(14)),i=g(r(16)),o=g(r(0)),a=g(r(2)),s=r(1),l=g(r(98)),u=g(r(136)),c=g(r(137)),f=r(6),h=r(99),d=r(8),p=r(9),y=g(r(198));function g(e){return e&&e.__esModule?e:{default:e}}var v=function(){function e(t,r){(0,o.default)(this,e),r=(0,s.defaultValue)(r,{}),this.url=t,this.requestInterceptor=(0,s.defaultValue)(r.requestInterceptor,new u.default),this.responseInterceptor=(0,s.defaultValue)(r.responseInterceptor,new c.default),this.requestTimeout=(0,s.defaultValue)(r.requestTimeout,45e3),this.headers=(0,s.defaultValue)(r.headers,{}),this.tokenKey=(0,s.defaultValue)(r.tokenKey,"token"),this.tokenValue=(0,s.defaultValue)(r.tokenValue,void 0),this.tokenAttachType=(0,s.defaultValue)(r.tokenAttachType,f.TokenAttachType.normal)}return(0,a.default)(e,[{key:"destroy",value:function(){this.url=null,this.options=null}},{key:"request",value:function(e){if(e=(0,s.defaultValue)(e,{}),!(0,s.isNull)(e.url))return!(0,s.isNull)(this.requestInterceptor)&&!(0,s.isNull)(this.requestInterceptor.before)&&this.requestInterceptor.before instanceof Function&&(e=this.requestInterceptor.before(e)),(0,s.isNull)(e)?void 0:this._commit(e);s.Log.error("url不存在！")}},{key:"_commit",value:function(e){var t=this;e.url=(0,h.ServiceConfigRequestInterceptors)(y.default,(0,h.isEncoded)(e.url)?e.url:encodeURI(e.url)),e.headers=(0,s.defaultValue)(e.headers,{});var r=(0,i.default)(e.headers,this.headers),o={headers:r=(0,i.default)(r,y.default.headers),withCredentials:e.withCredentials,requestTimeout:this.requestTimeout,proxy:e.proxy,tokenKey:this.tokenKey||y.default.tokenKey,tokenValue:this.tokenValue||y.default.tokenValue,tokenAttachType:e.tokenAttachType||this.tokenAttachType};return e.responseType&&(o.responseType=e.responseType),l.default.commit(e.method,e.url,e.data,o).then(function(r){var i=void 0;if(r.text){if("blob"===o.responseType)return r.blob();i=function(){return r.text()}}else i=function(){return r.json()};return 200===r.status?new n.default(function(r){i().then(function(i){var o=void 0;if((0,s.isNull)(i))o={succeed:!0,msg:"服务器没有返回信息",data:void 0};else{var a=void 0;if("string"==typeof i)if(i.indexOf("<?xml")>-1)if(i.indexOf("OGC:WMS")>-1||i.indexOf("WMS_Capabilities")>-1||i.indexOf("<Keyword>WMS</Keyword>")>-1){var l="1.1.1";i.indexOf("1.3.0")>-1&&(l="1.3.0");var u=(0,h.getDoc)(i);a=(0,h.getWMSInfoFromXML)(u,l,e.url)}else if(i.indexOf("WMTS")>-1||i.indexOf("wmts/1.0")>-1){var c=(0,h.getDoc)(i);a=(0,h.getWMTSInfoFromXML)(c)}else if(i.indexOf("wfs:WFS_Capabilities")>-1){var f=(0,h.getDoc)(i);a=(0,h.getWFSInfoFromXML)(f)}else if(i.indexOf("wfs:FeatureCollection")>-1){var g=(0,h.getDoc)(i),v=e.url.toLowerCase(),m="2.0.0";v.indexOf("version=1.0.0")>-1?m="1.0.0":v.indexOf("version=1.1.0")>-1?m="1.1.0":v.indexOf("version=2.0.0")>-1&&(m="1.1.0"),a=(0,h.getWFSFeature)(g,m)}else i.indexOf("<svg")>-1&&(a=i);else{if(i.indexOf("html>")>-1)return!(0,s.isNull)(t.responseInterceptor)&&!(0,s.isNull)(t.responseInterceptor.failure)&&t.responseInterceptor.failure instanceof Function&&t.responseInterceptor.failure({succeed:!1,msg:"服务器不支持"+e.method+"请求或其他错误",data:void 0,errorType:"unKnownError"}),!(0,s.isNull)(e.failure)&&e.failure instanceof Function&&e.failure({succeed:!1,msg:"服务器不支持"+e.method+"请求或其他错误",data:void 0,errorType:"unKnownError"}),n.default.reject({succeed:!1,msg:"服务器不支持"+e.method+"请求或其他错误",data:void 0,errorType:"unKnownError"});if((a=JSON.parse(i))instanceof Object&&(e.url.indexOf("/igs/rest/mrfs/layer/query")>-1||e.url.indexOf("/igs/rest/mrfs/docs/")>-1)){var _=(0,h.fromQueryResult)(a);delete a.SFEleArray,a.featureSets=_;var S=[];if(_.length>1)for(var x=0;x<_.length;x++)S.push(a[String(x)]),delete a[String(x)];else a.AttStruct.TotalCount=a.TotalCount,S.push(a.AttStruct),delete a.AttStruct,delete a.TotalCount;a.featureInfos=S,(e.url.indexOf("/igs/rest/mrfs/docs/")>-1||e.url.indexOf("/igs/rest/mrfs/layer/")>-1)&&(_.length>0?a.featureSet=_[0]:a.featureSet=new d.FeatureSet)}}if(a instanceof Object){if(a.hasOwnProperty("features")&&a.features instanceof Array){var b=void 0,w=!1;a.spatialReference?b=new p.SpatialReference(a.spatialReference):e.extensionOptions&&e.extensionOptions.outSrs?b=new p.SpatialReference(e.extensionOptions.outSrs):(w=!0,b=p.SpatialReference.fromJSON(a.spatialReference));var k=!1;/(igs)\/rest\/services\/.*\/WFSServer/.test(e.url)&&4326===b.wkid&&w&&(k=!0),a.featureSet=d.FeatureSet.fromArray(a.features,new d.FeatureSet({spatialReference:b}),{reverse:k})}else if(a.hasOwnProperty("layers")&&e.url.indexOf("igs/rest/mrcs/tiles")<0)for(var M=0;M<a.layers.length;M++){var E;E=e.extensionOptions&&e.extensionOptions.outSrs?new p.SpatialReference(e.extensionOptions.outSrs):p.SpatialReference.fromJSON(a.layers[M].spatialReference),a.layers[M].featureSet=d.FeatureSet.fromArray(a.layers[M].features,new d.FeatureSet({spatialReference:E}))}else if(e.url.indexOf("/MapServer/query")>-1||e.url.indexOf("/SceneServer/query")>-1){if(a.layers&&a.layers instanceof Array){var I=new p.SpatialReference("EPSG:4326");a.spatialReference&&(I=new p.SpatialReference({wkid:a.spatialReference.wkid,wkt:a.spatialReference.wkt}));for(var T=a.layers,L=0;L<T.length;L++)T[L].features&&(T[L].featureSet=d.FeatureSet.fromArray(T[L].features,new d.FeatureSet({spatialReference:I})),delete T[L].features)}}else e.url.indexOf("/MapServer/layers?")>-1&&function e(t){for(var r=0;r<t.length;r++)t[r].id=t[r].index,t[r].children&&t[r].children instanceof Array&&e(t[r].children)}(a.layers);o={succeed:!0,msg:"请求成功",data:a}}else o={succeed:!0,msg:a,data:a}}o=(0,h.ServiceConfigResponseInterceptors)(y.default,(0,h.isEncoded)(e.url)?e.url:encodeURI(e.url),o),!(0,s.isNull)(t.responseInterceptor)&&!(0,s.isNull)(t.responseInterceptor.success)&&t.responseInterceptor.success instanceof Function&&(o=t.responseInterceptor.success(o)),!(0,s.isNull)(o)&&!(0,s.isNull)(e.success)&&e.success instanceof Function&&e.success(o),r(o)})},function(e){console.log("Fetch返回异常",e)}):new n.default(function(r){i().then(function(n){var i=void 0;if((0,s.isNull)(n))i={succeed:!1,msg:"请求失败，服务器没有返回信息",data:void 0};else{var o=JSON.parse(n);i=o instanceof Object?{succeed:!1,msg:"请求失败",data:o}:{succeed:!1,msg:o,data:void 0}}!(0,s.isNull)(t.responseInterceptor)&&!(0,s.isNull)(t.responseInterceptor.failure)&&t.responseInterceptor.failure instanceof Function&&(i=t.responseInterceptor.failure(i)),!(0,s.isNull)(i)&&!(0,s.isNull)(e.failure)&&e.failure instanceof Function&&e.failure(i),r(i)})},function(e){console.error("Fetch返回异常",e)})}).catch(function(r){var n={succeed:!1,msg:"请求失败",data:r};t._resolveFailure instanceof Function&&t._resolveFailure(n,e.failure,void 0)})}}]),e}();t.default=v},function(e,t,r){var n=r(24);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={tokenKey:"token",tokenValue:void 0,headers:{},request:{interceptors:[]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"getLayerJSON",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/layer.json"})}}]),t}(l(r(13)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(5)),l=r(1),u=f(r(13)),c=r(38);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"queryResourceInfo",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/resources/info"})}},{key:"getStyleList",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/resources/styles"})}},{key:"getStyle",value:function(e){return this._queryByParameters(e,{styleId:{type:"String"}},{},function(e,t){return e+"/resources/styles/"+t.styleId+"?f=json"})}},{key:"getTileMap",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/tilemap"})}},{key:"getRootJSON",value:function(e){var t=void 0,r="";if((e=(0,l.defaultValue)(e,{})).url){var n=c.UrlUtil.getBaseUrlAndParams(e.url),i=n.params;(0,l.defined)(this.tokenKey)&&(0,l.defined)(this.tokenValue)&&delete i[e.tokenValue],t=n.baseUrl,(r=c.UrlUtil.getStringFromObject(i))&&(r="?"+r)}return this._queryByParameters(e,{},{},function(e){return(0,l.defined)(t)?""+t+r:e+"/resources/styles/root.json"})}},{key:"getSpiriteJSON",value:function(e){return this._queryByParameters(e,{},{},function(){return""+e.url})}}]),t}(u.default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={DefaultThemeInfo:1,DataItemIntrinsicInfo:2}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.default=function(e){e=(0,n.defaultValue)(e,{}),(0,n.extend)(this,e),this.LibID=void 0!==e.LibID?e.LibID:0,this.Ovprnt=void 0!==e.Ovprnt&&e.Ovprnt,this.Angle=void 0!==e.Ovprnt?e.Ovprnt:0,this.BackClr=void 0!==e.BackClr?e.BackClr:0,this.BackExp=void 0!==e.BackExp?e.BackExp:0,this.Chnt=void 0!==e.Chnt?e.Chnt:0,this.Color=void 0!==e.Color?e.Color:0,this.FontAngle=void 0!==e.FontAngle?e.FontAngle:0,this.Height=void 0!==e.Height?e.Height:0,this.Ifnt=void 0!==e.Ifnt?e.Ifnt:0,this.Ifnx=void 0!==e.Ifnx?e.Ifnx:0,this.IsFilled=void 0!==e.IsFilled&&e.IsFilled,this.IsHzpl=void 0===e.IsHzpl||e.IsHzpl,this.OffsetX=void 0!==e.OffsetX?e.OffsetX:0,this.OffsetY=void 0!==e.OffsetY?e.OffsetY:0,this.Space=void 0!==e.Space?e.Space:0,this.Width=void 0!==e.Width?e.Width:0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={Unknown:0,Value:1,Percent:2}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(4)),a=c(r(5)),s=c(r(32)),l=c(r(205)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.ChartType=void 0!==e.ChartType?e.ChartType:l.default.Bar,r.ChartThemeInfoArr=void 0!==e.ChartThemeInfoArr?e.ChartThemeInfoArr:null,r.RepresentInfo=void 0!==e.RepresentInfo?e.RepresentInfo:null,r.Type="CChartTheme",r}return(0,a.default)(t,e),t}(s.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={Unknown:0,Bar:1,Bar3D:2,Pie:3,Pie3D:4,Line:5,Line3D:6,Point:7}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=u(r(32)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,i.default)(this,t),e=(0,l.defaultValue)(e,{});var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.Expression=void 0!==e.Expression?e.Expression:"",r.Info=void 0!==e.Info?e.Info:null,r.Value=void 0!==e.Value?e.Value:null,r.Type="CDotDensityTheme",r}return(0,a.default)(t,e),t}(s.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=u(r(32)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,i.default)(this,t),e=(0,l.defaultValue)(e,{});var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.ClrInfo=void 0!==e.ClrInfo?e.ClrInfo:[25,57,89,121],r.Type="CFourColorTheme",r}return(0,a.default)(t,e),t}(s.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=u(r(32)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,i.default)(this,t),e=(0,l.defaultValue)(e,{});var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.BaseValue=void 0!==e.BaseValue?e.BaseValue:141e-6,r.DispMinus=void 0!==e.DispMinus&&e.DispMinus,r.DispZero=void 0!==e.DispZero&&e.DispZero,r.Expression=void 0!==e.Expression?e.Expression:null,r.MinusPntInfo=void 0!==e.MinusPntInfo?e.MinusPntInfo:null,r.PlusPntInfo=void 0!==e.PlusPntInfo?e.PlusPntInfo:null,r.ZeroPntInfo=void 0!==e.ZeroPntInfo?e.ZeroPntInfo:null,r.Type="CGraduatedSymbolTheme",r}return(0,a.default)(t,e),t}(s.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XClsType={SFCls:"SFeatureCls",OCls:"ObjectCls",ACls:"AnnotationCls",GnetCls:"GNetCls",RDS:"RasterDataset",SFClsInfo:"sfcls_new"},t.VectClsType={Unknown:0,SFCls:"SFeatureCls",AnnoCls:"AnnotationCls"},t.FeatureType={Unknown:0,Pnt:1,Lin:2,Reg:3},t.FontShape={Positive:0,LeftOblique:1,RightOblique:2,LeftTowering:3,RightTowering:4},t.LabelLinType={Curved:0,Forward:1,Horizontal:2,Tangent:3},t.LabelRegType={Curved:0,Forward:1,Horizontal:2,Boundray:3,Outside:4},t.LabelPntType={PntAnyDir:0,PntEightDir:1,PntOnFea:2},t.RepeatType={Auto:0,NoRep:1,OnStep:2},t.LabelSpreadType={AutoSpread:0,Centralization:1,Decentralization:2},t.LineConstrain={Left:0,Right:1,Above:2,Below:3,Both:4,NoRes:5},t.EightDirType={East:0,North:1,NorthEast:2,NorthWest:3,South:4,SouthEast:5,SouthWest:6,West:7,NoDir:8},t.ISShowArc={Reg:0,Arc:1,All:2},t.NetAnalyType={UserMode:"UserMode",SysModeCommwayPrefer:"SysModeCommwayPrefer",SysModeHighWayPrefer:"SysModeHighWayPrefer",SysModeMinCost:"SysModeMinCost",SysModeMinDis:"SysModeMinDis",SysModeSysRecommend:"SysModeSysRecommend"},t.NetElemType={Node:1,Edge:2,CNode:3,Chain:4,Center:5,Source:13,Sink:13},t.CLinAdjustType={Adjust:0,NoAdjust:1},t.CLinHeadType={Round:0,Square:1,Butt:2},t.CLinJointType={Round:0,Square:1,Butt:2},t.CLinStyleMakeType={Byrule:0,Bypoint:1},t.CItemType={Unknown:0,UniqueTheme:1,RangeTheme:2},t.MapType={Doc:"mapType",Tile:"tileType"},t.LayerStatusType={Show:"show",Hide:"hide",Include:"include",Exclude:"exclude"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=u(r(32)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,i.default)(this,t),e=(0,l.defaultValue)(e,{});var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.DefaultInfo=void 0!==e.DefaultInfo?e.DefaultInfo:null,r.ExpInfoArr=void 0!==e.ExpInfoArr?e.ExpInfoArr:null,r.MultiClassThemeInfoArr=void 0!==e.MultiClassThemeInfoArr?e.MultiClassThemeInfoArr:null,r.GeoInfoType=void 0!==e.GeoInfoType?e.GeoInfoType:null,r.Type="CMultiClassTheme",r}return(0,a.default)(t,e),t}(s.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=u(r(32)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,i.default)(this,t),e=(0,l.defaultValue)(e,{});var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.Type="CRandomTheme",r}return(0,a.default)(t,e),t}(s.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(4)),a=c(r(5)),s=c(r(32)),l=c(r(201)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t),e=(0,u.defaultValue)(e,{});var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.AllOtherDataItemInfoSource=void 0!==e.AllOtherDataItemInfoSource?e.AllOtherDataItemInfoSource:l.default.DefaultThemeInfo,r.Expression=void 0!==e.Expression?e.Expression:"",r.DefaultInfo=void 0!==e.DefaultInfo?e.DefaultInfo:null,r.RangeThemeInfoArr=void 0!==e.RangeThemeInfoArr?e.RangeThemeInfoArr:null,r.GeoInfoType=void 0!==e.GeoInfoType?e.GeoInfoType:null,r.Type="CRangeTheme",r}return(0,a.default)(t,e),t}(s.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(4)),a=c(r(5)),s=c(r(32)),l=c(r(84)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t),e=(0,u.defaultValue)(e,{});var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.ThemeInfo=void 0!==e.ThemeInfo?e.ThemeInfo:new l.default,r.Type="CSimpleTheme",r}return(0,a.default)(t,e),t}(s.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=u(r(32)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,i.default)(this,t),e=(0,l.defaultValue)(e,{});var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.DefaultInfo=void 0!==e.DefaultInfo?e.DefaultInfo:null,r.Expression=void 0!==e.Expression?e.Expression:"",r.UniqueThemeInfoArr=void 0!==e.UniqueThemeInfoArr?e.UniqueThemeInfoArr:null,r.GeoInfoType=void 0!==e.GeoInfoType?e.GeoInfoType:null,r.Type="CUniqueTheme",r}return(0,a.default)(t,e),t}(s.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){this.name=void 0!==e?e:null,this.attribute=void 0!==t?t:null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){this.name=void 0!==e?e:null,this.Value=void 0!==t?t:null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){this.LayerName=void 0!==e?e:null,this.ThemeArr=void 0!==t?t:null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWorkflow=t.WorkFlowServer=void 0;var n=E(r(17)),i=E(r(465)),o=E(r(466)),a=E(r(467)),s=E(r(468)),l=E(r(469)),u=E(r(470)),c=E(r(471)),f=E(r(472)),h=E(r(473)),d=E(r(474)),p=E(r(475)),y=E(r(476)),g=E(r(477)),v=E(r(478)),m=E(r(479)),_=E(r(480)),S=E(r(481)),x=E(r(482)),b=E(r(483)),w=E(r(484)),k=E(r(485)),M=E(r(486));function E(e){return e&&e.__esModule?e:{default:e}}var I={WorkFlowServer:n.default,WorkFlowServer600227:i.default,WorkFlowServer600228:o.default,WorkFlowServer600229:a.default,WorkFlowServer600230:s.default,WorkFlowServer600231:l.default,WorkFlowServer600232:u.default,WorkFlowServer600233:c.default,WorkFlowServer600235:f.default,WorkFlowServer600237:h.default,WorkFlowServer600238:d.default,WorkFlowServer600239:p.default,WorkFlowServer600307:y.default,WorkFlowServer600308:g.default,WorkFlowServer600309:v.default,WorkFlowServer600314:m.default,WorkFlowServer600334:_.default,WorkFlowServer600336:S.default,WorkFlowServer600340:x.default,WorkFlowServer600354:b.default,WorkFlowServer600368:w.default,WorkFlowServer600369:k.default,WorkFlowServer600370:M.default};t.WorkFlowServer=n.default,t.createWorkflow=function(e){var t=((e||{}).url||"").match(/(workflow)(\/)\d+(\/)(WorkflowServer)/g);if(!t)throw new Error("未识别工作流id");var r=t[0].split("/"),n=void 0;if(Array.isArray(r)&&3===r.length&&(n=r[1]),!n)throw new Error("未识别工作流id "+n);var i=I["WorkFlowServer"+n];if(!i)throw new Error("id为"+n+"的工作流未定义");return new i(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IGSFeatureLayer=t.Scene=t.IGSTileLayer=t.IGSSceneSubLayer=t.IGSSceneLayer=t.IGSMapImageSubLayer=t.IGSMapImageLayer=t.IGSVectorTileSubLayer=t.IGSVectorTileLayer=void 0;var n=h(r(492)),i=h(r(226)),o=h(r(522)),a=h(r(227)),s=h(r(523)),l=h(r(524)),u=h(r(142)),c=h(r(228)),f=h(r(525));function h(e){return e&&e.__esModule?e:{default:e}}t.IGSVectorTileLayer=n.default,t.IGSVectorTileSubLayer=i.default,t.IGSMapImageLayer=o.default,t.IGSMapImageSubLayer=a.default,t.IGSSceneLayer=l.default,t.IGSSceneSubLayer=u.default,t.IGSTileLayer=s.default,t.Scene=c.default,t.IGSFeatureLayer=f.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(r(11)),i=m(r(16)),o=m(r(10)),a=m(r(23)),s=m(r(3)),l=m(r(0)),u=m(r(2)),c=m(r(4)),f=m(r(7)),h=m(r(5)),d=r(1),p=m(r(101)),y=m(r(494)),g=m(r(69)),v=r(6);function m(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e){(0,l.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return e=(0,d.defaultValue)(e,{}),r.type=v.LayerType.vectorTileSubLayer,r._labelingInfo=(0,d.defaultValue)(e.labelingInfo,[]),r._styleLayers=(0,d.defaultValue)(e.styleLayers,[]),r._visible=(0,d.defaultValue)(e.visible,!0),r._opacity=(0,d.defaultValue)(e.opacity,1),r._renderer=(0,d.defaultValue)(e.renderer,void 0),r._updateStyle(),r}return(0,h.default)(t,e),(0,u.default)(t,[{key:"_updateStyle",value:function(){var e=this;this._convertLabelInfoToLabelClass(),this._renderer?this._styleLayers.forEach(function(t){e._updateStyleLayerByRenderer(t),e._updateStyleLayerVisibleBySublayer(t),e._updateStyleLayerOpacityBySublayer(t),e._updateStyleLayerByLabelingInfo(t)}):this._styleLayers.forEach(function(t){e._updateStyleLayerVisibleBySublayer(t),e._updateStyleLayerOpacityBySublayer(t),e._updateStyleLayerByLabelingInfo(t)})}},{key:"_updateStyleLayerVisibleBySublayer",value:function(e){var t=this.layer._getBackupProperties(e.id,"visibility");e.layout.visibility=this.layer.visible&&this.visible?t:"none"}},{key:"_updateStyleLayerOpacityBySublayer",value:function(e){var t=this,r=this.layer._getBackupProperties(e.id,"opacities");(0,a.default)(r).forEach(function(n){e.paint[n]=Number(r[n])*t.opacity*t.layer.opacity})}},{key:"_updateStyleLayerByRenderer",value:function(e){var t=y.default.renderToStyle(this._renderer,e.type,JSON.parse((0,o.default)(e)));if(t){var r=t.paint,n=t.layout;e.paint=(0,i.default)(e.paint,r),e.layout=(0,i.default)(e.layout,n)}}},{key:"_convertLabelInfoToLabelClass",value:function(){for(var e=(0,d.cloneObject)(this._labelingInfo),t=[],r=0;r<e.length;r++)t.push(new p.default(e[r]));this._labelingInfo=t}},{key:"_updateStyleLayerByLabelingInfo",value:function(e){this.layer.setExtendProperties(e.id,"labelingInfo",this._labelingInfo)}},{key:"_fireLayerUpdateEvent",value:function(e,t){e=(0,d.defaultValue)(e,"setStyleLayer"),t=(0,d.defaultValue)(t,[]),this.layer._fireLayerUpdateEvent([{params:t,dataChanged:!0,name:e,operationType:"method"}])}},{key:"toJSON",value:function(){var e=(0,f.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.styleLayers=this.styleLayers,e.renderer=this.renderer?this.renderer.toJSON():null,e.labelingInfo=this.labelingInfo.map(function(e){return e.toJSON()}),e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(g.default);(0,n.default)(_.prototype,{styleLayers:{get:function(){return this._styleLayers}},renderer:{get:function(){return this._renderer},set:function(e){var t=this;this._renderer=e,this._styleLayers.forEach(function(e){t._updateStyleLayerByRenderer(e)}),this._fireLayerUpdateEvent()}},visible:{get:function(){return this._visible},set:function(e){var t=this;this._visible=e,this._styleLayers.forEach(function(e){t._updateStyleLayerVisibleBySublayer(e)}),this._fireLayerUpdateEvent()}},opacity:{get:function(){return this._opacity},set:function(e){var t=this;this._opacity=e,this._styleLayers.forEach(function(e){t._updateStyleLayerOpacityBySublayer(e)}),this._fireLayerUpdateEvent()}},labelingInfo:{get:function(){return this._labelingInfo},set:function(e){var t=this;this._labelingInfo=e,this._convertLabelInfoToLabelClass(),this._styleLayers.forEach(function(e){t._updateStyleLayerByLabelingInfo(e)}),this._fireLayerUpdateEvent()}}}),t.default=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMapboxExpression=t.convertColorToRgb=t.convertLineStyle=void 0;var n=r(8);t.convertLineStyle=function(e,t){switch(e){case"dash":case"esriSLSDash":return t?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return t?[4,3,1,3]:[3,4,0,4];case"dot":case"esriSLSDot":return t?[1,3]:[0,4];case"long-dash":case"esriSLSLongDash":return t?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return t?[8,3,1,3]:[7,4,0,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return t?[8,3,1,3,1,3]:[7,4,0,4,0,4];case"short-dash":case"esriSLSShortDash":return t?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return t?[4,1,1,1]:[3,2,0,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return t?[4,1,1,1,1,1]:[3,2,0,2,0,2];case"short-dot":case"esriSLSShortDot":return t?[1,1]:[0,2];case"solid":case"esriSLSSolid":case"none":default:return}},t.convertColorToRgb=function(e){return e instanceof n.Color?e.toCssRGBAString():e},t.isMapboxExpression=function(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&"== != > < >= <= array at boolean case coalesce collator format image in interpolate interpolate-hcl interpolate-lab\nlength let literal match number number-format object step string to-boolean to-color to-number to-string var within".indexOf(e[0])>-1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(7)),l=f(r(5)),u=r(1),c=r(22);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.value=e.value,r.symbol=c.Symbol.fromJSON(e.symbol),r.visible=(0,u.defaultValue)(e.visible,!0),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.value=this.value,e.symbol=this.symbol.toJSON(),e.visible=this.visible,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,u.defaultValue)(e,{}))}}]),t}(f(r(223)).default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.id=(0,o.defaultValue)(t.id,(0,o.getGUID)()),this.label=(0,o.defaultValue)(t.label,""),this.description=(0,o.defaultValue)(t.description,"")}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.id=this.id,e.label=this.label,e.description=this.description,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(7)),l=f(r(5)),u=r(1),c=r(22);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.minValue=e.minValue,r.maxValue=e.maxValue,r.symbol=c.Symbol.fromJSON(e.symbol),r.visible=(0,u.defaultValue)(e.visible,!0),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.minValue=this.minValue,e.maxValue=this.maxValue,e.symbol=this.symbol.toJSON(),e.visible=this.visible,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,u.defaultValue)(e,{}))}}]),t}(f(r(223)).default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=r(8);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.ratio=t.ratio,this.color=a.Color.fromColor((0,o.defaultValue)(t.color,{}))}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.ratio=this.ratio,e.color=this.color.toJSON(),e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(l(r(220)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(r(11)),i=m(r(14)),o=m(r(3)),a=m(r(0)),s=m(r(2)),l=m(r(4)),u=m(r(7)),c=m(r(5)),f=r(1),h=r(9),d=r(15),p=r(59),y=r(219),g=r(70),v=r(8);function m(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));if(r.url=(0,f.defaultValue)(e.url,""),r.name=(0,f.defaultValue)(e.name,""),r.type=(0,f.defaultValue)(e.type,""),r.fields=(0,f.defaultValue)(e.fields,[]),r.geomType=(0,f.defaultValue)(e.geomType||e.GeomType,""),r.maxScale=(0,f.defaultValue)(e.maxScale,0),r.minScale=(0,f.defaultValue)(e.minScale,0),e.range?r.extent=new h.Extent({xmin:e.range.xmin,ymin:e.range.ymin,xmax:e.range.xmax,ymax:e.range.ymax}):r.extent=new h.Extent({xmin:-180,ymin:-90,xmax:180,ymax:90}),r.spatialReference=e.spatialReference?new h.SpatialReference(e.spatialReference):new h.SpatialReference({wkid:4326}),r.supportedMethods=(0,f.defaultValue)(e.supportedMethods,[]),r.systemLibGuid=(0,f.defaultValue)(e.systemLibGuid,void 0),r.systemLibName=(0,f.defaultValue)(e.systemLibName,void 0),r.id=(0,f.defaultValue)(e.id,e.LayerIndex||e.index),void 0!==r.id&&null!==r.id&&""!==r.id||(r.id=(0,f.getGUID)()),r.index=(0,f.defaultValue)(e.index,void 0),r._renderer=e.renderer?g.BaseRenderer.fromJSON(e.renderer):void 0,r._definitionExpression=(0,f.defaultValue)(e.definitionExpression,void 0),r.geometryFilter=(0,f.defaultValue)(e.geometryFilter,void 0),e.sublayers&&Array.isArray(e.sublayers)){for(var n=new v.Collection,i=0;i<e.sublayers.length;i++){var s=e.sublayers[i];s.layer=r,n.add(new t(s))}r.sublayers=n}return r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.url=this.url,e.name=this.name,e.type=this.type,e.fields=this.fields,e.geomType=this.geomType,e.maxScale=this.maxScale,e.minScale=this.minScale,e.extent=this.extent.toJSON(),e.spatialReference=this.spatialReference.toJSON(),e.supportedMethods=this.supportedMethods,e.systemLibGuid=this.systemLibGuid,e.systemLibName=this.systemLibName,e.index=this.index,e.renderer=this._renderer?this._renderer.toJSON():void 0,e}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"load",value:function(){if(this.layer&&this.layer._mapServer){var e=this;return this.layer._mapServer.queryLayerInfo({layerId:this.id}).then(function(t){var r=t.data;return r&&(r.drawingInfo&&r.drawingInfo.renderer&&(e._renderer=(0,p.formatIGSRenderer)(r.drawingInfo.renderer)),e.fields=r.fields,e.geomType=r.geomType,e.index=r.index,e.id=r.index,e.maxScale=r.maxScale,e.minScale=r.minScale,e.name=r.name,e.extent=new h.Extent({xmin:r.range.xmin,ymin:r.range.ymin,xmax:r.range.xmax,ymax:r.range.ymax}),e.spatialReference=r.spatialReference?new h.SpatialReference(r.spatialReference):new h.SpatialReference({wkid:4326}),e.systemLibGuid=r.systemLibGuid,e.systemLibName=r.systemLibName,e.type=r.type,e.url=r.url),new i.default(function(t){t(e)})})}}},{key:"_getSourceLayer",value:function(){for(var e=this.layer;e&&!(e instanceof y.IGSMapImageLayer);)e=e.layer;return e instanceof y.IGSMapImageLayer?e:null}}]),t}(d.SubLayer);(0,n.default)(_.prototype,{renderer:{get:function(){return this._renderer},set:function(e){e instanceof g.BaseRenderer?this._renderer=e:this._renderer=g.BaseRenderer.fromJSON(e);var t=this._getSourceLayer();t&&t.refresh()}},definitionExpression:{get:function(){return this._definitionExpression},set:function(e){if(e){this._definitionExpression=e;var t=this._getSourceLayer();t&&t.refresh()}}},visible:{get:function(){return this._visible},set:function(e){this._visible=e;var t=this._getSourceLayer();t&&t.refresh()}}}),t.default=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(11)),i=p(r(3)),o=p(r(0)),a=p(r(2)),s=p(r(4)),l=p(r(5)),u=r(1),c=r(9),f=p(r(142)),h=r(8),d=r(6);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.sceneIndex=(0,u.defaultValue)(e.sceneIndex,0),r.sceneName=(0,u.defaultValue)(e.sceneName,void 0),r.sceneMode=(0,u.defaultValue)(e.sceneMode,void 0),r.sceneRange=(0,u.defaultValue)(new c.Extent({xmin:e.sceneRange.xMin,ymin:e.sceneRange.yMin,xmax:e.sceneRange.xMax,ymax:e.sceneRange.yMax,zmin:e.sceneRange.zMin,zmax:e.sceneRange.zMax}),void 0),r.sublayers=(0,u.defaultValue)(e.sublayers,new h.Collection),r.layer=(0,u.defaultValue)(e.layer,void 0),r.extendedProps=(0,u.defaultValue)(e.extendedProps,void 0),r._allSublayers=new h.Collection,r._initAllSubLayers(r.sublayers),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"findSublayerByGDBP",value:function(e){return this.allSublayers.find(function(t){return t.url===e})}},{key:"findSublayerById",value:function(e){return this.allSublayers.find(function(t){return String(t.id)===String(e)})}},{key:"toJSON",value:function(){for(var e=[],t=0;t<this.sublayers.length;t++)e.push((0,u.toJSON)(this.sublayers[t],f.default));return{sceneIndex:this.sceneIndex,sceneName:this.sceneName,sceneMode:this.sceneMode,sceneRange:(0,u.toJSON)(this.sceneRange,c.Extent),extendedProps:this.extendedProps,sublayers:e}}},{key:"_initAllSubLayers",value:function(e){var t=this;e.forEach(function(e){e.type!==d.SceneSubLayerType.groupLayer3D?t._allSublayers.add(e):e.sublayers.items.length>0&&t._initAllSubLayers(e.sublayers)})}}]),t}(p(r(143)).default);(0,n.default)(y.prototype,{allSublayers:{get:function(){return this._allSublayers}}}),t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(0)),i=u(r(2)),o=r(8),a=r(6),s=u(r(29)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,n.default)(this,e),t=(0,l.defaultValue)(t,{}),this.distance=(0,l.defaultValue)(t.distance,.1),this.units=(0,l.defaultValue)(t.units,a.LengthUnit.meter),this.geometry=t.geometry?s.default.fromJSON(t.geometry):null,this.objectIds=t.objectIds,this.spatialRelation=(0,l.defaultValue)(t.spatialRelation,o.SpatialRelation.Intersects),this.where=(0,l.defaultValue)(t.where,"")}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.distance=this.distance,e.units=this.units,e.geometry=this.geometry?this.geometry.toJSON():null,e.objectIds=this.objectIds?this.objectIds.map(function(e){return e}):null,e.spatialRelation=this.spatialRelation,e.where=this.where,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,l.defaultValue)(t,{}))}}]),e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(11)),i=p(r(3)),o=p(r(0)),a=p(r(2)),s=p(r(4)),l=p(r(5)),u=r(8),c=r(1),f=p(r(231)),h=p(r(143)),d=r(6);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));e=(0,c.defaultValue)(e,{}),r.sceneIndex=(0,c.defaultValue)(e.sceneIndex,0),r.sceneName=(0,c.defaultValue)(e.name,void 0),r.resourceConfigId=(0,c.defaultValue)(e.resourceConfigId,void 0),r.supportedMediaTypes=(0,c.defaultValue)(e.supportedMediaTypes,void 0),r.resourceType=(0,c.defaultValue)(e.resourceType,void 0),r.sublayers=new u.Collection;var n=e.sublayers;if(n instanceof Array)for(var a=0;a<n.length;a++)r.sublayers.add(new f.default(n[a]));else n instanceof u.Collection&&n.forEach(function(e){r.sublayers.add(new f.default(e))});return r.layer=(0,c.defaultValue)(e.layer,void 0),r.extendedProps=(0,c.defaultValue)(e.extendedProps,void 0),r._allSublayers=new u.Collection,r._initAllSubLayers(r.sublayers),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"findSublayerByGDBP",value:function(e){return this.allSublayers.find(function(t){return t.url===e})}},{key:"findSublayerById",value:function(e){return this.allSublayers.find(function(t){return String(t.id)===String(e)})}},{key:"toJSON",value:function(){for(var e=[],t=0;t<this.sublayers.length;t++)e.push((0,c.toJSON)(this.sublayers[t],IGSSceneSubLayer));return{sceneIndex:this.sceneIndex,sceneName:this.sceneName,sceneMode:this.sceneMode,sceneRange:(0,c.toJSON)(this.sceneRange,Extent),extendedProps:this.extendedProps,sublayers:e}}},{key:"_initAllSubLayers",value:function(e){var t=this;e.forEach(function(e){e.type!==d.SceneSubLayerType.groupLayer3D?t._allSublayers.add(e):e.sublayers.items.length>0&&t._initAllSubLayers(e.sublayers)})}}]),t}(h.default);(0,n.default)(y.prototype,{allSublayers:{get:function(){return this._allSublayers}}}),t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(11)),i=y(r(16)),o=y(r(3)),a=y(r(0)),s=y(r(2)),l=y(r(4)),u=y(r(7)),c=y(r(5)),f=r(8),h=r(15),d=r(1),p=r(9);function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));e=(0,d.defaultValue)(e,{}),r.id=(0,d.defaultValue)(e.id,(0,d.getGUID)()),r.layerIndex=(0,d.defaultValue)(e.layerIndex,0),r.layerRenderIndex=(0,d.defaultValue)(e.layerRenderIndex,0),r.type=(0,d.defaultValue)(e.layerType,void 0),r.renderType=(0,d.defaultValue)(e.layerRenderType,void 0),r._labelingInfo=(0,d.defaultValue)(e.labelingInfo,[]),r.beginLevel=(0,d.defaultValue)(e.beginLevel,-1),r.endLevel=(0,d.defaultValue)(e.endLevel,-1),r._renderer=(0,d.defaultValue)(e.renderer,void 0),e.originalPoints?r.originPoint=new p.Point({coordinates:[e.originalPoints.x,e.originalPoints.y]}):r.originPoint=void 0,e.frameSizes?r.maxFrameSize=e.frameSizes[0]:r.maxFrameSize=void 0,r.url=(0,d.defaultValue)(e.url||e.configUrl,void 0),e.range?r.range=new p.Extent({xmin:e.range.xMin,ymin:e.range.yMin,xmax:e.range.xMax,ymax:e.range.yMax}):r.range=void 0,e.range3D?r.range3D=new p.Extent({xmin:e.range3D.xMin,ymin:e.range3D.yMin,xmax:e.range3D.xMax,ymax:e.range3D.yMax,zmin:e.range3D.zMin,zmax:e.range3D.zMax}):r.range3D=void 0,r.layer=(0,d.defaultValue)(e.layer,void 0),r.spatialReference=(0,d.defaultValue)(e.spatialReference,void 0);var n=e.sublayers||e.subLayers&&e.subLayers.layers;if(r.sublayers=new f.Collection,n instanceof Array)for(var i=0;i<n.length;i++)r.sublayers.add(new t(n[i]));else n instanceof f.Collection&&n.forEach(function(e){r.sublayers.add(new t(e))});return r.elevationScale=(0,d.defaultValue)(e.elevationScale,void 0),r.requestVertexNormals=(0,d.defaultValue)(e.requestVertexNormals,!1),r.labelLayer=(0,d.defaultValue)(e.labelLayer,void 0),r.layerName=(0,d.defaultValue)(e.layerName,void 0),r._opacity=(0,d.defaultValue)(e.opacity,1),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"reset",value:function(){this.layer&&this.layer._fireUpdateEvent("重置视角",[{name:"reset",params:[this.id],dataChanged:!0,operationType:"method"}])}},{key:"toJSON",value:function(){for(var e=[],r=0;r<this.sublayers.length;r++)e.push((0,d.toJSON)(this.sublayers[r],t));var n=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return(0,i.default)(n,{sublayers:e,layerIndex:this.layerIndex,type:this.type,renderType:this.renderType,beginLevel:this.beginLevel,endLevel:this.endLevel,originPoint:this.originPoint,maxFrameSize:this.maxFrameSize})}}]),t}(h.SubLayer);(0,n.default)(g.prototype,{visible:{get:function(){return this._visible},set:function(e){this._visible=e,this.layer&&this.layer._fireUpdateEvent("设置子图层可见性",[{name:"sbuLayerVisible",params:[this._visible,this.id],dataChanged:!0,operationType:"property"}])}},opacity:{get:function(){return this._opacity},set:function(e){this._opacity=e,this.layer&&this.layer._fireUpdateEvent("设置子图层透明度",[{name:"subLayerOpacity",params:[this._opacity,this.id],dataChanged:!0,operationType:"property"}])}}}),t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(11)),i=f(r(3)),o=f(r(0)),a=f(r(2)),s=f(r(4)),l=f(r(5)),u=r(1),c=r(9);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r.url=(0,u.defaultValue)(e.url,""),r.name=(0,u.defaultValue)(e.name,""),r.type=(0,u.defaultValue)(e.type,""),r.fields=(0,u.defaultValue)(e.fields,[]),r.geomType=(0,u.defaultValue)(e.geomType||e.GeomType,""),r.maxScale=(0,u.defaultValue)(e.maxScale,0),r.minScale=(0,u.defaultValue)(e.minScale,0),e.range?r.extent=new c.Extent({xmin:e.range.xmin,ymin:e.range.ymin,xmax:e.range.xmax,ymax:e.range.ymax}):r.extent=new c.Extent({xmin:-180,ymin:-90,xmax:180,ymax:90}),r.spatialReference=(0,u.defaultValue)(e.spatialReference,void 0),r.supportedMethods=(0,u.defaultValue)(e.supportedMethods,[]),r.systemLibGuid=(0,u.defaultValue)(e.systemLibGuid,void 0),r.systemLibName=(0,u.defaultValue)(e.systemLibName,void 0),r.id=e.id,r.index=(0,u.defaultValue)(e.index,void 0),r.moveIndex=(0,u.defaultValue)(e.moveIndex,void 0),r._renderer=(0,u.defaultValue)(e.renderer,void 0),r.layer=(0,u.defaultValue)(e.layer,void 0),r}return(0,l.default)(t,e),(0,a.default)(t,null,[{key:"fromJSON",value:function(e){return new t(e=(0,u.defaultValue)(e,{}))}}]),t}(r(15).SubLayer);(0,n.default)(h.prototype,{renderer:{get:function(){return this._renderer},set:function(e){this._renderer=e,this.layer.setSubLayer(this)}}}),t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(3)),i=y(r(0)),o=y(r(2)),a=y(r(4)),s=y(r(7)),l=y(r(5)),u=r(15),c=r(8),f=r(1),h=r(9),d=y(r(58)),p=y(r(71));function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));if(e=(0,f.defaultValue)(e,{}),r.description="IGS WMTS子图层",r.imageFormat=(0,f.defaultValue)(e.imageFormat,"image/png"),r.identifier=(0,f.defaultValue)(e.identifier,""),r.title=(0,f.defaultValue)(e.title,""),r.imageFormats=(0,f.defaultValue)(e.imageFormats,void 0),r.styleId=(0,f.defaultValue)(e.styleId,void 0),r.styles=(0,f.defaultValue)(e.styles,void 0),r.tileMatrixSets=(0,f.defaultValue)(e.tileMatrixSets,void 0),r.tileMatrixSets&&r.tileMatrixSets instanceof Array)for(var o=0;o<r.tileMatrixSets.length;o++)r.tileMatrixSets[o]instanceof c.TileMatrixSet||(r.tileMatrixSets[o]=c.TileMatrixSet.fromJSON(r.tileMatrixSets[o]),!r.tileMatrixSets[o].tileInfo||r.tileMatrixSets[o].tileInfo instanceof p.default||(r.tileMatrixSets[o].tileInfo=p.default.fromJSON(r.tileMatrixSets[o].tileInfo)));r.tileMatrixSetId=(0,f.defaultValue)(e.tileMatrixSetId,void 0),r.tileMatrixSet=(0,f.defaultValue)(e.tileMatrixSet,void 0),r.extent=(0,f.defaultValue)(e.extent,void 0),r.resourceURLTemplates=(0,f.defaultValue)(e.resourceURLTemplates,void 0);for(var s=0;s<r.tileMatrixSets.length;s++)r.tileMatrixSets[s].id===r.tileMatrixSetId&&(r.spatialReference=h.SpatialReference.fromJSON(r.tileMatrixSets[s].tileInfo.spatialReference));return r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);e.description=this.description,e.imageFormat=this.imageFormat,e.identifier=this.identifier,e.title=this.title,e.imageFormats=this.imageFormats,e.styleId=this.styleId,e.tileMatrixSets=this.tileMatrixSets,e.tileMatrixSetId=this.tileMatrixSetId,e.tileMatrixSet=(0,f.toJSON)(this.tileMatrixSet,c.TileMatrixSet),e.extent=this.extent instanceof d.default?this.extent.toJSON():this.extent,e.resourceURLTemplates=this.resourceURLTemplates,e.spatialReference=this.spatialReference instanceof h.SpatialReference?this.spatialReference.toJSON():this.spatialReference;var r=[];if(this.styles)for(var i=0;i<this.styles.length;i++)r.push(this.styles[i]instanceof c.WMTSStyle?this.styles[i].toJSON():this.styles[i]);return e.styles=r,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.Layer);g.fromJSON=function(e){return e=(0,f.defaultValue)(e,{}),new g(e)},t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(7)),l=h(r(5)),u=r(1),c=h(r(69)),f=r(9);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.name=(0,u.defaultValue)(e.name,void 0),r.description=(0,u.defaultValue)(e.abstract,void 0),r.queryable=(0,u.defaultValue)(e.queryable,!0),r.spatialReferences=(0,u.defaultValue)(e.spatialReferences,[]),r.spatialReference=(0,u.defaultValue)(e.spatialReference,void 0),r.extent=(0,u.defaultValue)(e.extent,void 0),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);e.spatialReference=(0,u.toJSON)(this.spatialReference,f.SpatialReference),e.name=this.name,e.extent=(0,u.toJSON)(this.extent,f.Extent);for(var r=[],i=0;i<this.spatialReferences.length;i++)r.push((0,u.toJSON)(this.spatialReferences[i],f.SpatialReference));return e.spatialReferences=r,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(c.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.minValue=t.minValue,this.maxValue=t.maxValue}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.minValue=this.minValue,e.maxValue=this.maxValue,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(r(11)),i=m(r(3)),o=m(r(0)),a=m(r(2)),s=m(r(4)),l=m(r(5)),u=r(8),c=r(6),f=r(15),h=r(1),d=r(39),p=r(46),y=r(9),g=r(97),v=r(141);function m(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e){(0,o.default)(this,t),e=(0,h.defaultValue)(e,{});var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this));return r._id=(0,h.defaultValue)(e.id,(0,h.getGUID)()),r._basemap=(0,h.defaultValue)(e.basemap,void 0),r.groupLayer=new d.GroupLayer({layers:e.layers,copyright:""}),r.groupLayer.setMap(r),r.layers=r.groupLayer.layers,r.allLayers=new u.CollectionFlattener({getCollections:function(){return r._basemap&&r._basemap.baseLayers?[r._basemap.baseLayers,r.groupLayer.layers]:[r.groupLayer.layers]},getChildrenFunction:function(e){return e.layers}}),r._spatialReference=null,r._fullExtent=null,r._waitLoadStorage=[],r._isInitLayersLoaded=!1,r._initHandlers(),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){for(var e={layers:[]},t=0;t<this.layers.items.length;t++)e.layers.push((0,h.toJSON)(this.layers.items[t],f.Layer));return e.exportTime=(new Date).toISOString(),e}},{key:"clone",value:function(){return(0,h.cloneObject)(this)}},{key:"add",value:function(e,t){if(e){var r=e instanceof f.Layer?e:f.Layer.fromJSON(e);this._isValidateLayers([r]),this.groupLayer.add(e,t)}}},{key:"addMany",value:function(e,t){if(e&&Array.isArray(e)){var r=e.map(function(e){return e instanceof f.Layer?e:f.Layer.fromJSON(e)});this._isValidateLayers(r),this.groupLayer.addMany(e,t)}}},{key:"remove",value:function(e){e&&this.groupLayer.remove(e)}},{key:"removeMany",value:function(e){e&&Array.isArray(e)&&this.groupLayer.removeMany(e)}},{key:"removeAll",value:function(){this.groupLayer.removeAll()}},{key:"destroy",value:function(){this.removeAll(),this._removeHandlers()}},{key:"reorder",value:function(e,t){this.groupLayer.reorder(e,t)}},{key:"findLayerById",value:function(e){return this.groupLayer.findLayerById(e)}},{key:"dispatchEvent",value:function(e,t,r){return this.fire(e,t,r),this}},{key:"getFullExtent",value:function(){return this._getLayersExtent(this.allLayers)}},{key:"_isValidateLayers",value:function(e){this.groupLayer._isValidateLayers(e)}},{key:"_initHandlers",value:function(){this._initBasemapHandlers(),this.groupLayer.on(c.MapEventType.layerChange,this._processGroupLayerChange,this)}},{key:"_removeHandlers",value:function(){this.groupLayer.off(c.MapEventType.layerChange,this._processGroupLayerChange,this),this._basemap&&this._basemap._baseGroupLayer.off(c.MapEventType.layerChange,this._processGroupLayerChange,this)}},{key:"_initBasemap",value:function(){this._basemap&&(this._basemap.baseLayers&&this.allLayers._addCollection(this._basemap.baseLayers,0),this._initBasemapHandlers(),this.basemap._baseGroupLayer.fire(c.MapEventType.layerChange,new p.LayerChangeEvent({added:this._basemap._baseGroupLayer.layers.items.map(function(e){return e}),path:[this._basemap._baseGroupLayer]})),this.fire(c.MapEventType.basemapChange,new p.BasemapChangeEvent({basemap:this._basemap,detail:[{action:"basemap-create"}]})))}},{key:"_initBasemapHandlers",value:function(){this._basemap&&this._basemap._baseGroupLayer.on(c.MapEventType.layerChange,this._processGroupLayerChange,this)}},{key:"_processGroupLayerChange",value:function(e){var t=e.added,r=e.moved,n=e.removed,i=e.sourceTarget,o=e.path;this._dispatchOldMapEvent(e),this.fire(c.MapEventType.layerChange,new p.LayerChangeEvent({type:c.MapEventType.layerChange,sourceTarget:i,removed:n,path:o,moved:r,added:t})),t.length>0&&(this._waitLoadStorage.push(e),this._triggerLayersAddToView()),0===n.length&&0===t.length&&0===r.length?this._waitLoadStorage=this._waitLoadStorage.filter(function(e){return e.sourceTarget!==i}):n.length>0&&(this._waitLoadStorage.forEach(function(e){e&&e.sourceTarget===i&&(e.added=e.added.filter(function(e){return!n.some(function(t){return t&&e&&t.id===e.id})}))}),this._waitLoadStorage=this._waitLoadStorage.filter(function(e){return e&&e.added&&e.added.length>0}))}},{key:"_triggerLayersAddToView",value:function(){this._isInitLayersLoaded?this._processLoadStorage():(this._cacheProcessLoadStorage||(this._cacheProcessLoadStorage=(0,g.debouncePromise)(this._processLoadStorage,10).bind(this)),this._cacheProcessLoadStorage())}},{key:"_processLoadStorage",value:function(){var e=this;if(0!==this._waitLoadStorage.length){var t=this._waitLoadStorage.map(function(e){var t=e.sourceTarget,r=e.added.filter(function(e){return e});return t.load().then(function(){return{added:r,sourceTarget:t}})});(0,g.allSettled)(t).then(function(t){if(t&&Array.isArray(t)){var r=[];t.forEach(function(e){var t=e.value,n=t.added.filter(function(e){return e&&e.type!==c.LayerType.unknown});n.length>0&&r.push({added:n,sourceTarget:t.sourceTarget})}),r.length>0&&(e._isInitLayersLoaded=!0,e.fire(c.MapEventType.layerLoaded,new p.LayerLoadedEvent({addDetail:r})))}}),this._waitLoadStorage=[]}}},{key:"_dispatchOldMapEvent",value:function(e){var t=e.added,r=e.removed,n=e.sourceTarget;if(n===this.groupLayer&&(t&&Array.isArray(t)&&t.length>0&&(1===t.length?this.dispatchEvent(c.MapEventType.layerAdd,{type:c.MapEventType.layerAdd,layer:t[0]}):this.dispatchEvent(c.MapEventType.layerAddMany,{type:c.MapEventType.layerAddMany,layers:t})),Array.isArray(r))){var i=n.layers;i&&i.items&&0===i.items.length&&0===r.length?this.dispatchEvent(c.MapEventType.layerRemoveAll,{type:c.MapEventType.layerRemoveAll,layers:r}):1===r.length?this.dispatchEvent(c.MapEventType.layerRemove,{type:c.MapEventType.layerRemove,layer:r[0]}):r.length>1&&this.dispatchEvent(c.MapEventType.layerRemoveMany,{type:c.MapEventType.layerRemoveMany,layers:r})}}},{key:"_loadLayers",value:function(){return this._basemap&&this._basemap._baseGroupLayer.fire(c.MapEventType.layerChange,new p.LayerChangeEvent({added:this._basemap._baseGroupLayer.layers.items.map(function(e){return e}),path:[this._basemap._baseGroupLayer]})),this.groupLayer&&this.groupLayer.fire(c.MapEventType.layerChange,new p.LayerChangeEvent({added:this.groupLayer.layers.items.map(function(e){return e}),path:[this.groupLayer]})),this}},{key:"_setSpatialReference",value:function(e){this._spatialReference=e}},{key:"_getLayersExtent",value:function(e){var t=(0,v.getLayersExtent)(e,this._spatialReference);return t&&!t.spatialReference.isGeographic&&(t=u.Projection.project(t,new y.SpatialReference("EPSG:4326"))),this._fullExtent=t,t}}],[{key:"fromJSON",value:function(e){e=(0,h.defaultValue)(e,{});for(var r=(0,h.defaultValue)(e.layers,[]),n=new t,i=0;i<r.length;i++)n.add(f.Layer.fromJSON(r[i]));return n}}]),t}(u.Evented);(0,n.default)(_.prototype,{basemap:{get:function(){return this._basemap},set:function(e){this._basemap?e?this._basemap._setBasemap(e,this):(this._basemap._setBasemap(e),this._basemap=null):e?(this._basemap=e,this._basemap._map=this,this._initBasemap()):this._basemap=null}},spatialReference:{get:function(){return this._spatialReference},set:function(){}},fullExtent:{get:function(){return u.Projection.project(this._fullExtent,this._spatialReference)},set:function(){}}}),t.default=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(2)),a=u(r(4)),s=u(r(7)),l=u(r(5));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r._initInstance(e),r._initHandlers(),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"_initInstance",value:function(e){}},{key:"_initHandlers",value:function(){this._layerChangeAction=this._layerChangeAction.bind(this),this.layer.on("set",this._layerChangeAction)}},{key:"_removeHandlers",value:function(){this.layer.off("set",this._layerChangeAction)}},{key:"_layerChangeAction",value:function(e){"renderer"===e.eventData.key&&this._rendererChangeAction(e)}},{key:"_rendererChangeAction",value:function(e){}},{key:"onRemove",value:function(e){(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"onRemove",this).call(this,e),this._removeHandlers()}}]),t}(u(r(87)).default);t.default=c},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _stringify=__webpack_require__(10),_stringify2=_interopRequireDefault(_stringify),_isNan=__webpack_require__(558),_isNan2=_interopRequireDefault(_isNan),_log=__webpack_require__(561),_log2=_interopRequireDefault(_log),_index=__webpack_require__(105),_util=__webpack_require__(1),_symbol=__webpack_require__(22),_VisualVariableType=__webpack_require__(55),_VisualVariableType2=_interopRequireDefault(_VisualVariableType),_NormalizationType=__webpack_require__(172),_NormalizationType2=_interopRequireDefault(_NormalizationType);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function parseExpression(feature,expression){if(!expression)return"";var excuteStr=expression.replace(/\$feature/g,"feature.attributes");try{var v=eval(excuteStr);return v}catch(e){_index.Log.info("字段表达式输入值非法")}return""}function parseFieldAndExpression(e,t,r){var n=(e.attributes||{})[t];return(0,_util.defined)(n)?n:parseExpression(e,r)}function parseClassBreakNormalizationType(e,t,r){var n=t,i=r=r||{},o=i.normalizationField,a=i.normalizationTotal;switch(i.normalizationType){case _NormalizationType2.default.field:n/=e.attributes[o];break;case _NormalizationType2.default.log:n=(0,_log2.default)(n);break;case _NormalizationType2.default.percentOfTotal:n=n/a*100}return n}function randomColor(){return"rgba("+Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random())+",1)"}function calcSpaceRatio(e,t,r){var n=r-t;return((0,_isNan2.default)(n)||n<=0)&&_index.Log.error("传入的视觉变量不合法"),e<=t?0:e>r?1:(e-t)/n}function calcGradientInStops(e,t,r){if(Array.isArray(t)&&!(t.length<=0)){var n=t.sort(function(e,t){return e.value-t.value});if(1===n.length)return r(t[0],t[0],1);var i=n[0],o=n[n.length-1];if(e<i.value)return r(i,i,1);if(e>=o.value)return r(o,o,1);for(var a=1;a<n.length;a++){var s=n[a-1],l=n[a];if(e>=s.value&&e<=l.value)return r(s,l,calcSpaceRatio(e,s.value,l.value))}}}function updateFeatureSymbol(e,t,r,n){if(e&&e.symbol&&t){var i=!(0,_util.defined)(r)||r;e.visible!==i&&(e.visible=i);var o=e.symbol.toJSON(),a=t.toJSON();if(o!==a&&(e.symbol=a),n&&Array.isArray(n)&&!(n.length<=0))for(var s=e.symbol instanceof _symbol.Symbol?e.symbol.toJSON():(0,_stringify2.default)(e.symbol),l=0;l<n.length;l++){var u=n[l],c=u.field,f=u.type,h=parseFieldAndExpression(e,c,u.valueExpression);if(h=parseFloat(h),!(0,_isNan2.default)(h)){switch(f){case _VisualVariableType2.default.color:var d=calcGradientInStops(h,u.stops,function(e,t,r){var n=_index.Color.fromColor(e.color),i=_index.Color.fromColor(t.color),o=parseInt(n.red+(i.red-n.red)*r),a=parseInt(n.green+(i.green-n.green)*r),s=parseInt(n.blue+(i.blue-n.blue)*r),l=parseFloat(n.alpha+(i.alpha-n.alpha)*r);return new _index.Color(o,a,s,l)});(0,_util.defined)(d)&&(s.color=d);break;case _VisualVariableType2.default.size:var p=u.stops,y=u.maxDataValue,g=u.minDataValue,v=u.maxSize,m=u.minSize,_=p;(0,_util.isNumber)(y)&&(0,_util.isNumber)(g)&&(0,_util.isNumber)(v)&&(0,_util.isNumber)(m)&&(_=[{size:m,value:g},{size:v,value:y}]);var S=calcGradientInStops(h,_,function(e,t,r){var n=e.size,i=t.size;return parseInt(n+(i-n)*r)});if((0,_util.defined)(S))if(s.symbolLayers)for(var x=0;x<s.symbolLayers.length;x++){var b=s.symbolLayers[x];b.type!==_index.Symbol3DLayerType.extrude&&b.type!==_index.Symbol3DLayerType.icon&&b.type!==_index.Symbol3DLayerType.line&&b.type!==_index.Symbol3DLayerType.text||(b.size=S)}else s.size=S;break;case _VisualVariableType2.default.opacity:var w=calcGradientInStops(h,u.stops,function(e,t,r){var n=e.opacity,i=t.opacity;return parseInt(100*(n+(i-n)*r))/100});if((0,_util.defined)(w)&&s.color){var k=_index.Color.fromColor(s.color);k.alpha=w,s.color=k}}e.symbol=s}}}}function updateRandomFeatureSymbol(e){if(e&&e.geometry)switch(e.geometry.type){case _index.GeometryType.multiPoint:case _index.GeometryType.point:e.symbol=new _symbol.SimpleMarkerSymbol({color:randomColor(),outline:new _symbol.SimpleLineSymbol({color:randomColor()})});break;case _index.GeometryType.multiLineString:case _index.GeometryType.lineString:e.symbol=new _symbol.SimpleLineSymbol({color:randomColor()});break;case _index.GeometryType.polygon:case _index.GeometryType.extent:case _index.GeometryType.circle:case _index.GeometryType.multiPolygon:e.symbol=new _symbol.SimpleFillSymbol({color:randomColor(),outline:new _symbol.SimpleLineSymbol({color:randomColor()})})}}function updateRenderer(e,t){e instanceof _index.FeatureSet&&(e=e.features);var r=(t=t||{}).visualVariables||[];switch(t.type){case _index.RendererType.simple:var n=t.symbol;e.forEach(function(e){updateFeatureSymbol(e,n,!0,r)});break;case _index.RendererType.uniqueValue:for(var i=t.defaultSymbol||{},o=t.defaultVisible,a=t.uniqueValueInfos||[],s=t.valueExpression||"",l=0;l<e.length;l++){var u=e[l],c=parseFieldAndExpression(u,t.field||"",s);if((0,_util.defined)(c)){for(var f=null,h=null,d=0;d<a.length;d++){var p=a[d];if(p.value===c){f=p.symbol,h=p;break}}if(f){updateFeatureSymbol(u,f,h.visible,r);continue}}updateFeatureSymbol(u,i,o,r)}break;case _index.RendererType.classBreak:for(var y=t.defaultSymbol||{},g=t.classBreakInfos||[],v=t.valueExpression||"",m=t.defaultVisible,_=0;_<e.length;_++){var S=e[_],x=t.field||"",b=parseFloat(parseFieldAndExpression(S,x,v));if(b=parseClassBreakNormalizationType(S,b,{normalizationField:t.normalizationField,normalizationTotal:t.normalizationTotal,normalizationType:t.normalizationType}),(0,_util.defined)(b)){for(var w=null,k=null,M=0;M<g.length;M++){var E=g[M],I=E.maxValue;if(b>=E.minValue&&b<I){w=E.symbol,k=E;break}}if(w){updateFeatureSymbol(S,w,k.visible,r);continue}}updateFeatureSymbol(S,y,m,r)}break;case _index.RendererType.random:e.forEach(function(e){updateRandomFeatureSymbol(e)});break;case _index.RendererType.rank:var T=t.symbol,L=t,P=L.minSize,C=L.maxSize,N=L.maxDataValue,O=L.minDataValue,R=L.field,V=L.valueExpression;(!T||P>C||!R&&!V)&&_index.Log.error("等级符号专题图参数异常！");var G=void 0,A=void 0;e.forEach(function(e){var t=parseFieldAndExpression(e,R,V);t=parseFloat(t),(0,_util.defined)(G)||(G=t),(0,_util.defined)(A)||(A=t),G=Math.max(G,t),A=Math.min(A,t)}),(0,_util.defined)(O)&&(0,_util.defined)(N)&&N>O&&(G=N,A=O),G-A==0&&(G+=1e-4),e.forEach(function(e){var t,n=T.clone(),i=parseFieldAndExpression(e,R,V);t=(i=parseFloat(i))<A?0:i>G?1:(i-A)/(G-A);var o=parseInt(t*(C-P)+P);if((0,_util.isNumber)(o))switch(n.type){case _index.SymbolType.simpleMarker:n.size=o;break;case _index.SymbolType.pictureMarker:n.width=o,n.height=o;break;case _index.SymbolType.text:var a=n.font||{};a.size=o,n.font=a}updateFeatureSymbol(e,n,!0,r)});break;default:var F=t.symbol;e.forEach(function(e){updateFeatureSymbol(e,F,!0,r)})}}var RendererUtil={updateRenderer:updateRenderer,parseExpression:parseExpression};exports.default=RendererUtil},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=I(r(11)),i=I(r(16)),o=I(r(3)),a=I(r(0)),s=I(r(2)),l=I(r(4)),u=I(r(5)),c=r(8),f=r(1),h=r(9),d=I(r(41)),p=I(r(42)),y=I(r(60)),g=I(r(566)),v=I(r(240)),m=I(r(241)),_=I(r(242)),S=I(r(568)),x=I(r(569)),b=I(r(570)),w=I(r(243)),k=I(r(244)),M=r(148),E=r(68);function I(e){return e&&e.__esModule?e:{default:e}}var T=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this));if((e=(0,f.defaultValue)(e,{})).view||f.Log.error("options.view is null!",e),r.view=e.view,r._spatialReference=r.view&&r.view._spatialReference?r.view._spatialReference:new h.SpatialReference("EPSG:4326"),r._sketchInnerLayer=new E.GraphicsLayer,r.layer=(0,f.defaultValue)(e.layer,void 0),r._layer=r.layer||r._sketchInnerLayer,r.sketchStyle=(0,f.defaultValue)(e.sketchStyle,new d.default),r._editable=(0,f.defaultValue)(e.editable,!0),r.isSimple=(0,f.defaultValue)(e.isSimple,!1),r.snapOption=(0,f.defaultValue)(e.snapOption,{}),r.snapAndReferGeometries=(0,f.defaultValue)(e.snapAndReferGeometries,[]),r.measureOption=(0,f.defaultValue)(e.measureOption,void 0),r._drawTool=null,r._sketchDataType=null,r._sketchSnappingTool={},r._sketchTopologyTool={},r._undoRedoManager=new x.default,r._editorState={editMode:0,undoRedoManager:r.undoRedoManager,_hitTestEvent:r._hitTestEvent},r._layer){var n=r.view._map.findLayerById(r._layer.id),s=r.view.getInnerLayer(r._layer);n&&s?r._hitTestSketchEvent(r._layer):r._layer.on("layerview-created",function(e){r._layerView=e.layerView,r.view._id===e.view._id&&r._hitTestSketchEvent(r._layer)})}return r._sketchInnerLayer?(r._sketchInnerLayer.on("layerview-created",function(e){r._layerView=e.layerView,r.view._id===e.view._id&&r._hitTestSketchEvent()}),r.view._graphicsLayers.add(r._sketchInnerLayer),r._sketchSnappingTool=new g.default((0,i.default)(r.snapOption,{view:r.view})),r._sketchTopologyTool=new S.default):r._hitTestSketchEvent(),r}return(0,u.default)(t,e),(0,s.default)(t,[{key:"start",value:function(e,t){var r=this._getDrawTool(e,t),n=r.drawTool,i=r.sketchType;r.isGeometry?this._startDrawTool(n,i,e):this._startDrawTool(n,i)}},{key:"startCustomDrawTool",value:function(e,t){var r=new e({view:this.view,sketchStyle:this.sketchStyle,layer:this._layer,sketchInnerLayer:this._sketchInnerLayer,undoRedoManager:this._undoRedoManager,elevationInfo:this.elevationInfo,_sketchEditor:this});this._startDrawTool(r,t)}},{key:"_getDrawTool",value:function(e,t){var r=void 0,n=void 0,i=!1;"number"==typeof e?r=e:e instanceof h.Point?(r=c.SketchDataType.POINT,i=!0):e instanceof h.LineString?(r=c.SketchDataType.POLYLINE,i=!0):e instanceof h.Polygon?(r=c.SketchDataType.POLYGON,i=!0):e instanceof h.Circle?(r=c.SketchDataType.CIRCLE,i=!0):e instanceof h.Extent&&(r=c.SketchDataType.RECTANGLE,i=!0);var o={view:this.view,sketchStyle:this.sketchStyle,sketchDataType:r,layer:this._layer,sketchInnerLayer:this._sketchInnerLayer,undoRedoManager:this._undoRedoManager,elevationInfo:this.elevationInfo,_sketchEditor:this,arcType:this.arcType,_getCenterCoordinate:this._getCenterCoordinate};switch(r){case c.SketchDataType.POINT:n=new p.default(o);break;case c.SketchDataType.POLYLINE:n=new v.default(o);break;case c.SketchDataType.POLYGON:n=new y.default(o);break;case c.SketchDataType.CIRCLE:n=new m.default(o);break;case c.SketchDataType.RECTANGLE:n=new _.default(o);break;case c.SketchDataType.FREEHANDPOLYLINE:n=new w.default(o);break;case c.SketchDataType.FREEHANDPOLYGON:n=new k.default(o)}return{drawTool:n,sketchType:r,isGeometry:i}}},{key:"_startDrawTool",value:function(e,t,r){if(this._drawTool&&(this._drawTool._removeEditGraphics(),this._drawTool._stopAll(),this._drawTools=[],this._undoRedoManager.reset()),this._drawTool=e,this._drawTool){if(this._drawTool._sketchDataType=t,this._sketchEvent(),r){var n=r.clone();if(this.arcType&&(n.extensionOptions?n.extensionOptions.arcType=this.arcType:n.extensionOptions={extensionOptions:{arcType:this.arcType}}),this.isSimple&&!h.GeometryEngine.isSimple(n)){var i=new M.SketchEditorEvent({type:c.SketchEditorEventType.create,toolEventInfo:{type:c.SketchEditorToolEventType.geometryUnsimple},state:c.SketchEditorState.complete});return this._drawTool.fire(c.SketchEditorEventType.create,i,self),f.Log.info("该坐标构成的几何不符合拓扑规范！")}this._addGeometry(n,this._layer),this._bindHit&&this._bindHit(this._drawTool,void 0,this._layer),this._drawTool.state="drawn"}else this._drawTool.start(this._sketchDataType);this._selectEvent(),this._drawEvent()}}},{key:"_addFeatureToSketchEditor",value:function(e,t){var r=e.geometry,n=this._getDrawTool(r),i=n.drawTool,o=n.sketchType;this._drawTool=i,this._drawTool&&(this._drawTool.sketchStage.entityGraphic=e,this._drawTool.state="drawn",this._drawTool._sketchDataType=o,this._selectEvent(),this._drawEvent(),this._sketchEvent(),t&&this._drawTool._addFeatureToLayer(e,this._layer))}},{key:"stop",value:function(){this._drawTool&&(this.view.cursor=this._drawTool.cursorStyle,this._drawTool.cursorStyle=null,this.view._mapActionControl("drag-pan",!0),this._drawTool.stop(),this._drawTool._editMode===c.SketchEditMode.DRAWING&&this._remove(),this._fireCancelDrawEvent())}},{key:"remove",value:function(){this._drawTool&&this._fireRemoveEvent(this._drawTool.sketchStage.entityGraphic),this._remove()}},{key:"_remove",value:function(){this._drawTool&&(this._drawTool.removeDrawTool(),this._drawTool=null)}},{key:"update",value:function(e,t){this._drawTool.updateFeature(e,t)}},{key:"_addGeometry",value:function(e,t){this._drawTool.addFeatureByGeometry(e,void 0,void 0,t)}},{key:"addVertex",value:function(e,t){return this._drawTool.addVertex(e,t)}},{key:"updateVertex",value:function(e,t){return this._drawTool.updateVertex(e,t)}},{key:"removeVertex",value:function(e){return this._drawTool.removeVertex(e)}},{key:"getSketchDataType",value:function(){return this._sketchDataType}},{key:"setSketchStyle",value:function(e){var t=this;if(this.sketchStyle=e.clone(),this._drawTool&&this._drawTool.sketchStage){this._drawTool.sketchStyle=e;var r=this._drawTool.sketchStage;(0,f.isNull)(r.entityGraphic)||("Point"===r.entityGraphic.geometry.type?this._drawTool._sketchDataType===c.SketchDataType.TEXT?r.entityGraphic.symbol=e._textStyle:r.entityGraphic.symbol=e._vertexStyle:"Polyline"===r.entityGraphic.geometry.type?r.entityGraphic.symbol=e._lineStyle:"Polygon"===r.entityGraphic.geometry.type&&(r.entityGraphic.symbol=e._fillStyle)),(0,f.isNull)(r.vertexGraphics)||r.vertexGraphics.forEach(function(t){t.symbol=e._vertexStyle}),(0,f.isNull)(r.midVertexGraphics)||r.midVertexGraphics.forEach(function(t){t.symbol=e._selectVertexStyle}),(0,f.isNull)(r.selectBoxGraphics)||r.selectBoxGraphics.forEach(function(r){t._drawTool._sketchDataType===c.SketchDataType.TEXT?r.symbol=e._selectTextStyle:r.symbol=e._selectBoxStyle}),(0,f.isNull)(r.selectBoxVertexGraphics)||r.selectBoxVertexGraphics.forEach(function(t){t.symbol=e._selectBoxVertexStyle})}}},{key:"getSketchStyle",value:function(){return this.sketchStyle}},{key:"union",value:function(e){for(var t=this,r=this,n=0;n<e.length;n++)if(!h.GeometryEngine.isSimple(e[n]))return f.Log.error("输入的几何不符合拓扑规范！");var i=c.Projection.project(this._sketchTopologyTool.unionPolygons(e),this._spatialReference);if("Polygon"===i.type){var o=r.view.allLayerViews.items.filter(function(e){return e.id===r._layer.id});return this.start(i),o.length>0?(this._selectEvent(),this._drawEvent(),this._sketchEvent()):r._layer.once("layerview-created",function(){r._selectEvent(),r._drawEvent(),t._sketchEvent()}),i}f.Log.error("合并结果不符合规范，请检查输入的几何！")}},{key:"split",value:function(e,r){var n=null,i=this;if(e instanceof h.Polygon)n=e;else{if(!(e instanceof t&&e.drawTool._sketchDataType===c.SketchDataType.POLYGON))return void f.Log.error("传入对象不符合要求，请检查");n=e.sketchStage.entityGraphic}return function(e,t){for(var r=1;r<e.coordinates[0].length;r++)e.coordinates[0][r][0]===e.coordinates[0][r-1][0]&&e.coordinates[0][r][1]===e.coordinates[0][r-1][1]&&(e.coordinates[0].splice(r,1),r--);var n=i._sketchTopologyTool.splitPolygonByPolyline(e,t);return n.length>0&&(i.view.allLayerViews.items.filter(function(e){return e.id===i._layer.id}).length>0?n.forEach(function(e){e=c.Projection.project(e,i._spatialReference),i.start(e)}):i._layer.once("layerview-created",function(){n.forEach(function(e){e=c.Projection.project(e,i._spatialReference),i.start(e)})})),n}(n,r)}},{key:"drawPolylineToPolygon",value:function(e){var t=this,r=this;this._drawTool&&(this._drawTool._removeEditGraphics(),this._drawTool._stopAll(),this._drawTools=[],this._undoRedoManager.reset()),this._drawTool=new b.default({view:this.view,sketchStyle:this.sketchStyle,layer:this._sketchInnerLayer,undoRedoManager:this._undoRedoManager,elevationInfo:this.elevationInfo,_sketchEditor:this,snapAndReferGeometries:e,arcType:this.arcType,_getCenterCoordinate:this._getCenterCoordinate}),this._drawTool.start(),this._drawTool.on("drawn",function(e){e.geometry&&(e.geometry instanceof h.Polygon?r.start(e.geometry):e.geometry.coordinates.forEach(function(e){var n=new h.Polygon({coordinates:e,spatialReference:t._spatialReference});r.start(n)}))})}},{key:"undo",value:function(){if(this._editable){var e=this._undoRedoManager.undo();return e?(this._updateByStage(e,"undo"),this._fireUndoEvent(e.entityGraphic),e.entityGraphic.geometry):null}}},{key:"redo",value:function(){if(this._editable){var e=this._undoRedoManager.redo();return e?(this._updateByStage(e,"redo"),this._fireRedoEvent(e.entityGraphic),e.entityGraphic.geometry):null}}},{key:"canUndo",value:function(){return this._undoRedoManager.canUndo()}},{key:"canRedo",value:function(){return this._undoRedoManager.canRedo()}},{key:"destroy",value:function(){this._removeSketchEvent(),this.stop(),this._remove(),this.view=null,this._spatialReference=null,this._sketchInnerLayer=null,this._layer=null,this.sketchStyle=new d.default,this._editable=!0,this.isSimple=!1,this.snapOption={},this.snapAndReferGeometries=[],this.measureOption=null,this._drawTool=null,this._drawTools=[],this._sketchDataType=null,this._sketchSnappingTool={},this._sketchTopologyTool={},this._undoRedoManager=new x.default,this._editorState=null,this._sketchSnappingTool=null}},{key:"_updateByStage",value:function(e,t){var r=this;this._drawTool.sketchStage.getAllFeatures().forEach(function(e){r._drawTool._removeFeatureFromLayer(e,r._sketchInnerLayer)}),this._drawTool._removeFeatureFromLayer(this._drawTool.sketchStage.entityGraphic,this._layer),this._drawTool._setSketchStage(e),e.getAllFeatures().forEach(function(n){var i=r._updateDrawToolByFeature(n);if(i)if(i._editMode===c.SketchEditMode.DRAWING)if(n.id===e.entityGraphic.id){var o=n.clone(),a=[],s=i._currentMovePoint;if(s){if(i.vertexNum&&("undo"===t?i.vertexNum--:"redo"===t&&i.vertexNum++),"Polygon"===o.geometry.type){a=o.geometry.coordinates[0];var l=i.vertexNum||0;1===l?(a[1]=s.coordinates,a[2]=s.coordinates):2===l||1===l?a[2]=s.coordinates:a.splice(a.length-1,0,s.coordinates)}else"LineString"===o.geometry.type&&(a=o.geometry.coordinates,1===i.vertexNum?a[1]=s.coordinates:a[a.length]=s.coordinates);i.sketchStage.entityGraphic=o,i._addFeatureToLayer(o,r._layer)}}else i._addFeatureToLayer(n,r._sketchInnerLayer);else n.id===e.entityGraphic.id?i._addFeatureToLayer(n,r._layer):i._addFeatureToLayer(n,r._sketchInnerLayer)})}},{key:"_updateDrawToolByFeature",value:function(e){for(var t=null,r=this._drawTool._drawTools,n=0;n<r.length;n++)if(r[n].sketchStage.entityGraphic.id===e.id){r[n].sketchStage.entityGraphic=e,t=r[n];break}return t}},{key:"_selectEvent",value:function(){var e=this;this._drawTool.on("selected",function(t){var r=t.isSelected?e:null;e.fire("selected",{selectedSketch:r,isSelected:t.isSelected},e)})}},{key:"_drawEvent",value:function(){var e=this;this._drawTool.on("drawn",function(t){e.fire("drawn",{geometry:t.geometry,feature:t.feature},e)}),this._drawTool.on("drawn-vertex",function(t){e.fire("drawn-vertex",{geometry:t.geometry,feature:t.feature},e)})}},{key:"_sketchEvent",value:function(){var e=this;this._drawTool&&(this._drawTool.on(c.SketchEditorEventType.create,function(t){e.fire(c.SketchEditorEventType.create,t,e),t.state===c.SketchEditorState.complete&&(e._drawTool&&(e._drawTool.state="drawn",e._bindHit(e._drawTool,void 0,e._layer),e._drawTool._stopAll(),e._drawTool=null),e._undoRedoManager.reset())}),this._drawTool.on(c.SketchEditorEventType.update,function(t){e.fire(c.SketchEditorEventType.update,t,e),t.state===c.SketchEditorState.complete&&e._undoRedoManager.reset()}))}},{key:"_addFeatureToCustomGraphicLayer",value:function(e){this._layer&&(this.view._map.findLayerById(this._layer.id)&&this._sketchInnerLayer.remove(e),this._layer.graphics.find(function(t){return e.id===t.id})?(this._layer.remove(e),this._layer.add(e)):this._layer.add(e))}},{key:"_removeFeatureToCustomGraphicLayer",value:function(e){this._layer&&this.view._map.findLayerById(this._layer.id)&&this._layer.graphics.find(function(t){return e.id===t.id})&&(this._layer.remove(e),this._sketchInnerLayer.add(e))}},{key:"_removeSketchEvent",value:function(){this.off(c.SketchEditorEventType.create),this.off(c.SketchEditorEventType.update),this.off(c.SketchEditorEventType.undo),this.off(c.SketchEditorEventType.redo),this.off(c.SketchEditorEventType.remove),this.off("drawn"),this.off("selected")}},{key:"_fireUndoEvent",value:function(e){var t=new M.SketchEditorEvent({type:c.SketchEditorEventType.undo,feature:e,geometry:e.geometry});this.fire(c.SketchEditorEventType.undo,t,this)}},{key:"_fireRedoEvent",value:function(e){var t=new M.SketchEditorEvent({type:c.SketchEditorEventType.redo,feature:e,geometry:e.geometry});this.fire(c.SketchEditorEventType.redo,t,this)}},{key:"_fireRemoveEvent",value:function(e){var t=new M.SketchEditorEvent({type:c.SketchEditorEventType.remove,feature:e,geometry:e.geometry});this.fire(c.SketchEditorEventType.remove,t,this)}},{key:"_fireCancelDrawEvent",value:function(){var e=new M.SketchEditorEvent({type:c.SketchEditorEventType.create,eventInfo:null,state:c.SketchEditorState.cancel});this.fire(c.SketchEditorEventType.create,e,self)}},{key:"getGeometry",value:function(){return this._drawTool?this._drawTool.sketchStage.entityGraphic.geometry:null}},{key:"setSnapOption",value:function(e){this.snapOption=(0,i.default)(this.snapOption,e),this._sketchSnappingTool.setSnapOption(e)}},{key:"getSnapOption",value:function(){return this.snapOption}},{key:"setSnapAndReferGeometries",value:function(e){this.snapAndReferGeometries=e,this._drawTool&&this._drawTool.setSnapAndReferGeometries()}},{key:"getSnapAndReferGeometries",value:function(){return this.snapAndReferGeometries}},{key:"_bindHit",value:function(){}}]),t}(c.Evented);(0,n.default)(T.prototype,{editable:{get:function(){return this._editable},set:function(e){this._editable=e}},sketchDataType:{get:function(){return this._sketchDataType},set:function(e){this._sketchDataType=e}}}),t.default=T},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(10)),i=g(r(3)),o=g(r(0)),a=g(r(2)),s=g(r(4)),l=g(r(5)),u=r(8),c=r(9),f=g(r(43)),h=g(r(42)),d=g(r(60)),p=g(r(41)),y=r(1);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r._initEvent(),r.type="sketchPolylineDrawTool",r._drawTools=[r],r._otherDrawTools=[],r._currentMovePoint=void 0,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_initEvent",value:function(){this._processEvent=this._processEvent.bind(this),this.on("pan",this._processEvent),this.on("vertexScale",this._processEvent),this.on("midVertexScale",this._processEvent),this.on("vertexMove",this._processEvent),this.on("midVertexAdd",this._processEvent)}},{key:"drawFeature",value:function(){var e=this;this._editMode=u.SketchEditMode.DRAWING,this.view._mapActionControl("double-click-zoom",!1),this.view._mapActionControl("video-map-active",!0);var t=!1,r=!1,i=!1,o=null,a=[],s=[];this.vertexNum=0;var l=[];this.cursorStyle=this.view.cursor,(0,y.isNull)(this.cursorStyle)&&(this.view.cursor="crosshair");var f=this._getInteractiveDom(),d=this.extensionOptions&&this.extensionOptions.vertexNumber?this.extensionOptions.vertexNumber:null;this._setInitSnap(),this._fireStartDrawEvent();var p=function n(i){if(i&&i.x&&i.y){e._stopInitSnap(),clearTimeout(null);var a={x:i.x,y:i.y};(new Date).getTime(),e._editMode=u.SketchEditMode.DRAWING;var f;f=e._snapPoint?e._snapPoint:e.view.toMap({x:a.x,y:a.y});var p=e.vertexNum+1;if(1===p)s=[f.coordinates],(o=e._getFeature()).geometry.coordinates=[s[0],s[0]];else if(2===p){var g=o.geometry.coordinates[0];if(g&&g[0]===f.coordinates[0]&&g[1]===f.coordinates[1])return y.Log.info("相邻两顶点重复！");s=[o.geometry.coordinates[0],f.coordinates],o.geometry.coordinates=s,e._polylineGeometry=o}else{var v=(s=o.geometry.coordinates)[s.length-2];if(v&&v[0]===f.coordinates[0]&&v[1]===f.coordinates[1])return y.Log.info("相邻两顶点重复！");if(s[s.length-1]=f.coordinates,e._sketchEditor.isSimple){var m=new c.LineString({coordinates:s,spatialReference:e._spatialReference,extensionOptions:{arcType:e.arcType}});if(!c.GeometryEngine.isSimple(m))return e._fireUnsimpleDraw(),y.Log.info("该坐标构成的几何不符合拓扑规范！")}o.geometry.coordinates=s}if(e.vertexNum=p,d&&p>=d)e.view.off(u.ViewEventType.immediateClick,n);else{var _=new h.default({view:e.view,layer:e.layer,_parent:e,sketchStyle:e.sketchStyle,elevationInfo:e.elevationInfo});_.addFeature(f,void 0,void 0,e.sketchInnerLayer),e._drawTools.push(_);var S=_.sketchStage.entityGraphic;e.sketchStage.entityGraphic=o,e.sketchStage.vertexGraphics.push(S),o&&(r=t=!0),s.length>1&&l.push(function(e,t){return(e[1]-t[1])/(e[0]-t[0])}(s[s.length-1],s[s.length-2])),e.fire("drawn-vertex",{geometry:_.sketchStage.entityGraphic.geometry,feature:_.sketchStage.entityGraphic},self),e._fireDrawVertexEvent(o),e.undoRedoManager&&e.undoRedoManager.addProcess("add-vertex",e.sketchStage,e._editMode)}}},g=!0,v=function(l){if(l&&l.x&&l.y&&t&&!i){clearTimeout(null),i=!0,e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]);var u={x:l.x,y:l.y},c=e.view.toMap({x:u.x,y:u.y});o=e.sketchStage.entityGraphic;var h=d&&e.vertexNum===d?e.vertexNum-1:e.vertexNum;s=1===h?[o.geometry.coordinates[0]]:o.geometry.coordinates.slice(0,o.geometry.coordinates.length-1),h>=1&&(e._snapPoint=e.getSnapGraphics(c,s)),e._snapPoint&&(c=e._snapPoint),e._currentMovePoint=c,1===h?o.geometry.coordinates[1]=c.coordinates:h>1&&(r?(o.geometry.coordinates.push(c.coordinates),r=!1):o.geometry.coordinates[o.geometry.coordinates.length-1]=c.coordinates),o.geometry._pixelCoords=a,o.geometry.coordinates=JSON.parse((0,n.default)(o.geometry.coordinates)),g&&(e._addFeatureToLayer(o,e.layer),g=!1),i=!1;var p=e._getInteractiveDom();f=f.concat(p),e._removeInteractiveStyle(p),e._fireChangeCursorEvent(o)}},m=function(){return clearTimeout(null),clearTimeout(null),(o=e.sketchStage.entityGraphic)&&e._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(o.geometry)?(e._fireUnsimpleDraw(),y.Log.info("该坐标构成的几何不符合拓扑规范！")):e.vertexNum<2&&e.sketchStage.entityGraphic?y.Log.info("线几何顶点少于两个，不符合规范！"):(s=[],a=[],e.stop(),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),e._editMode=u.SketchEditMode.NONE,e.view.cursor=e.cursorStyle,e._addInteractiveStyle(f),e.fire("drawn",{geometry:o.geometry,feature:o},self),e._fireStopDrawEvent(o),e.sketchStage.vertexGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.vertexNum=0,e.sketchStage.vertexGraphics=[],e._currentMovePoint=void 0,e.undoRedoManager._initDrawProcess(),void setTimeout(function(){e.view._mapActionControl("double-click-zoom",!0),e.view._mapActionControl("video-map-active",!1)},0))};this._drawEventHandlers.push(p,v,m),this.view.on(u.ViewEventType.immediateClick,p),this.view.on(u.ViewEventType.pointerMove,v),this.view.on(u.ViewEventType.doubleClick,m)}},{key:"addFeature",value:function(e,t,r,n){var i;i=t&&t.lineStyle?t.lineStyle:this.sketchStyle.lineStyle;var o=this._getFeature(e,i);r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"addFeatureByGeometry",value:function(e,t,r,n){var i;i=t&&t.lineStyle?t.lineStyle:this.sketchStyle.lineStyle;var o=new u.Feature({geometry:e,symbol:i,elevationInfo:this.elevationInfo});r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"_getFeature",value:function(e){e||(e=[[0,0],[1,1]]);var t=new c.LineString({coordinates:e,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),r=this.sketchStyle.lineStyle.clone();return new u.Feature({geometry:t,symbol:r,elevationInfo:this.elevationInfo})}},{key:"hitTestFeature",value:function(e,t){this.view._mapActionControl("video-map-active",!0),!this._parent&&this.editOption.showSelectBox&&(this._editMode===u.SketchEditMode.NONE?this._editMode=u.SketchEditMode.EDITGRAGIC:this._editMode===u.SketchEditMode.EDITVERTEX&&(this.view.off(u.ViewEventType.immediateClick,this._mapClickEvent),this._mapClickEvent=null,this._editMode=u.SketchEditMode.EDITGRAGIC),this.selectFeature(e)),this._parent&&this._parent._editMode===u.SketchEditMode.EDITGRAGIC&&this.startPanGraphics(e,t)}},{key:"selectFeature",value:function(e){var t=this;if(this.editOption.showSelectBox){this._clearEditGraphics(2);var r=e.geometry.extent,n=new d.default({view:this.view,layer:this.layer,sketchStyle:new p.default({fillStyle:this.sketchStyle._selectBoxStyle,isShowSegmentLength:!0,isShowArea:!0}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,arcType:this.arcType,_getCenterCoordinate:this._getCenterCoordinate,_parent:this});this._drawTools.push(n),n.addFeature([[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax]],void 0,void 0,this.sketchInnerLayer),this.sketchStage.selectBoxGraphics=[n.sketchStage.entityGraphic];var i=[];if(i=[{point:new c.Point({coordinates:[r.xmax,r.ymax],spatialReference:this._spatialReference}),direction:"ne"},{point:new c.Point({coordinates:[r.xmax,r.ymin],spatialReference:this._spatialReference}),direction:"se"},{point:new c.Point({coordinates:[r.xmin,r.ymin],spatialReference:this._spatialReference}),direction:"sw"},{point:new c.Point({coordinates:[r.xmin,r.ymax],spatialReference:this._spatialReference}),direction:"nw"}],this._sketchEditor&&this._getCenterCoordinate){var o=[{point:new c.Point({coordinates:this._getCenterCoordinate([r.xmax,r.ymax],[r.xmax,r.ymin]),spatialReference:this._spatialReference}),direction:"e",type:"midVertex"},{point:new c.Point({coordinates:this._getCenterCoordinate([r.xmax,r.ymin],[r.xmin,r.ymin]),spatialReference:this._spatialReference}),direction:"s",type:"midVertex"},{point:new c.Point({coordinates:this._getCenterCoordinate([r.xmin,r.ymin],[r.xmin,r.ymax]),spatialReference:this._spatialReference}),direction:"w",type:"midVertex"},{point:new c.Point({coordinates:this._getCenterCoordinate([r.xmin,r.ymax],[r.xmax,r.ymax]),spatialReference:this._spatialReference}),direction:"n",type:"midVertex"}];i=i.concat(o)}var a=[],s=[];i.forEach(function(e){var r=new h.default({view:t.view,layer:t.layer,sketchStyle:new p.default({vertexStyle:t.sketchStyle._selectBoxVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},arcType:t.arcType,_getCenterCoordinate:t._getCenterCoordinate,elevationInfo:t.elevationInfo,_parent:t});t._drawTools.push(r),r.addFeature(e.point,t.sketchStage,{direction:e.direction,type:e.type},t.sketchInnerLayer),a.push(r),s.push(r.sketchStage.entityGraphic)}),this.sketchStage.selectBoxVertexGraphics=s,this._otherDrawTools?this._otherDrawTools.push(n):this._otherDrawTools=[n],this._otherDrawTools=this._otherDrawTools.concat(a),this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage,this._editMode),this._mapClickEvent||this._parent&&(!this._parent||this._parent._mapClickEvent)||(this._mapClickEvent=function(){t._preventFirstCall?t._preventFirstCall=void 0:(t.sketchStage.selectBoxGraphics.concat(t.sketchStage.selectBoxVertexGraphics).concat(t.sketchStage.vertexGraphics).concat(t.sketchStage.midVertexGraphics).forEach(function(e){t._removeFeatureFromLayer(e,t.sketchInnerLayer)}),t.view.off(u.ViewEventType.immediateClick,t._mapClickEvent),t.view._mapActionControl("drag-pan",!0),t._mapClickEvent=null,t.fire("selected",{isSelected:!1},self),t._fireRemoveSelectEvent(t.sketchStage.entityGraphic),t.sketchStage.selectBoxGraphics=[],t.sketchStage.selectBoxVertexGraphics=[],t.sketchStage.vertexGraphics=[],t.sketchStage.midVertexGraphics=[],t._editMode=u.SketchEditMode.NONE,t.view._mapActionControl("video-map-active",!1))},this._hitTestEventHandlers.push(this._mapClickEvent),this._preventFirstCall=!0,this.view.on(u.ViewEventType.immediateClick,this._mapClickEvent))}}},{key:"selectFeatureVertex",value:function(e){var t=this;this._clearEditGraphics(1);var r=[],n=[];e.geometry.coordinates.forEach(function(i,o){var a=new h.default({view:t.view,layer:t.layer,sketchStyle:new p.default({vertexStyle:t.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t}),s=new c.Point({coordinates:i,spatialReference:t._spatialReference});if(t._drawTools.push(a),a.addFeature(s,void 0,{vertexIndex:o},t.sketchInnerLayer),r.push(a),t.sketchStage.vertexGraphics.push(a.sketchStage.entityGraphic),o>0){var l=new h.default({view:t.view,layer:t.layer,sketchStyle:new p.default({vertexStyle:t.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t});n.push(l);var u,f=e.geometry.coordinates[o-1],d=t._getCenterCoordinate(i,f);u=new c.Point({coordinates:d,spatialReference:t._spatialReference}),t._drawTools.push(l),l.addFeature(u,void 0,{vertexIndex:o-1,type:"midVertex"},t.sketchInnerLayer),t.sketchStage.midVertexGraphics.push(l.sketchStage.entityGraphic)}});var i=r.concat(n);this._otherDrawTools=this._otherDrawTools?this._otherDrawTools.concat(i):i,this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage,this.undoRedoManager.addProcess)}},{key:"_processEvent",value:function(e){"pan"===e.type?this._handlerPanEvent(e):"vertexScale"===e.type?this._handlerVertexScaleEvent(e):"midVertexScale"===e.type?this._handlerMidVertexScaleEvent(e):"vertexMove"===e.type?this._handlerVertexMoveEvent(e):"midVertexAdd"===e.type&&this._handlerMidVertexAddEvent(e)}},{key:"_handlerPanEvent",value:function(e){var t=this,r=[];this.sketchStage.entityGraphic.geometry.coordinates.forEach(function(n){r.push(t.getPanCoordinates(n,e.deltaPosition.x,e.deltaPosition.y))});var n=new c.LineString({coordinates:r,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}});this.sketchStage.entityGraphic.geometry=n,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}},{key:"_handlerVertexScaleEvent",value:function(e){if("scale"===e.action){var t;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates));this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var i=this.getScaleCoordinates(this.sketchStage.entityGraphic.geometry.coordinates,e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t=new c.LineString({coordinates:i,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}else"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),this._resetSelectBoxDirection())}},{key:"_handlerMidVertexScaleEvent",value:function(e){var t;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates));this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var i=this.getMidScaleCoordinates(this.sketchStage.entityGraphic.geometry.coordinates,e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t=new c.LineString({coordinates:i,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),this._resetSelectBoxDirection())}},{key:"_resetSelectBoxDirection",value:function(){var e=this,t=this.sketchStage.entityGraphic.geometry.extent;this.sketchStage.selectBoxVertexGraphics.forEach(function(r){r.attributes&&("ne"===r.attributes.direction?r.geometry.coordinates=[t.xmax,t.ymax]:"se"===r.attributes.direction?r.geometry.coordinates=[t.xmax,t.ymin]:"sw"===r.attributes.direction?r.geometry.coordinates=[t.xmin,t.ymin]:"nw"===r.attributes.direction?r.geometry.coordinates=[t.xmin,t.ymax]:"e"===r.attributes.direction?r.geometry.coordinates=e._getCenterCoordinate([t.xmax,t.ymax],[t.xmax,t.ymin]):"s"===r.attributes.direction?r.geometry.coordinates=e._getCenterCoordinate([t.xmax,t.ymin],[t.xmin,t.ymin]):"w"===r.attributes.direction?r.geometry.coordinates=e._getCenterCoordinate([t.xmin,t.ymin],[t.xmin,t.ymax]):"n"===r.attributes.direction&&(r.geometry.coordinates=e._getCenterCoordinate([t.xmin,t.ymax],[t.xmax,t.ymax])))})}},{key:"_handlerVertexMoveEvent",value:function(e){this.sketchStage.currentVertexIndex=e.vertexIndex;var t=this.sketchStage.entityGraphic,r=t.geometry.coordinates,i=JSON.parse((0,n.default)(r));i[e.vertexIndex]=e.movePoint.coordinates;var o=new c.LineString({coordinates:i,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}});if(this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(o))return this._fireUnsimpleUpdate(),y.Log.info("该坐标构成的几何不符合拓扑规范！");if(t.geometry=o,this._otherDrawTools){if(0===e.vertexIndex){var a=this.sketchStage.midVertexGraphics[e.vertexIndex],s=i[e.vertexIndex],l=i[e.vertexIndex+1];a.geometry.coordinates=this._getCenterCoordinate(s,l),a.geometry=new c.Point({coordinates:a.geometry.coordinates,spatialReference:this._spatialReference})}else if(e.vertexIndex===i.length-1){var u=this.sketchStage.midVertexGraphics[e.vertexIndex-1],f=i[e.vertexIndex-1],h=i[e.vertexIndex];u.geometry.coordinates=this._getCenterCoordinate(f,h),u.geometry=new c.Point({coordinates:u.geometry.coordinates,spatialReference:this._spatialReference})}else{var d=this.sketchStage.midVertexGraphics[e.vertexIndex],p=this.sketchStage.midVertexGraphics[e.vertexIndex-1],g=i[e.vertexIndex-1],v=i[e.vertexIndex],m=i[e.vertexIndex+1];d.geometry.coordinates=this._getCenterCoordinate(m,v),p.geometry.coordinates=this._getCenterCoordinate(g,v)}this.sketchStage.vertexGraphics[e.vertexIndex].geometry.coordinates=i[e.vertexIndex]}}},{key:"_handlerMidVertexAddEvent",value:function(e){var t=this;if("changeFeature"===e.action&&(this.sketchStage.entityGraphic.geometry.coordinates.splice(e.vertexIndex+1,0,e.point.coordinates),this.sketchStage.entityGraphic.geometry=new c.LineString({coordinates:this.sketchStage.entityGraphic.geometry.coordinates,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}})),"moveMidVertex"===e.action){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates));r[e.vertexIndex+1]=e.movePoint.coordinates;var i=new c.LineString({coordinates:r,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}});if(this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(i))return this._fireUnsimpleUpdate(),y.Log.info("该坐标构成的几何不符合拓扑规范！");this.sketchStage.currentVertexIndex=e.vertexIndex,this.sketchStage.entityGraphic.geometry.coordinates=r,this.sketchStage.midVertexGraphics[e.vertexIndex].geometry.coordinates=e.movePoint.coordinates}if("addVertex"===e.action){var o=this.sketchStage.midVertexGraphics[e.vertexIndex].id.toString(),a=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(a),a.addFeature(e.point,void 0,void 0,this.sketchInnerLayer),this.sketchStage.vertexGraphics.splice(e.vertexIndex+1,0,a.sketchStage.entityGraphic);var s,l=this.sketchStage.entityGraphic.geometry.coordinates[e.vertexIndex];this._getHight;var u=this._getCenterCoordinate(l,e.point.coordinates);s=new c.Point({coordinates:u,spatialReference:this._spatialReference});var f=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(f),f.addFeature(s,void 0,{type:"midVertex"},this.sketchInnerLayer),this.sketchStage.midVertexGraphics.splice(e.vertexIndex,1,f.sketchStage.entityGraphic);var d,g=this.sketchStage.entityGraphic.geometry.coordinates[e.vertexIndex+2];this._getHight;var v=this._getCenterCoordinate(g,e.point.coordinates);d=new c.Point({coordinates:v,spatialReference:this._spatialReference});var m=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(m),m.addFeature(d,void 0,{type:"midVertex"},this.sketchInnerLayer),this.sketchStage.midVertexGraphics.splice(e.vertexIndex+1,0,m.sketchStage.entityGraphic),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools.forEach(function(e){e.sketchStage.entityGraphic.id===o&&t._removeFeatureFromLayer(e.sketchStage.entityGraphic,t.sketchInnerLayer)}),this._otherDrawTools.push(a),this._otherDrawTools.push(f),this._otherDrawTools.push(m)}}},{key:"addMidVertex",value:function(e,t){var r=new h.default;r.addPoint(t),this.sketchStage.midVertexGraphics=r}},{key:"addVertex",value:function(e,t){var r=null;if(--t>-1&&t<=this.sketchStage.midVertexGraphics.length+1){var i=[];if(t<=this.sketchStage.entityGraphic.geometry.coordinates.length-1){if((i=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates))).splice(t,0,e.coordinates),r=new c.LineString({coordinates:i,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(r))return this._fireUnsimpleUpdateByFun(),y.Log.info("该坐标构成的几何不符合拓扑规范！");this.sketchStage.entityGraphic.geometry=r;var o=void 0,a=void 0,s=this.sketchStage.entityGraphic.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var l=[[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin],[s.xmin,s.ymax],this._getCenterCoordinate([s.xmax,s.ymax],[s.xmin,s.ymax]),this._getCenterCoordinate([s.xmax,s.ymin],[s.xmin,s.ymin]),this._getCenterCoordinate([s.xmax,s.ymax],[s.xmax,s.ymin]),this._getCenterCoordinate([s.xmin,s.ymax],[s.xmin,s.ymin])];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=l[t]})}if(this.sketchStage.vertexGraphics.length>0&&(o=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this}),this._drawTools.push(o),o.addFeatureByGeometry(e,void 0,void 0,this.sketchInnerLayer),this.sketchStage.vertexGraphics.splice(t,0,o.sketchStage.entityGraphic),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}})),this.sketchStage.midVertexGraphics.length>0){var u=-1,f=-1,d=null,g=null;if(0===t?(f=0,g=this.sketchStage.entityGraphic.geometry.coordinates[1]):t===this.sketchStage.midVertexGraphics.length+1?(f=this.sketchStage.midVertexGraphics.length-2,g=this.sketchStage.entityGraphic.geometry.coordinates[f]):(u=t-1,f=t+1,d=this.sketchStage.entityGraphic.geometry.coordinates[u],g=this.sketchStage.entityGraphic.geometry.coordinates[f]),u>-1){var v=new c.Point({coordinates:this._getCenterCoordinate(d,e.coordinates),spatialReference:this._spatialReference});this.sketchStage.midVertexGraphics[u].geometry.coordinates=v.coordinates}if(f>-1){var m=new c.Point({coordinates:this._getCenterCoordinate(g,e.coordinates),spatialReference:this._spatialReference});a=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this}),this._drawTools.push(a),a.addFeatureByGeometry(m,void 0,{type:"midVertex"}),this.sketchStage.midVertexGraphics.splice(t,0,a.sketchStage.entityGraphic)}this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}})}o&&this._otherDrawTools.push(o),a&&this._otherDrawTools.push(a),this.undoRedoManager.addProcess("update",this.sketchStage,this._editMode),this._fireAddVertexEventByFun(o.sketchStage.entityGraphic,this._parent)}return r}}},{key:"updateVertex",value:function(e,t){var r=null;if(--t>-1){var i=this.sketchStage.entityGraphic.geometry.coordinates.length;if(t<i){var o=this.sketchStage.entityGraphic,a=JSON.parse((0,n.default)(o.geometry.coordinates));if(this.currentVertexIndex=t,r=e.coordinates,o.geometry=new c.LineString({coordinates:o.geometry.coordinates,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(r))return this._fireUnsimpleUpdateByFun(),y.Log.info("该坐标构成的几何不符合拓扑规范！");this.sketchStage.entityGraphic.geometry=r;var s=o.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var l=[[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin],[s.xmin,s.ymax],this._getCenterCoordinate([s.xmax,s.ymax],[s.xmin,s.ymax]),this._getCenterCoordinate([s.xmax,s.ymin],[s.xmin,s.ymin]),this._getCenterCoordinate([s.xmax,s.ymax],[s.xmax,s.ymin]),this._getCenterCoordinate([s.xmin,s.ymax],[s.xmin,s.ymin])];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=l[t]})}if(this.sketchStage.vertexGraphics.length>0&&(this.sketchStage.vertexGraphics[t].geometry.coordinates=e.coordinates),this.sketchStage.midVertexGraphics.length>0){var u=a[t-1],f=a[t],h=a[t+1],d=-1,p=-1;if(0===t?d=t:t===i-1?p=t-1:(d=t,p=t-1),d>-1){var g=this.sketchStage.midVertexGraphics[d];g.geometry.coordinates=this._getCenterCoordinate(h,f),g.geometry=new c.Point({coordinates:g.geometry.coordinates,spatialReference:this._spatialReference})}if(p>-1){var v=this.sketchStage.midVertexGraphics[p];v.geometry.coordinates=this._getCenterCoordinate(u,f),v.geometry=new c.Point({coordinates:v.geometry.coordinates,spatialReference:this._spatialReference})}}}this.undoRedoManager.addProcess("update",this.sketchStage,this._editMode),this._fireUpdateVertexByFun(this.sketchStage.entityGraphic,this._parent)}return r}},{key:"removeVertex",value:function(e){var t=null;if(--e>-1){var r=this.sketchStage.entityGraphic.geometry.coordinates.length;if(r>2&&e<r){var i=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates));if(i.splice(e,1),t=new c.LineString({coordinates:i,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),this._sketchEditor.isSimple&&!c.GeometryEngine.isSimple(t))return this._fireUnsimpleUpdateByFun(),y.Log.info("该坐标构成的几何不符合拓扑规范！");this.sketchStage.entityGraphic.geometry=t;var o=this.sketchStage.entityGraphic.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var a=[[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin],[o.xmin,o.ymax],this._getCenterCoordinate([o.xmax,o.ymax],[o.xmin,o.ymax]),this._getCenterCoordinate([o.xmax,o.ymin],[o.xmin,o.ymin]),this._getCenterCoordinate([o.xmax,o.ymax],[o.xmax,o.ymin]),this._getCenterCoordinate([o.xmin,o.ymax],[o.xmin,o.ymin])];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=a[t]})}if(this.sketchStage.vertexGraphics.length>0){var s=this.sketchStage.vertexGraphics[e].id.toString();this._removeFeatureFromLayer(this.sketchStage.vertexGraphics[e],this.sketchInnerLayer),this.sketchStage.vertexGraphics.splice(e,1),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools=this._otherDrawTools.filter(function(e){if(e.sketchStage.entityGraphic.id!==s)return e})}if(this.sketchStage.midVertexGraphics.length>0){var l=[],u=-1,f=-1;0===e?f=0:e===r-1?f=e-1:(l=[(t.coordinates[e-1][0]+t.coordinates[e][0])/2,(t.coordinates[e-1][1]+t.coordinates[e][1])/2],u=e-1,f=e),u>-1&&(this.sketchStage.midVertexGraphics[u].geometry=new c.Point({coordinates:l,spatialReference:this._spatialReference}));var h=this.sketchStage.vertexGraphics[f].id.toString();this._removeFeatureFromLayer(this.sketchStage.midVertexGraphics[f],this.sketchInnerLayer),this.sketchStage.midVertexGraphics.splice(f,1),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools=this._otherDrawTools.filter(function(e){if(e.sketchStage.entityGraphic.id!==h)return e})}}this.undoRedoManager.addProcess("update",this.sketchStage,this._editMode),this._fireRemoveVertexByFun(this.sketchStage.entityGraphic,this._parent)}return t}}]),t}(f.default);t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(3)),i=g(r(0)),o=g(r(2)),a=g(r(4)),s=g(r(5)),l=r(8),u=r(9),c=g(r(43)),f=g(r(42)),h=g(r(60)),d=g(r(41)),p=g(r(66)),y=r(1);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.type="sketchCircleDrawTool",r._drawTools=[r],r._otherDrawTools=[],r._initEvent(),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_initEvent",value:function(){this._processEvent=this._processEvent.bind(this),this.on("pan",this._processEvent),this.on("circleVertexScale",this._processEvent)}},{key:"drawFeature",value:function(){var e=this;this._editMode=l.SketchEditMode.DRAWING,this.view._mapActionControl("drag-pan",!1),this.view._mapActionControl("video-map-active",!0);var t=null,r=0,n=null;this.cursorStyle=this.view.cursor,(0,y.isNull)(this.cursorStyle)&&(this.view.cursor="crosshair");var i=this._getInteractiveDom();this._setInitSnap(),this._fireStartDrawEvent();var o=function(o){if(clearTimeout(null),e._stopInitSnap(),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),0===o.button)if("start"===o.action)n=e._snapPoint?e._snapPoint:n||e.view.toMap(o.origin),e._fireDrawVertexEvent();else if("update"===o.action){var a=e.view.toMap({x:o.x,y:o.y});e._snapPoint=e.getSnapGraphics(a),e._snapPoint&&(a=e._snapPoint),r=p.default.planarLength(new u.LineString({coordinates:[n.coordinates,a.coordinates],spatialReference:e._spatialReference})),t?t.geometry.radius=r:(t=e._getFeature(n,r),e._addFeatureToLayer(t,e.layer),e.sketchStage.entityGraphic=t);var s=e._getInteractiveDom();i=i.concat(s),e._removeInteractiveStyle(s),e._fireChangeCursorEvent(t)}else"end"===o.action&&(e.stop(),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),n=null,e._editMode=l.SketchEditMode.NONE,e.view.cursor=e.cursorStyle,e._addInteractiveStyle(i),e.fire("drawn",{geometry:t.geometry,feature:t},self),e._fireDrawVertexEvent(t),e._fireStopDrawEvent(t),e.view._mapActionControl("drag-pan",!0),e.view._mapActionControl("video-map-active",!1))};this._drawEventHandlers.push(o),this.view.on(l.ViewEventType.drag,o)}},{key:"addFeature",value:function(e,t,r,n){var i;i=t&&t.lineStyle?t.lineStyle:this.sketchStyle.lineStyle;var o=this._getFeature(e,i);r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"addFeatureByGeometry",value:function(e,t,r,n){var i;i=t&&t.lineStyle?t.lineStyle:this.sketchStyle.lineStyle;var o=new l.Feature({geometry:e,symbol:i,elevationInfo:this.elevationInfo});r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"_getFeature",value:function(e,t){e?e instanceof Array?e=new u.Point({coordinates:e,spatialReference:this._spatialReference}):e instanceof u.Point||(e=new u.Point({coordinates:[0,0],spatialReference:this._spatialReference})):e=new u.Point({coordinates:[0,0],spatialReference:this._spatialReference}),t=void 0!==t?t:0;var r=this._spatialReference.isGeographic?l.RadiusUnit.degrees:l.RadiusUnit.meters,n=new u.Circle({center:e,radius:t,radiusUnit:r,spatialReference:this._spatialReference}),i=this.sketchStyle.fillStyle.clone();return new l.Feature({geometry:n,symbol:i,elevationInfo:this.elevationInfo})}},{key:"hitTestFeature",value:function(e){this.view._mapActionControl("video-map-active",!0),!this._parent&&this.editOption.showSelectBox&&(this._editMode===l.SketchEditMode.NONE&&(this._editMode=l.SketchEditMode.EDITGRAGIC),this.selectFeature(e))}},{key:"selectFeature",value:function(e){var t=this;if(this.editOption.showSelectBox){this._clearEditGraphics(2);var r=e.geometry.extent,n=new h.default({view:this.view,layer:this.layer,sketchStyle:new d.default({fillStyle:this.sketchStyle._selectBoxStyle,isShowSegmentLength:!0,isShowArea:!0}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(n),n.addFeature([[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax]],void 0,void 0,this.sketchInnerLayer),this.sketchStage.selectBoxGraphics=[n.sketchStage.entityGraphic];var i=[];if(this._sketchEditor&&this._sketchEditor._getCenterCoordinate){var o=[{point:new u.Point({coordinates:this._sketchEditor._getCenterCoordinate([r.xmax,r.ymax],[r.xmax,r.ymin]),spatialReference:this._spatialReference}),direction:"e",type:"circleVertex"}];i=i.concat(o)}var a=[],s=[];i.forEach(function(e){var r=new f.default({view:t.view,layer:t.layer,sketchStyle:new d.default({vertexStyle:t.sketchStyle._selectBoxVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t});t._drawTools.push(r),r.addFeature(e.point,t.sketchStage,{direction:e.direction,type:e.type},t.sketchInnerLayer),a.push(r),s.push(r.sketchStage.entityGraphic)}),this.sketchStage.selectBoxVertexGraphics=s,this._otherDrawTools?this._otherDrawTools.push(n):this._otherDrawTools=[n],this._otherDrawTools=this._otherDrawTools.concat(a),this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage),this._mapClickEvent||this._parent&&(!this._parent||this._parent._mapClickEvent)||(this._mapClickEvent=function(){t._preventFirstCall?t._preventFirstCall=void 0:(t.sketchStage.selectBoxGraphics.concat(t.sketchStage.selectBoxVertexGraphics).concat(t.sketchStage.vertexGraphics).concat(t.sketchStage.midVertexGraphics).forEach(function(e){t._removeFeatureFromLayer(e,t.sketchInnerLayer)}),t.view.off(l.ViewEventType.immediateClick,t._mapClickEvent),t.view._mapActionControl("drag-pan",!0),t._mapClickEvent=null,t.fire("selected",{isSelected:!1},self),t._fireRemoveSelectEvent(t.sketchStage.entityGraphic),t.sketchStage.selectBoxGraphics=[],t.sketchStage.selectBoxVertexGraphics=[],t.sketchStage.vertexGraphics=[],t.sketchStage.midVertexGraphics=[],t._editMode=l.SketchEditMode.NONE,t.view._mapActionControl("video-map-active",!1))},this._hitTestEventHandlers.push(this._mapClickEvent),this._preventFirstCall=!0,this.view.on(l.ViewEventType.immediateClick,this._mapClickEvent))}}},{key:"_processEvent",value:function(e){"pan"===e.type?this._handlerPanEvent(e):"circleVertexScale"===e.type&&this._handlerCircleVertexScaleEvent(e)}},{key:"_handlerPanEvent",value:function(e){var t=this.sketchStage.entityGraphic.geometry.center;this.sketchStage.entityGraphic.geometry.center=this.getPanCoordinates(t,e.deltaPosition.x,e.deltaPosition.y),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}},{key:"_handlerCircleVertexScaleEvent",value:function(e){if("scale"===e.action){var t=p.default.planarLength(new u.LineString({coordinates:[this.sketchStage.entityGraphic.geometry.center,[e.movePoint.coordinates[0],this.sketchStage.entityGraphic.geometry.center[1]]],spatialReference:this._spatialReference})),r=this._spatialReference.isGeographic?l.RadiusUnit.degrees:l.RadiusUnit.meters,n=new u.Circle({center:this.sketchStage.entityGraphic.geometry.center,radius:t,radiusUnit:r,spatialReference:this._spatialReference});this.sketchStage.entityGraphic.geometry=n,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}else"stop"===e.action&&(this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),this._resetSelectBoxDirection())}},{key:"_resetSelectBoxDirection",value:function(){var e=this,t=this.sketchStage.entityGraphic.geometry.extent;this.sketchStage.selectBoxVertexGraphics.forEach(function(r){if(r.attributes)if("e"===r.attributes.direction){var n=e._sketchEditor._getCenterCoordinate([t.xmin,t.ymin],[t.xmin,t.ymax]);r.geometry.coordinates[0]===n[0]&&r.geometry.coordinates[1]===n[1]&&(r.attributes.direction="w")}else if("w"===r.attributes.direction){var i=e._sketchEditor._getCenterCoordinate([t.xmax,t.ymax],[t.xmax,t.ymin]);r.geometry.coordinates[0]===i[0]&&r.geometry.coordinates[1]===i[1]&&(r.attributes.direction="e")}})}}]),t}(c.default);t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(3)),i=y(r(0)),o=y(r(2)),a=y(r(4)),s=y(r(5)),l=r(8),u=r(9),c=y(r(43)),f=y(r(42)),h=y(r(60)),d=y(r(41)),p=r(1);function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.type="sketchExtentDrawTool",r._initEvent(),r._drawTools=[r],r._otherDrawTools=[],r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_initEvent",value:function(){this._processEvent=this._processEvent.bind(this),this.on("pan",this._processEvent),this.on("vertexScale",this._processEvent),this.on("midVertexScale",this._processEvent),this.on("vertexMove",this._processEvent),this.on("midVertexAdd",this._processEvent)}},{key:"drawFeature",value:function(){var e=this;this._editMode=l.SketchEditMode.DRAWING,this.view._mapActionControl("drag-pan",!1),this.view._mapActionControl("video-map-active",!0);var t=null,r=null;this.cursorStyle=this.view.cursor,(0,p.isNull)(this.cursorStyle)&&(this.view.cursor="crosshair");var n=this._getInteractiveDom();this._setInitSnap(),this._fireStartDrawEvent();var i=function(i){if(clearTimeout(null),e.view.off(l.ViewEventType.pointerMove,e._handlerInitMouseMove),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),0===i.button)if("start"===i.action)r=e._snapPoint?e._snapPoint:r||e.view.toMap(i.origin),e._fireDrawVertexEvent();else if("update"===i.action){var o=e.view.toMap({x:i.x,y:i.y});e._snapPoint=e.getSnapGraphics(o),e._snapPoint&&(o=e._snapPoint);var a=Math.min(r.coordinates[0],o.coordinates[0]),s=Math.min(r.coordinates[1],o.coordinates[1]),u=Math.max(r.coordinates[0],o.coordinates[0]),c=Math.max(r.coordinates[1],o.coordinates[1]);t?(t.geometry.xmin=a,t.geometry.ymin=s,t.geometry.xmax=u,t.geometry.ymax=c):(t=e._getFeature(a,s,u,c),e._addFeatureToLayer(t,e.layer),e.sketchStage.entityGraphic=t);var f=e._getInteractiveDom();n=n.concat(f),e._removeInteractiveStyle(f),e._fireChangeCursorEvent(t)}else"end"===i.action&&(e.stop(),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),e._editMode=l.SketchEditMode.NONE,e.view.cursor=e.cursorStyle,e._addInteractiveStyle(n),e.fire("drawn",{geometry:t.geometry,feature:t},self),e._fireDrawVertexEvent(t),e._fireStopDrawEvent(t),e.view._mapActionControl("drag-pan",!0),e.view._mapActionControl("video-map-active",!1))};this._drawEventHandlers.push(i),this.view.on(l.ViewEventType.drag,i)}},{key:"addFeature",value:function(e,t,r,n){var i;i=t&&t.lineStyle?t.lineStyle:this.sketchStyle.lineStyle;var o=this._getFeature(e,i);r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"addFeatureByGeometry",value:function(e,t,r,n){var i;i=t&&t.lineStyle?t.lineStyle:this.sketchStyle.lineStyle;var o=new l.Feature({geometry:e,symbol:i,elevationInfo:this.elevationInfo});r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"_getFeature",value:function(e,t,r,n){e=void 0!==e?e:0,t=void 0!==t?t:0,r=void 0!==r?r:0,n=void 0!==n?n:0;var i=new u.Extent({xmin:e,ymin:t,xmax:r,ymax:n,spatialReference:this._spatialReference,extensionOptions:{arcType:this.arcType}}),o=this.sketchStyle.fillStyle.clone();return new l.Feature({geometry:i,symbol:o,elevationInfo:this.elevationInfo})}},{key:"hitTestFeature",value:function(e){this.view._mapActionControl("video-map-active",!0),!this._parent&&this.editOption.showSelectBox&&(this._editMode===l.SketchEditMode.NONE?this._editMode=l.SketchEditMode.EDITGRAGIC:this._editMode===l.SketchEditMode.EDITVERTEX&&(this.view.off(l.ViewEventType.immediateClick,this._mapClickEvent),this._mapClickEvent=null,this._editMode=l.SketchEditMode.EDITGRAGIC),this.selectFeature(e))}},{key:"selectFeature",value:function(e){var t=this;if(this.editOption.showSelectBox){this._clearEditGraphics(2);var r=e.geometry,n=new h.default({view:this.view,layer:this.layer,sketchStyle:new d.default({fillStyle:this.sketchStyle._selectBoxStyle,isShowSegmentLength:!0,isShowArea:!0}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,arcType:this.arcType,_getCenterCoordinate:this._getCenterCoordinate,_parent:this});this._drawTools.push(n),n.addFeature([[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax]],void 0,void 0,this.sketchInnerLayer),this.sketchStage.selectBoxGraphics=[n.sketchStage.entityGraphic];var i=[];if(i=[{point:new u.Point({coordinates:[r.xmax,r.ymax],spatialReference:this._spatialReference}),direction:"ne"},{point:new u.Point({coordinates:[r.xmax,r.ymin],spatialReference:this._spatialReference}),direction:"se"},{point:new u.Point({coordinates:[r.xmin,r.ymin],spatialReference:this._spatialReference}),direction:"sw"},{point:new u.Point({coordinates:[r.xmin,r.ymax],spatialReference:this._spatialReference}),direction:"nw"}],this._sketchEditor&&this._getCenterCoordinate){var o=[{point:new u.Point({coordinates:this._getCenterCoordinate([r.xmax,r.ymax],[r.xmax,r.ymin]),spatialReference:this._spatialReference}),direction:"e",type:"midVertex"},{point:new u.Point({coordinates:this._getCenterCoordinate([r.xmax,r.ymin],[r.xmin,r.ymin]),spatialReference:this._spatialReference}),direction:"s",type:"midVertex"},{point:new u.Point({coordinates:this._getCenterCoordinate([r.xmin,r.ymin],[r.xmin,r.ymax]),spatialReference:this._spatialReference}),direction:"w",type:"midVertex"},{point:new u.Point({coordinates:this._getCenterCoordinate([r.xmin,r.ymax],[r.xmax,r.ymax]),spatialReference:this._spatialReference}),direction:"n",type:"midVertex"}];i=i.concat(o)}var a=[],s=[];i.forEach(function(e){var r=new f.default({view:t.view,layer:t.layer,sketchStyle:new d.default({vertexStyle:t.sketchStyle._selectBoxVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t});t._drawTools.push(r),r.addFeature(e.point,t.sketchStage,{direction:e.direction,type:e.type},t.sketchInnerLayer),a.push(r),s.push(r.sketchStage.entityGraphic)}),this.sketchStage.selectBoxVertexGraphics=s,this._otherDrawTools?this._otherDrawTools.push(n):this._otherDrawTools=[n],this._otherDrawTools=this._otherDrawTools.concat(a),this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage),this._mapClickEvent||this._parent&&(!this._parent||this._parent._mapClickEvent)||(this._mapClickEvent=function(){t._preventFirstCall?t._preventFirstCall=void 0:(t.sketchStage.selectBoxGraphics.concat(t.sketchStage.selectBoxVertexGraphics).concat(t.sketchStage.vertexGraphics).concat(t.sketchStage.midVertexGraphics).forEach(function(e){t._removeFeatureFromLayer(e,t.sketchInnerLayer)}),t.view.off(l.ViewEventType.immediateClick,t._mapClickEvent),t.view._mapActionControl("drag-pan",!0),t._mapClickEvent=null,t.fire("selected",{isSelected:!1},self),t._fireRemoveSelectEvent(t.sketchStage.entityGraphic),t.sketchStage.selectBoxGraphics=[],t.sketchStage.selectBoxVertexGraphics=[],t.sketchStage.vertexGraphics=[],t.sketchStage.midVertexGraphics=[],t._editMode=l.SketchEditMode.NONE,t.view._mapActionControl("video-map-active",!1))},this._hitTestEventHandlers.push(this._mapClickEvent),this._preventFirstCall=!0,this.view.on(l.ViewEventType.immediateClick,this._mapClickEvent))}}},{key:"_processEvent",value:function(e){"pan"===e.type?this._handlerPanEvent(e):"vertexScale"===e.type?this._handlerVertexScaleEvent(e):"midVertexScale"===e.type&&this._handlerMidVertexScaleEvent(e)}},{key:"_handlerPanEvent",value:function(e){var t=this.sketchStage.entityGraphic.geometry;t.xmin+=e.deltaPosition.x,t.ymin+=e.deltaPosition.y,t.xmax+=e.deltaPosition.x,t.ymax+=e.deltaPosition.y,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}},{key:"_handlerVertexScaleEvent",value:function(e){if("scale"===e.action){var t=this.sketchStage.entityGraphic.geometry;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=[[t.xmin,t.ymin],[t.xmax,t.ymax]];this.sketchStage.entityGraphic.attributes.lastCoordinates=r}this.sketchStage.entityGraphic.attributes=this.sketchStage.entityGraphic.attributes?this.sketchStage.entityGraphic.attributes:{};var n=this.getScaleCoordinates([[t.xmin,t.ymin],[t.xmax,t.ymax]],e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t.xmin=n[0][0],t.ymin=n[0][1],t.xmax=n[1][0],t.ymax=n[1][1],this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}else"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}))}},{key:"_handlerMidVertexScaleEvent",value:function(e){if("scale"===e.action){var t=this.sketchStage.entityGraphic.geometry;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=[[t.xmin,t.ymin],[t.xmax,t.ymax]];this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var n=this.getMidScaleCoordinates([[t.xmin,t.ymin],[t.xmax,t.ymax]],e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t.xmin=n[0][0],t.ymin=n[0][1],t.xmax=n[1][0],t.ymax=n[1][1],this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}else"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}))}}]),t}(c.default);t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(10)),i=g(r(3)),o=g(r(0)),a=g(r(2)),s=g(r(4)),l=g(r(5)),u=r(8),c=r(9),f=g(r(43)),h=g(r(42)),d=g(r(60)),p=g(r(41)),y=r(1);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r._initEvent(),r.type="sketchFreehandPolylineDrawTool",r._drawTools=[r],r._otherDrawTools=[],r._currentMovePoint=void 0,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_initEvent",value:function(){this._processEvent=this._processEvent.bind(this),this.on("pan",this._processEvent),this.on("vertexScale",this._processEvent),this.on("midVertexScale",this._processEvent),this.on("vertexMove",this._processEvent),this.on("midVertexAdd",this._processEvent)}},{key:"drawFeature",value:function(){var e=this;this._editMode=u.SketchEditMode.DRAWING,this.view._mapActionControl("double-click-zoom",!1),this.view._mapActionControl("video-map-active",!0);var t=!1,r=!1,i=null,o=[],a=[];this.vertexNum=0;var s=[],l="";this.cursorStyle=this.view.cursor,(0,y.isNull)(this.cursorStyle)&&(this.view.cursor="crosshair");var c=this._getInteractiveDom();this._setInitSnap(),this._fireStartDrawEvent();var f=function r(n){if(n&&n.x&&n.y){e._stopInitSnap(),clearTimeout(null),e._editMode=u.SketchEditMode.DRAWING;var o,c={x:n.x,y:n.y};o=e._snapPoint?e._snapPoint:e.view.toMap({x:c.x,y:c.y}),e.vertexNum++,1===e.vertexNum?(a=[o.coordinates],(i=e._getFeature()).geometry.coordinates=[a[0],a[0]]):2===e.vertexNum?(a=[i.geometry.coordinates[0],o.coordinates],i.geometry.coordinates=a):((a=i.geometry.coordinates)[a.length-1]=o.coordinates,i.geometry.coordinates=a),"move"===l&&a[a.length-1][0]===a[a.length-2][0]&&a[a.length-1][1]===a[a.length-2][1]&&a.splice(a.length-1);var f=new h.default({view:e.view,layer:e.layer,_parent:e,sketchStyle:e.sketchStyle,elevationInfo:e.elevationInfo});f.addFeature(o,void 0,void 0,e.sketchInnerLayer);var d=f.sketchStage.entityGraphic;e.sketchStage.entityGraphic=i,e.sketchStage.vertexGraphics.push(d),t=!0,a.length>1&&s.push(function(e,t){return(e[1]-t[1])/(e[0]-t[0])}(a[a.length-1],a[a.length-2])),l="click",e.fire("drawn-vertex",{geometry:f.sketchStage.entityGraphic.geometry,feature:f.sketchStage.entityGraphic},self),e.view.off(u.ViewEventType.immediateClick,r)}},d=!0,p=function(s){if(s&&s.x&&s.y&&t&&!r){clearTimeout(null),r=!0,e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]);var u={x:s.x,y:s.y},f=e.view.toMap({x:u.x,y:u.y});e.vertexNum>0&&(e._snapPoint=e.getSnapGraphics(f,[i.geometry.coordinates[0]])),e._snapPoint&&(f=e._snapPoint),e.vertexNum,a.push(f.coordinates),i.geometry.coordinates=a,e.vertexNum++,e.sketchStage.entityGraphic=i,i.geometry._pixelCoords=o,i.geometry.coordinates=JSON.parse((0,n.default)(a)),d&&(e._addFeatureToLayer(i,e.layer),d=!1),r=!1,l="move";var h=e._getInteractiveDom();c=c.concat(h),e._removeInteractiveStyle(h),e._fireDrawVertexEvent(i)}},g=function(){clearTimeout(null),clearTimeout(null),a=[],o=[],e.stop(),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),e._editMode=u.SketchEditMode.NONE,r=!1,t=!1,e.view.cursor=e.cursorStyle,e._addInteractiveStyle(c),e.fire("drawn",{geometry:i.geometry,feature:i},self),e._fireStopDrawEvent(i),e.sketchStage.vertexGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.vertexGraphics=[],setTimeout(function(){e.view._mapActionControl("double-click-zoom",!0),e.view._mapActionControl("video-map-active",!1)},0),l="double-click"};this._drawEventHandlers.push(f,p,g),this.view.on(u.ViewEventType.immediateClick,f),this.view.on(u.ViewEventType.pointerMove,this.debounce(p,5)),this.view.on(u.ViewEventType.doubleClick,g)}},{key:"addFeature",value:function(e,t,r,n){var i;i=t&&t.lineStyle?t.lineStyle:this.sketchStyle.lineStyle;var o=this._getFeature(e,i);r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"addFeatureByGeometry",value:function(e,t,r,n){var i;i=t&&t.lineStyle?t.lineStyle:this.sketchStyle.lineStyle;var o=new u.Feature({geometry:e,symbol:i,elevationInfo:this.elevationInfo});r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"_getFeature",value:function(e){e||(e=[[0,0],[1,1]]);var t=new c.LineString({coordinates:e,spatialReference:this._spatialReference}),r=this.sketchStyle.lineStyle.clone();return new u.Feature({geometry:t,symbol:r,elevationInfo:this.elevationInfo})}},{key:"hitTestFeature",value:function(e,t){this.view._mapActionControl("video-map-active",!0),!this._parent&&this.editOption.showSelectBox&&(this._editMode===u.SketchEditMode.NONE?this._editMode=u.SketchEditMode.EDITGRAGIC:this._editMode===u.SketchEditMode.EDITVERTEX&&(this.view.off(u.ViewEventType.immediateClick,this._mapClickEvent),this._mapClickEvent=null,this._editMode=u.SketchEditMode.EDITGRAGIC),this.selectFeature(e)),this._parent&&this._parent._editMode===u.SketchEditMode.EDITGRAGIC&&this.startPanGraphics(e,t)}},{key:"selectFeature",value:function(e){var t=this;if(this.editOption.showSelectBox){this._clearEditGraphics(2);var r=e.geometry.extent,n=new d.default({view:this.view,layer:this.layer,sketchStyle:new p.default({fillStyle:this.sketchStyle._selectBoxStyle,isShowSegmentLength:!0,isShowArea:!0}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(n),n.addFeature([[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax]],void 0,void 0,this.sketchInnerLayer),this.sketchStage.selectBoxGraphics=[n.sketchStage.entityGraphic];var i=[];if(i=[{point:new c.Point({coordinates:[r.xmax,r.ymax],spatialReference:this._spatialReference}),direction:"ne"},{point:new c.Point({coordinates:[r.xmax,r.ymin],spatialReference:this._spatialReference}),direction:"se"},{point:new c.Point({coordinates:[r.xmin,r.ymin],spatialReference:this._spatialReference}),direction:"sw"},{point:new c.Point({coordinates:[r.xmin,r.ymax],spatialReference:this._spatialReference}),direction:"nw"}],this._sketchEditor&&this._sketchEditor._getCenterCoordinate){var o=[{point:new c.Point({coordinates:this._sketchEditor._getCenterCoordinate([r.xmax,r.ymax],[r.xmax,r.ymin]),spatialReference:this._spatialReference}),direction:"e",type:"midVertex"},{point:new c.Point({coordinates:this._sketchEditor._getCenterCoordinate([r.xmax,r.ymin],[r.xmin,r.ymin]),spatialReference:this._spatialReference}),direction:"s",type:"midVertex"},{point:new c.Point({coordinates:this._sketchEditor._getCenterCoordinate([r.xmin,r.ymin],[r.xmin,r.ymax]),spatialReference:this._spatialReference}),direction:"w",type:"midVertex"},{point:new c.Point({coordinates:this._sketchEditor._getCenterCoordinate([r.xmin,r.ymax],[r.xmax,r.ymax]),spatialReference:this._spatialReference}),direction:"n",type:"midVertex"}];i=i.concat(o)}var a=[],s=[];i.forEach(function(e){var r=new h.default({view:t.view,layer:t.layer,sketchStyle:new p.default({vertexStyle:t.sketchStyle._selectBoxVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t});t._drawTools.push(r),r.addFeature(e.point,t.sketchStage,{direction:e.direction,type:e.type},t.sketchInnerLayer),a.push(r),s.push(r.sketchStage.entityGraphic)}),this.sketchStage.selectBoxVertexGraphics=s,this._otherDrawTools?this._otherDrawTools.push(n):this._otherDrawTools=[n],this._otherDrawTools=this._otherDrawTools.concat(a),this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage),this._mapClickEvent||this._parent&&(!this._parent||this._parent._mapClickEvent)||(this._mapClickEvent=function(){t._preventFirstCall?t._preventFirstCall=void 0:(t.sketchStage.selectBoxGraphics.concat(t.sketchStage.selectBoxVertexGraphics).concat(t.sketchStage.vertexGraphics).concat(t.sketchStage.midVertexGraphics).forEach(function(e){t._removeFeatureFromLayer(e,t.sketchInnerLayer)}),t.view.off(u.ViewEventType.immediateClick,t._mapClickEvent),t.view._mapActionControl("drag-pan",!0),t._mapClickEvent=null,t.fire("selected",{isSelected:!1},self),t.sketchStage.selectBoxGraphics=[],t.sketchStage.selectBoxVertexGraphics=[],t.sketchStage.vertexGraphics=[],t.sketchStage.midVertexGraphics=[],t._editMode=u.SketchEditMode.NONE,t.view._mapActionControl("video-map-active",!1))},this._hitTestEventHandlers.push(this._mapClickEvent),this._preventFirstCall=!0,this.view.on(u.ViewEventType.immediateClick,this._mapClickEvent))}}},{key:"selectFeatureVertex",value:function(e){var t=this;this._clearEditGraphics(1);var r=[],n=[];e.geometry.coordinates.forEach(function(i,o){var a=new h.default({view:t.view,layer:t.layer,sketchStyle:new p.default({vertexStyle:t.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t}),s=new c.Point({coordinates:i,spatialReference:t._spatialReference});if(t._drawTools.push(a),a.addFeature(s,void 0,{vertexIndex:o}),r.push(a),t.sketchStage.vertexGraphics.push(a.sketchStage.entityGraphic),o>0){var l=new h.default({view:t.view,layer:t.layer,sketchStyle:new p.default({vertexStyle:t.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t});n.push(l);var u,f=e.geometry.coordinates[o-1];u=i.length>2?new c.Point({coordinates:[(i[0]+f[0])/2,(i[1]+f[1])/2,(i[2]+f[2])/2],spatialReference:t._spatialReference}):new c.Point({coordinates:[(i[0]+f[0])/2,(i[1]+f[1])/2],spatialReference:t._spatialReference}),t._drawTools.push(l),l.addFeature(u,void 0,{vertexIndex:o-1,type:"midVertex"}),t.sketchStage.midVertexGraphics.push(l.sketchStage.entityGraphic)}});var i=r.concat(n);this._otherDrawTools=this._otherDrawTools?this._otherDrawTools.concat(i):i,this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage)}},{key:"startPanGraphics",value:function(e,t){var r=this;this.view._mapActionControl("drag-pan",!1);var n=!1;this._startPan=!0;var i=t.mapPoint.coordinates[0],o=t.mapPoint.coordinates[1],a=null;a=u.Projection.project(new c.Point({coordinates:[i,o]}),this._spatialReference);var s=!0,l=setTimeout(function(){s=!1},200);this._parent&&this._parent._mapClickEvent&&this.view.off(u.ViewEventType.immediateClick,this._parent._mapClickEvent);var f=function(t){if(t&&t.x&&t.y&&!n&&r._startPan&&!r._editMode!==u.SketchEditMode.EDITGRAGIC&&!s){clearTimeout(null),n=!0;var i={x:t.x,y:t.y},o=r.view.toMap({x:i.x,y:i.y}),l=o.coordinates[0]-a.coordinates[0],f=o.coordinates[1]-a.coordinates[1];if(0!==l||0!==f){var h=[];e.geometry.coordinates[0].forEach(function(e){h.push(r.getPanCoordinates(e,l,f))});var d=new c.Polygon({coordinates:[h],spatialReference:r._spatialReference});a=o,r._dispatchEvent("pan",{deltaPosition:{x:l,y:f}},r),r.updateFeature(d,e),n=!1}else n=!1}},h=function e(){if(!r._editMode!==u.SketchEditMode.EDITGRAGIC&&r._startPan){if(s&&r._parent&&r._parent._editMode===u.SketchEditMode.EDITGRAGIC)return r._parent._editMode=u.SketchEditMode.EDITVERTEX,clearTimeout(l),r._parent.selectFeatureVertex(r._parent.sketchStage.entityGraphic),r._parent&&r._parent._mapClickEvent&&r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent),r._startPan=!1,r.view.off(u.ViewEventType.pointerMove,f),void r.view.off(u.ViewEventType.pointerUp,e);r._editMode=u.SketchEditMode.NONE,r._startPan=!1,r._enableMapDrag&&r._enableMapDrag(),r.view.off(u.ViewEventType.pointerMove,f),r.view.off(u.ViewEventType.pointerUp,e),r._parent&&r._parent.undoRedoManager&&r._parent.undoRedoManager.addProcess("update",r._parent.sketchStage),r._parent&&r._parent._mapClickEvent&&(r._parent._preventFirstCall=!0,r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent))}};this._hitTestEventHandlers.push(f),this._hitTestEventHandlers.push(h),this.view.on(u.ViewEventType.pointerUp,h),this.view.on(u.ViewEventType.pointerMove,f)}},{key:"_processEvent",value:function(e){"pan"===e.type?this._handlerPanEvent(e):"vertexScale"===e.type?this._handlerVertexScaleEvent(e):"midVertexScale"===e.type?this._handlerMidVertexScaleEvent(e):"vertexMove"===e.type?this._handlerVertexMoveEvent(e):"midVertexAdd"===e.type&&this._handlerMidVertexAddEvent(e)}},{key:"_handlerPanEvent",value:function(e){var t=this,r=[];this.sketchStage.entityGraphic.geometry.coordinates.forEach(function(n){r.push(t.getPanCoordinates(n,e.deltaPosition.x,e.deltaPosition.y))});var n=new c.LineString({coordinates:r,spatialReference:this._spatialReference});this.sketchStage.entityGraphic.geometry=n,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}},{key:"_handlerVertexScaleEvent",value:function(e){if("scale"===e.action){var t;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates));this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var i=this.getScaleCoordinates(this.sketchStage.entityGraphic.geometry.coordinates,e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t=new c.LineString({coordinates:i,spatialReference:this._spatialReference}),this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}else"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),this._resetSelectBoxDirection())}},{key:"_handlerMidVertexScaleEvent",value:function(e){var t;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates));this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var i=this.getMidScaleCoordinates(this.sketchStage.entityGraphic.geometry.coordinates,e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t=new c.LineString({coordinates:i,spatialReference:this._spatialReference}),this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),this._resetSelectBoxDirection())}},{key:"_resetSelectBoxDirection",value:function(){var e=this,t=this.sketchStage.entityGraphic.geometry.extent;this.sketchStage.selectBoxVertexGraphics.forEach(function(r){r.attributes&&("ne"===r.attributes.direction?r.geometry.coordinates=[t.xmax,t.ymax]:"se"===r.attributes.direction?r.geometry.coordinates=[t.xmax,t.ymin]:"sw"===r.attributes.direction?r.geometry.coordinates=[t.xmin,t.ymin]:"nw"===r.attributes.direction?r.geometry.coordinates=[t.xmin,t.ymax]:"e"===r.attributes.direction?r.geometry.coordinates=e._sketchEditor._getCenterCoordinate([t.xmax,t.ymax],[t.xmax,t.ymin]):"s"===r.attributes.direction?r.geometry.coordinates=e._sketchEditor._getCenterCoordinate([t.xmax,t.ymin],[t.xmin,t.ymin]):"w"===r.attributes.direction?r.geometry.coordinates=e._sketchEditor._getCenterCoordinate([t.xmin,t.ymin],[t.xmin,t.ymax]):"n"===r.attributes.direction&&(r.geometry.coordinates=e._sketchEditor._getCenterCoordinate([t.xmin,t.ymax],[t.xmax,t.ymax])))})}},{key:"_handlerVertexMoveEvent",value:function(e){this.sketchStage.currentVertexIndex=e.vertexIndex;var t=this.sketchStage.entityGraphic,r=t.geometry.coordinates;if(t.geometry.coordinates[e.vertexIndex]=e.movePoint.coordinates,t.geometry=new c.LineString({coordinates:t.geometry.coordinates,spatialReference:this._spatialReference}),this._otherDrawTools)if(0===e.vertexIndex){var n=this.sketchStage.midVertexGraphics[e.vertexIndex],i=r[e.vertexIndex],o=r[e.vertexIndex+1];n.geometry.coordinates=[(o[0]+i[0])/2,(o[1]+i[1])/2],n.geometry=new c.Point({coordinates:n.geometry.coordinates,spatialReference:this._spatialReference})}else if(e.vertexIndex===r.length-1){var a=this.sketchStage.midVertexGraphics[e.vertexIndex-1],s=r[e.vertexIndex-1],l=r[e.vertexIndex];a.geometry.coordinates=[(s[0]+l[0])/2,(s[1]+l[1])/2],a.geometry=new c.Point({coordinates:a.geometry.coordinates,spatialReference:this._spatialReference})}else{var u=this.sketchStage.midVertexGraphics[e.vertexIndex],f=this.sketchStage.midVertexGraphics[e.vertexIndex-1],h=r[e.vertexIndex-1],d=r[e.vertexIndex],p=r[e.vertexIndex+1];u.geometry.coordinates=[(p[0]+d[0])/2,(p[1]+d[1])/2],u.geometry=new c.Point({coordinates:u.geometry.coordinates,spatialReference:this._spatialReference}),f.geometry.coordinates=[(h[0]+d[0])/2,(h[1]+d[1])/2],f.geometry=new c.Point({coordinates:f.geometry.coordinates,spatialReference:this._spatialReference})}}},{key:"_handlerMidVertexAddEvent",value:function(e){var t=this;if("changeFeature"===e.action&&(this.sketchStage.entityGraphic.geometry.coordinates.splice(e.vertexIndex+1,0,e.point.coordinates),this.sketchStage.entityGraphic.geometry=new c.LineString({coordinates:this.sketchStage.entityGraphic.geometry.coordinates,spatialReference:this._spatialReference})),"moveMidVertex"===e.action&&(this.sketchStage.currentVertexIndex=e.vertexIndex,this.sketchStage.entityGraphic.geometry.coordinates[e.vertexIndex+1]=e.movePoint.coordinates,this.sketchStage.entityGraphic.geometry=new c.LineString({coordinates:this.sketchStage.entityGraphic.geometry.coordinates,spatialReference:this._spatialReference})),"addVertex"===e.action){var r=this.sketchStage.midVertexGraphics[e.vertexIndex].id.toString(),n=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(n),n.addFeature(e.point),this.sketchStage.vertexGraphics.splice(e.vertexIndex+1,0,n.sketchStage.entityGraphic);var i,o=this.sketchStage.entityGraphic.geometry.coordinates[e.vertexIndex],a=null;this._getHight&&(a=0),i=a?new c.Point({coordinates:[(o[0]+e.point.coordinates[0])/2,(o[1]+e.point.coordinates[1])/2,a],spatialReference:this._spatialReference}):new c.Point({coordinates:[(o[0]+e.point.coordinates[0])/2,(o[1]+e.point.coordinates[1])/2],spatialReference:this._spatialReference});var s=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(s),s.addFeature(i,void 0,{type:"midVertex"}),this.sketchStage.midVertexGraphics.splice(e.vertexIndex,1,s.sketchStage.entityGraphic);var l,u=this.sketchStage.entityGraphic.geometry.coordinates[e.vertexIndex+2],f=null;this._getHight&&(f=0),l=f?new c.Point({coordinates:[(u[0]+e.point.coordinates[0])/2,(u[1]+e.point.coordinates[1])/2,f],spatialReference:this._spatialReference}):new c.Point({coordinates:[(u[0]+e.point.coordinates[0])/2,(u[1]+e.point.coordinates[1])/2],spatialReference:this._spatialReference});var d=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(d),d.addFeature(l,void 0,{type:"midVertex"}),this.sketchStage.midVertexGraphics.splice(e.vertexIndex+1,0,d.sketchStage.entityGraphic),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools.forEach(function(e){e.sketchStage.entityGraphic.id===r&&t._removeFeatureFromMap(e.sketchStage.entityGraphic)}),this._otherDrawTools.push(n),this._otherDrawTools.push(s),this._otherDrawTools.push(d)}}},{key:"addMidVertex",value:function(e,t){var r=new h.default;r.addPoint(t),this.sketchStage.midVertexGraphics=r}},{key:"addVertex",value:function(e,t){if(--t>-1&&t<=this.sketchStage.midVertexGraphics.length+1){var r=[];if(t<=this.sketchStage.entityGraphic.geometry.coordinates.length-1){(r=this.sketchStage.entityGraphic.geometry.coordinates).splice(t,0,e.coordinates),this.sketchStage.entityGraphic.geometry=new c.LineString({coordinates:r,spatialReference:this._spatialReference});var n=void 0,i=void 0,o=this.sketchStage.entityGraphic.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var a=[[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin],[o.xmin,o.ymax],[(o.xmax+o.xmin)/2,o.ymax],[(o.xmax+o.xmin)/2,o.ymin],[o.xmax,(o.ymax+o.ymin)/2],[o.xmin,(o.ymax+o.ymin)/2]];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=a[t]})}if(this.sketchStage.vertexGraphics.length>0&&(n=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this}),this._drawTools.push(n),n.addFeatureByGeometry(e),this.sketchStage.vertexGraphics.splice(t,0,n.sketchStage.entityGraphic),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}})),this.sketchStage.midVertexGraphics.length>0){var s=-1,l=-1,u=null,f=null;if(0===t?(l=0,f=this.sketchStage.entityGraphic.geometry.coordinates[1]):t===this.sketchStage.midVertexGraphics.length+1?(l=this.sketchStage.midVertexGraphics.length-2,f=this.sketchStage.entityGraphic.geometry.coordinates[l]):(s=t-1,l=t+1,u=this.sketchStage.entityGraphic.geometry.coordinates[s],f=this.sketchStage.entityGraphic.geometry.coordinates[l]),s>-1){var d=new c.Point({coordinates:[(u[0]+e.coordinates[0])/2,(u[1]+e.coordinates[1])/2],spatialReference:this._spatialReference});this.sketchStage.midVertexGraphics[s].geometry.coordinates=d.coordinates}if(l>-1){var y=new c.Point({coordinates:[(f[0]+e.coordinates[0])/2,(f[1]+e.coordinates[1])/2],spatialReference:this._spatialReference});i=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this}),this._drawTools.push(i),i.addFeatureByGeometry(y,void 0,{type:"midVertex"}),this.sketchStage.midVertexGraphics.splice(t,0,i.sketchStage.entityGraphic)}this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}})}n&&this._otherDrawTools.push(n),i&&this._otherDrawTools.push(i),this.undoRedoManager.addProcess("update",this.sketchStage)}return null}}},{key:"updateVertex",value:function(e,t){var r=null;if(--t>-1){var n=this.sketchStage.entityGraphic.geometry.coordinates.length;if(t<n){var i=this.sketchStage.entityGraphic,o=i.geometry.coordinates;i.geometry.coordinates=o,this.currentVertexIndex=t,o[t]=e.coordinates,i.geometry=new c.LineString({coordinates:i.geometry.coordinates,spatialReference:this._spatialReference}),r=i.geometry,this.sketchStage.entityGraphic.geometry=r;var a=i.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var s=[[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin],[a.xmin,a.ymax],[(a.xmax+a.xmin)/2,a.ymax],[(a.xmax+a.xmin)/2,a.ymin],[a.xmax,(a.ymax+a.ymin)/2],[a.xmin,(a.ymax+a.ymin)/2]];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=s[t]})}if(this.sketchStage.vertexGraphics.length>0&&(this.sketchStage.vertexGraphics[t].geometry.coordinates=e.coordinates),this.sketchStage.midVertexGraphics.length>0){var l=o[t-1],u=o[t],f=o[t+1],h=-1,d=-1;if(0===t?h=t:t===n-1?d=t-1:(h=t,d=t-1),h>-1){var p=this.sketchStage.midVertexGraphics[h];p.geometry.coordinates=[(f[0]+u[0])/2,(f[1]+u[1])/2],p.geometry=new c.Point({coordinates:p.geometry.coordinates,spatialReference:this._spatialReference})}if(d>-1){var y=this.sketchStage.midVertexGraphics[d];y.geometry.coordinates=[(l[0]+u[0])/2,(l[1]+u[1])/2],y.geometry=new c.Point({coordinates:y.geometry.coordinates,spatialReference:this._spatialReference})}}}this.undoRedoManager.addProcess("update",this.sketchStage)}return r}},{key:"removeVertex",value:function(e){var t=null;if(--e>-1){var r=this.sketchStage.entityGraphic.geometry.coordinates.length;if(r>2&&e<r){var n=this.sketchStage.entityGraphic.geometry.coordinates;n.splice(e,1),t=new c.LineString({coordinates:n,spatialReference:this._spatialReference}),this.sketchStage.entityGraphic.geometry=t;var i=this.sketchStage.entityGraphic.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var o=[[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin],[i.xmin,i.ymax],[(i.xmax+i.xmin)/2,i.ymax],[(i.xmax+i.xmin)/2,i.ymin],[i.xmax,(i.ymax+i.ymin)/2],[i.xmin,(i.ymax+i.ymin)/2]];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=o[t]})}if(this.sketchStage.vertexGraphics.length>0){var a=this.sketchStage.vertexGraphics[e].id.toString();this._removeFeatureFromMap(this.sketchStage.vertexGraphics[e]),this.sketchStage.vertexGraphics.splice(e,1),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools=this._otherDrawTools.filter(function(e){if(e.sketchStage.entityGraphic.id!==a)return e})}if(this.sketchStage.midVertexGraphics.length>0){var s=[],l=-1,u=-1;0===e?u=0:e===r-1?u=e-1:(s=[(t.coordinates[e-1][0]+t.coordinates[e][0])/2,(t.coordinates[e-1][1]+t.coordinates[e][1])/2],l=e-1,u=e),l>-1&&(this.sketchStage.midVertexGraphics[l].geometry=new c.Point({coordinates:s,spatialReference:this._spatialReference}));var f=this.sketchStage.vertexGraphics[u].id.toString();this._removeFeatureFromMap(this.sketchStage.midVertexGraphics[u]),this.sketchStage.midVertexGraphics.splice(u,1),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools=this._otherDrawTools.filter(function(e){if(e.sketchStage.entityGraphic.id!==f)return e})}}this.undoRedoManager.addProcess("update",this.sketchStage)}return t}}]),t}(f.default);t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(10)),i=g(r(3)),o=g(r(0)),a=g(r(2)),s=g(r(4)),l=g(r(5)),u=r(8),c=r(9),f=g(r(43)),h=g(r(42)),d=g(r(60)),p=g(r(41)),y=r(1);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r.type="sketchFreehandPolygonDrawTool",r._initEvent(),r._drawTools=[r],r._otherDrawTools=[],r._currentMovePoint=void 0,r.vertexNum=0,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_initEvent",value:function(){this._processEvent=this._processEvent.bind(this),this.on("pan",this._processEvent),this.on("vertexScale",this._processEvent),this.on("midVertexScale",this._processEvent),this.on("vertexMove",this._processEvent),this.on("midVertexAdd",this._processEvent)}},{key:"drawFeature",value:function(){var e=this;this._editMode=u.SketchEditMode.DRAWING,this.view._mapActionControl("double-click-zoom",!1),this.view._mapActionControl("video-map-active",!0);var t=!1,r=!1,i=null,o=[],a=null,s=[];this.vertexNum=0;var l=null;this.cursorStyle=this.view.cursor,(0,y.isNull)(this.cursorStyle)&&(this.view.cursor="crosshair");var c=this._getInteractiveDom();this._setInitSnap(),this._fireStartDrawEvent();var f=function r(n){if(n&&n.x&&n.y){e._stopInitSnap(),clearTimeout(null);var o={x:n.x,y:n.y};if(!(a&&l&&o.x===a.x&&o.y===a.y&&(new Date).getTime()-l<200)){a=o,l=(new Date).getTime(),e._editMode=u.SketchEditMode.DRAWING;var c;c=e._snapPoint?e._snapPoint:e.view.toMap({x:o.x,y:o.y}),e.vertexNum++,1===e.vertexNum?(s=[c.coordinates],(i=e._getFeature()).geometry.coordinates=[[s[0],s[0],s[0],s[0]]],t=!1):2===e.vertexNum?s=[i.geometry.coordinates[0][0],i.geometry.coordinates[0][1]]:(s=i.geometry.coordinates[0].slice(0,i.geometry.coordinates[0].length-2)).push(c.coordinates),e.sketchStage.entityGraphic=i;var f=new h.default({view:e.view,layer:e.layer,_parent:e,sketchStyle:e.sketchStyle,elevationInfo:e.elevationInfo});f.addFeature(c,void 0,void 0,e.sketchInnerLayer),e._drawTools.push(f);var d=f.sketchStage.entityGraphic;e.sketchStage.vertexGraphics.push(d),i&&(t=!0),e.fire("drawn-vertex",{geometry:f.sketchStage.entityGraphic.geometry,feature:f.sketchStage.entityGraphic},self),e.undoRedoManager&&e.undoRedoManager.addProcess("add-vertex",e.sketchStage,e._editMode),e.view.off(u.ViewEventType.immediateClick,r)}}},d=!0,p=function(a){if(a&&a.x&&a.y&&t&&!r){clearTimeout(null),r=!0,i=e.sketchStage.entityGraphic,e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]);var l={x:a.x,y:a.y};o[o.length-1]=l;var u=e.view.toMap({x:l.x,y:l.y});1===e.vertexNum?s=[i.geometry.coordinates[0][0]]:2===e.vertexNum?(i.geometry.coordinates[0][2]=u.coordinates,s=i.geometry.coordinates[0].slice(0,i.geometry.coordinates[0].length-2)):s=i.geometry.coordinates[0].slice(0,i.geometry.coordinates[0].length-2),e.vertexNum>0&&(e._snapPoint=e.getSnapGraphics(u,[i.geometry.coordinates[0][0]])),e._snapPoint&&(u=e._snapPoint),e._currentMovePoint=u,1===e.vertexNum?(i.geometry.coordinates[0][1]=u.coordinates,i.geometry.coordinates[0][2]=u.coordinates,s=i.geometry.coordinates[0].slice(0,i.geometry.coordinates[0].length-2)):2===e.vertexNum?(i.geometry.coordinates[0][2]=u.coordinates,s=i.geometry.coordinates[0].slice(0,i.geometry.coordinates[0].length-1)):(i.geometry.coordinates[0].splice(i.geometry.coordinates[0].length-1,0,u.coordinates),s=i.geometry.coordinates[0].slice(0,i.geometry.coordinates[0].length-1)),e.vertexNum++,e.sketchStage.entityGraphic=i,i.geometry.coordinates=[JSON.parse((0,n.default)(i.geometry.coordinates[0]))],d&&(e._addFeatureToLayer(i,e.layer),d=!1),r=!1;var f=e._getInteractiveDom();c=c.concat(f),e._removeInteractiveStyle(f),e._fireDrawVertexEvent(i)}},g=function(){if(clearTimeout(null),clearTimeout(null),!t)return i=null,s=[],void(o=[]);i=e.sketchStage.entityGraphic,s=[],o=[],t=!1,e.vertexNum=0,e.stop(),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),e._editMode=u.SketchEditMode.NONE,e.view.cursor=e.cursorStyle,e._addInteractiveStyle(c),e.fire("drawn",{geometry:i.geometry,feature:i},self),e._fireStopDrawEvent(i),e.sketchStage.vertexGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.vertexGraphics=[],e._currentMovePoint=void 0,e.undoRedoManager._initDrawProcess(),setTimeout(function(){e.view._mapActionControl("double-click-zoom",!0),e.view._mapActionControl("video-map-active",!1)},0)};this._drawEventHandlers.push(f,p,g),this.view.on(u.ViewEventType.immediateClick,f),this.view.on(u.ViewEventType.pointerMove,p),this.view.on(u.ViewEventType.doubleClick,g)}},{key:"addFeature",value:function(e,t,r,n){var i;i=t&&t.fillStyle?t.fillStyle:this.sketchStyle._fillStyle;var o=this._getFeature(e,i);r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"addFeatureByGeometry",value:function(e,t,r,n){var i;i=t&&t.fillStyle?t.fillStyle:this.sketchStyle._fillStyle;var o=new u.Feature({geometry:e,symbol:i,elevationInfo:this.elevationInfo});r&&(o.attributes=r),this.sketchStage.entityGraphic=o,this._addFeatureToLayer(o,n)}},{key:"_getFeature",value:function(e){e||(e=[[0,0],[0,0],[0,0],[0,0]]);var t=new c.Polygon({coordinates:[e],spatialReference:this._spatialReference}),r=this.sketchStyle.fillStyle.clone(),n=new u.Feature({geometry:t,symbol:r,elevationInfo:this.elevationInfo});return n.isShowArea=this.sketchStyle.isShowArea,n.isShowArea&&(n._textStyle=this.sketchStyle.textStyle),n}},{key:"hitTestFeature",value:function(e,t){this.view._mapActionControl("video-map-active",!0),!this._parent&&this.editOption.showSelectBox&&(this._editMode===u.SketchEditMode.NONE?this._editMode=u.SketchEditMode.EDITGRAGIC:this._editMode===u.SketchEditMode.EDITVERTEX&&(this.view.off(u.ViewEventType.immediateClick,this._mapClickEvent),this._mapClickEvent=null,this._editMode=u.SketchEditMode.EDITGRAGIC),this.selectFeature(e)),this._parent&&this._parent._editMode===u.SketchEditMode.EDITGRAGIC&&this.startPanGraphics(e,t)}},{key:"selectFeature",value:function(e){var t=this;if(this.editOption.showSelectBox){this._clearEditGraphics(2);var r=e.geometry.extent,n=new d.default({view:this.view,layer:this.layer,sketchStyle:new p.default({fillStyle:this.sketchStyle._selectBoxStyle,isShowSegmentLength:!0,isShowArea:!0}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(n),n.addFeature([[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax]],void 0,void 0,this.sketchInnerLayer),this.sketchStage.selectBoxGraphics=[n.sketchStage.entityGraphic];var i=[];if(i=[{point:new c.Point({coordinates:[r.xmax,r.ymax],spatialReference:this._spatialReference}),direction:"ne"},{point:new c.Point({coordinates:[r.xmax,r.ymin],spatialReference:this._spatialReference}),direction:"se"},{point:new c.Point({coordinates:[r.xmin,r.ymin],spatialReference:this._spatialReference}),direction:"sw"},{point:new c.Point({coordinates:[r.xmin,r.ymax],spatialReference:this._spatialReference}),direction:"nw"}],this._sketchEditor&&this._sketchEditor._getCenterCoordinate){var o=[{point:new c.Point({coordinates:this._sketchEditor._getCenterCoordinate([r.xmax,r.ymax],[r.xmax,r.ymin]),spatialReference:this._spatialReference}),direction:"e",type:"midVertex"},{point:new c.Point({coordinates:this._sketchEditor._getCenterCoordinate([r.xmax,r.ymin],[r.xmin,r.ymin]),spatialReference:this._spatialReference}),direction:"s",type:"midVertex"},{point:new c.Point({coordinates:this._sketchEditor._getCenterCoordinate([r.xmin,r.ymin],[r.xmin,r.ymax]),spatialReference:this._spatialReference}),direction:"w",type:"midVertex"},{point:new c.Point({coordinates:this._sketchEditor._getCenterCoordinate([r.xmin,r.ymax],[r.xmax,r.ymax]),spatialReference:this._spatialReference}),direction:"n",type:"midVertex"}];i=i.concat(o)}var a=[],s=[];i.forEach(function(e){var r=new h.default({view:t.view,layer:t.layer,sketchStyle:new p.default({vertexStyle:t.sketchStyle._selectBoxVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:t.elevationInfo,_parent:t});t._drawTools.push(r),r.addFeature(e.point,t.sketchStage,{direction:e.direction,type:e.type},t.sketchInnerLayer),a.push(r),s.push(r.sketchStage.entityGraphic)}),this.sketchStage.selectBoxVertexGraphics=s,this._otherDrawTools?this._otherDrawTools.push(n):this._otherDrawTools=[n],this._otherDrawTools=this._otherDrawTools.concat(a),this.undoRedoManager&&this.undoRedoManager.addProcess("add",this.sketchStage,this._editMode),this._mapClickEvent||this._parent&&(!this._parent||this._parent._mapClickEvent)||(this._mapClickEvent=function(){t._preventFirstCall?t._preventFirstCall=void 0:(t.sketchStage.selectBoxGraphics.concat(t.sketchStage.selectBoxVertexGraphics).concat(t.sketchStage.vertexGraphics).concat(t.sketchStage.midVertexGraphics).forEach(function(e){t._removeFeatureFromLayer(e,t.sketchInnerLayer)}),t.view.off(u.ViewEventType.immediateClick,t._mapClickEvent),t.view._mapActionControl("drag-pan",!0),t._mapClickEvent=null,t.fire("selected",{isSelected:!1},self),t.sketchStage.selectBoxGraphics=[],t.sketchStage.selectBoxVertexGraphics=[],t.sketchStage.vertexGraphics=[],t.sketchStage.midVertexGraphics=[],t._editMode=u.SketchEditMode.NONE,t.view._mapActionControl("video-map-active",!1))},this._hitTestEventHandlers.push(this._mapClickEvent),this._preventFirstCall=!0,this.view.on(u.ViewEventType.immediateClick,this._mapClickEvent))}}},{key:"startPanGraphics",value:function(e,t){var r=this;this.view._mapActionControl("drag-pan",!1);var n=!1;this._startPan=!0;var i=null;i=t.mapPoint;var o=!0;setTimeout(function(){o=!1},200),this._parent&&this._parent._mapClickEvent&&this.view.off(u.ViewEventType.immediateClick,this._parent._mapClickEvent);var a=function(t){if(t&&t.x&&t.y&&!n&&r._startPan&&!r._editMode!==u.SketchEditMode.EDITGRAGIC&&!o){clearTimeout(null),n=!0;var a={x:t.x,y:t.y},s=r.view.toMap({x:a.x,y:a.y}),l=s.coordinates[0]-i.coordinates[0],f=s.coordinates[1]-i.coordinates[1];if(0!==l||0!==f){var h=[];e.geometry.coordinates[0].forEach(function(e){h.push(r.getPanCoordinates(e,l,f))});var d=new c.Polygon({coordinates:[h],spatialReference:r._spatialReference});i=s,r._dispatchEvent("pan",{deltaPosition:{x:l,y:f}},r),r.updateFeature(d,e),n=!1}else n=!1}},s=function e(){!r._editMode!==u.SketchEditMode.EDITGRAGIC&&r._startPan&&(r._editMode=u.SketchEditMode.NONE,r._startPan=!1,r.view.off(u.ViewEventType.pointerMove,a),r.view.off(u.ViewEventType.pointerUp,e),r._parent&&r._parent.undoRedoManager&&r._parent.undoRedoManager.addProcess("update",r._parent.sketchStage,r._editMode),r._parent&&r._parent._mapClickEvent&&(r._parent._preventFirstCall=!0,r.view.on(u.ViewEventType.immediateClick,r._parent._mapClickEvent)),r.view._mapActionControl("drag-pan",!0))};this._hitTestEventHandlers.push(a),this._hitTestEventHandlers.push(s),this.view.on(u.ViewEventType.pointerUp,s),this.view.on(u.ViewEventType.pointerMove,a)}},{key:"_processEvent",value:function(e){"pan"===e.type?this._handlerPanEvent(e):"vertexScale"===e.type?this._handlerVertexScaleEvent(e):"midVertexScale"===e.type?this._handlerMidVertexScaleEvent(e):"circleVertexScale"===e.type?this._handlerCircleVertexScaleEvent(e):"vertexMove"===e.type?this._handlerVertexMoveEvent(e):"midVertexAdd"===e.type&&this._handlerMidVertexAddEvent(e)}},{key:"_handlerPanEvent",value:function(e){var t=this,r=[];this.sketchStage.entityGraphic.geometry.coordinates[0].forEach(function(n){r.push(t.getPanCoordinates(n,e.deltaPosition.x,e.deltaPosition.y))});var n=new c.Polygon({coordinates:[r],spatialReference:this._spatialReference});this.sketchStage.entityGraphic.geometry=n,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}},{key:"_handlerVertexScaleEvent",value:function(e){if("scale"===e.action){var t;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates[0]));this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var i=this.getScaleCoordinates(this.sketchStage.entityGraphic.geometry.coordinates[0],e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t=new c.Polygon({coordinates:[i],spatialReference:this._spatialReference}),this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)})}"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),this._resetSelectBoxDirection())}},{key:"_handlerMidVertexScaleEvent",value:function(e){var t;if(!this.sketchStage.entityGraphic.attributes.lastCoordinates){var r=JSON.parse((0,n.default)(this.sketchStage.entityGraphic.geometry.coordinates[0]));this.sketchStage.entityGraphic.attributes.lastCoordinates=r}var i=this.getMidScaleCoordinates(this.sketchStage.entityGraphic.geometry.coordinates[0],e.direction,e.extent,e.startPoint,e.movePoint,this.sketchStage.entityGraphic.attributes.lastCoordinates);t=new c.Polygon({coordinates:[i],spatialReference:this._spatialReference}),this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),this._resetSelectBoxDirection())}},{key:"_resetSelectBoxDirection",value:function(){var e=this,t=this.sketchStage.entityGraphic.geometry.extent;this.sketchStage.selectBoxVertexGraphics.forEach(function(r){r.attributes&&("ne"===r.attributes.direction?r.geometry.coordinates=[t.xmax,t.ymax]:"se"===r.attributes.direction?r.geometry.coordinates=[t.xmax,t.ymin]:"sw"===r.attributes.direction?r.geometry.coordinates=[t.xmin,t.ymin]:"nw"===r.attributes.direction?r.geometry.coordinates=[t.xmin,t.ymax]:"e"===r.attributes.direction?r.geometry.coordinates=e._sketchEditor._getCenterCoordinate([t.xmax,t.ymax],[t.xmax,t.ymin]):"s"===r.attributes.direction?r.geometry.coordinates=e._sketchEditor._getCenterCoordinate([t.xmax,t.ymin],[t.xmin,t.ymin]):"w"===r.attributes.direction?r.geometry.coordinates=e._sketchEditor._getCenterCoordinate([t.xmin,t.ymin],[t.xmin,t.ymax]):"n"===r.attributes.direction&&(r.geometry.coordinates=e._sketchEditor._getCenterCoordinate([t.xmin,t.ymax],[t.xmax,t.ymax])))})}},{key:"_handlerCircleVertexScaleEvent",value:function(e){if(this._parent&&this._parent.sketchStage.entityGraphic){var t,r=this._parent.sketchStage.entityGraphic.geometry.extent,n=[[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax]];(t=new c.Polygon({coordinates:[[[0,0],[0,0],[0,0],[0,0]]],spatialReference:this._spatialReference})).coordinates=[n],this.sketchStage.entityGraphic.geometry=t,this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}),"stop"===e.action&&(this.sketchStage.entityGraphic.attributes.lastCoordinates&&(this.sketchStage.entityGraphic.attributes.lastCoordinates=void 0),this._otherDrawTools&&this._otherDrawTools.forEach(function(t){t._processEvent(e)}))}}},{key:"_handlerVertexMoveEvent",value:function(e){this.sketchStage.currentVertexIndex=e.vertexIndex;var t=this.sketchStage.entityGraphic,r=t.geometry.coordinates[0];if(t.geometry.coordinates[0][e.vertexIndex]=e.movePoint.coordinates,t.geometry.coordinates[0].length-1===e.vertexIndex?t.geometry.coordinates[0][0]=e.movePoint.coordinates:0===e.vertexIndex&&(t.geometry.coordinates[0][t.geometry.coordinates[0].length-1]=e.movePoint.coordinates),t.geometry=new c.Polygon({coordinates:t.geometry.coordinates,spatialReference:this._spatialReference}),this._otherDrawTools){var n=e.vertexIndex,i=0===n?n-1+this.sketchStage.midVertexGraphics.length:n-1,o=n===this.sketchStage.midVertexGraphics.length-1?0:n+1,a=this.sketchStage.midVertexGraphics[n],s=this.sketchStage.midVertexGraphics[i],l=r[i],u=r[n],f=r[o];a.geometry.coordinates=[(f[0]+u[0])/2,(f[1]+u[1])/2],a.geometry=new c.Point({coordinates:a.geometry.coordinates,spatialReference:this._spatialReference}),s.geometry.coordinates=[(l[0]+u[0])/2,(l[1]+u[1])/2],s.geometry=new c.Point({coordinates:s.geometry.coordinates,spatialReference:this._spatialReference})}}},{key:"_handlerMidVertexAddEvent",value:function(e){var t=this;if("changeFeature"===e.action&&(this.sketchStage.entityGraphic.geometry.coordinates[0].splice(e.vertexIndex+1,0,e.point.coordinates),this.sketchStage.entityGraphic.geometry=new c.Polygon({coordinates:[this.sketchStage.entityGraphic.geometry.coordinates[0]],spatialReference:this._spatialReference})),"moveMidVertex"===e.action&&(this.sketchStage.currentVertexIndex=e.vertexIndex,this.sketchStage.entityGraphic.geometry.coordinates[0][e.vertexIndex+1]=e.movePoint.coordinates,this.sketchStage.entityGraphic.geometry=new c.Polygon({coordinates:this.sketchStage.entityGraphic.geometry.coordinates,spatialReference:this._spatialReference})),"addVertex"===e.action){var r=this.sketchStage.midVertexGraphics[e.vertexIndex].id.toString(),n=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(n),n.addFeature(e.point),this.sketchStage.vertexGraphics.splice(e.vertexIndex+1,0,n.sketchStage.entityGraphic);var i,o=this.sketchStage.entityGraphic.geometry.coordinates[0][e.vertexIndex],a=null;this._getHight&&(a=0),i=a?new c.Point({coordinates:[(o[0]+e.point.coordinates[0])/2,(o[1]+e.point.coordinates[1])/2,a],spatialReference:this._spatialReference}):new c.Point({coordinates:[(o[0]+e.point.coordinates[0])/2,(o[1]+e.point.coordinates[1])/2],spatialReference:this._spatialReference});var s=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(s),s.addFeature(i,void 0,{type:"midVertex"}),this.sketchStage.midVertexGraphics.splice(e.vertexIndex,1,s.sketchStage.entityGraphic);var l,u=this.sketchStage.entityGraphic.geometry.coordinates[0][e.vertexIndex+2],f=null;this._getHight&&(f=0),l=f?new c.Point({coordinates:[(u[0]+e.point.coordinates[0])/2,(u[1]+e.point.coordinates[1])/2,f],spatialReference:this._spatialReference}):new c.Point({coordinates:[(u[0]+e.point.coordinates[0])/2,(u[1]+e.point.coordinates[1])/2],spatialReference:this._spatialReference});var d=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this});this._drawTools.push(d),d.addFeature(l,void 0,{type:"midVertex"}),this.sketchStage.midVertexGraphics.splice(e.vertexIndex+1,0,d.sketchStage.entityGraphic),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools.forEach(function(e){e.sketchStage.entityGraphic.id===r&&t._removeFeatureFromMap(e.sketchStage.entityGraphic)}),this._otherDrawTools.push(n),this._otherDrawTools.push(s),this._otherDrawTools.push(d)}}},{key:"addMidVertex",value:function(e,t){var r=new h.default;r.addPoint(t),this.sketchStage.midVertexGraphics=r}},{key:"addVertex",value:function(e,t){var r=null;if(--t>-1){var n=[];if(t<this.sketchStage.entityGraphic.geometry.coordinates[0].length-1){(n=this.sketchStage.entityGraphic.geometry.coordinates[0]).splice(t,0,e.coordinates),0===t?n[n.length-1]=e.coordinates:t===n.length-1&&n.splice(0,0,e.coordinates),this.sketchStage.entityGraphic.geometry.coordinates=[n],r=this.sketchStage.entityGraphic.geometry;var i=void 0,o=void 0,a=this.sketchStage.entityGraphic.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var s=[[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin],[a.xmin,a.ymax],[(a.xmax+a.xmin)/2,a.ymax],[(a.xmax+a.xmin)/2,a.ymin],[a.xmax,(a.ymax+a.ymin)/2],[a.xmin,(a.ymax+a.ymin)/2]];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=s[t]})}if(this.sketchStage.vertexGraphics.length>0&&(i=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this}),this._drawTools.push(i),i.addFeatureByGeometry(e),this.sketchStage.vertexGraphics.splice(t,0,i.sketchStage.entityGraphic),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}})),this.sketchStage.midVertexGraphics.length>0){var l=-1,u=-1,f=null,d=null;0===t?(u=0,l=this.sketchStage.midVertexGraphics.length-1,f=this.sketchStage.entityGraphic.geometry.coordinates[0][this.sketchStage.entityGraphic.geometry.coordinates[0].length-2],d=this.sketchStage.entityGraphic.geometry.coordinates[0][1]):(l=t-1,u=t+1,f=this.sketchStage.entityGraphic.geometry.coordinates[0][l],d=this.sketchStage.entityGraphic.geometry.coordinates[0][u]);var y=new c.Point({coordinates:[(f[0]+e.coordinates[0])/2,(f[1]+e.coordinates[1])/2],spatialReference:this._spatialReference});this.sketchStage.midVertexGraphics[l].geometry.coordinates=y.coordinates;var g=new c.Point({coordinates:[(d[0]+e.coordinates[0])/2,(d[1]+e.coordinates[1])/2],spatialReference:this._spatialReference});o=new h.default({view:this.view,layer:this.layer,sketchStyle:new p.default({vertexStyle:this.sketchStyle._selectMidVertexStyle}),editOption:{showSelectBox:!1,_hitTestMode:1},elevationInfo:this.elevationInfo,_parent:this}),this._drawTools.push(o),o.addFeatureByGeometry(g,void 0,{type:"midVertex"}),this.sketchStage.midVertexGraphics.splice(t,0,o.sketchStage.entityGraphic),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}})}i&&this._otherDrawTools.push(i),o&&this._otherDrawTools.push(o),this.undoRedoManager.addProcess("update",this.sketchStage,this._editMode)}return r}}},{key:"updateVertex",value:function(e,t){var r=null;if(--t>-1){if(t<this.sketchStage.entityGraphic.geometry.coordinates[0].length-1){var n=this.sketchStage.entityGraphic,i=n.geometry.coordinates[0];n.geometry.coordinates=[i],this.currentVertexIndex=t,i[t]=e.coordinates,i.length-1===t?i[0]=e.coordinates:0===t&&(i[i.length-1]=e.coordinates),n.geometry=new c.Polygon({coordinates:n.geometry.coordinates,spatialReference:this._spatialReference}),r=n.geometry;var o=n.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var a=[[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin],[o.xmin,o.ymax],[(o.xmax+o.xmin)/2,o.ymax],[(o.xmax+o.xmin)/2,o.ymin],[o.xmax,(o.ymax+o.ymin)/2],[o.xmin,(o.ymax+o.ymin)/2]];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=a[t]})}if(this.sketchStage.vertexGraphics.length>0&&(this.sketchStage.vertexGraphics[t].geometry.coordinates=e.coordinates),this.sketchStage.midVertexGraphics.length>0){var s=t,l=0===s?s-1+this.sketchStage.midVertexGraphics.length:s-1,u=s===this.sketchStage.midVertexGraphics.length-1?0:s+1,f=this.sketchStage.midVertexGraphics[s],h=this.sketchStage.midVertexGraphics[l],d=i[l],p=i[s],y=i[u];f.geometry.coordinates=[(y[0]+p[0])/2,(y[1]+p[1])/2],f.geometry=new c.Point({coordinates:f.geometry.coordinates,spatialReference:this._spatialReference}),h.geometry.coordinates=[(d[0]+p[0])/2,(d[1]+p[1])/2],h.geometry=new c.Point({coordinates:h.geometry.coordinates,spatialReference:this._spatialReference})}}this.undoRedoManager.addProcess("update",this.sketchStage,this._editMode)}return r}},{key:"removeVertex",value:function(e){var t=null;if(--e>-1){var r=this.sketchStage.entityGraphic.geometry.coordinates[0].length-1;if(r>3&&e<r){var n=this.sketchStage.entityGraphic.geometry.coordinates[0];n.splice(e,1),0===e&&n.splice(n.length-1,1,n[0]),t=new c.Polygon({coordinates:[n],spatialReference:this._spatialReference}),this.sketchStage.entityGraphic.geometry=t;var i=this.sketchStage.entityGraphic.geometry.extent;if(this.sketchStage.selectBoxGraphics.length>0&&this.sketchStage.selectBoxGraphics.forEach(function(e){e.geometry.coordinates=[[[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax]]]}),this.sketchStage.selectBoxVertexGraphics.length>0){var o=[[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin],[i.xmin,i.ymax],[(i.xmax+i.xmin)/2,i.ymax],[(i.xmax+i.xmin)/2,i.ymin],[i.xmax,(i.ymax+i.ymin)/2],[i.xmin,(i.ymax+i.ymin)/2]];this.sketchStage.selectBoxVertexGraphics.forEach(function(e,t){e.geometry.coordinates=o[t]})}if(this.sketchStage.vertexGraphics.length>0){var a=this.sketchStage.vertexGraphics[e].id.toString();this._removeFeatureFromMap(this.sketchStage.vertexGraphics[e]),this.sketchStage.vertexGraphics.splice(e,1),this.sketchStage.vertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools=this._otherDrawTools.filter(function(e){if(e.sketchStage.entityGraphic.id!==a)return e})}if(this.sketchStage.midVertexGraphics.length>0){var s=[],l=-1;0===e?(s=[(t.coordinates[0][t.coordinates[0].length-2][0]+t.coordinates[0][e][0])/2,(t.coordinates[0][t.coordinates[0].length-2][1]+t.coordinates[0][e][1])/2],l=this.sketchStage.midVertexGraphics.length-1):(s=[(t.coordinates[0][e-1][0]+t.coordinates[0][e][0])/2,(t.coordinates[0][e-1][1]+t.coordinates[0][e][1])/2],l=e-1),this.sketchStage.midVertexGraphics[l].geometry=new c.Point({coordinates:s,spatialReference:this._spatialReference});var u=this.sketchStage.vertexGraphics[e].id.toString();this._removeFeatureFromMap(this.sketchStage.midVertexGraphics[e]),this.sketchStage.midVertexGraphics.splice(e,1),this.sketchStage.midVertexGraphics.forEach(function(e,t){e.attributes?e.attributes.vertexIndex=t:e.attributes={vertexIndex:t}}),this._otherDrawTools=this._otherDrawTools.filter(function(e){if(e.sketchStage.entityGraphic.id!==u)return e})}}this.undoRedoManager.addProcess("update",this.sketchStage,this._editMode)}return t}}]),t}(f.default);t.default=v},function(e,t,r){"use strict";r.r(t);var n=1,i=2,o=3,a=484813681109536e-20,s=Math.PI/2,l=.16666666666666666,u=.04722222222222222,c=.022156084656084655,f=1e-10,h=.017453292519943295,d=57.29577951308232,p=Math.PI/4,y=2*Math.PI,g=3.14159265359,v={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},m={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},_=/[\s_\-\/\(\)]/g;function S(e,t){if(e[t])return e[t];for(var r,n=Object.keys(e),i=t.toLowerCase().replace(_,""),o=-1;++o<n.length;)if((r=n[o]).toLowerCase().replace(_,"")===i)return e[r]}var x=function(e){var t,r,n,i={},o=e.split("+").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,t){var r=t.split("=");return r.push(!0),e[r[0].toLowerCase()]=r[1],e},{}),a={proj:"projName",datum:"datumCode",rf:function(e){i.rf=parseFloat(e)},lat_0:function(e){i.lat0=e*h},lat_1:function(e){i.lat1=e*h},lat_2:function(e){i.lat2=e*h},lat_ts:function(e){i.lat_ts=e*h},lon_0:function(e){i.long0=e*h},lon_1:function(e){i.long1=e*h},lon_2:function(e){i.long2=e*h},alpha:function(e){i.alpha=parseFloat(e)*h},gamma:function(e){i.rectified_grid_angle=parseFloat(e)},lonc:function(e){i.longc=e*h},x_0:function(e){i.x0=parseFloat(e)},y_0:function(e){i.y0=parseFloat(e)},k_0:function(e){i.k0=parseFloat(e)},k:function(e){i.k0=parseFloat(e)},a:function(e){i.a=parseFloat(e)},b:function(e){i.b=parseFloat(e)},r_a:function(){i.R_A=!0},zone:function(e){i.zone=parseInt(e,10)},south:function(){i.utmSouth=!0},towgs84:function(e){i.datum_params=e.split(",").map(function(e){return parseFloat(e)})},to_meter:function(e){i.to_meter=parseFloat(e)},units:function(e){i.units=e;var t=S(m,e);t&&(i.to_meter=t.to_meter)},from_greenwich:function(e){i.from_greenwich=e*h},pm:function(e){var t=S(v,e);i.from_greenwich=(t||parseFloat(e))*h},nadgrids:function(e){"@null"===e?i.datumCode="none":i.nadgrids=e},axis:function(e){3===e.length&&-1!=="ewnsud".indexOf(e.substr(0,1))&&-1!=="ewnsud".indexOf(e.substr(1,1))&&-1!=="ewnsud".indexOf(e.substr(2,1))&&(i.axis=e)},approx:function(){i.approx=!0}};for(t in o)r=o[t],t in a?"function"==typeof(n=a[t])?n(r):i[n]=r:i[t]=r;return"string"==typeof i.datumCode&&"WGS84"!==i.datumCode&&(i.datumCode=i.datumCode.toLowerCase()),i},b=1,w=/\s/,k=/[A-Za-z]/,M=/[A-Za-z84_]/,E=/[,\]]/,I=/[\d\.E\-\+]/;function T(e){if("string"!=typeof e)throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=b}function L(e,t,r){Array.isArray(t)&&(r.unshift(t),t=null);var n=t?{}:e,i=r.reduce(function(e,t){return P(t,e),e},n);t&&(e[t]=i)}function P(e,t){if(Array.isArray(e)){var r=e.shift();if("PARAMETER"===r&&(r=e.shift()),1===e.length)return Array.isArray(e[0])?(t[r]={},void P(e[0],t[r])):void(t[r]=e[0]);if(e.length)if("TOWGS84"!==r){if("AXIS"===r)return r in t||(t[r]=[]),void t[r].push(e);var n;switch(Array.isArray(r)||(t[r]={}),r){case"UNIT":case"PRIMEM":case"VERT_DATUM":return t[r]={name:e[0].toLowerCase(),convert:e[1]},void(3===e.length&&P(e[2],t[r]));case"SPHEROID":case"ELLIPSOID":return t[r]={name:e[0],a:e[1],rf:e[2]},void(4===e.length&&P(e[3],t[r]));case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":return e[0]=["name",e[0]],void L(t,r,e);case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":return e[0]=["name",e[0]],L(t,r,e),void(t[r].type=r);default:for(n=-1;++n<e.length;)if(!Array.isArray(e[n]))return P(e,t[r]);return L(t,r,e)}}else t[r]=e;else t[r]=!0}else t[e]=!0}T.prototype.readCharicter=function(){var e=this.text[this.place++];if(4!==this.state)for(;w.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case b:return this.neutral(e);case 2:return this.keyword(e);case 4:return this.quoted(e);case 5:return this.afterquote(e);case 3:return this.number(e);case-1:return}},T.prototype.afterquote=function(e){if('"'===e)return this.word+='"',void(this.state=4);if(E.test(e))return this.word=this.word.trim(),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in afterquote yet, index '+this.place)},T.prototype.afterItem=function(e){return","===e?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=b)):"]"===e?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=b,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},T.prototype.number=function(e){if(!I.test(e)){if(E.test(e))return this.word=parseFloat(this.word),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in number yet, index '+this.place)}this.word+=e},T.prototype.quoted=function(e){'"'!==e?this.word+=e:this.state=5},T.prototype.keyword=function(e){if(M.test(e))this.word+=e;else{if("["===e){var t=[];return t.push(this.word),this.level++,null===this.root?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,void(this.state=b)}if(!E.test(e))throw new Error("havn't handled \""+e+'" in keyword yet, index '+this.place);this.afterItem(e)}},T.prototype.neutral=function(e){if(k.test(e))return this.word=e,void(this.state=2);if('"'===e)return this.word="",void(this.state=4);if(I.test(e))return this.word=e,void(this.state=3);if(!E.test(e))throw new Error("havn't handled \""+e+'" in neutral yet, index '+this.place);this.afterItem(e)},T.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var C=.017453292519943295,N=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function O(e){return e*C}function R(e){if(e.AUTHORITY){var t=Object.keys(e.AUTHORITY)[0];t&&t in e.AUTHORITY&&(e.title=t+":"+e.AUTHORITY[t])}if("GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):"object"==typeof e.PROJECTION?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var r="",n=0,i=e.AXIS.length;n<i;++n){var o=[e.AXIS[n][0].toLowerCase(),e.AXIS[n][1].toLowerCase()];-1!==o[0].indexOf("north")||("y"===o[0]||"lat"===o[0])&&"north"===o[1]?r+="n":-1!==o[0].indexOf("south")||("y"===o[0]||"lat"===o[0])&&"south"===o[1]?r+="s":-1!==o[0].indexOf("east")||("x"===o[0]||"lon"===o[0])&&"east"===o[1]?r+="e":-1===o[0].indexOf("west")&&("x"!==o[0]&&"lon"!==o[0]||"west"!==o[1])||(r+="w")}2===r.length&&(r+="u"),3===r.length&&(e.axis=r)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var a=e.GEOGCS;function s(t){return t*(e.to_meter||1)}"GEOGCS"===e.type&&(a=e),a&&(a.DATUM?e.datumCode=a.DATUM.name.toLowerCase():e.datumCode=a.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),"new_zealand_1949"===e.datumCode&&(e.datumCode="nzgd49"),"wgs_1984"!==e.datumCode&&"world_geodetic_system_1984"!==e.datumCode||("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"belge_1972"===e.datumCode&&(e.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(e.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=a.DATUM.SPHEROID.a,e.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(e.datum_params=a.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",O],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",O],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",O],["lat0","latitude_of_origin",O],["lat0","standard_parallel_1",O],["lat1","standard_parallel_1",O],["lat2","standard_parallel_2",O],["azimuth","Azimuth"],["alpha","azimuth",O],["srsCode","name"]].forEach(function(t){return function(e,t){var r=t[0],n=t[1];!(r in e)&&n in e&&(e[r]=e[n],3===t.length&&(e[r]=t[2](e[r])))}(e,t)}),e.long0||!e.longc||"Albers_Conic_Equal_Area"!==e.projName&&"Lambert_Azimuthal_Equal_Area"!==e.projName||(e.long0=e.longc),e.lat_ts||!e.lat1||"Stereographic_South_Pole"!==e.projName&&"Polar Stereographic (variant B)"!==e.projName?!e.lat_ts&&e.lat0&&"Polar_Stereographic"===e.projName&&(e.lat_ts=e.lat0,e.lat0=O(e.lat0>0?90:-90)):(e.lat0=O(e.lat1>0?90:-90),e.lat_ts=e.lat1)}var V=function(e){var t=function(e){return new T(e).output()}(e),r=t[0],n={};return P(t,n),function e(t){for(var r=Object.keys(t),n=0,i=r.length;n<i;++n){var o=r[n];-1!==N.indexOf(o)&&R(t[o]),"object"==typeof t[o]&&e(t[o])}}(n),n[r]};function G(e){var t=this;if(2===arguments.length){var r=arguments[1];"string"==typeof r?"+"===r.charAt(0)?G[e]=x(arguments[1]):G[e]=V(arguments[1]):G[e]=r}else if(1===arguments.length){if(Array.isArray(e))return e.map(function(e){Array.isArray(e)?G.apply(t,e):G(e)});if("string"==typeof e){if(e in G)return G[e]}else"EPSG"in e?G["EPSG:"+e.EPSG]=e:"ESRI"in e?G["ESRI:"+e.ESRI]=e:"IAU2000"in e?G["IAU2000:"+e.IAU2000]=e:console.log(e);return}}!function(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}(G);var A=G,F=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],D=["3857","900913","3785","102113"],j=function(e){if(!function(e){return"string"==typeof e}(e))return e;if(function(e){return e in A}(e))return A[e];if(function(e){return F.some(function(t){return e.indexOf(t)>-1})}(e)){var t=V(e);if(function(e){var t=S(e,"authority");if(t){var r=S(t,"epsg");return r&&D.indexOf(r)>-1}}(t))return A["EPSG:3857"];var r=function(e){var t=S(e,"extension");if(t)return S(t,"proj4")}(t);return r?x(r):t}return function(e){return"+"===e[0]}(e)?x(e):void 0},B=function(e,t){var r,n;if(e=e||{},!t)return e;for(n in t)void 0!==(r=t[n])&&(e[n]=r);return e},q=function(e,t,r){var n=e*t;return r/Math.sqrt(1-n*n)},U=function(e){return e<0?-1:1},J=function(e){return Math.abs(e)<=g?e:e-U(e)*y},z=function(e,t,r){var n=e*r,i=.5*e;return n=Math.pow((1-n)/(1+n),i),Math.tan(.5*(s-t))/n},W=function(e,t){for(var r,n,i=.5*e,o=s-2*Math.atan(t),a=0;a<=15;a++)if(r=e*Math.sin(o),o+=n=s-2*Math.atan(t*Math.pow((1-r)/(1+r),i))-o,Math.abs(n)<=1e-10)return o;return-9999};function H(e){return e}var X=[{init:function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=q(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(e){var t,r,n=e.x,i=e.y;if(i*d>90&&i*d<-90&&n*d>180&&n*d<-180)return null;if(Math.abs(Math.abs(i)-s)<=f)return null;if(this.sphere)t=this.x0+this.a*this.k0*J(n-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(p+.5*i));else{var o=Math.sin(i),a=z(this.e,i,o);t=this.x0+this.a*this.k0*J(n-this.long0),r=this.y0-this.a*this.k0*Math.log(a)}return e.x=t,e.y=r,e},inverse:function(e){var t,r,n=e.x-this.x0,i=e.y-this.y0;if(this.sphere)r=s-2*Math.atan(Math.exp(-i/(this.a*this.k0)));else{var o=Math.exp(-i/(this.a*this.k0));if(-9999===(r=W(this.e,o)))return null}return t=J(this.long0+n/(this.a*this.k0)),e.x=t,e.y=r,e},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:H,inverse:H,names:["longlat","identity"]}],Y={},Z=[];function K(e,t){var r=Z.length;return e.names?(Z[r]=e,e.names.forEach(function(e){Y[e.toLowerCase()]=r}),this):(console.log(t),!0)}var Q={start:function(){X.forEach(K)},add:K,get:function(e){if(!e)return!1;var t=e.toLowerCase();return void 0!==Y[t]&&Z[Y[t]]?Z[Y[t]]:void 0}},$={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},ee=$.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};$.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var te={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},re=function(e,t,r,s,l,u,c){var f={};return f.datum_type=void 0===e||"none"===e?5:4,t&&(f.datum_params=t.map(parseFloat),0===f.datum_params[0]&&0===f.datum_params[1]&&0===f.datum_params[2]||(f.datum_type=n),f.datum_params.length>3&&(0===f.datum_params[3]&&0===f.datum_params[4]&&0===f.datum_params[5]&&0===f.datum_params[6]||(f.datum_type=i,f.datum_params[3]*=a,f.datum_params[4]*=a,f.datum_params[5]*=a,f.datum_params[6]=f.datum_params[6]/1e6+1))),c&&(f.datum_type=o,f.grids=c),f.a=r,f.b=s,f.es=l,f.ep2=u,f},ne={};function ie(e){if(0===e.length)return null;var t="@"===e[0];return t&&(e=e.slice(1)),"null"===e?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:ne[e]||null,isNull:!1}}function oe(e){return e/3600*Math.PI/180}function ae(e,t,r){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(t,r)))}function se(e){return e.map(function(e){return[oe(e.longitudeShift),oe(e.latitudeShift)]})}function le(e,t,r){return{name:ae(e,t+8,t+16).trim(),parent:ae(e,t+24,t+24+8).trim(),lowerLatitude:e.getFloat64(t+72,r),upperLatitude:e.getFloat64(t+88,r),lowerLongitude:e.getFloat64(t+104,r),upperLongitude:e.getFloat64(t+120,r),latitudeInterval:e.getFloat64(t+136,r),longitudeInterval:e.getFloat64(t+152,r),gridNodeCount:e.getInt32(t+168,r)}}function ue(e,t,r,n){for(var i=t+176,o=[],a=0;a<r.gridNodeCount;a++){var s={latitudeShift:e.getFloat32(i+16*a,n),longitudeShift:e.getFloat32(i+16*a+4,n),latitudeAccuracy:e.getFloat32(i+16*a+8,n),longitudeAccuracy:e.getFloat32(i+16*a+12,n)};o.push(s)}return o}function ce(e,t){if(!(this instanceof ce))return new ce(e);t=t||function(e){if(e)throw e};var r=j(e);if("object"==typeof r){var n=ce.projections.get(r.projName);if(n){if(r.datumCode&&"none"!==r.datumCode){var i=S(te,r.datumCode);i&&(r.datum_params=r.datum_params||(i.towgs84?i.towgs84.split(","):null),r.ellps=i.ellipse,r.datumName=i.datumName?i.datumName:r.datumCode)}r.k0=r.k0||1,r.axis=r.axis||"enu",r.ellps=r.ellps||"wgs84",r.lat1=r.lat1||r.lat0;var o=function(e,t,r,n,i){if(!e){var o=S($,n);o||(o=ee),e=o.a,t=o.b,r=o.rf}return r&&!t&&(t=(1-1/r)*e),(0===r||Math.abs(e-t)<f)&&(i=!0,t=e),{a:e,b:t,rf:r,sphere:i}}(r.a,r.b,r.rf,r.ellps,r.sphere),a=function(e,t,r,n){var i=e*e,o=t*t,a=(i-o)/i,s=0;return n?(i=(e*=1-a*(l+a*(u+a*c)))*e,a=0):s=Math.sqrt(a),{es:a,e:s,ep2:(i-o)/o}}(o.a,o.b,o.rf,r.R_A),s=function(e){return void 0===e?null:e.split(",").map(ie)}(r.nadgrids),h=r.datum||re(r.datumCode,r.datum_params,o.a,o.b,a.es,a.ep2,s);B(this,r),B(this,n),this.a=o.a,this.b=o.b,this.rf=o.rf,this.sphere=o.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=h,this.init(),t(null,this)}else t(e)}else t(e)}ce.projections=Q,ce.projections.start();var fe=ce;function he(e,t,r){var n,i,o,a,l=e.x,u=e.y,c=e.z?e.z:0;if(u<-s&&u>-1.001*s)u=-s;else if(u>s&&u<1.001*s)u=s;else{if(u<-s)return{x:-1/0,y:-1/0,z:e.z};if(u>s)return{x:1/0,y:1/0,z:e.z}}return l>Math.PI&&(l-=2*Math.PI),i=Math.sin(u),a=Math.cos(u),o=i*i,{x:((n=r/Math.sqrt(1-t*o))+c)*a*Math.cos(l),y:(n+c)*a*Math.sin(l),z:(n*(1-t)+c)*i}}function de(e,t,r,n){var i,o,a,s,l,u,c,f,h,d,p,y,g,v,m,_=e.x,S=e.y,x=e.z?e.z:0;if(i=Math.sqrt(_*_+S*S),o=Math.sqrt(_*_+S*S+x*x),i/r<1e-12){if(v=0,o/r<1e-12)return m=-n,{x:e.x,y:e.y,z:e.z}}else v=Math.atan2(S,_);a=x/o,f=(s=i/o)*(1-t)*(l=1/Math.sqrt(1-t*(2-t)*s*s)),h=a*l,g=0;do{g++,u=t*(c=r/Math.sqrt(1-t*h*h))/(c+(m=i*f+x*h-c*(1-t*h*h))),y=(p=a*(l=1/Math.sqrt(1-u*(2-u)*s*s)))*f-(d=s*(1-u)*l)*h,f=d,h=p}while(y*y>1e-24&&g<30);return{x:v,y:Math.atan(p/Math.abs(d)),z:m}}function pe(e){return e===n||e===i}var ye=function(e,t,r){if(function(e,t){return e.datum_type===t.datum_type&&!(e.a!==t.a||Math.abs(e.es-t.es)>5e-11)&&(e.datum_type===n?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type!==i||e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6])}(e,t))return r;if(5===e.datum_type||5===t.datum_type)return r;var a=e.a,s=e.es;if(e.datum_type===o){if(0!==ge(e,!1,r))return;a=6378137,s=.0066943799901413165}var l=t.a,u=t.b,c=t.es;return t.datum_type===o&&(l=6378137,u=6356752.314,c=.0066943799901413165),s!==c||a!==l||pe(e.datum_type)||pe(t.datum_type)?(r=he(r,s,a),pe(e.datum_type)&&(r=function(e,t,r){if(t===n)return{x:e.x+r[0],y:e.y+r[1],z:e.z+r[2]};if(t===i){var o=r[0],a=r[1],s=r[2],l=r[3],u=r[4],c=r[5],f=r[6];return{x:f*(e.x-c*e.y+u*e.z)+o,y:f*(c*e.x+e.y-l*e.z)+a,z:f*(-u*e.x+l*e.y+e.z)+s}}}(r,e.datum_type,e.datum_params)),pe(t.datum_type)&&(r=function(e,t,r){if(t===n)return{x:e.x-r[0],y:e.y-r[1],z:e.z-r[2]};if(t===i){var o=r[0],a=r[1],s=r[2],l=r[3],u=r[4],c=r[5],f=r[6],h=(e.x-o)/f,d=(e.y-a)/f,p=(e.z-s)/f;return{x:h+c*d-u*p,y:-c*h+d+l*p,z:u*h-l*d+p}}}(r,t.datum_type,t.datum_params)),r=de(r,c,l,u),t.datum_type!==o||0===ge(t,!0,r)?r:void 0):r};function ge(e,t,r){if(null===e.grids||0===e.grids.length)return console.log("Grid shift grids not found"),-1;for(var n={x:-r.x,y:r.y},i={x:Number.NaN,y:Number.NaN},o=[],a=0;a<e.grids.length;a++){var s=e.grids[a];if(o.push(s.name),s.isNull){i=n;break}if(s.mandatory,null!==s.grid){var l=s.grid.subgrids[0],u=(Math.abs(l.del[1])+Math.abs(l.del[0]))/1e4,c=l.ll[0]-u,f=l.ll[1]-u,h=l.ll[0]+(l.lim[0]-1)*l.del[0]+u,p=l.ll[1]+(l.lim[1]-1)*l.del[1]+u;if(!(f>n.y||c>n.x||p<n.y||h<n.x||(i=ve(n,t,l),isNaN(i.x))))break}else if(s.mandatory)return console.log("Unable to find mandatory grid '"+s.name+"'"),-1}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*d+" "+n.y*d+" tried: '"+o+"'"),-1):(r.x=-i.x,r.y=i.y,0)}function ve(e,t,r){var n={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return n;var i={x:e.x,y:e.y};i.x-=r.ll[0],i.y-=r.ll[1],i.x=J(i.x-Math.PI)+Math.PI;var o=me(i,r);if(t){if(isNaN(o.x))return n;o.x=i.x-o.x,o.y=i.y-o.y;var a,s,l=9;do{if(s=me(o,r),isNaN(s.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}a={x:i.x-(s.x+o.x),y:i.y-(s.y+o.y)},o.x+=a.x,o.y+=a.y}while(l--&&Math.abs(a.x)>1e-12&&Math.abs(a.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=J(o.x+r.ll[0]),n.y=o.y+r.ll[1]}else isNaN(o.x)||(n.x=e.x+o.x,n.y=e.y+o.y);return n}function me(e,t){var r,n={x:e.x/t.del[0],y:e.y/t.del[1]},i=Math.floor(n.x),o=Math.floor(n.y),a=n.x-1*i,s=n.y-1*o,l={x:Number.NaN,y:Number.NaN};if(i<0||i>=t.lim[0])return l;if(o<0||o>=t.lim[1])return l;r=o*t.lim[0]+i;var u=t.cvs[r][0],c=t.cvs[r][1];r++;var f=t.cvs[r][0],h=t.cvs[r][1];r+=t.lim[0];var d=t.cvs[r][0],p=t.cvs[r][1];r--;var y=t.cvs[r][0],g=t.cvs[r][1],v=a*s,m=a*(1-s),_=(1-a)*(1-s),S=(1-a)*s;return l.x=_*u+m*f+S*y+v*d,l.y=_*c+m*h+S*g+v*p,l}var _e=function(e,t,r){var n,i,o,a=r.x,s=r.y,l=r.z||0,u={};for(o=0;o<3;o++)if(!t||2!==o||void 0!==r.z)switch(0===o?(n=a,i=-1!=="ew".indexOf(e.axis[o])?"x":"y"):1===o?(n=s,i=-1!=="ns".indexOf(e.axis[o])?"y":"x"):(n=l,i="z"),e.axis[o]){case"e":u[i]=n;break;case"w":u[i]=-n;break;case"n":u[i]=n;break;case"s":u[i]=-n;break;case"u":void 0!==r[i]&&(u.z=n);break;case"d":void 0!==r[i]&&(u.z=-n);break;default:return null}return u},Se=function(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t},xe=function(e){be(e.x),be(e.y)};function be(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!=e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function we(e,t,r,a){var s,l=void 0!==(r=Array.isArray(r)?Se(r):{x:r.x,y:r.y,z:r.z,m:r.m}).z;if(xe(r),e.datum&&t.datum&&function(e,t){return(e.datum.datum_type===n||e.datum.datum_type===i||e.datum.datum_type===o)&&"WGS84"!==t.datumCode||(t.datum.datum_type===n||t.datum.datum_type===i||t.datum.datum_type===o)&&"WGS84"!==e.datumCode}(e,t)&&(r=we(e,s=new fe("WGS84"),r,a),e=s),a&&"enu"!==e.axis&&(r=_e(e,!1,r)),"longlat"===e.projName)r={x:r.x*h,y:r.y*h,z:r.z||0};else if(e.to_meter&&(r={x:r.x*e.to_meter,y:r.y*e.to_meter,z:r.z||0}),!(r=e.inverse(r)))return;if(e.from_greenwich&&(r.x+=e.from_greenwich),r=ye(e.datum,t.datum,r))return t.from_greenwich&&(r={x:r.x-t.from_greenwich,y:r.y,z:r.z||0}),"longlat"===t.projName?r={x:r.x*d,y:r.y*d,z:r.z||0}:(r=t.forward(r),t.to_meter&&(r={x:r.x/t.to_meter,y:r.y/t.to_meter,z:r.z||0})),a&&"enu"!==t.axis?_e(t,!0,r):(l||delete r.z,r)}var ke=fe("WGS84");function Me(e,t,r,n){var i,o,a;return Array.isArray(r)?(i=we(e,t,r,n)||{x:NaN,y:NaN},r.length>2?void 0!==e.name&&"geocent"===e.name||void 0!==t.name&&"geocent"===t.name?"number"==typeof i.z?[i.x,i.y,i.z].concat(r.splice(3)):[i.x,i.y,r[2]].concat(r.splice(3)):[i.x,i.y].concat(r.splice(2)):[i.x,i.y]):(o=we(e,t,r,n),2===(a=Object.keys(r)).length?o:(a.forEach(function(n){if(void 0!==e.name&&"geocent"===e.name||void 0!==t.name&&"geocent"===t.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;o[n]=r[n]}),o))}function Ee(e){return e instanceof fe?e:e.oProj?e.oProj:fe(e)}var Ie=function(e,t,r){e=Ee(e);var n,i=!1;return void 0===t?(t=e,e=ke,i=!0):(void 0!==t.x||Array.isArray(t))&&(r=t,t=e,e=ke,i=!0),t=Ee(t),r?Me(e,t,r):(n={forward:function(r,n){return Me(e,t,r,n)},inverse:function(r,n){return Me(t,e,r,n)}},i&&(n.oProj=t),n)},Te=6,Le="AJSAJS",Pe="AFAFAF",Ce=65,Ne=73,Oe=79,Re=86,Ve=90,Ge={forward:Ae,inverse:function(e){var t=Be(Ue(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]},toPoint:Fe};function Ae(e,t){return t=t||5,function(e,t){var r="00000"+e.easting,n="00000"+e.northing;return e.zoneNumber+e.zoneLetter+function(e,t,r){var n=qe(r);return function(e,t,r){var n=r-1,i=Le.charCodeAt(n),o=Pe.charCodeAt(n),a=i+e-1,s=o+t,l=!1;return a>Ve&&(a=a-Ve+Ce-1,l=!0),(a===Ne||i<Ne&&a>Ne||(a>Ne||i<Ne)&&l)&&a++,(a===Oe||i<Oe&&a>Oe||(a>Oe||i<Oe)&&l)&&++a===Ne&&a++,a>Ve&&(a=a-Ve+Ce-1),s>Re?(s=s-Re+Ce-1,l=!0):l=!1,(s===Ne||o<Ne&&s>Ne||(s>Ne||o<Ne)&&l)&&s++,(s===Oe||o<Oe&&s>Oe||(s>Oe||o<Oe)&&l)&&++s===Ne&&s++,s>Re&&(s=s-Re+Ce-1),String.fromCharCode(a)+String.fromCharCode(s)}(Math.floor(e/1e5),Math.floor(t/1e5)%20,n)}(e.easting,e.northing,e.zoneNumber)+r.substr(r.length-5,t)+n.substr(n.length-5,t)}(function(e){var t,r,n,i,o,a,s=e.lat,l=e.lon,u=6378137,c=De(s),f=De(l);a=Math.floor((l+180)/6)+1,180===l&&(a=60),s>=56&&s<64&&l>=3&&l<12&&(a=32),s>=72&&s<84&&(l>=0&&l<9?a=31:l>=9&&l<21?a=33:l>=21&&l<33?a=35:l>=33&&l<42&&(a=37)),o=De(6*(a-1)-180+3),t=u/Math.sqrt(1-.00669438*Math.sin(c)*Math.sin(c)),r=Math.tan(c)*Math.tan(c),n=.006739496752268451*Math.cos(c)*Math.cos(c);var h=.9996*t*((i=Math.cos(c)*(f-o))+(1-r+n)*i*i*i/6+(5-18*r+r*r+72*n-.39089081163157013)*i*i*i*i*i/120)+5e5,d=.9996*(u*(.9983242984503243*c-.002514607064228144*Math.sin(2*c)+2639046602129982e-21*Math.sin(4*c)-3.418046101696858e-9*Math.sin(6*c))+t*Math.tan(c)*(i*i/2+(5-r+9*n+4*n*n)*i*i*i*i/24+(61-58*r+r*r+600*n-2.2240339282485886)*i*i*i*i*i*i/720));return s<0&&(d+=1e7),{northing:Math.round(d),easting:Math.round(h),zoneNumber:a,zoneLetter:function(e){var t="Z";return 84>=s&&s>=72?t="X":72>s&&s>=64?t="W":64>s&&s>=56?t="V":56>s&&s>=48?t="U":48>s&&s>=40?t="T":40>s&&s>=32?t="S":32>s&&s>=24?t="R":24>s&&s>=16?t="Q":16>s&&s>=8?t="P":8>s&&s>=0?t="N":0>s&&s>=-8?t="M":-8>s&&s>=-16?t="L":-16>s&&s>=-24?t="K":-24>s&&s>=-32?t="J":-32>s&&s>=-40?t="H":-40>s&&s>=-48?t="G":-48>s&&s>=-56?t="F":-56>s&&s>=-64?t="E":-64>s&&s>=-72?t="D":-72>s&&s>=-80&&(t="C"),t}()}}({lat:e[1],lon:e[0]}),t)}function Fe(e){var t=Be(Ue(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function De(e){return e*(Math.PI/180)}function je(e){return e/Math.PI*180}function Be(e){var t=e.northing,r=e.easting,n=e.zoneLetter,i=e.zoneNumber;if(i<0||i>60)return null;var o,a,s,l,u,c,f,h,d=6378137,p=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),y=r-5e5,g=t;n<"N"&&(g-=1e7),c=6*(i-1)-180+3,h=(f=g/.9996/6367449.145945056)+(3*p/2-27*p*p*p/32)*Math.sin(2*f)+(21*p*p/16-55*p*p*p*p/32)*Math.sin(4*f)+151*p*p*p/96*Math.sin(6*f),o=d/Math.sqrt(1-.00669438*Math.sin(h)*Math.sin(h)),a=Math.tan(h)*Math.tan(h),s=.006739496752268451*Math.cos(h)*Math.cos(h),l=.99330562*d/Math.pow(1-.00669438*Math.sin(h)*Math.sin(h),1.5),u=y/(.9996*o);var v=h-o*Math.tan(h)/l*(u*u/2-(5+3*a+10*s-4*s*s-.06065547077041606)*u*u*u*u/24+(61+90*a+298*s+45*a*a-1.6983531815716497-3*s*s)*u*u*u*u*u*u/720);v=je(v);var m,_=(u-(1+2*a+s)*u*u*u/6+(5-2*s+28*a-3*s*s+.05391597401814761+24*a*a)*u*u*u*u*u/120)/Math.cos(h);if(_=c+je(_),e.accuracy){var S=Be({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});m={top:S.lat,right:S.lon,bottom:v,left:_}}else m={lat:v,lon:_};return m}function qe(e){var t=e%Te;return 0===t&&(t=Te),t}function Ue(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,r=e.length,n=null,i="",o=0;!/[A-Z]/.test(t=e.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+e;i+=t,o++}var a=parseInt(i,10);if(0===o||o+3>r)throw"MGRSPoint bad conversion from: "+e;var s=e.charAt(o++);if(s<="A"||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+e;n=e.substring(o,o+=2);for(var l=qe(a),u=function(e,t){for(var r=Le.charCodeAt(t-1),n=1e5,i=!1;r!==e.charCodeAt(0);){if(++r===Ne&&r++,r===Oe&&r++,r>Ve){if(i)throw"Bad character: "+e;r=Ce,i=!0}n+=1e5}return n}(n.charAt(0),l),c=function(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var r=Pe.charCodeAt(t-1),n=0,i=!1;r!==e.charCodeAt(0);){if(++r===Ne&&r++,r===Oe&&r++,r>Re){if(i)throw"Bad character: "+e;r=Ce,i=!0}n+=1e5}return n}(n.charAt(1),l);c<Je(s);)c+=2e6;var f=r-o;if(f%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var h,d,p,y=f/2,g=0,v=0;return y>0&&(h=1e5/Math.pow(10,y),d=e.substring(o,o+y),g=parseFloat(d)*h,p=e.substring(o+y),v=parseFloat(p)*h),{easting:g+u,northing:v+c,zoneLetter:s,zoneNumber:a,accuracy:h}}function Je(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function ze(e,t,r){if(!(this instanceof ze))return new ze(e,t,r);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&void 0===t){var n=e.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=e,this.y=t,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}ze.fromMGRS=function(e){return new ze(Fe(e))},ze.prototype.toMGRS=function(e){return Ae([this.x,this.y],e)};var We=ze,He=.01068115234375,Xe=function(e){var t=[];t[0]=1-e*(.25+e*(.046875+e*(.01953125+e*He))),t[1]=e*(.75-e*(.046875+e*(.01953125+e*He)));var r=e*e;return t[2]=r*(.46875-e*(.013020833333333334+.007120768229166667*e)),r*=e,t[3]=r*(.3645833333333333-.005696614583333333*e),t[4]=r*e*.3076171875,t},Ye=function(e,t,r,n){return r*=t,t*=t,n[0]*e-r*(n[1]+t*(n[2]+t*(n[3]+t*n[4])))},Ze=function(e,t,r){for(var n=1/(1-t),i=e,o=20;o;--o){var a=Math.sin(i),s=1-t*a*a;if(i-=s=(Ye(i,a,Math.cos(i),r)-e)*(s*Math.sqrt(s))*n,Math.abs(s)<f)return i}return i},Ke={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Xe(this.es),this.ml0=Ye(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(e){var t,r,n,i=e.x,o=e.y,a=J(i-this.long0),s=Math.sin(o),l=Math.cos(o);if(this.es){var u=l*a,c=Math.pow(u,2),h=this.ep2*Math.pow(l,2),d=Math.pow(h,2),p=Math.abs(l)>f?Math.tan(o):0,y=Math.pow(p,2),g=Math.pow(y,2);t=1-this.es*Math.pow(s,2),u/=Math.sqrt(t);var v=Ye(o,s,l,this.en);r=this.a*(this.k0*u*(1+c/6*(1-y+h+c/20*(5-18*y+g+14*h-58*y*h+c/42*(61+179*g-g*y-479*y)))))+this.x0,n=this.a*(this.k0*(v-this.ml0+s*a*u/2*(1+c/12*(5-y+9*h+4*d+c/30*(61+g-58*y+270*h-330*y*h+c/56*(1385+543*g-g*y-3111*y))))))+this.y0}else{var m=l*Math.sin(a);if(Math.abs(Math.abs(m)-1)<f)return 93;if(r=.5*this.a*this.k0*Math.log((1+m)/(1-m))+this.x0,n=l*Math.cos(a)/Math.sqrt(1-Math.pow(m,2)),(m=Math.abs(n))>=1){if(m-1>f)return 93;n=0}else n=Math.acos(n);o<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return e.x=r,e.y=n,e},inverse:function(e){var t,r,n,i,o=(e.x-this.x0)*(1/this.a),a=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+a/this.k0,r=Ze(t,this.es,this.en),Math.abs(r)<s){var l=Math.sin(r),u=Math.cos(r),c=Math.abs(u)>f?Math.tan(r):0,h=this.ep2*Math.pow(u,2),d=Math.pow(h,2),p=Math.pow(c,2),y=Math.pow(p,2);t=1-this.es*Math.pow(l,2);var g=o*Math.sqrt(t)/this.k0,v=Math.pow(g,2);n=r-(t*=c)*v/(1-this.es)*.5*(1-v/12*(5+3*p-9*h*p+h-4*d-v/30*(61+90*p-252*h*p+45*y+46*h-v/56*(1385+3633*p+4095*y+1574*y*p)))),i=J(this.long0+g*(1-v/6*(1+2*p+h-v/20*(5+28*p+24*y+8*h*p+6*h-v/42*(61+662*p+1320*y+720*y*p))))/u)}else n=s*U(a),i=0;else{var m=Math.exp(o/this.k0),_=.5*(m-1/m),S=this.lat0+a/this.k0,x=Math.cos(S);t=Math.sqrt((1-Math.pow(x,2))/(1+Math.pow(_,2))),n=Math.asin(t),a<0&&(n=-n),i=0===_&&0===x?0:J(Math.atan2(_,x)+this.long0)}return e.x=i,e.y=n,e},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]},Qe=function(e){var t=Math.exp(e);return(t-1/t)/2},$e=function(e,t){e=Math.abs(e),t=Math.abs(t);var r=Math.max(e,t),n=Math.min(e,t)/(r||1);return r*Math.sqrt(1+Math.pow(n,2))},et=function(e,t){for(var r,n=2*Math.cos(2*t),i=e.length-1,o=e[i],a=0;--i>=0;)r=n*o-a+e[i],a=o,o=r;return t+r*Math.sin(2*t)},tt=function(e,t,r){for(var n,i,o=Math.sin(t),a=Math.cos(t),s=Qe(r),l=function(e){var t=Math.exp(e);return(t+1/t)/2}(r),u=2*a*l,c=-2*o*s,f=e.length-1,h=e[f],d=0,p=0,y=0;--f>=0;)n=p,i=d,h=u*(p=h)-n-c*(d=y)+e[f],y=c*p-i+u*d;return[(u=o*l)*h-(c=a*s)*y,u*y+c*h]},rt={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Ke.init.apply(this),this.forward=Ke.forward,this.inverse=Ke.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),r=t;this.cgb[0]=t*(2+t*(-2/3+t*(t*(116/45+t*(26/45+t*(-2854/675)))-2))),this.cbg[0]=t*(t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))-2),r*=t,this.cgb[1]=r*(7/3+t*(t*(-227/45+t*(2704/315+t*(2323/945)))-1.6)),this.cbg[1]=r*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),r*=t,this.cgb[2]=r*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=r*(-26/15+t*(34/21+t*(1.6+t*(-12686/2835)))),r*=t,this.cgb[3]=r*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=r*(1237/630+t*(t*(-24832/14175)-2.4)),r*=t,this.cgb[4]=r*(4174/315+t*(-144838/6237)),this.cbg[4]=r*(-734/315+t*(109598/31185)),r*=t,this.cgb[5]=r*(601676/22275),this.cbg[5]=r*(444337/155925),r=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+r*(.25+r*(1/64+r/256))),this.utg[0]=t*(t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))-.5),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=r*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=r*(13/48+t*(t*(557/1440+t*(281/630+t*(-1983433/1935360)))-.6)),r*=t,this.utg[2]=r*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=r*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),r*=t,this.utg[3]=r*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=r*(49561/161280+t*(-179/168+t*(6601661/7257600))),r*=t,this.utg[4]=r*(-4583/161280+t*(108847/3991680)),this.gtu[4]=r*(34729/80640+t*(-3418889/1995840)),r*=t,this.utg[5]=-.03233083094085698*r,this.gtu[5]=.6650675310896665*r;var n=et(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(e,t){for(var r,n=2*Math.cos(t),i=e.length-1,o=e[i],a=0;--i>=0;)r=n*o-a+e[i],a=o,o=r;return Math.sin(t)*r}(this.gtu,2*n))},forward:function(e){var t=J(e.x-this.long0),r=e.y;r=et(this.cbg,r);var n=Math.sin(r),i=Math.cos(r),o=Math.sin(t),a=Math.cos(t);r=Math.atan2(n,a*i),t=Math.atan2(o*i,$e(n,i*a)),t=function(e){var t=Math.abs(e);return t=function(e){var t=1+e,r=t-1;return 0===r?e:e*Math.log(t)/r}(t*(1+t/($e(1,t)+1))),e<0?-t:t}(Math.tan(t));var s,l,u=tt(this.gtu,2*r,2*t);return r+=u[0],t+=u[1],Math.abs(t)<=2.623395162778?(s=this.a*(this.Qn*t)+this.x0,l=this.a*(this.Qn*r+this.Zb)+this.y0):(s=1/0,l=1/0),e.x=s,e.y=l,e},inverse:function(e){var t,r,n=(e.x-this.x0)*(1/this.a),i=(e.y-this.y0)*(1/this.a);if(i=(i-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var o=tt(this.utg,2*i,2*n);i+=o[0],n+=o[1],n=Math.atan(Qe(n));var a=Math.sin(i),s=Math.cos(i),l=Math.sin(n),u=Math.cos(n);i=Math.atan2(a*u,$e(l,u*s)),n=Math.atan2(l,u*s),t=J(n+this.long0),r=et(this.cgb,i)}else t=1/0,r=1/0;return e.x=t,e.y=r,e},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]},nt={init:function(){var e=function(e,t){if(void 0===e){if((e=Math.floor(30*(J(t)+Math.PI)/Math.PI)+1)<0)return 0;if(e>60)return 60}return e}(this.zone,this.long0);if(void 0===e)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*h,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,rt.init.apply(this),this.forward=rt.forward,this.inverse=rt.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},it=function(e,t){return Math.pow((1-e)/(1+e),t)},ot={init:function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+p)/(Math.pow(Math.tan(.5*this.lat0+p),this.C)*it(this.e*e,this.ratexp))},forward:function(e){var t=e.x,r=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+p),this.C)*it(this.e*Math.sin(r),this.ratexp))-s,e.x=this.C*t,e},inverse:function(e){for(var t=e.x/this.C,r=e.y,n=Math.pow(Math.tan(.5*r+p)/this.K,1/this.C),i=20;i>0&&(r=2*Math.atan(n*it(this.e*Math.sin(e.y),-.5*this.e))-s,!(Math.abs(r-e.y)<1e-14));--i)e.y=r;return i?(e.x=t,e.y=r,e):null},names:["gauss"]},at={init:function(){ot.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(e){var t,r,n,i;return e.x=J(e.x-this.long0),ot.forward.apply(this,[e]),t=Math.sin(e.y),r=Math.cos(e.y),n=Math.cos(e.x),i=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*r*n),e.x=i*r*Math.sin(e.x),e.y=i*(this.cosc0*t-this.sinc0*r*n),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){var t,r,n,i,o;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,o=Math.sqrt(e.x*e.x+e.y*e.y)){var a=2*Math.atan2(o,this.R2);t=Math.sin(a),r=Math.cos(a),i=Math.asin(r*this.sinc0+e.y*t*this.cosc0/o),n=Math.atan2(e.x*t,o*this.cosc0*r-e.y*this.sinc0*t)}else i=this.phic0,n=0;return e.x=n,e.y=i,ot.inverse.apply(this,[e]),e.x=J(e.x+this.long0),e},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},st={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=f&&(this.k0=.5*(1+U(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=f&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=f&&(this.k0=.5*this.cons*q(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/z(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=q(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-s,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(e){var t,r,n,i,o,a,l=e.x,u=e.y,c=Math.sin(u),h=Math.cos(u),d=J(l-this.long0);return Math.abs(Math.abs(l-this.long0)-Math.PI)<=f&&Math.abs(u+this.lat0)<=f?(e.x=NaN,e.y=NaN,e):this.sphere?(t=2*this.k0/(1+this.sinlat0*c+this.coslat0*h*Math.cos(d)),e.x=this.a*t*h*Math.sin(d)+this.x0,e.y=this.a*t*(this.coslat0*c-this.sinlat0*h*Math.cos(d))+this.y0,e):(r=2*Math.atan(this.ssfn_(u,c,this.e))-s,i=Math.cos(r),n=Math.sin(r),Math.abs(this.coslat0)<=f?(o=z(this.e,u*this.con,this.con*c),a=2*this.a*this.k0*o/this.cons,e.x=this.x0+a*Math.sin(l-this.long0),e.y=this.y0-this.con*a*Math.cos(l-this.long0),e):(Math.abs(this.sinlat0)<f?(t=2*this.a*this.k0/(1+i*Math.cos(d)),e.y=t*n):(t=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*i*Math.cos(d))),e.y=t*(this.cosX0*n-this.sinX0*i*Math.cos(d))+this.y0),e.x=t*i*Math.sin(d)+this.x0,e))},inverse:function(e){var t,r,n,i,o;e.x-=this.x0,e.y-=this.y0;var a=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var l=2*Math.atan(a/(2*this.a*this.k0));return t=this.long0,r=this.lat0,a<=f?(e.x=t,e.y=r,e):(r=Math.asin(Math.cos(l)*this.sinlat0+e.y*Math.sin(l)*this.coslat0/a),t=Math.abs(this.coslat0)<f?this.lat0>0?J(this.long0+Math.atan2(e.x,-1*e.y)):J(this.long0+Math.atan2(e.x,e.y)):J(this.long0+Math.atan2(e.x*Math.sin(l),a*this.coslat0*Math.cos(l)-e.y*this.sinlat0*Math.sin(l))),e.x=t,e.y=r,e)}if(Math.abs(this.coslat0)<=f){if(a<=f)return r=this.lat0,t=this.long0,e.x=t,e.y=r,e;e.x*=this.con,e.y*=this.con,n=a*this.cons/(2*this.a*this.k0),r=this.con*W(this.e,n),t=this.con*J(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,a<=f?o=this.X0:(o=Math.asin(Math.cos(i)*this.sinX0+e.y*Math.sin(i)*this.cosX0/a),t=J(this.long0+Math.atan2(e.x*Math.sin(i),a*this.cosX0*Math.cos(i)-e.y*this.sinX0*Math.sin(i)))),r=-1*W(this.e,Math.tan(.5*(s+o)));return e.x=t,e.y=r,e},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(e,t,r){return t*=r,Math.tan(.5*(s+e))*Math.pow((1-t)/(1+t),.5*r)}},lt={init:function(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),r=this.a,n=1/this.rf,i=2*n-Math.pow(n,2),o=this.e=Math.sqrt(i);this.R=this.k0*r*Math.sqrt(1-i)/(1-i*Math.pow(t,2)),this.alpha=Math.sqrt(1+i/(1-i)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),s=Math.log(Math.tan(Math.PI/4+e/2)),l=Math.log((1+o*t)/(1-o*t));this.K=a-this.alpha*s+this.alpha*o/2*l},forward:function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),r=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),n=-this.alpha*(t+r)+this.K,i=2*(Math.atan(Math.exp(n))-Math.PI/4),o=this.alpha*(e.x-this.lambda0),a=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(o))),s=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(o));return e.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,e.x=this.R*a+this.x0,e},inverse:function(e){for(var t=e.x-this.x0,r=e.y-this.y0,n=t/this.R,i=2*(Math.atan(Math.exp(r/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(n)),a=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(i))),s=this.lambda0+a/this.alpha,l=0,u=o,c=-1e3,f=0;Math.abs(u-c)>1e-7;){if(++f>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),c=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return e.x=s,e.y=u,e},names:["somerc"]},ut=1e-7,ct={init:function(){var e,t,r,n,i,o,a,l,u,c,d,g=0,v=0,m=0,_=0,S=0,x=0,b=0;this.no_off=function(e){var t="object"==typeof e.PROJECTION?Object.keys(e.PROJECTION)[0]:e.PROJECTION;return"no_uoff"in e||"no_off"in e||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(t)}(this),this.no_rot="no_rot"in this;var w=!1;"alpha"in this&&(w=!0);var k=!1;if("rectified_grid_angle"in this&&(k=!0),w&&(b=this.alpha),k&&(g=this.rectified_grid_angle*h),w||k)v=this.longc;else if(m=this.long1,S=this.lat1,_=this.long2,x=this.lat2,Math.abs(S-x)<=ut||(e=Math.abs(S))<=ut||Math.abs(e-s)<=ut||Math.abs(Math.abs(this.lat0)-s)<=ut||Math.abs(Math.abs(x)-s)<=ut)throw new Error;var M=1-this.es;t=Math.sqrt(M),Math.abs(this.lat0)>f?(l=Math.sin(this.lat0),r=Math.cos(this.lat0),e=1-this.es*l*l,this.B=r*r,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*t/e,(i=(n=this.B*t/(r*Math.sqrt(e)))*n-1)<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=n,this.E*=Math.pow(z(this.e,this.lat0,l),this.B)):(this.B=1/t,this.A=this.k0,this.E=n=i=1),w||k?(w?(d=Math.asin(Math.sin(b)/n),k||(g=b)):(d=g,b=Math.asin(n*Math.sin(d))),this.lam0=v-Math.asin(.5*(i-1/i)*Math.tan(d))/this.B):(o=Math.pow(z(this.e,S,Math.sin(S)),this.B),a=Math.pow(z(this.e,x,Math.sin(x)),this.B),i=this.E/o,u=(a-o)/(a+o),c=((c=this.E*this.E)-a*o)/(c+a*o),(e=m-_)<-Math.pi?_-=y:e>Math.pi&&(_+=y),this.lam0=J(.5*(m+_)-Math.atan(c*Math.tan(.5*this.B*(m-_))/u)/this.B),d=Math.atan(2*Math.sin(this.B*J(m-this.lam0))/(i-1/i)),g=b=Math.asin(n*Math.sin(d))),this.singam=Math.sin(d),this.cosgam=Math.cos(d),this.sinrot=Math.sin(g),this.cosrot=Math.cos(g),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(b))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*d,this.v_pole_n=this.ArB*Math.log(Math.tan(p-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(p+i))},forward:function(e){var t,r,n,i,o,a,l,u,c={};if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-s)>f){if(t=.5*((o=this.E/Math.pow(z(this.e,e.y,Math.sin(e.y)),this.B))-(a=1/o)),r=.5*(o+a),i=Math.sin(this.B*e.x),n=(t*this.singam-i*this.cosgam)/r,Math.abs(Math.abs(n)-1)<f)throw new Error;u=.5*this.ArB*Math.log((1-n)/(1+n)),a=Math.cos(this.B*e.x),l=Math.abs(a)<ut?this.A*e.x:this.ArB*Math.atan2(t*this.cosgam+i*this.singam,a)}else u=e.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*e.y;return this.no_rot?(c.x=l,c.y=u):(l-=this.u_0,c.x=u*this.cosrot+l*this.sinrot,c.y=l*this.cosrot-u*this.sinrot),c.x=this.a*c.x+this.x0,c.y=this.a*c.y+this.y0,c},inverse:function(e){var t,r,n,i,o,a,l,u={};if(e.x=(e.x-this.x0)*(1/this.a),e.y=(e.y-this.y0)*(1/this.a),this.no_rot?(r=e.y,t=e.x):(r=e.x*this.cosrot-e.y*this.sinrot,t=e.y*this.cosrot+e.x*this.sinrot+this.u_0),i=.5*((n=Math.exp(-this.BrA*r))-1/n),o=.5*(n+1/n),l=((a=Math.sin(this.BrA*t))*this.cosgam+i*this.singam)/o,Math.abs(Math.abs(l)-1)<f)u.x=0,u.y=l<0?-s:s;else{if(u.y=this.E/Math.sqrt((1+l)/(1-l)),u.y=W(this.e,Math.pow(u.y,1/this.B)),u.y===1/0)throw new Error;u.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*t))}return u.x+=this.lam0,u},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},ft={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<f)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),r=Math.cos(this.lat1),n=q(this.e,t,r),i=z(this.e,this.lat1,t),o=Math.sin(this.lat2),a=Math.cos(this.lat2),s=q(this.e,o,a),l=z(this.e,this.lat2,o),u=z(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>f?this.ns=Math.log(n/s)/Math.log(i/l):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=n/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(e){var t=e.x,r=e.y;Math.abs(2*Math.abs(r)-Math.PI)<=f&&(r=U(r)*(s-2*f));var n,i,o=Math.abs(Math.abs(r)-s);if(o>f)n=z(this.e,r,Math.sin(r)),i=this.a*this.f0*Math.pow(n,this.ns);else{if((o=r*this.ns)<=0)return null;i=0}var a=this.ns*J(t-this.long0);return e.x=this.k0*(i*Math.sin(a))+this.x0,e.y=this.k0*(this.rh-i*Math.cos(a))+this.y0,e},inverse:function(e){var t,r,n,i,o,a=(e.x-this.x0)/this.k0,l=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(a*a+l*l),r=1):(t=-Math.sqrt(a*a+l*l),r=-1);var u=0;if(0!==t&&(u=Math.atan2(r*a,r*l)),0!==t||this.ns>0){if(r=1/this.ns,n=Math.pow(t/(this.a*this.f0),r),-9999===(i=W(this.e,n)))return null}else i=-s;return o=J(u/this.ns+this.long0),e.x=o,e.y=i,e},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},ht={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(e){var t,r,n,i,o,a,s,l=e.x,u=e.y,c=J(l-this.long0);return t=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/t)-this.s45),n=-c*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(n)),o=Math.asin(Math.cos(r)*Math.sin(n)/Math.cos(i)),a=this.n*o,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),e.y=s*Math.cos(a)/1,e.x=s*Math.sin(a)/1,this.czech||(e.y*=-1,e.x*=-1),e},inverse:function(e){var t,r,n,i,o,a,s,l=e.x;e.x=e.y,e.y=l,this.czech||(e.y*=-1,e.x*=-1),o=Math.sqrt(e.x*e.x+e.y*e.y),i=Math.atan2(e.y,e.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),r=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(t)),e.x=this.long0-r/this.alfa,a=t,s=0;var u=0;do{e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-e.y)<1e-10&&(s=1),a=e.y,u+=1}while(0===s&&u<15);return u>=15?null:e},names:["Krovak","krovak"]},dt=function(e,t,r,n,i){return e*i-t*Math.sin(2*i)+r*Math.sin(4*i)-n*Math.sin(6*i)},pt=function(e){return 1-.25*e*(1+e/16*(3+1.25*e))},yt=function(e){return.375*e*(1+.25*e*(1+.46875*e))},gt=function(e){return.05859375*e*e*(1+.75*e)},vt=function(e){return e*e*e*(35/3072)},mt=function(e,t,r){var n=t*r;return e/Math.sqrt(1-n*n)},_t=function(e){return Math.abs(e)<s?e:e-U(e)*Math.PI},St=function(e,t,r,n,i){var o,a;o=e/t;for(var s=0;s<15;s++)if(o+=a=(e-(t*o-r*Math.sin(2*o)+n*Math.sin(4*o)-i*Math.sin(6*o)))/(t-2*r*Math.cos(2*o)+4*n*Math.cos(4*o)-6*i*Math.cos(6*o)),Math.abs(a)<=1e-10)return o;return NaN},xt={init:function(){this.sphere||(this.e0=pt(this.es),this.e1=yt(this.es),this.e2=gt(this.es),this.e3=vt(this.es),this.ml0=this.a*dt(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(e){var t,r,n=e.x,i=e.y;if(n=J(n-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(i)*Math.sin(n)),r=this.a*(Math.atan2(Math.tan(i),Math.cos(n))-this.lat0);else{var o=Math.sin(i),a=Math.cos(i),s=mt(this.a,this.e,o),l=Math.tan(i)*Math.tan(i),u=n*Math.cos(i),c=u*u,f=this.es*a*a/(1-this.es);t=s*u*(1-c*l*(1/6-(8-l+8*f)*c/120)),r=this.a*dt(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+s*o/a*c*(.5+(5-l+6*f)*c/24)}return e.x=t+this.x0,e.y=r+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,r,n=e.x/this.a,i=e.y/this.a;if(this.sphere){var o=i+this.lat0;t=Math.asin(Math.sin(o)*Math.cos(n)),r=Math.atan2(Math.tan(n),Math.cos(o))}else{var a=this.ml0/this.a+i,l=St(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(l)-s)<=f)return e.x=this.long0,e.y=s,i<0&&(e.y*=-1),e;var u=mt(this.a,this.e,Math.sin(l)),c=u*u*u/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(l),2),d=n*this.a/u,p=d*d;t=l-u*Math.tan(l)/c*d*d*(.5-(1+3*h)*d*d/24),r=d*(1-p*(h/3+(1+3*h)*h*p/15))/Math.cos(l)}return e.x=J(r+this.long0),e.y=_t(t),e},names:["Cassini","Cassini_Soldner","cass"]},bt=function(e,t){var r;return e>1e-7?(1-e*e)*(t/(1-(r=e*t)*r)-.5/e*Math.log((1-r)/(1+r))):2*t},wt={init:function(){var e,t=Math.abs(this.lat0);if(Math.abs(t-s)<f?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<f?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=bt(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(e){var t,r=[];return r[0]=.3333333333333333*e,t=e*e,r[0]+=.17222222222222222*t,r[1]=.06388888888888888*t,t*=e,r[0]+=.10257936507936508*t,r[1]+=.0664021164021164*t,r[2]=.016415012942191543*t,r}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=bt(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(e){var t,r,n,i,o,a,l,u,c,h,d=e.x,y=e.y;if(d=J(d-this.long0),this.sphere){if(o=Math.sin(y),h=Math.cos(y),n=Math.cos(d),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((r=this.mode===this.EQUIT?1+h*n:1+this.sinph0*o+this.cosph0*h*n)<=f)return null;t=(r=Math.sqrt(2/r))*h*Math.sin(d),r*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*h*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(y+this.lat0)<f)return null;r=p-.5*y,t=(r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r)))*Math.sin(d),r*=n}}else{switch(l=0,u=0,c=0,n=Math.cos(d),i=Math.sin(d),o=Math.sin(y),a=bt(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(l=a/this.qp,u=Math.sqrt(1-l*l)),this.mode){case this.OBLIQ:c=1+this.sinb1*l+this.cosb1*u*n;break;case this.EQUIT:c=1+u*n;break;case this.N_POLE:c=s+y,a=this.qp-a;break;case this.S_POLE:c=y-s,a=this.qp+a}if(Math.abs(c)<f)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),r=this.mode===this.OBLIQ?this.ymf*c*(this.cosb1*l-this.sinb1*u*n):(c=Math.sqrt(2/(1+u*n)))*l*this.ymf,t=this.xmf*c*u*i;break;case this.N_POLE:case this.S_POLE:a>=0?(t=(c=Math.sqrt(a))*i,r=n*(this.mode===this.S_POLE?c:-c)):t=r=0}}return e.x=this.a*t+this.x0,e.y=this.a*r+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,r,n,i,o,a,l,u=e.x/this.a,c=e.y/this.a;if(this.sphere){var h,d=0,p=0;if((r=.5*(h=Math.sqrt(u*u+c*c)))>1)return null;switch(r=2*Math.asin(r),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(p=Math.sin(r),d=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(h)<=f?0:Math.asin(c*p/h),u*=p,c=d*h;break;case this.OBLIQ:r=Math.abs(h)<=f?this.lat0:Math.asin(d*this.sinph0+c*p*this.cosph0/h),u*=p*this.cosph0,c=(d-Math.sin(r)*this.sinph0)*h;break;case this.N_POLE:c=-c,r=s-r;break;case this.S_POLE:r-=s}t=0!==c||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,c):0}else{if(l=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,c*=this.dd,(a=Math.sqrt(u*u+c*c))<f)return e.x=this.long0,e.y=this.lat0,e;i=2*Math.asin(.5*a/this.rq),n=Math.cos(i),u*=i=Math.sin(i),this.mode===this.OBLIQ?(l=n*this.sinb1+c*i*this.cosb1/a,o=this.qp*l,c=a*this.cosb1*n-c*this.sinb1*i):(l=c*i/a,o=this.qp*l,c=a*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(c=-c),!(o=u*u+c*c))return e.x=this.long0,e.y=this.lat0,e;l=1-o/this.qp,this.mode===this.S_POLE&&(l=-l)}t=Math.atan2(u,c),r=function(e,t){var r=e+e;return e+t[0]*Math.sin(r)+t[1]*Math.sin(r+r)+t[2]*Math.sin(r+r+r)}(Math.asin(l),this.apa)}return e.x=J(this.long0+t),e.y=r,e},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},kt=function(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)},Mt={init:function(){Math.abs(this.lat1+this.lat2)<f||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=q(this.e3,this.sin_po,this.cos_po),this.qs1=bt(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=q(this.e3,this.sin_po,this.cos_po),this.qs2=bt(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=bt(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>f?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(e){var t=e.x,r=e.y;this.sin_phi=Math.sin(r),this.cos_phi=Math.cos(r);var n=bt(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,o=this.ns0*J(t-this.long0),a=i*Math.sin(o)+this.x0,s=this.rh-i*Math.cos(o)+this.y0;return e.x=a,e.y=s,e},inverse:function(e){var t,r,n,i,o,a;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),n=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),n=-1),i=0,0!==t&&(i=Math.atan2(n*e.x,n*e.y)),n=t*this.ns0/this.a,this.sphere?a=Math.asin((this.c-n*n)/(2*this.ns0)):(r=(this.c-n*n)/this.ns0,a=this.phi1z(this.e3,r)),o=J(i/this.ns0+this.long0),e.x=o,e.y=a,e},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(e,t){var r,n,i,o,a,s=kt(.5*t);if(e<f)return s;for(var l=e*e,u=1;u<=25;u++)if(r=Math.sin(s),n=Math.cos(s),s+=a=.5*(o=1-(i=e*r)*i)*o/n*(t/(1-l)-r/o+.5/e*Math.log((1-i)/(1+i))),Math.abs(a)<=1e-7)return s;return null}},Et={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(e){var t,r,n,i,o,a,s,l=e.x,u=e.y;return n=J(l-this.long0),t=Math.sin(u),r=Math.cos(u),i=Math.cos(n),(o=this.sin_p14*t+this.cos_p14*r*i)>0||Math.abs(o)<=f?(a=this.x0+1*this.a*r*Math.sin(n)/o,s=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*r*i)/o):(a=this.x0+this.infinity_dist*r*Math.sin(n),s=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*r*i)),e.x=a,e.y=s,e},inverse:function(e){var t,r,n,i,o,a;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(i=Math.atan2(t,this.rc),r=Math.sin(i),n=Math.cos(i),a=kt(n*this.sin_p14+e.y*r*this.cos_p14/t),o=Math.atan2(e.x*r,t*this.cos_p14*n-e.y*this.sin_p14*r),o=J(this.long0+o)):(a=this.phic0,o=0),e.x=o,e.y=a,e},names:["gnom"]},It={init:function(){this.sphere||(this.k0=q(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(e){var t,r,n=e.x,i=e.y,o=J(n-this.long0);if(this.sphere)t=this.x0+this.a*o*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var a=bt(this.e,Math.sin(i));t=this.x0+this.a*this.k0*o,r=this.y0+this.a*a*.5/this.k0}return e.x=t,e.y=r,e},inverse:function(e){var t,r;return e.x-=this.x0,e.y-=this.y0,this.sphere?(t=J(this.long0+e.x/this.a/Math.cos(this.lat_ts)),r=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(r=function(e,t){var r=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-r)<1e-6)return t<0?-1*s:s;for(var n,i,o,a,l=Math.asin(.5*t),u=0;u<30;u++)if(i=Math.sin(l),o=Math.cos(l),a=e*i,l+=n=Math.pow(1-a*a,2)/(2*o)*(t/(1-e*e)-i/(1-a*a)+.5/e*Math.log((1-a)/(1+a))),Math.abs(n)<=1e-10)return l;return NaN}(this.e,2*e.y*this.k0/this.a),t=J(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=r,e},names:["cea"]},Tt={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(e){var t=e.x,r=e.y,n=J(t-this.long0),i=_t(r-this.lat0);return e.x=this.x0+this.a*n*this.rc,e.y=this.y0+this.a*i,e},inverse:function(e){var t=e.x,r=e.y;return e.x=J(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=_t(this.lat0+(r-this.y0)/this.a),e},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Lt={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=pt(this.es),this.e1=yt(this.es),this.e2=gt(this.es),this.e3=vt(this.es),this.ml0=this.a*dt(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var t,r,n,i=e.x,o=e.y,a=J(i-this.long0);if(n=a*Math.sin(o),this.sphere)Math.abs(o)<=f?(t=this.a*a,r=-1*this.a*this.lat0):(t=this.a*Math.sin(n)/Math.tan(o),r=this.a*(_t(o-this.lat0)+(1-Math.cos(n))/Math.tan(o)));else if(Math.abs(o)<=f)t=this.a*a,r=-1*this.ml0;else{var s=mt(this.a,this.e,Math.sin(o))/Math.tan(o);t=s*Math.sin(n),r=this.a*dt(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+s*(1-Math.cos(n))}return e.x=t+this.x0,e.y=r+this.y0,e},inverse:function(e){var t,r,n,i,o,a,s,l,u;if(n=e.x-this.x0,i=e.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=f)t=J(n/this.a+this.long0),r=0;else{var c;for(a=this.lat0+i/this.a,s=n*n/this.a/this.a+a*a,l=a,o=20;o;--o)if(l+=u=-1*(a*(l*(c=Math.tan(l))+1)-l-.5*(l*l+s)*c)/((l-a)/c-1),Math.abs(u)<=f){r=l;break}t=J(this.long0+Math.asin(n*Math.tan(l)/this.a)/Math.sin(r))}else if(Math.abs(i+this.ml0)<=f)r=0,t=J(this.long0+n/this.a);else{var h,d,p,y,g;for(a=(this.ml0+i)/this.a,s=n*n/this.a/this.a+a*a,l=a,o=20;o;--o)if(g=this.e*Math.sin(l),h=Math.sqrt(1-g*g)*Math.tan(l),d=this.a*dt(this.e0,this.e1,this.e2,this.e3,l),p=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=u=(a*(h*(y=d/this.a)+1)-y-.5*h*(y*y+s))/(this.es*Math.sin(2*l)*(y*y+s-2*a*y)/(4*h)+(a-y)*(h*p-2/Math.sin(2*l))-p),Math.abs(u)<=f){r=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r),t=J(this.long0+Math.asin(n*h/this.a)/Math.sin(r))}return e.x=t,e.y=r,e},names:["Polyconic","poly"]},Pt={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(e){var t,r=e.x,n=e.y-this.lat0,i=r-this.long0,o=n/a*1e-5,s=i,l=1,u=0;for(t=1;t<=10;t++)l*=o,u+=this.A[t]*l;var c,f=u,h=s,d=1,p=0,y=0,g=0;for(t=1;t<=6;t++)c=p*f+d*h,d=d*f-p*h,p=c,y=y+this.B_re[t]*d-this.B_im[t]*p,g=g+this.B_im[t]*d+this.B_re[t]*p;return e.x=g*this.a+this.x0,e.y=y*this.a+this.y0,e},inverse:function(e){var t,r,n=e.x,i=e.y,o=n-this.x0,s=(i-this.y0)/this.a,l=o/this.a,u=1,c=0,f=0,h=0;for(t=1;t<=6;t++)r=c*s+u*l,u=u*s-c*l,c=r,f=f+this.C_re[t]*u-this.C_im[t]*c,h=h+this.C_im[t]*u+this.C_re[t]*c;for(var d=0;d<this.iterations;d++){var p,y=f,g=h,v=s,m=l;for(t=2;t<=6;t++)p=g*f+y*h,y=y*f-g*h,g=p,v+=(t-1)*(this.B_re[t]*y-this.B_im[t]*g),m+=(t-1)*(this.B_im[t]*y+this.B_re[t]*g);y=1,g=0;var _=this.B_re[1],S=this.B_im[1];for(t=2;t<=6;t++)p=g*f+y*h,y=y*f-g*h,g=p,_+=t*(this.B_re[t]*y-this.B_im[t]*g),S+=t*(this.B_im[t]*y+this.B_re[t]*g);var x=_*_+S*S;f=(v*_+m*S)/x,h=(m*_-v*S)/x}var b=f,w=h,k=1,M=0;for(t=1;t<=9;t++)k*=b,M+=this.D[t]*k;var E=this.lat0+M*a*1e5,I=this.long0+w;return e.x=I,e.y=E,e},names:["New_Zealand_Map_Grid","nzmg"]},Ct={init:function(){},forward:function(e){var t=e.x,r=e.y,n=J(t-this.long0),i=this.x0+this.a*n,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;return e.x=i,e.y=o,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=J(this.long0+e.x/this.a),r=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=r,e},names:["Miller_Cylindrical","mill"]},Nt={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Xe(this.es)},forward:function(e){var t,r,n=e.x,i=e.y;if(n=J(n-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(i),a=20;a;--a){var s=(this.m*i+Math.sin(i)-o)/(this.m+Math.cos(i));if(i-=s,Math.abs(s)<f)break}else i=1!==this.n?Math.asin(this.n*Math.sin(i)):i;t=this.a*this.C_x*n*(this.m+Math.cos(i)),r=this.a*this.C_y*i}else{var l=Math.sin(i),u=Math.cos(i);r=this.a*Ye(i,l,u,this.en),t=this.a*n*u/Math.sqrt(1-this.es*l*l)}return e.x=t,e.y=r,e},inverse:function(e){var t,r,n,i;return e.x-=this.x0,n=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,n/=this.C_x*(this.m+Math.cos(t)),this.m?t=kt((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=kt(Math.sin(t)/this.n)),n=J(n+this.long0),t=_t(t)):(t=Ze(e.y/this.a,this.es,this.en),(i=Math.abs(t))<s?(i=Math.sin(t),r=this.long0+e.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(t)),n=J(r)):i-f<s&&(n=this.long0)),e.x=n,e.y=t,e},names:["Sinusoidal","sinu"]},Ot={init:function(){},forward:function(e){for(var t=e.x,r=e.y,n=J(t-this.long0),i=r,o=Math.PI*Math.sin(r);;){var a=-(i+Math.sin(i)-o)/(1+Math.cos(i));if(i+=a,Math.abs(a)<f)break}i/=2,Math.PI/2-Math.abs(r)<f&&(n=0);var s=.900316316158*this.a*n*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return e.x=s,e.y=l,e},inverse:function(e){var t,r;e.x-=this.x0,e.y-=this.y0,r=e.y/(1.4142135623731*this.a),Math.abs(r)>.999999999999&&(r=.999999999999),t=Math.asin(r);var n=J(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),r=(2*t+Math.sin(2*t))/Math.PI,Math.abs(r)>1&&(r=1);var i=Math.asin(r);return e.x=n,e.y=i,e},names:["Mollweide","moll"]},Rt={init:function(){Math.abs(this.lat1+this.lat2)<f||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=pt(this.es),this.e1=yt(this.es),this.e2=gt(this.es),this.e3=vt(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=q(this.e,this.sinphi,this.cosphi),this.ml1=dt(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<f?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=q(this.e,this.sinphi,this.cosphi),this.ml2=dt(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=dt(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(e){var t,r=e.x,n=e.y;if(this.sphere)t=this.a*(this.g-n);else{var i=dt(this.e0,this.e1,this.e2,this.e3,n);t=this.a*(this.g-i)}var o=this.ns*J(r-this.long0),a=this.x0+t*Math.sin(o),s=this.y0+this.rh-t*Math.cos(o);return e.x=a,e.y=s,e},inverse:function(e){var t,r,n,i;e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns>=0?(r=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(r=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var o=0;if(0!==r&&(o=Math.atan2(t*e.x,t*e.y)),this.sphere)return i=J(this.long0+o/this.ns),n=_t(this.g-r/this.a),e.x=i,e.y=n,e;var a=this.g-r/this.a;return n=St(a,this.e0,this.e1,this.e2,this.e3),i=J(this.long0+o/this.ns),e.x=i,e.y=n,e},names:["Equidistant_Conic","eqdc"]},Vt={init:function(){this.R=this.a},forward:function(e){var t,r,n=e.x,i=e.y,o=J(n-this.long0);Math.abs(i)<=f&&(t=this.x0+this.R*o,r=this.y0);var a=kt(2*Math.abs(i/Math.PI));(Math.abs(o)<=f||Math.abs(Math.abs(i)-s)<=f)&&(t=this.x0,r=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*a):this.y0+Math.PI*this.R*-Math.tan(.5*a));var l=.5*Math.abs(Math.PI/o-o/Math.PI),u=l*l,c=Math.sin(a),h=Math.cos(a),d=h/(c+h-1),p=d*d,y=d*(2/c-1),g=y*y,v=Math.PI*this.R*(l*(d-g)+Math.sqrt(u*(d-g)*(d-g)-(g+u)*(p-g)))/(g+u);o<0&&(v=-v),t=this.x0+v;var m=u+d;return v=Math.PI*this.R*(y*m-l*Math.sqrt((g+u)*(u+1)-m*m))/(g+u),r=i>=0?this.y0+v:this.y0-v,e.x=t,e.y=r,e},inverse:function(e){var t,r,n,i,o,a,s,l,u,c,h,d;return e.x-=this.x0,e.y-=this.y0,h=Math.PI*this.R,o=(n=e.x/h)*n+(i=e.y/h)*i,h=3*(i*i/(l=-2*(a=-Math.abs(i)*(1+o))+1+2*i*i+o*o)+(2*(s=a-2*i*i+n*n)*s*s/l/l/l-9*a*s/l/l)/27)/(u=(a-s*s/3/l)/l)/(c=2*Math.sqrt(-u/3)),Math.abs(h)>1&&(h=h>=0?1:-1),d=Math.acos(h)/3,r=e.y>=0?(-c*Math.cos(d+Math.PI/3)-s/3/l)*Math.PI:-(-c*Math.cos(d+Math.PI/3)-s/3/l)*Math.PI,t=Math.abs(n)<f?this.long0:J(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(n*n-i*i)+o*o))/2/n),e.x=t,e.y=r,e},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},Gt={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(e){var t,r,n,i,o,a,l,u,c,h,d,p,y,g,v,m,_,S,x,b,w,k,M=e.x,E=e.y,I=Math.sin(e.y),T=Math.cos(e.y),L=J(M-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=f?(e.x=this.x0+this.a*(s-E)*Math.sin(L),e.y=this.y0-this.a*(s-E)*Math.cos(L),e):Math.abs(this.sin_p12+1)<=f?(e.x=this.x0+this.a*(s+E)*Math.sin(L),e.y=this.y0+this.a*(s+E)*Math.cos(L),e):(S=this.sin_p12*I+this.cos_p12*T*Math.cos(L),_=(m=Math.acos(S))?m/Math.sin(m):1,e.x=this.x0+this.a*_*T*Math.sin(L),e.y=this.y0+this.a*_*(this.cos_p12*I-this.sin_p12*T*Math.cos(L)),e):(t=pt(this.es),r=yt(this.es),n=gt(this.es),i=vt(this.es),Math.abs(this.sin_p12-1)<=f?(o=this.a*dt(t,r,n,i,s),a=this.a*dt(t,r,n,i,E),e.x=this.x0+(o-a)*Math.sin(L),e.y=this.y0-(o-a)*Math.cos(L),e):Math.abs(this.sin_p12+1)<=f?(o=this.a*dt(t,r,n,i,s),a=this.a*dt(t,r,n,i,E),e.x=this.x0+(o+a)*Math.sin(L),e.y=this.y0+(o+a)*Math.cos(L),e):(l=I/T,u=mt(this.a,this.e,this.sin_p12),c=mt(this.a,this.e,I),h=Math.atan((1-this.es)*l+this.es*u*this.sin_p12/(c*T)),x=0===(d=Math.atan2(Math.sin(L),this.cos_p12*Math.tan(h)-this.sin_p12*Math.cos(L)))?Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.abs(Math.abs(d)-Math.PI)<=f?-Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.asin(Math.sin(L)*Math.cos(h)/Math.sin(d)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),m=u*x*(1-(b=x*x)*(v=(y=this.e*this.cos_p12*Math.cos(d)/Math.sqrt(1-this.es))*y)*(1-v)/6+(w=b*x)/8*(g=p*y)*(1-2*v)+(k=w*x)/120*(v*(4-7*v)-3*p*p*(1-7*v))-k*x/48*g),e.x=this.x0+m*Math.sin(d),e.y=this.y0+m*Math.cos(d),e))},inverse:function(e){var t,r,n,i,o,a,l,u,c,h,d,p,y,g,v,m,_,S,x,b,w,k,M;if(e.x-=this.x0,e.y-=this.y0,this.sphere){if((t=Math.sqrt(e.x*e.x+e.y*e.y))>2*s*this.a)return;return r=t/this.a,n=Math.sin(r),i=Math.cos(r),o=this.long0,Math.abs(t)<=f?a=this.lat0:(a=kt(i*this.sin_p12+e.y*n*this.cos_p12/t),l=Math.abs(this.lat0)-s,o=Math.abs(l)<=f?this.lat0>=0?J(this.long0+Math.atan2(e.x,-e.y)):J(this.long0-Math.atan2(-e.x,e.y)):J(this.long0+Math.atan2(e.x*n,t*this.cos_p12*i-e.y*this.sin_p12*n))),e.x=o,e.y=a,e}return u=pt(this.es),c=yt(this.es),h=gt(this.es),d=vt(this.es),Math.abs(this.sin_p12-1)<=f?(p=this.a*dt(u,c,h,d,s),t=Math.sqrt(e.x*e.x+e.y*e.y),a=St((p-t)/this.a,u,c,h,d),o=J(this.long0+Math.atan2(e.x,-1*e.y)),e.x=o,e.y=a,e):Math.abs(this.sin_p12+1)<=f?(p=this.a*dt(u,c,h,d,s),t=Math.sqrt(e.x*e.x+e.y*e.y),a=St((t-p)/this.a,u,c,h,d),o=J(this.long0+Math.atan2(e.x,e.y)),e.x=o,e.y=a,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),v=Math.atan2(e.x,e.y),y=mt(this.a,this.e,this.sin_p12),m=Math.cos(v),S=-(_=this.e*this.cos_p12*m)*_/(1-this.es),x=3*this.es*(1-S)*this.sin_p12*this.cos_p12*m/(1-this.es),k=1-S*(w=(b=t/y)-S*(1+S)*Math.pow(b,3)/6-x*(1+3*S)*Math.pow(b,4)/24)*w/2-b*w*w*w/6,g=Math.asin(this.sin_p12*Math.cos(w)+this.cos_p12*Math.sin(w)*m),o=J(this.long0+Math.asin(Math.sin(v)*Math.sin(w)/Math.cos(g))),M=Math.sin(g),a=Math.atan2((M-this.es*k*this.sin_p12)*Math.tan(g),M*(1-this.es)),e.x=o,e.y=a,e)},names:["Azimuthal_Equidistant","aeqd"]},At={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(e){var t,r,n,i,o,a,s,l=e.x,u=e.y;return n=J(l-this.long0),t=Math.sin(u),r=Math.cos(u),i=Math.cos(n),((o=this.sin_p14*t+this.cos_p14*r*i)>0||Math.abs(o)<=f)&&(a=1*this.a*r*Math.sin(n),s=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*r*i)),e.x=a,e.y=s,e},inverse:function(e){var t,r,n,i,o,a,l;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),r=kt(t/this.a),n=Math.sin(r),i=Math.cos(r),a=this.long0,Math.abs(t)<=f?(l=this.lat0,e.x=a,e.y=l,e):(l=kt(i*this.sin_p14+e.y*n*this.cos_p14/t),o=Math.abs(this.lat0)-s,Math.abs(o)<=f?(a=this.lat0>=0?J(this.long0+Math.atan2(e.x,-e.y)):J(this.long0-Math.atan2(-e.x,e.y)),e.x=a,e.y=l,e):(a=J(this.long0+Math.atan2(e.x*n,t*this.cos_p14*i-e.y*this.sin_p14*n)),e.x=a,e.y=l,e))},names:["ortho"]},Ft=1,Dt=2,jt=3,Bt=4,qt=5,Ut=6,Jt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function zt(e,t,r,n){var i;return e<f?(n.value=Jt.AREA_0,i=0):(i=Math.atan2(t,r),Math.abs(i)<=p?n.value=Jt.AREA_0:i>p&&i<=s+p?(n.value=Jt.AREA_1,i-=s):i>s+p||i<=-(s+p)?(n.value=Jt.AREA_2,i=i>=0?i-g:i+g):(n.value=Jt.AREA_3,i+=s)),i}function Wt(e,t){var r=e+t;return r<-g?r+=y:r>+g&&(r-=y),r}var Ht={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=s-p/2?this.face=qt:this.lat0<=-(s-p/2)?this.face=Ut:Math.abs(this.long0)<=p?this.face=Ft:Math.abs(this.long0)<=s+p?this.face=this.long0>0?Dt:Bt:this.face=jt,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(e){var t,r,n,i,o,a,l={x:0,y:0},u={value:0};if(e.x-=this.long0,t=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(e.y)):e.y,r=e.x,this.face===qt)i=s-t,r>=p&&r<=s+p?(u.value=Jt.AREA_0,n=r-s):r>s+p||r<=-(s+p)?(u.value=Jt.AREA_1,n=r>0?r-g:r+g):r>-(s+p)&&r<=-p?(u.value=Jt.AREA_2,n=r+s):(u.value=Jt.AREA_3,n=r);else if(this.face===Ut)i=s+t,r>=p&&r<=s+p?(u.value=Jt.AREA_0,n=-r+s):r<p&&r>=-p?(u.value=Jt.AREA_1,n=-r):r<-p&&r>=-(s+p)?(u.value=Jt.AREA_2,n=-r-s):(u.value=Jt.AREA_3,n=r>0?-r+g:-r-g);else{var c,f,h,d,y,v;this.face===Dt?r=Wt(r,+s):this.face===jt?r=Wt(r,+g):this.face===Bt&&(r=Wt(r,-s)),d=Math.sin(t),y=Math.cos(t),v=Math.sin(r),c=y*Math.cos(r),f=y*v,h=d,this.face===Ft?n=zt(i=Math.acos(c),h,f,u):this.face===Dt?n=zt(i=Math.acos(f),h,-c,u):this.face===jt?n=zt(i=Math.acos(-c),h,-f,u):this.face===Bt?n=zt(i=Math.acos(-f),h,c,u):(i=n=0,u.value=Jt.AREA_0)}return a=Math.atan(12/g*(n+Math.acos(Math.sin(n)*Math.cos(p))-s)),o=Math.sqrt((1-Math.cos(i))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(n))))),u.value===Jt.AREA_1?a+=s:u.value===Jt.AREA_2?a+=g:u.value===Jt.AREA_3&&(a+=1.5*g),l.x=o*Math.cos(a),l.y=o*Math.sin(a),l.x=l.x*this.a+this.x0,l.y=l.y*this.a+this.y0,e.x=l.x,e.y=l.y,e},inverse:function(e){var t,r,n,i,o,a,l,u,c,f,h,d,p={lam:0,phi:0},y={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,r=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),t=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?y.value=Jt.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(y.value=Jt.AREA_1,t-=s):e.x<0&&-e.x>=Math.abs(e.y)?(y.value=Jt.AREA_2,t=t<0?t+g:t-g):(y.value=Jt.AREA_3,t+=s),c=g/12*Math.tan(t),o=Math.sin(c)/(Math.cos(c)-1/Math.sqrt(2)),a=Math.atan(o),(l=1-(n=Math.cos(t))*n*(i=Math.tan(r))*i*(1-Math.cos(Math.atan(1/Math.cos(a)))))<-1?l=-1:l>1&&(l=1),this.face===qt)u=Math.acos(l),p.phi=s-u,y.value===Jt.AREA_0?p.lam=a+s:y.value===Jt.AREA_1?p.lam=a<0?a+g:a-g:y.value===Jt.AREA_2?p.lam=a-s:p.lam=a;else if(this.face===Ut)u=Math.acos(l),p.phi=u-s,y.value===Jt.AREA_0?p.lam=-a+s:y.value===Jt.AREA_1?p.lam=-a:y.value===Jt.AREA_2?p.lam=-a-s:p.lam=a<0?-a-g:-a+g;else{var v,m,_;c=(v=l)*v,m=(c+=(_=c>=1?0:Math.sqrt(1-c)*Math.sin(a))*_)>=1?0:Math.sqrt(1-c),y.value===Jt.AREA_1?(c=m,m=-_,_=c):y.value===Jt.AREA_2?(m=-m,_=-_):y.value===Jt.AREA_3&&(c=m,m=_,_=-c),this.face===Dt?(c=v,v=-m,m=c):this.face===jt?(v=-v,m=-m):this.face===Bt&&(c=v,v=m,m=-c),p.phi=Math.acos(-_)-s,p.lam=Math.atan2(m,v),this.face===Dt?p.lam=Wt(p.lam,-s):this.face===jt?p.lam=Wt(p.lam,-g):this.face===Bt&&(p.lam=Wt(p.lam,+s))}return 0!==this.es&&(f=p.phi<0?1:0,h=Math.tan(p.phi),d=this.b/Math.sqrt(h*h+this.one_minus_f_squared),p.phi=Math.atan(Math.sqrt(this.a*this.a-d*d)/(this.one_minus_f*d)),f&&(p.phi=-p.phi)),p.lam+=this.long0,e.x=p.lam,e.y=p.phi,e},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},Xt=[[1,2.2199e-17,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Yt=[[-5.20417e-18,.0124,1.21431e-18,-8.45284e-11],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Zt=d/5,Kt=1/Zt,Qt=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},$t={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(e){var t=J(e.x-this.long0),r=Math.abs(e.y),n=Math.floor(r*Zt);n<0?n=0:n>=18&&(n=17);var i={x:Qt(Xt[n],r=d*(r-Kt*n))*t,y:Qt(Yt[n],r)};return e.y<0&&(i.y=-i.y),i.x=i.x*this.a*.8487+this.x0,i.y=i.y*this.a*1.3523+this.y0,i},inverse:function(e){var t={x:(e.x-this.x0)/(.8487*this.a),y:Math.abs(e.y-this.y0)/(1.3523*this.a)};if(t.y>=1)t.x/=Xt[18][0],t.y=e.y<0?-s:s;else{var r=Math.floor(18*t.y);for(r<0?r=0:r>=18&&(r=17);;)if(Yt[r][0]>t.y)--r;else{if(!(Yt[r+1][0]<=t.y))break;++r}var n=Yt[r],i=5*(t.y-n[0])/(Yt[r+1][0]-n[0]);i=function(e,t,r,n){for(var i=t;n;--n){var o=e(i);if(i-=o,Math.abs(o)<r)break}return i}(function(e){return(Qt(n,e)-t.y)/function(e,t){return e[1]+t*(2*e[2]+3*t*e[3])}(n,e)},i,f,100),t.x/=Qt(Xt[r],i),t.y=(5*r+i)*h,e.y<0&&(t.y=-t.y)}return t.x=J(t.x+this.long0),t},names:["Robinson","robin"]},er={init:function(){this.name="geocent"},forward:function(e){return he(e,this.es,this.a)},inverse:function(e){return de(e,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]},tr=0,rr=1,nr=2,ir=3,or={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}},ar={init:function(){if(Object.keys(or).forEach(function(e){if(void 0===this[e])this[e]=or[e].def;else{if(or[e].num&&isNaN(this[e]))throw new Error("Invalid parameter value, must be numeric "+e+" = "+this[e]);or[e].num&&(this[e]=parseFloat(this[e]))}or[e].degrees&&(this[e]=this[e]*h)}.bind(this)),Math.abs(Math.abs(this.lat0)-s)<f?this.mode=this.lat0<0?rr:tr:Math.abs(this.lat0)<f?this.mode=nr:(this.mode=ir,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(e),this.sw=Math.sin(e)},forward:function(e){e.x-=this.long0;var t,r,n,i,o=Math.sin(e.y),a=Math.cos(e.y),s=Math.cos(e.x);switch(this.mode){case ir:r=this.sinph0*o+this.cosph0*a*s;break;case nr:r=a*s;break;case rr:r=-o;break;case tr:r=o}switch(t=(r=this.pn1/(this.p-r))*a*Math.sin(e.x),this.mode){case ir:r*=this.cosph0*o-this.sinph0*a*s;break;case nr:r*=o;break;case tr:r*=-a*s;break;case rr:r*=a*s}return i=1/((n=r*this.cg+t*this.sg)*this.sw*this.h1+this.cw),t=(t*this.cg-r*this.sg)*this.cw*i,r=n*i,e.x=t*this.a,e.y=r*this.a,e},inverse:function(e){e.x/=this.a,e.y/=this.a;var t,r,n,i={x:e.x,y:e.y};n=1/(this.pn1-e.y*this.sw),t=this.pn1*e.x*n,r=this.pn1*e.y*this.cw*n,e.x=t*this.cg+r*this.sg,e.y=r*this.cg-t*this.sg;var o=$e(e.x,e.y);if(Math.abs(o)<f)i.x=0,i.y=e.y;else{var a,s;switch(s=1-o*o*this.pfact,s=(this.p-Math.sqrt(s))/(this.pn1/o+o/this.pn1),a=Math.sqrt(1-s*s),this.mode){case ir:i.y=Math.asin(a*this.sinph0+e.y*s*this.cosph0/o),e.y=(a-this.sinph0*Math.sin(i.y))*o,e.x*=s*this.cosph0;break;case nr:i.y=Math.asin(e.y*s/o),e.y=a*o,e.x*=s;break;case tr:i.y=Math.asin(a),e.y=-e.y;break;case rr:i.y=-Math.asin(a)}i.x=Math.atan2(e.x,e.y)}return e.x=i.x+this.long0,e.y=i.y,e},names:["Tilted_Perspective","tpers"]},sr={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var e=1-this.es,t=1/e;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(e){var t,r,n,i,o=e.x,a=e.y;if(o-=this.long0,"ellipse"===this.shape){a=Math.atan(this.radius_p2*Math.tan(a));var s=this.radius_p/$e(this.radius_p*Math.cos(a),Math.sin(a));if(r=s*Math.cos(o)*Math.cos(a),n=s*Math.sin(o)*Math.cos(a),i=s*Math.sin(a),(this.radius_g-r)*r-n*n-i*i*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;t=this.radius_g-r,this.flip_axis?(e.x=this.radius_g_1*Math.atan(n/$e(i,t)),e.y=this.radius_g_1*Math.atan(i/t)):(e.x=this.radius_g_1*Math.atan(n/t),e.y=this.radius_g_1*Math.atan(i/$e(n,t)))}else"sphere"===this.shape&&(t=Math.cos(a),r=Math.cos(o)*t,n=Math.sin(o)*t,i=Math.sin(a),t=this.radius_g-r,this.flip_axis?(e.x=this.radius_g_1*Math.atan(n/$e(i,t)),e.y=this.radius_g_1*Math.atan(i/t)):(e.x=this.radius_g_1*Math.atan(n/t),e.y=this.radius_g_1*Math.atan(i/$e(n,t))));return e.x=e.x*this.a,e.y=e.y*this.a,e},inverse:function(e){var t,r,n,i,o=-1,a=0,s=0;if(e.x=e.x/this.a,e.y=e.y/this.a,"ellipse"===this.shape){this.flip_axis?(s=Math.tan(e.y/this.radius_g_1),a=Math.tan(e.x/this.radius_g_1)*$e(1,s)):(a=Math.tan(e.x/this.radius_g_1),s=Math.tan(e.y/this.radius_g_1)*$e(1,a));var l=s/this.radius_p;if(t=a*a+l*l+o*o,(n=(r=2*this.radius_g*o)*r-4*t*this.C)<0)return e.x=Number.NaN,e.y=Number.NaN,e;i=(-r-Math.sqrt(n))/(2*t),o=this.radius_g+i*o,a*=i,s*=i,e.x=Math.atan2(a,o),e.y=Math.atan(s*Math.cos(e.x)/o),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if("sphere"===this.shape){if(this.flip_axis?(s=Math.tan(e.y/this.radius_g_1),a=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+s*s)):(a=Math.tan(e.x/this.radius_g_1),s=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+a*a)),t=a*a+s*s+o*o,(n=(r=2*this.radius_g*o)*r-4*t*this.C)<0)return e.x=Number.NaN,e.y=Number.NaN,e;i=(-r-Math.sqrt(n))/(2*t),o=this.radius_g+i*o,a*=i,s*=i,e.x=Math.atan2(a,o),e.y=Math.atan(s*Math.cos(e.x)/o)}return e.x=e.x+this.long0,e},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};Ie.defaultDatum="WGS84",Ie.Proj=fe,Ie.WGS84=new Ie.Proj("WGS84"),Ie.Point=We,Ie.toPoint=Se,Ie.defs=A,Ie.nadgrid=function(e,t){var r=new DataView(t),n=function(e){var t=e.getInt32(8,!1);return 11!==t&&(11!==(t=e.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(r),i=function(e,t){return{nFields:e.getInt32(8,t),nSubgridFields:e.getInt32(24,t),nSubgrids:e.getInt32(40,t),shiftType:ae(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,t),fromSemiMinorAxis:e.getFloat64(136,t),toSemiMajorAxis:e.getFloat64(152,t),toSemiMinorAxis:e.getFloat64(168,t)}}(r,n);i.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var o={header:i,subgrids:function(e,t,r){for(var n=[],i=0;i<t.nSubgrids;i++){var o=le(e,176,r),a=ue(e,176,o,r),s=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),l=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);n.push({ll:[oe(o.lowerLongitude),oe(o.lowerLatitude)],del:[oe(o.longitudeInterval),oe(o.latitudeInterval)],lim:[s,l],count:o.gridNodeCount,cvs:se(a)})}return n}(r,i,n)};return ne[e]=o,o},Ie.transform=we,Ie.mgrs=Ge,Ie.version="__VERSION__",function(e){e.Proj.projections.add(Ke),e.Proj.projections.add(rt),e.Proj.projections.add(nt),e.Proj.projections.add(at),e.Proj.projections.add(st),e.Proj.projections.add(lt),e.Proj.projections.add(ct),e.Proj.projections.add(ft),e.Proj.projections.add(ht),e.Proj.projections.add(xt),e.Proj.projections.add(wt),e.Proj.projections.add(Mt),e.Proj.projections.add(Et),e.Proj.projections.add(It),e.Proj.projections.add(Tt),e.Proj.projections.add(Lt),e.Proj.projections.add(Pt),e.Proj.projections.add(Ct),e.Proj.projections.add(Nt),e.Proj.projections.add(Ot),e.Proj.projections.add(Rt),e.Proj.projections.add(Vt),e.Proj.projections.add(Gt),e.Proj.projections.add(At),e.Proj.projections.add(Ht),e.Proj.projections.add($t),e.Proj.projections.add(er),e.Proj.projections.add(ar),e.Proj.projections.add(sr)}(Ie),t.default=Ie},function(e,t,r){r(247),e.exports=r(12).Object.keys},function(e,t,r){var n=r(51),i=r(61);r(90)("keys",function(){return function(e){return i(n(e))}})},function(e,t,r){var n=r(44),i=r(88),o=r(249);e.exports=function(e){return function(t,r,a){var s,l=n(t),u=i(l.length),c=o(a,u);if(e&&r!=r){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===r)return e||c||0;return!e&&-1}}},function(e,t,r){var n=r(108),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):o(e,t)}},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var l,u=[],c=!1,f=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):f=-1,u.length&&d())}function d(){if(!c){var e=s(h);c=!0;for(var t=u.length;t;){for(l=u,u=[];++f<t;)l&&l[f].run();f=-1,t=u.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||c||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){r(252);var n=r(12).Object;e.exports=function(e,t){return n.defineProperties(e,t)}},function(e,t,r){var n=r(18);n(n.S+n.F*!r(26),"Object",{defineProperties:r(151)})},function(e,t,r){r(114),r(63),r(76),r(258),r(262),r(263),e.exports=r(12).Promise},function(e,t,r){var n=r(108),i=r(106);e.exports=function(e){return function(t,r){var o,a,s=String(i(t)),l=n(r),u=s.length;return l<0||l>=u?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(e,t,r){"use strict";var n=r(91),i=r(62),o=r(75),a={};r(45)(a,r(21)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(a,{next:i(1,r)}),o(e,t+" Iterator")}},function(e,t,r){"use strict";var n=r(257),i=r(154),o=r(64),a=r(44);e.exports=r(115)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(e,t){e.exports=function(){}},function(e,t,r){"use strict";var n,i,o,a,s=r(73),l=r(20),u=r(34),c=r(93),f=r(18),h=r(24),d=r(74),p=r(116),y=r(77),g=r(157),v=r(158).set,m=r(260)(),_=r(118),S=r(159),x=r(261),b=r(160),w=l.TypeError,k=l.process,M=k&&k.versions,E=M&&M.v8||"",I=l.Promise,T="process"==c(k),L=function(){},P=i=_.f,C=!!function(){try{var e=I.resolve(1),t=(e.constructor={})[r(21)("species")]=function(e){e(L,L)};return(T||"function"==typeof PromiseRejectionEvent)&&e.then(L)instanceof t&&0!==E.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(e){}}(),N=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},O=function(e,t){if(!e._n){e._n=!0;var r=e._c;m(function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{s?(i||(2==e._h&&G(e),e._h=1),!0===s?r=n:(c&&c.enter(),r=s(n),c&&(c.exit(),a=!0)),r===t.promise?u(w("Promise-chain cycle")):(o=N(r))?o.call(r,l,u):l(r)):u(n)}catch(e){c&&!a&&c.exit(),u(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&R(e)})}},R=function(e){v.call(l,function(){var t,r,n,i=e._v,o=V(e);if(o&&(t=S(function(){T?k.emit("unhandledRejection",i,e):(r=l.onunhandledrejection)?r({promise:e,reason:i}):(n=l.console)&&n.error&&n.error("Unhandled promise rejection",i)}),e._h=T||V(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},V=function(e){return 1!==e._h&&0===(e._a||e._c).length},G=function(e){v.call(l,function(){var t;T?k.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},A=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),O(t,!0))},F=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw w("Promise can't be resolved itself");(t=N(e))?m(function(){var n={_w:r,_d:!1};try{t.call(e,u(F,n,1),u(A,n,1))}catch(e){A.call(n,e)}}):(r._v=e,r._s=1,O(r,!1))}catch(e){A.call({_w:r,_d:!1},e)}}};C||(I=function(e){p(this,I,"Promise","_h"),d(e),n.call(this);try{e(u(F,this,1),u(A,this,1))}catch(e){A.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(119)(I.prototype,{then:function(e,t){var r=P(g(this,I));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=T?k.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&O(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=u(F,e,1),this.reject=u(A,e,1)},_.f=P=function(e){return e===I||e===a?new o(e):i(e)}),f(f.G+f.W+f.F*!C,{Promise:I}),r(75)(I,"Promise"),r(161)("Promise"),a=r(12).Promise,f(f.S+f.F*!C,"Promise",{reject:function(e){var t=P(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(s||!C),"Promise",{resolve:function(e){return b(s&&this===a?I:this,e)}}),f(f.S+f.F*!(C&&r(162)(function(e){I.all(e).catch(L)})),"Promise",{all:function(e){var t=this,r=P(t),n=r.resolve,i=r.reject,o=S(function(){var r=[],o=0,a=1;y(e,!1,function(e){var s=o++,l=!1;r.push(void 0),a++,t.resolve(e).then(function(e){l||(l=!0,r[s]=e,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=P(t),n=r.reject,i=S(function(){y(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(20),i=r(158).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,l="process"==r(72)(a);e.exports=function(){var e,t,r,u=function(){var n,i;for(l&&(n=a.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(l)r=function(){a.nextTick(u)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);r=function(){c.then(u)}}else r=function(){i.call(n,u)};else{var f=!0,h=document.createTextNode("");new o(u).observe(h,{characterData:!0}),r=function(){h.data=f=!f}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},function(e,t,r){var n=r(20).navigator;e.exports=n&&n.userAgent||""},function(e,t,r){"use strict";var n=r(18),i=r(12),o=r(20),a=r(157),s=r(160);n(n.P+n.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){"use strict";var n=r(18),i=r(118),o=r(159);n(n.S,"Promise",{try:function(e){var t=i.f(this),r=o(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t,r){e.exports={default:r(265),__esModule:!0}},function(e,t,r){r(266);var n=r(12).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},function(e,t,r){var n=r(18);n(n.S+n.F*!r(26),"Object",{defineProperty:r(27).f})},function(e,t,r){r(63),r(268),e.exports=r(12).Array.from},function(e,t,r){"use strict";var n=r(34),i=r(18),o=r(51),a=r(155),s=r(156),l=r(88),u=r(269),c=r(117);i(i.S+i.F*!r(162)(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,i,f,h=o(e),d="function"==typeof this?this:Array,p=arguments.length,y=p>1?arguments[1]:void 0,g=void 0!==y,v=0,m=c(h);if(g&&(y=n(y,p>2?arguments[2]:void 0,2)),void 0==m||d==Array&&s(m))for(r=new d(t=l(h.length));t>v;v++)u(r,v,g?y(h[v],v):h[v]);else for(f=m.call(h),r=new d;!(i=f.next()).done;v++)u(r,v,g?a(f,y,[i.value,v],!0):i.value);return r.length=v,r}})},function(e,t,r){"use strict";var n=r(27),i=r(62);e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},function(e,t,r){var n=r(12),i=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},function(e,t,r){e.exports={default:r(272),__esModule:!0}},function(e,t,r){r(63),r(76),e.exports=r(121).f("iterator")},function(e,t,r){e.exports={default:r(274),__esModule:!0}},function(e,t,r){r(275),r(114),r(278),r(279),e.exports=r(12).Symbol},function(e,t,r){"use strict";var n=r(20),i=r(33),o=r(26),a=r(18),s=r(152),l=r(94).KEY,u=r(52),c=r(110),f=r(75),h=r(89),d=r(21),p=r(121),y=r(122),g=r(276),v=r(163),m=r(28),_=r(24),S=r(51),x=r(44),b=r(113),w=r(62),k=r(91),M=r(277),E=r(79),I=r(123),T=r(27),L=r(61),P=E.f,C=T.f,N=M.f,O=n.Symbol,R=n.JSON,V=R&&R.stringify,G=d("_hidden"),A=d("toPrimitive"),F={}.propertyIsEnumerable,D=c("symbol-registry"),j=c("symbols"),B=c("op-symbols"),q=Object.prototype,U="function"==typeof O&&!!I.f,J=n.QObject,z=!J||!J.prototype||!J.prototype.findChild,W=o&&u(function(){return 7!=k(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=P(q,t);n&&delete q[t],C(e,t,r),n&&e!==q&&C(q,t,n)}:C,H=function(e){var t=j[e]=k(O.prototype);return t._k=e,t},X=U&&"symbol"==typeof O.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof O},Y=function(e,t,r){return e===q&&Y(B,t,r),m(e),t=b(t,!0),m(r),i(j,t)?(r.enumerable?(i(e,G)&&e[G][t]&&(e[G][t]=!1),r=k(r,{enumerable:w(0,!1)})):(i(e,G)||C(e,G,w(1,{})),e[G][t]=!0),W(e,t,r)):C(e,t,r)},Z=function(e,t){m(e);for(var r,n=g(t=x(t)),i=0,o=n.length;o>i;)Y(e,r=n[i++],t[r]);return e},K=function(e){var t=F.call(this,e=b(e,!0));return!(this===q&&i(j,e)&&!i(B,e))&&(!(t||!i(this,e)||!i(j,e)||i(this,G)&&this[G][e])||t)},Q=function(e,t){if(e=x(e),t=b(t,!0),e!==q||!i(j,t)||i(B,t)){var r=P(e,t);return!r||!i(j,t)||i(e,G)&&e[G][t]||(r.enumerable=!0),r}},$=function(e){for(var t,r=N(x(e)),n=[],o=0;r.length>o;)i(j,t=r[o++])||t==G||t==l||n.push(t);return n},ee=function(e){for(var t,r=e===q,n=N(r?B:x(e)),o=[],a=0;n.length>a;)!i(j,t=n[a++])||r&&!i(q,t)||o.push(j[t]);return o};U||(s((O=function(){if(this instanceof O)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(r){this===q&&t.call(B,r),i(this,G)&&i(this[G],e)&&(this[G][e]=!1),W(this,e,w(1,r))};return o&&z&&W(q,e,{configurable:!0,set:t}),H(e)}).prototype,"toString",function(){return this._k}),E.f=Q,T.f=Y,r(164).f=M.f=$,r(78).f=K,I.f=ee,o&&!r(73)&&s(q,"propertyIsEnumerable",K,!0),p.f=function(e){return H(d(e))}),a(a.G+a.W+a.F*!U,{Symbol:O});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),re=0;te.length>re;)d(te[re++]);for(var ne=L(d.store),ie=0;ne.length>ie;)y(ne[ie++]);a(a.S+a.F*!U,"Symbol",{for:function(e){return i(D,e+="")?D[e]:D[e]=O(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in D)if(D[t]===e)return t},useSetter:function(){z=!0},useSimple:function(){z=!1}}),a(a.S+a.F*!U,"Object",{create:function(e,t){return void 0===t?k(e):Z(k(e),t)},defineProperty:Y,defineProperties:Z,getOwnPropertyDescriptor:Q,getOwnPropertyNames:$,getOwnPropertySymbols:ee});var oe=u(function(){I.f(1)});a(a.S+a.F*oe,"Object",{getOwnPropertySymbols:function(e){return I.f(S(e))}}),R&&a(a.S+a.F*(!U||u(function(){var e=O();return"[null]"!=V([e])||"{}"!=V({a:e})||"{}"!=V(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(_(t)||void 0!==e)&&!X(e))return v(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!X(t))return t}),n[1]=t,V.apply(R,n)}}),O.prototype[A]||r(45)(O.prototype,A,O.prototype.valueOf),f(O,"Symbol"),f(Math,"Math",!0),f(n.JSON,"JSON",!0)},function(e,t,r){var n=r(61),i=r(123),o=r(78);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var a,s=r(e),l=o.f,u=0;s.length>u;)l.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,r){var n=r(44),i=r(164).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(n(e))}},function(e,t,r){r(122)("asyncIterator")},function(e,t,r){r(122)("observable")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(2)),a=u(r(4)),s=u(r(7)),l=u(r(5));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,o.default)(t,[{key:"initPropertys",value:function(e){var r=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"initPropertys",this).call(this,e);this.message=r.message}}]),t}(u(r(47)).default);t.default=c},function(e,t,r){r(282),e.exports=r(12).Object.getPrototypeOf},function(e,t,r){var n=r(51),i=r(92);r(90)("getPrototypeOf",function(){return function(e){return i(n(e))}})},function(e,t,r){e.exports={default:r(284),__esModule:!0}},function(e,t,r){r(285);var n=r(12).Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}},function(e,t,r){var n=r(44),i=r(79).f;r(90)("getOwnPropertyDescriptor",function(){return function(e,t){return i(n(e),t)}})},function(e,t,r){e.exports={default:r(287),__esModule:!0}},function(e,t,r){r(288),e.exports=r(12).Object.setPrototypeOf},function(e,t,r){var n=r(18);n(n.S,"Object",{setPrototypeOf:r(289).set})},function(e,t,r){var n=r(24),i=r(28),o=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r(34)(Function.call,r(79).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return o(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:o}},function(e,t,r){r(291);var n=r(12).Object;e.exports=function(e,t){return n.create(e,t)}},function(e,t,r){var n=r(18);n(n.S,"Object",{create:r(91)})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"initPropertys",value:function(e){var t=e||{};return this.target=t.target,this.sourceTarget=t.sourceTarget,this.eventData=t.eventData,this.sourceEventData=t.sourceEventData,this.eventPath=t.eventPath||[],t}}]),t}(l(r(47)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(2)),a=u(r(4)),s=u(r(5)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"initPropertys",value:function(e){var t=(0,l.defaultValue)(e,{});return this.added=(0,l.defaultValue)(t.added,[]),this.removed=(0,l.defaultValue)(t.removed,[]),this.moved=(0,l.defaultValue)(t.moved,[]),this.sourceTarget=t.sourceTarget,this.target=t.target,t}}]),t}(u(r(47)).default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(2)),a=u(r(4)),s=u(r(5)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"initPropertys",value:function(e){var t=(0,l.defaultValue)(e,{});return this.added=(0,l.defaultValue)(t.added,[]),this.removed=(0,l.defaultValue)(t.removed,[]),this.moved=(0,l.defaultValue)(t.moved,[]),this.path=(0,l.defaultValue)(t.path,[]),this.sourceTarget=t.sourceTarget,this.target=t.target,t}}]),t}(u(r(47)).default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(2)),a=u(r(4)),s=u(r(5)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"initPropertys",value:function(e){var t=(0,l.defaultValue)(e,{});return this.addDetail=(0,l.defaultValue)(t.addDetail,[]),t}}]),t}(u(r(47)).default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(2)),a=u(r(4)),s=u(r(5)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"initPropertys",value:function(e){var t=(0,l.defaultValue)(e,{});return this.basemap=(0,l.defaultValue)(t.basemap,null),this.detail=(0,l.defaultValue)(t.detail,[]),t}}]),t}(u(r(47)).default);t.default=c},function(e,t,r){e.exports={default:r(298),__esModule:!0}},function(e,t,r){r(299),e.exports=r(12).Reflect.set},function(e,t,r){var n=r(27),i=r(79),o=r(92),a=r(33),s=r(18),l=r(62),u=r(28),c=r(24);s(s.S,"Reflect",{set:function e(t,r,s){var f,h,d=arguments.length<4?t:arguments[3],p=i.f(u(t),r);if(!p){if(c(h=o(t)))return e(h,r,s,d);p=l(0)}if(a(p,"value")){if(!1===p.writable||!c(d))return!1;if(f=i.f(d,r)){if(f.get||f.set||!1===f.writable)return!1;f.value=s,n.f(d,r,f)}else n.f(d,r,l(0,s));return!0}return void 0!==p.set&&(p.set.call(d,s),!0)}})},function(e,t,r){e.exports={default:r(301),__esModule:!0}},function(e,t,r){r(302),e.exports=r(12).Reflect.get},function(e,t,r){var n=r(79),i=r(92),o=r(33),a=r(18),s=r(24),l=r(28);a(a.S,"Reflect",{get:function e(t,r){var a,u,c=arguments.length<3?t:arguments[2];return l(t)===c?t[r]:(a=n.f(t,r))?o(a,"value")?a.value:void 0!==a.get?a.get.call(c):void 0:s(u=i(t))?e(u,r,c):void 0}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cancelFn=t.requestFn=t.emptyImageUrl=t.isArray=t.lastId=t.create=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(165));t.extend=function(e){var t,r=void 0,n=void 0,i=void 0;for(n=1,t=arguments.length;n<t;n++)for(r in i=arguments[n])e[r]=i[r];return e},t.bind=o,t.stamp=function(e){return e._leaflet_id},t.throttle=function(e,t,r){var n=void 0,i=void 0,o=void 0,a=function(){n=!1,i&&(o.apply(r,i),i=!1)};return o=function(){n?i=arguments:(e.apply(r,arguments),setTimeout(a,t),n=!0)}},t.wrapNum=function(e,t,r){var n=t[1],i=t[0],o=n-i;return e===n&&r?e:((e-i)%o+o)%o+i},t.falseFn=function(){return!1},t.formatNum=function(e,t){var r=Math.pow(10,void 0===t?6:t);return Math.round(e*r)/r},t.trim=a,t.splitWords=function(e){return a(e).split(/\s+/)},t.setOptions=function(e,t){for(var r in Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?i(e.options):{}),t)e.options[r]=t[r];return e.options},t.getParamString=function(e,t,r){var n=[];for(var i in e)n.push(encodeURIComponent(r?i.toUpperCase():i)+"="+encodeURIComponent(e[i]));return(t&&-1!==t.indexOf("?")?"&":"?")+n.join("&")},t.template=function(e,t){return e.replace(s,function(e,r){var n=t[r];if(void 0===n)throw new Error("No value provided for variable "+e);return"function"==typeof n&&(n=n(t)),n})},t.indexOf=function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1},t.requestAnimFrame=function(e,t,r){if(!r||f!==c)return f.call(window,o(e,t));e.call(t)},t.cancelAnimFrame=function(e){e&&h.call(window,e)};var i=t.create=n.default||function(){function e(){}return function(t){return e.prototype=t,new e}}();function o(e,t){var r=Array.prototype.slice;if(e.bind)return e.bind.apply(e,r.call(arguments,1));var n=r.call(arguments,2);return function(){return e.apply(t,n.length?n.concat(r.call(arguments)):arguments)}}function a(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}t.lastId=0;var s=/\{ *([\w_-]+) *\}/g;function l(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}t.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.emptyImageUrl="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";var u=0;function c(e){var t=+new Date,r=Math.max(0,16-(t-u));return u=t+r,window.setTimeout(e,r)}var f=t.requestFn=window.requestAnimationFrame||l("RequestAnimationFrame")||c,h=t.cancelFn=window.cancelAnimationFrame||l("CancelAnimationFrame")||l("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(11)),i=f(r(3)),o=f(r(0)),a=f(r(2)),s=f(r(4)),l=f(r(5)),u=r(1),c=f(r(124));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r.type="collection-flat",e=(0,u.defaultValue)(e,{}),r.getCollections=e.getCollections||function(){return[]},r._cacheCollections=r.getCollections(),r.getChildrenFunction=e.getChildrenFunction,r._refresh(),r._cacheCollections.forEach(function(e){r._addRefreshHandler(e)}),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_refresh",value:function(e){var t=this,r=this._cacheCollections;if(r&&Array.isArray(r)){var n=0;r.forEach(function(e){n=t._processCollection(n,e)}),this._items.splice(n,this._items.length-n)}else this.removeAll()}},{key:"_processCollection",value:function(e,t){var r=this;return t?(t.forEach(function(n){if(n){var i=r._items.findIndex(function(e){return e===n});if(i>-1?i!==e&&r._reorder(n,e):r._add(n,e),e+=1,r.getChildrenFunction){var o=r.getChildrenFunction(n);o&&(Array.isArray(o)?o.forEach(function(n){n instanceof c.default&&(e=r._processCollection(e,n),n._addParentCollection(t))}):o instanceof c.default&&(e=r._processCollection(e,o),o._addParentCollection(t)))}}}),e):e}},{key:"_addCollection",value:function(e,t){var r=(0,u.defaultValue)(t,this._cacheCollections.length);r=Math.max(0,Math.min(this._cacheCollections.length,t)),this._cacheCollections.splice(r,0,e),this._addRefreshHandler(e),this._refresh()}},{key:"_removeCollection",value:function(e){var t=this._cacheCollections.indexOf(function(t){return t===e});t>-1&&(this._cacheCollections.splice(t,1),this._removeRreshHandler(e),this._refresh())}},{key:"_addRefreshHandler",value:function(e){e&&e.on("collection-refresh",this._refresh,this)}},{key:"_removeRreshHandler",value:function(e){e&&e.off("collection-refresh",this._refresh,this)}}]),t}(c.default);(0,n.default)(h.prototype,{items:{get:function(){return this._items},set:function(e){}}}),t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.statisticType=(0,o.defaultValue)(t.statisticType,void 0),this.onStatisticField=(0,o.defaultValue)(t.onStatisticField,void 0),this.outStatisticFieldName=(0,o.defaultValue)(t.outStatisticFieldName,void 0),(0,o.isNull)(this.statisticType)&&console.warn("statisticType不能为空！"),(0,o.isNull)(this.onStatisticField)&&console.warn("onStatisticField不能为空！")}return(0,i.default)(e,[{key:"toString",value:function(){var e="";return(0,o.isNull)(this.statisticType)||(0,o.isNull)(this.onStatisticField)||((0,o.isNull)(this.outStatisticFieldName)?e+='{"statisticType":"'+this.statisticType+'","onStatisticField":"'+this.onStatisticField+'"}':e+='{"statisticType":"'+this.statisticType+'","onStatisticField":"'+this.onStatisticField+'","outStatisticFieldName":"'+this.outStatisticFieldName+'"}'),e}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),this.ProjAngleUnit=(0,i.defaultValue)(4,t.ProjAngleUnit),this.ProjLat=(0,i.defaultValue)(0,t.ProjLat),this.ProjLat1=(0,i.defaultValue)(25e4,t.ProjLat1),this.ProjLat2=(0,i.defaultValue)(47e4,t.ProjLat2),this.ProjLon=(0,i.defaultValue)(105e4,t.ProjLon),this.ProjRate=(0,i.defaultValue)(14e6,t.ProjRate),this.ProjType=(0,i.defaultValue)(3,t.ProjType),this.ProjTypeID=(0,i.defaultValue)(2,t.ProjTypeID),this.ProjUnit=(0,i.defaultValue)(1,t.ProjUnit),this.ProjZoneNO=(0,i.defaultValue)(18,t.ProjZoneNO),this.ProjZoneType=(0,i.defaultValue)(0,t.ProjZoneType),this.SphereID=(0,i.defaultValue)(2,t.SphereID)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),this.DesSrsID=(0,i.defaultValue)(610,t.DesSrsID),this.GdbInfo=(0,i.defaultValue)({GDBName:"示例数据",GDBSvrName:"MapGISLocal",Password:"",User:""},t.DesSrsID)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={HTML:"html",JSON:"json",png:"png",jpg:"jpg",gif:"gif"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:"GET",post:"POST",put:"PUT",delete:"DELETE"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={layerViewCreated:"layerview-created",layerViewCreatedError:"layerview-created-error",layerViewRemove:"layerview-remove",layerViewUpdate:"layerview-update",layerLoaded:"layer-loaded",layerLoadError:"layer-load-error",featureAdd:"feature-add",layerUpdate:"layer-update",layerUpdateStyle:"update-style",layerUpdateOpacity:"layer-update-opacity",layerUpdateVisible:"layer-update-visible",layerSublayerVisible:"layer-sublayer-visible"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={layerAdd:"layer-add",layerAddMany:"layer-add-many",layerRemove:"layer-remove",layerRemoveMany:"layer-remove-many",layerRemoveAll:"layer-remove-all",layerChange:"map-layer-change",layerLoaded:"map-layer-loaded",loaded:"loaded",basemapChange:"basemap-change"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={functionMax:"FUNCTION_MAX",functionMin:"FUNCTION_MIN",functionSum:"FUNCTION_SUM",functionAvg:"FUNCTION_AVG",functionCount:"FUNCTION_COUNT",functionMaxOID:"FUNCTION_MAX_OID"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={Intersects:"Intersects",EnvelopeIntersects:"EnvelopeIntersects",Contains:"Contains",Disjoint:"Disjoint"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={baseLayer:"baselayer",unknown:"unknown",tile:"tile",igsTile:"igs-tile",arcgisTile:"arcgis-tile",vectorTile:"vectorTile",vectorTileSubLayer:"vectorTileSubLayer",igsVectorTile:"igs-vectorTile",mapImage:"map-image",igsMapImage:"igs-map-image",arcgisMapImage:"arcgis-map-image",ogc:"ogc",wms:"wms",wmts:"wmts",wfs:"wfs",feature:"feature",igsFeature:"igs-feature",geojson:"geojson",overlay:"overlay",mapv:"mapv",echarts:"echarts",elevation:"elevation",modelCache:"model-cache",m3d:"m3d",m3dCache:"m3d-cache",scene:"scene",cesium3DTiles:"cesium3DTiles",group:"group",tdt:"tdt",baidu:"baidu",gaode:"gaode",terrain:"terrain",graphics:"graphics",arcgisVectorTile:"arcgis-vectorTile",webTileLayer:"web-tile-layer",s3m:"s3m",iserverScene:"iserverScene",isTileLayer:function(e){return[n.igsTile,n.arcgisTile,n.wmts,n.arcgisTile,n.igsVectorTile,n.tdt,n.baidu,n.gaode,n.arcgisVectorTile,n.webTileLayer].some(function(t){return e===t})}};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={normal:"normal",url:"url",header:"header",body:"body"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={geometry:"geometry",point:"point",point3D:"point3d",lineString:"line",polygon:"polygon",multiPoint:"multiPoint",multiLineString:"multiLine",multiPolygon:"multiPolygon",circle:"circle",extent:"rect",extent3D:"rect3d"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={none:"none",info:"info",error:"error",warning:"warning",all:"all",infoAndError:"infoAndError",warningAndError:"warningAndError"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={notLoaded:"not-loaded",loading:"loading",loaded:"loaded",failed:"failed"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={click:"click",immediateClick:"immediate-click",doubleClick:"double-click",pointerDown:"mouse-down",pointerUp:"mouse-up",mouseOut:"mouse-out",pointerMove:"mouse-move",mouseDown:"mouse-down",mouseUp:"mouse-up",mouseMove:"mouse-move",mouseOver:"mouse-over",keyPress:"key-press",keyDown:"key-down",keyUp:"key-up",rightClickDown:"right-click-down",previewClick:"preview-click",zoom:"zoom",zoomEnd:"zoom-end",mapMove:"move",mapMoveEnd:"map-end",resize:"resize",loaded:"loaded",wheel:"wheel",viewChange:"view-change",drag:"drag",viewCreated:"view-created"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={kilometer:"kilometers",meter:"meters",mile:"miles"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={degree:"degrees",radian:"radians"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={classBreak:"class-breaks",uniqueValue:"unique-value",simple:"simple",cluster:"cluster",random:"random",rank:"rank",heatmap:"heatmap"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={fill:"fill",line:"line",circle:"circle",background:"background"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(0,function(e){return e&&e.__esModule?e:{default:e}}(r(65)).default)({rtmp:"rtmp",mp4:"mp4",hls:"m3u8",videoPlayer:"videoPlayer",videoHTML:"videoHTML"});t.default=n},function(e,t,r){r(326),e.exports=r(12).Object.freeze},function(e,t,r){var n=r(24),i=r(94).onFreeze;r(90)("freeze",function(e){return function(t){return e&&n(t)?e(i(t)):t}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(0,function(e){return e&&e.__esModule?e:{default:e}}(r(65)).default)({POINT:0,POLYLINE:1,POLYGON:2,CIRCLE:3,RECTANGLE:4,FREEHANDPOLYLINE:5,FREEHANDPOLYGON:6,TEXT:7});t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(0,function(e){return e&&e.__esModule?e:{default:e}}(r(65)).default)({NONE:0,EDITGRAGIC:1,EDITVERTEX:2,DRAWING:3});t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(0,function(e){return e&&e.__esModule?e:{default:e}}(r(65)).default)({create:"create",remove:"remove",update:"update",redo:"redo",undo:"undo"});t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(0,function(e){return e&&e.__esModule?e:{default:e}}(r(65)).default)({start:"start",active:"active",complete:"complete",cancel:"cancel"});t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(0,function(e){return e&&e.__esModule?e:{default:e}}(r(65)).default)({cursorChange:"cursor-change",moveStart:"move-start",move:"move",moveStop:"move-stop",scaleStart:"scale-start",scale:"scale",scaleStop:"scale-stop",vertexAdd:"vertex-add",vertexRemove:"vertex-remove",vertexMoveStart:"vertex-move-start",vertexUpdate:"vertex-update",vertexMoveStop:"vertex-move-stop",geometryUnsimple:"geometry-unsimple",geometryAdd:"geometry-add"});t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={simpleRenderer:"1",uniqueValueRenderer:"2",classBreaksRenderer:"3",HeatmapRender:"4",PointClusterRenderer:"5",CartographicRenderer:"6",RuleBasedRenderer:"7",GridClusterRenderer:"8",DotDensityRenderer:"9"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={simpleMark:"1",fontMark:"2",pictureMark:"3",pointInfo:"4",svgMark:"5",customizeMark:"6",simpleLine:"7",pictureLine:"8",markLine:"9",lineInfo:"10",harshLine:"11",decorationLine:"12",simpleFill:"13",regInfoFill:"14",pictureFill:"15",markFill:"16",lineFill:"17",gradientFill:"18",customizeMarkFill:"19",strokeFill:"20",pieChart:"21",barChart:"22",stackedChart:"23",randomMarkFill:"24"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={OnTheGround:"OnTheGround",RelativeToGround:"RelativeToGround",AbsoluteHeight:"AbsoluteHeight",RelativeToScene:"RelativeToScene",OnTheScene:"OnTheScene"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={morphing:0,columbus:1,scene2d:2,scene3d:3}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={disabled:0,enable:1,cast:2,receive:3}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={igs_1:"igs_1",igs_2:"igs_2",tdt:"tdt",arcgis:"arcgis"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={png:"png",jpeg:"jpeg",svg:"svg"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={degrees:"degrees",miles:"miles",nauticalMiles:"nautical-miles",yards:"yards",meters:"meters",kilometers:"kilometers"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={corporationZD:1,corporationArcGIS:2,corporationSuperMap:3,corporationGeoServer:4,corporationTianDiTu:5,corporationOther:6,none:0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={icon:"icon",object:"object",line:"line",path:"path",fill:"fill",water:"water",extrude:"extrude",text:"text"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={begin:"begin",end:"end",beginAndEnd:"begin-end"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={arrow:"arrow",circle:"circle",square:"square",diamond:"diamond",cross:"cross",x:"x"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={dash:"dash",dashDot:"dash-dot",dot:"dot",longDash:"long-dash",longDashDot:"long-dash-dot",longDashDotDot:"long-dash-dot-dot",none:"none",shortDash:"short-dash",shortDashDot:"short-dash-dot",shortDashDotDot:"short-dash-dot-dot",shortDot:"short-dot",solid:"solid"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={center:"center",left:"left",right:"right",bottom:"bottom",top:"top",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={circle:"circle",quad:"quad"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={color:"color"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={meters:"meters",feet:"feet",kilometers:"kilometers",miles:"miles",nauticalMiles:"nautical-miles",yards:"yards"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={acres:"acres",ares:"ares",hectares:"hectares",squareFeet:"square-feet",squareMeters:"square-meters",squareYards:"square-yards",squareKilometers:"square-kilometers",squareMiles:"square-miles"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={none:0,geodesic:1,rhumb:2}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={vector3D:"1",model:"2",terrain:"3",label:"4",cloud:"5",panorama:"6",mapRef:"7",groupLayer3D:"9",modelCache:"10"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={wmts:"wmts",tms:"tms"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={GroupLayer:"GroupLayer",SFeatureLayer:"SFeatureLayer"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={vec:"vec",img:"img",cva:"cva",cia:"cia"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={milliseconds:"milliseconds",seconds:"seconds",minutes:"minutes",hours:"hours",days:"days",weeks:"weeks",months:"months",years:"years"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.description=(0,o.defaultValue)(t.description,void 0),this.id=(0,o.defaultValue)(t.id,(0,o.getGUID)()),this.isDefault=(0,o.defaultValue)(t.isDefault,!1),this.title=(0,o.defaultValue)(t.title,void 0)}return(0,i.default)(e,[{key:"fromJSON",value:function(e){e=(0,o.defaultValue)(e,{}),this.description=(0,o.defaultValue)(e.description,void 0),this.id=(0,o.defaultValue)(e.id,(0,o.getGUID)()),this.isDefault=(0,o.defaultValue)(e.isDefault,!1),this.title=(0,o.defaultValue)(e.title,void 0)}},{key:"toJSON",value:function(){return{description:this.description,id:this.id,isDefault:this.isDefault,title:this.title}}},{key:"clone",value:function(){return new e(this.toJSON())}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(0)),i=l(r(2)),o=r(1),a=l(r(174)),s=r(6);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.mode=(0,o.defaultValue)(t.mode,s.ElevationMode.AbsoluteHeight),this.offset=(0,o.defaultValue)(t.offset,0),this.featureExpressionInfo=new a.default(t.featureExpressionInfo),this.unit=(0,o.defaultValue)(t.unit,s.LengthUnit.meter)}return(0,i.default)(e,[{key:"clone",value:function(){return new e({unit:this.unit,mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo.clone()})}},{key:"toJSON",value:function(){return{unit:this.unit,mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo.toJSON()}}}]),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(3)),i=p(r(0)),o=p(r(2)),a=p(r(4)),s=p(r(5)),l=r(1),u=r(6),c=p(r(130)),f=p(r(131)),h=p(r(48)),d=r(31);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,l.defaultValue)(e,{}),r.type=u.Symbol3DLayerType.path,r.anchor=(0,l.defaultValue)(e.anchor,u.AnchorType.center),r.cap=(0,l.defaultValue)(e.cap,c.default.butt),r.castShadows=(0,l.defaultValue)(e.castShadows,!0),r.height=(0,l.defaultValue)(e.height,void 0),r.width=(0,l.defaultValue)(e.width,void 0),r.join=(0,l.defaultValue)(e.join,f.default.miter),r.material=e.material?d.ColorMaterial.fromJSON(e.material):new d.ColorMaterial,r.profile=(0,l.defaultValue)(e.profile,u.ProfileType.circle),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,anchor:this.anchor,cap:this.cap,castShadows:this.castShadows,height:this.height,width:this.width,join:this.join,material:this.material,profile:this.profile}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(h.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=r(1),u=r(8);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this));return e=(0,l.defaultValue)(e,{}),r.type="line",r.border=(0,l.defaultValue)(e.border,void 0),r.border&&r.border.hasOwnProperty("color")&&(r.border.color=new u.Color(r.border.color)),r.color=(0,l.defaultValue)(e.color,new u.Color),r.size=(0,l.defaultValue)(e.size,1),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,border:this.border?{color:this.border.color.toJSON()}:void 0,color:(0,l.toJSON)(this.color,u.Color),size:this.size}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(c(r(177)).default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.maxWorldLength=(0,o.defaultValue)(t.maxWorldLength,void 0),this.minWorldLength=(0,o.defaultValue)(t.minWorldLength,0),this.screenLength=(0,o.defaultValue)(t.screenLength,0)}return(0,i.default)(e,[{key:"toJSON",value:function(){return{maxWorldLength:this.maxWorldLength,minWorldLength:this.minWorldLength,screenLength:this.screenLength}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=r(6);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.color=(0,o.defaultValue)(t.color,void 0),this.placement=(0,o.defaultValue)(t.placement,a.LineMarkerPlacement.beginAndEnd),this.style=(0,o.defaultValue)(t.style,a.LineMarkerStyle.arrow),this.type="style"}return(0,i.default)(e,[{key:"toJSON",value:function(){return{color:this.color.toJSON(),placement:this.placement,type:this.type,style:this.style}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=r(6);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.style=(0,o.defaultValue)(t.style,a.LinePatternStyle.solid),this.type="style"}return(0,i.default)(e,[{key:"toJSON",value:function(){return{style:this.style,type:this.type}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(0)),i=l(r(2)),o=r(1),a=r(8),s=l(r(169));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.color=(0,o.defaultValue)(t.color,new a.Color),this.size=(0,o.defaultValue)(t.size,1),this.pattern=(0,o.defaultValue)(t.pattern,s.default.solid)}return(0,i.default)(e,[{key:"toJSON",value:function(){return{color:(0,o.toJSON)(this.color,a.Color),size:this.size,pattern:this.pattern}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=r(8);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.color=(0,o.defaultValue)(t.color,new a.Color),this.size=(0,o.defaultValue)(t.size,1)}return(0,i.default)(e,[{key:"toJSON",value:function(){return{color:(0,o.toJSON)(this.color,a.Color),size:this.size}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.primitive=(0,o.defaultValue)(t.primitive,"circle"),this.href=(0,o.defaultValue)(t.href,void 0)}return(0,i.default)(e,[{key:"toJSON",value:function(){return{primitive:this.primitive,href:this.href}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=r(8);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.color=(0,o.defaultValue)(t.color,new a.Color),this.size=(0,o.defaultValue)(t.size,1),this.extensionLength=(0,o.defaultValue)(t.extensionLength,0)}return(0,i.default)(e,[{key:"toJSON",value:function(){return{color:this.color.toJSON(),size:this.size,extensionLength:this.extensionLength}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorMaterial=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(368));t.ColorMaterial=n.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(0)),i=l(r(2)),o=r(1),a=r(8),s=r(6);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.type=s.MaterialType.color,this.color=(0,o.defaultValue)(t.color,new a.Color)}return(0,i.default)(e,[{key:"toJSON",value:function(){return{color:(0,o.toJSON)(this.color,a.Color),type:this.type}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(3)),i=p(r(0)),o=p(r(2)),a=p(r(4)),s=p(r(5)),l=p(r(48)),u=r(6),c=r(1),f=p(r(130)),h=p(r(131)),d=r(31);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=u.Symbol3DLayerType.line,r.cap=(0,c.defaultValue)(e.cap,f.default.butt),r.join=(0,c.defaultValue)(e.join,h.default.miter),r.marker=(0,c.defaultValue)(e.marker,void 0),r.material=e.material?d.ColorMaterial.fromJSON(e.material):new d.ColorMaterial,r.pattern=e.pattern?d.LineStylePattern3D.fromJSON(e.pattern):new d.LineStylePattern3D,r.size=(0,c.defaultValue)(e.size,1),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,cap:this.cap,join:this.join,marker:(0,c.toJSON)(this.marker,d.LineStyleMarker3D),material:(0,c.toJSON)(this.material,d.ColorMaterial),pattern:(0,c.toJSON)(this.pattern,d.LineStylePattern3D),size:this.size}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(l.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(5)),l=r(1),u=r(6),c=d(r(179)),f=d(r(48)),h=r(31);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,l.defaultValue)(e,{}),r.type=u.Symbol3DLayerType.fill,r.material=e.material?h.ColorMaterial.fromJSON(e.material):new h.ColorMaterial,r.castShadows=(0,l.defaultValue)(e.castShadows,!0),r.outline=e.outline?h.FillSymbol3DOutline.fromJSON(e.outline):new h.FillSymbol3DOutline,r.pattern=e.pattern?c.default.fromJSON(e.pattern):new c.default,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,material:(0,l.toJSON)(this.material,h.ColorMaterial),outline:(0,l.toJSON)(this.outline,h.FillSymbol3DOutline),pattern:(0,l.toJSON)(this.pattern,c.default)}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(f.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(10)),i=f(r(0)),o=f(r(2)),a=r(1),s=r(6),l=r(31),u=r(8),c=r(9);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,i.default)(this,e),t=(0,a.defaultValue)(t,{}),this.type=s.Symbol3DLayerType.icon,this.anchor=(0,a.defaultValue)(t.anchor,s.AnchorType.center),this.anchorPosition=t.anchorPosition?c.Point.fromJSON(t.anchorPosition):new c.Point({coordinates:[0,0]}),this.material=t.material?l.ColorMaterial.fromJSON(t.material):new l.ColorMaterial({color:new u.Color(255,255,255,1)}),this.outline=t.outline?l.PointSymbol3DOutline.fromJSON(t.outline):new l.PointSymbol3DOutline,this.resource=t.resource?l.IconResource.fromJSON(t.resource):new l.IconResource,this.size=(0,a.defaultValue)(t.size,12)}return(0,o.default)(e,[{key:"toJSON",value:function(){return{type:this.type,anchor:this.anchor,anchorPosition:JSON.parse((0,n.default)(this.anchorPosition)),material:this.material,outline:this.outline.toJSON(),resource:this.resource.toJSON(),size:this.size}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(3)),i=p(r(0)),o=p(r(2)),a=p(r(4)),s=p(r(5)),l=r(1),u=r(6),c=r(31),f=p(r(48)),h=r(9),d=r(8);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,l.defaultValue)(e,{}),r.type=u.Symbol3DLayerType.object,r.anchor=(0,l.defaultValue)(e.anchor,u.AnchorType.center),r.anchorPosition=e.anchorPosition?h.Point.fromJSON(e.anchorPosition):new h.Point({coordinates:[0,0]}),r.castShadows=(0,l.defaultValue)(e.castShadows,!0),r.depth=(0,l.defaultValue)(e.depth,10),r.heading=(0,l.defaultValue)(e.heading,0),r.height=(0,l.defaultValue)(e.height,10),r.material=e.material?c.ColorMaterial.fromJSON(e.material):new c.ColorMaterial({color:new d.Color(255,255,255,1)}),r.resource=e.resource?c.IconResource.fromJSON(e.resource):new c.IconResource,r.roll=(0,l.defaultValue)(e.roll,0),r.tilt=(0,l.defaultValue)(e.tilt,0),r.width=(0,l.defaultValue)(e.width,10),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,anchor:this.anchor,anchorPosition:(0,l.toJSON)(this.anchorPosition,h.Point),castShadows:this.castShadows,depth:this.depth,heading:this.heading,height:this.height,material:(0,l.toJSON)(this.material,c.ColorMaterial),resource:(0,l.toJSON)(this.resource,c.IconResource),roll:this.roll,tilt:this.tilt,width:this.width}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(f.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(5)),l=r(1),u=r(6),c=r(31);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,l.defaultValue)(e,{}),r.type=u.Symbol3DLayerType.extrude,r.castShadows=(0,l.defaultValue)(e.castShadows,!0),r.material=e.material?c.ColorMaterial.fromJSON(e.material):new c.ColorMaterial,r.size=(0,l.defaultValue)(e.size,1),r.edges=e.edges?c.Edges3D.fromJSON(e.edges):new c.Edges3D,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,castShadows:this.castShadows,material:(0,l.toJSON)(this.material,c.ColorMaterial),size:this.size,pattern:(0,l.toJSON)(this.edges,c.Edges3D)}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(f(r(48)).default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(3)),i=v(r(0)),o=v(r(2)),a=v(r(4)),s=v(r(5)),l=r(1),u=r(6),c=r(8),f=v(r(125)),h=v(r(128)),d=v(r(129)),p=v(r(178)),y=v(r(48)),g=r(31);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,l.defaultValue)(e,{}),r.type=u.Symbol3DLayerType.text,r.background=e.background?c.Color.fromJSON(e.background):new c.Color,r.font=e.font?f.default.fromJSON(e.font):new f.default,r.halo=e.halo?p.default.fromJSON(e.halo):new p.default,r.horizontalAlignment=(0,l.defaultValue)(e.horizontalAlignment,h.default.center),r.verticalAlignment=(0,l.defaultValue)(e.verticalAlignment,d.default.baseline),r.lineHeight=(0,l.defaultValue)(e.lineHeight,1),r.material=e.material?g.ColorMaterial.fromJSON(e.material):new g.ColorMaterial,r.size=(0,l.defaultValue)(e.size,9),r.text=(0,l.defaultValue)(e.text,void 0),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,background:(0,l.toJSON)(this.background,c.Color),font:(0,l.toJSON)(this.font,f.default),halo:(0,l.toJSON)(this.halo,p.default),horizontalAlignment:this.horizontalAlignment,verticalAlignment:this.verticalAlignment,lineHeight:this.lineHeight,material:(0,l.toJSON)(this.material,g.ColorMaterial),size:this.size,text:this.text}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(y.default);t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(5)),l=r(1),u=r(6),c=r(8),f=d(r(170)),h=d(r(171));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,l.defaultValue)(e,{}),r.type=u.Symbol3DLayerType.water,r.color=(0,l.defaultValue)(e.color,new c.Color),r.waterbodySize=(0,l.defaultValue)(e.waterbodySize,f.default.medium),r.waveDirection=(0,l.defaultValue)(e.waveDirection,void 0),r.waveStrength=(0,l.defaultValue)(e.waveStrength,h.default.moderate),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,color:this.color.toJSON(),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(d(r(48)).default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(7)),l=h(r(5)),u=r(1),c=r(6),f=h(r(134));function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.type=c.SymbolType.simpleMarker,r.size=(0,u.defaultValue)(e.size,20),r.outline=r._decorate("outline",e.outline,f.default,f.default.fromJSON),r.style=(0,u.defaultValue)(e.style,"circle"),r.path=(0,u.defaultValue)(e.path,""),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.size=this.size,e.outline=this.outline.toJSON(),e.style=this.style,e.path=this.path,e}}],[{key:"fromJSON",value:function(e){return new t(e=(0,u.defaultValue)(e,{}))}}]),t}(h(r(181)).default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=d(r(56)),c=r(1),f=r(6),h=d(r(54));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.color=h.default.fromColor((0,c.defaultValue)(e.color,new h.default(0,0,0,1))),r.type=f.SymbolType.simpleLine,r.width=(0,c.defaultValue)(e.width,1),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.width=this.width,e}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=s(r(54));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.type="line-marker",this.color=a.default.fromColor((0,o.defaultValue)(t.color,{})),this.placement=(0,o.defaultValue)(t.placement,"begin-end"),this.style=(0,o.defaultValue)(t.style,"arrow")}return(0,i.default)(e,[{key:"toJSON",value:function(){return{type:this.type,color:a.default.fromColor(this.color).toJSON(),placement:this.placement,style:this.style}}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(7)),l=f(r(5)),u=r(1),c=r(6);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.type=c.SymbolType.simpleFill,r.style=(0,u.defaultValue)(e.style,"solid"),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.style=this.style,e}}],[{key:"fromJSON",value:function(e){return new t(e=(0,u.defaultValue)(e,{}))}}]),t}(f(r(182)).default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(7)),l=f(r(5)),u=r(1),c=r(6);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.type=c.SymbolType.pictureMarker,r.width=(0,u.defaultValue)(e.width,20),r.height=(0,u.defaultValue)(e.height,20),r.url=r._decorate("url",(0,u.defaultValue)(e.url,""),null,u.convertImageSourceToBase64),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.width=this.width,e.height=this.height,e.url=this.url,e}}],[{key:"fromJSON",value:function(e){return new t(e=(0,u.defaultValue)(e,{}))}}]),t}(f(r(181)).default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(5)),l=h(r(182)),u=r(6),c=r(1),f=h(r(54));function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=u.SymbolType.pictureFill,r.height=(0,c.defaultValue)(e.height,12),r.url=r._decorate("url",(0,c.defaultValue)(e.url,""),null,c.convertImageSourceToBase64),r.width=(0,c.defaultValue)(e.width,12),r.xoffset=(0,c.defaultValue)(e.xoffset,0),r.xscale=(0,c.defaultValue)(e.xscale,1),r.yoffset=(0,c.defaultValue)(e.yoffset,0),r.yscale=(0,c.defaultValue)(e.yscale,1),r.color=f.default.fromColor((0,c.defaultValue)(e.color,new f.default(255,255,255,1))),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return{type:this.type,height:this.height,outline:this.outline.toJSON(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale}}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,c.defaultValue)(e,{}))}}]),t}(l.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(7)),l=h(r(5)),u=r(1),c=r(6),f=h(r(54));function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.type=c.SymbolType.mapgisText,r.backgroundPadding=(0,u.defaultValue)(e.backgroundPadding,[5,5]),r.backgroundImage=e.backgroundImage,r.textDecorationUnderlineColor=(0,u.defaultValue)(f.default.fromColor(e.textDecorationUnderlineColor),void 0),r.textDecorationUnderlineWidth=(0,u.defaultValue)(e.textDecorationUnderlineWidth,0),r.textDecorationThroughlineColor=(0,u.defaultValue)(f.default.fromColor(e.textDecorationThroughlineColor),void 0),r.textDecorationThroughlineWidth=(0,u.defaultValue)(e.textDecorationThroughlineWidth,0),r.textShadowOffsetX=(0,u.defaultValue)(e.textShadowOffsetX,0),r.textShadowOffsetY=(0,u.defaultValue)(e.textShadowOffsetY,0),r.textShadowBlur=(0,u.defaultValue)(e.textShadowBlur,1),r.textShadowColor=(0,u.defaultValue)(f.default.fromColor(e.textShadowColor),void 0),r.letterSpacing=(0,u.defaultValue)(e.letterSpacing,0),r.lineMaxNum=(0,u.defaultValue)(e.lineMaxNum,3),r.textWraps=(0,u.defaultValue)(e.textWraps,!1),r.textExtraIcon=e.textExtraIcon,r.textExtraIconAnchor=(0,u.defaultValue)(e.textExtraIconAnchor,"top"),r.textExtraIconSize=(0,u.defaultValue)(e.textExtraIconSize,14),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"clone",value:function(){return new t(this.toJSON())}},{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.backgroundPadding=this.backgroundPadding,e.textDecorationUnderlineColor=f.default.fromColor(this.textDecorationUnderlineColor).toJSON(),e.textDecorationUnderlineWidth=this.textDecorationUnderlineWidth,e.textDecorationThroughlineColor=f.default.fromColor(this.textDecorationThroughlineColor).toJSON(),e.textDecorationThroughlineWidth=this.textDecorationThroughlineWidth,e.textShadowOffsetX=this.textShadowOffsetX,e.textShadowOffsetY=this.textShadowOffsetY,e.textShadowBlur=this.textShadowBlur,e.textShadowColor=f.default.fromColor(this.textShadowColor).toJSON(),e.letterSpacing=this.letterSpacing,e.lineMaxNum=this.lineMaxNum,e.textWraps=this.textWraps,e.textExtraIcon=this.textExtraIcon,e.textExtraIconAnchor=this.textExtraIconAnchor,e.textExtraIconSize=this.textExtraIconSize,e}}],[{key:"fromJSON",value:function(e){return new t(e=(0,u.defaultValue)(e,{}))}}]),t}(h(r(180)).default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=d(r(82)),c=r(1),f=d(r(127)),h=r(31);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.default.label3D,r.callout=e.callout?h.LineCallout3D.fromJSON(e.callout):new h.LineCallout3D,r.verticalOffset=e.verticalOffset?h.Symbol3DVerticalOffset.fromJSON(e.verticalOffset):new h.Symbol3DVerticalOffset,r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.callout=(0,c.toJSON)(this.callout,h.LineCallout3D),e.verticalOffset=(0,c.toJSON)(this.verticalOffset,h.Symbol3DVerticalOffset),e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(7)),l=c(r(5)),u=r(6);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.type=u.SymbolType.line3D,r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this)}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(c(r(82)).default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=r(1),c=d(r(127)),f=d(r(82)),h=r(31);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.type=c.default.point3D,r.callout=(0,u.defaultValue)(e.callout,void 0),r.verticalOffset=(0,u.defaultValue)(e.verticalOffset,void 0),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.callout=(0,u.toJSON)(this.callout,h.LineCallout3D),e.verticalOffset=(0,u.toJSON)(this.verticalOffset,h.Symbol3DVerticalOffset),e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(f.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(7)),l=f(r(5)),u=r(1),c=r(6);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.type=c.SymbolType.polygon3D,r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){return(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this)}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,u.defaultValue)(e,{}))}}]),t}(f(r(82)).default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(0)),i=f(r(2)),o=r(1),a=f(r(175)),s=r(9),l=r(6),u=f(r(81)),c=r(183);function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t){return t&&e&&"4326"!==e.wkid?(t.spatialReference=e,u.default.project(t,new s.SpatialReference("EPSG:4326"))):t}function d(e){return e.length>2?[e[1],e[0],e[2]]:[e[1],e[0]]}function p(e,t,r){for(var n,i=[],o=0,a=e.length;o<a;o++)n=t?p(e[o],t-1,r):(r||d)(e[o]),i.push(n);return i}var y=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.id=(0,o.defaultValue)(t.id,(0,o.getGUID)()),this.features=(0,o.defaultValue)(t.features,[]),this.spatialReference=(0,o.defaultValue)(t.spatialReference,new s.SpatialReference("EPSG:4326")),this.type="FeatureCollection"}return(0,i.default)(e,[{key:"findFeatureById",value:function(e){for(var t=void 0,r=0;r<this.features.length;r++)if(this.features[r].id===e||this.features[r].attributes.id===e){t=this.features[r];break}return t}},{key:"toJSON",value:function(){var e={};return e.id=this.id,e.features=this.features.map(function(e){return e.toJSON()}),e.spatialReference=this.spatialReference.toJSON(),e.type=this.type,e}},{key:"clone",value:function(){for(var t=new e,r=0;r<this.features.length;r++)t.features.push(this.features[r].clone());return t}},{key:"toGeoJSON",value:function(){for(var e={type:"FeatureCollection",features:[]},t=0;t<this.features.length;t++){var r=this.features[t].clone();if(r.geometry){var n=h(r.geometry.spatialReference,r.geometry);r.geometry=s.Geometry.fromGeoJSON(n)}e.features.push(r.toGeoJSON())}return e}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}},{key:"fromGeoJSON",value:function(e){return e=(0,o.defaultValue)(e,{}),(0,c.convertDataSource)(e)}},{key:"fromArray",value:function(t,r,n){var i=(n=(0,o.defaultValue)(n,{})).reverse,u=(0,o.defaultValue)(t,[]);t instanceof e&&(u=(0,o.defaultValue)(t.features,[])),r=(0,o.defaultValue)(r,new e);for(var c=0;c<u.length;c++)if(u[c]){var f=void 0;if(u[c].geometry&&u[c].geometry.type&&u[c].geometry.coordinates){var h=s.SpatialReference.fromJSON(u[c].geometry.spatialReference||r.spatialReference);switch(u[c].geometry.type){case l.GeometryType.point:var y=u[c].geometry.coordinates;i&&(y=d(y)),f=new s.Point({coordinates:y,spatialReference:h});break;case l.GeometryType.multiPoint:var g=u[c].geometry.coordinates;i&&(g=p(g,0,d)),f=new s.MultiPoint({coordinates:g,spatialReference:h});break;case l.GeometryType.lineString:var v=u[c].geometry.coordinates;i&&(v=p(v,0,d)),f=new s.LineString({coordinates:v,spatialReference:h});break;case l.GeometryType.multiLineString:var m=u[c].geometry.coordinates;i&&(m=p(m,1,d)),f=new s.MultiLineString({coordinates:m,spatialReference:h});break;case l.GeometryType.polygon:var _=u[c].geometry.coordinates;i&&(_=p(_,1,d)),f=new s.Polygon({coordinates:_,spatialReference:h});break;case l.GeometryType.multiPolygon:var S=u[c].geometry.coordinates;i&&(S=p(S,2,d)),f=new s.MultiPolygon({coordinates:S,spatialReference:h})}}var x=new a.default({attributes:t[c].attributes,geometry:f,symbol:t[c].symbol,additional:t[c].additional,styleInfo:t[c].styleInfo});r.features.push(x)}return r}}]),e}();t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});
/**
@license
topojson - https://github.com/topojson/topojson

Copyright (c) 2012-2016, Michael Bostock
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* The name Michael Bostock may not be used to endorse or promote products
  derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL MICHAEL BOSTOCK BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
* */
var n=function(e){return e},i=function(e){if(null==e)return n;var t=void 0,r=void 0,i=e.scale[0],o=e.scale[1],a=e.translate[0],s=e.translate[1];return function(e,n){n||(t=r=0);var l=2,u=e.length,c=new Array(u);for(c[0]=(t+=e[0])*i+a,c[1]=(r+=e[1])*o+s;l<u;)c[l]=e[l],++l;return c}},o=function(e){var t=i(e.transform),r=void 0,n=1/0,o=n,a=-n,s=-n;function l(e){(e=t(e))[0]<n&&(n=e[0]),e[0]>a&&(a=e[0]),e[1]<o&&(o=e[1]),e[1]>s&&(s=e[1])}function u(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(u);break;case"Point":l(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(l)}}for(r in e.arcs.forEach(function(e){for(var r=-1,i=e.length,l=void 0;++r<i;)(l=t(e[r],r))[0]<n&&(n=l[0]),l[0]>a&&(a=l[0]),l[1]<o&&(o=l[1]),l[1]>s&&(s=l[1])}),e.objects)u(e.objects[r]);return[n,o,a,s]},a=function(e,t){for(var r=void 0,n=e.length,i=n-t;i<--n;)r=e[i],e[i++]=e[n],e[n]=r},s=function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return l(e,t)})}:l(e,t)};function l(e,t){var r=t.id,n=t.bbox,i=null==t.properties?{}:t.properties,o=u(e,t);return null==r&&null==n?{type:"Feature",properties:i,geometry:o}:null==n?{type:"Feature",id:r,properties:i,geometry:o}:{type:"Feature",id:r,bbox:n,properties:i,geometry:o}}function u(e,t){var r=i(e.transform),n=e.arcs;function o(e,t){t.length&&t.pop();for(var i=n[e<0?~e:e],o=0,s=i.length;o<s;++o)t.push(r(i[o],o));e<0&&a(t,s)}function s(e){return r(e)}function l(e){for(var t=[],r=0,n=e.length;r<n;++r)o(e[r],t);return t.length<2&&t.push(t[0]),t}function u(e){for(var t=l(e);t.length<4;)t.push(t[0]);return t}function c(e){return e.map(u)}return function e(t){var r=t.type,n=void 0;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=s(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(s);break;case"LineString":n=l(t.arcs);break;case"MultiLineString":n=t.arcs.map(l);break;case"Polygon":n=c(t.arcs);break;case"MultiPolygon":n=t.arcs.map(c);break;default:return null}return{type:r,coordinates:n}}(t)}var c=function(e,t){var r={},n={},i={},o=[],a=-1;function s(e,t){for(var n in e){var i=e[n];delete t[i.start],delete i.start,delete i.end,i.forEach(function(e){r[e<0?~e:e]=1}),o.push(i)}}return t.forEach(function(r,n){var i=e.arcs[r<0?~r:r],o=void 0;i.length<3&&!i[1][0]&&!i[1][1]&&(o=t[++a],t[a]=r,t[n]=o)}),t.forEach(function(t){var r=function(t){var r=e.arcs[t<0?~t:t],n=r[0],i=void 0;return e.transform?(i=[0,0],r.forEach(function(e){i[0]+=e[0],i[1]+=e[1]})):i=r[r.length-1],t<0?[i,n]:[n,i]}(t),o=r[0],a=r[1],s=void 0,l=void 0;if(s=i[o])if(delete i[s.end],s.push(t),s.end=a,l=n[a]){delete n[l.start];var u=l===s?s:s.concat(l);n[u.start=s.start]=i[u.end=l.end]=u}else n[s.start]=i[s.end]=s;else if(s=n[a])if(delete n[s.start],s.unshift(t),s.start=o,l=i[o]){delete i[l.end];var c=l===s?s:l.concat(s);n[c.start=l.start]=i[c.end=s.end]=c}else n[s.start]=i[s.end]=s;else n[(s=[t]).start=o]=i[s.end=a]=s}),s(i,n),s(n,i),t.forEach(function(e){r[e<0?~e:e]||o.push([e])}),o};function f(e,t,r){var n=void 0,i=void 0,o=void 0;if(arguments.length>1)n=function(e,t,r){var n=[],i=[],o=void 0;function a(e){var t=e<0?~e:e;(i[t]||(i[t]=[])).push({i:e,g:o})}function s(e){e.forEach(a)}function l(e){e.forEach(s)}return function e(t){switch(o=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":s(t.arcs);break;case"MultiLineString":case"Polygon":l(t.arcs);break;case"MultiPolygon":t.arcs.forEach(l)}}(t),i.forEach(null==r?function(e){n.push(e[0].i)}:function(e){r(e[0].g,e[e.length-1].g)&&n.push(e[0].i)}),n}(0,t,r);else for(i=0,n=new Array(o=e.arcs.length);i<o;++i)n[i]=i;return{type:"MultiLineString",arcs:c(e,n)}}function h(e,t){var r={},n=[],i=[];function o(e){e.forEach(function(t){t.forEach(function(t){(r[t=t<0?~t:t]||(r[t]=[])).push(e)})}),n.push(e)}function a(t){return function(e){for(var t=-1,r=e.length,n=void 0,i=e[r-1],o=0;++t<r;)n=i,i=e[t],o+=n[0]*i[1]-n[1]*i[0];return Math.abs(o)}(u(e,{type:"Polygon",arcs:[t]}).coordinates[0])}return t.forEach(function e(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"Polygon":o(t.arcs);break;case"MultiPolygon":t.arcs.forEach(o)}}),n.forEach(function(e){e._||function(){var t=[],n=[e];for(e._=1,i.push(t);e=n.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){r[e<0?~e:e].forEach(function(e){e._||(e._=1,n.push(e))})})})}()}),n.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:i.map(function(t){var n,i=[];if(t.forEach(function(e){e.forEach(function(e){e.forEach(function(e){r[e<0?~e:e].length<2&&i.push(e)})})}),(n=(i=c(e,i)).length)>1)for(var o,s,l=1,u=a(i[0]);l<n;++l)(o=a(i[l]))>u&&(s=i[0],i[0]=i[l],i[l]=s,u=o);return i})}}var d=function(e,t){for(var r=0,n=e.length;r<n;){var i=r+n>>>1;e[i]<t?r=i+1:n=i}return r},p=function(e){if(null==e)return n;var t=void 0,r=void 0,i=e.scale[0],o=e.scale[1],a=e.translate[0],s=e.translate[1];return function(e,n){n||(t=r=0);var l=2,u=e.length,c=new Array(u),f=Math.round((e[0]-a)/i),h=Math.round((e[1]-s)/o);for(c[0]=f-t,t=f,c[1]=h-r,r=h;l<u;)c[l]=e[l],++l;return c}},y=function(e,t,r,n,i,o){3===arguments.length&&(n=o=Array,i=null);for(var a=new n(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),s=new o(e),l=e-1,u=0;u<e;++u)a[u]=i;return{set:function(n,o){for(var u=t(n)&l,c=a[u],f=0;c!=i;){if(r(c,n))return s[u]=o;if(++f>=e)throw new Error("full hashmap");c=a[u=u+1&l]}return a[u]=n,s[u]=o,o},maybeSet:function(n,o){for(var u=t(n)&l,c=a[u],f=0;c!=i;){if(r(c,n))return s[u];if(++f>=e)throw new Error("full hashmap");c=a[u=u+1&l]}return a[u]=n,s[u]=o,o},get:function(n,o){for(var u=t(n)&l,c=a[u],f=0;c!=i;){if(r(c,n))return s[u];if(++f>=e)break;c=a[u=u+1&l]}return o},keys:function(){for(var e=[],t=0,r=a.length;t<r;++t){var n=a[t];n!=i&&e.push(n)}return e}}},g=function(e,t){return e[0]===t[0]&&e[1]===t[1]},v=new ArrayBuffer(16),m=new Uint32Array(v),_=function(e){var t=m[0]^m[1];return 2147483647&(t<<5^t>>7^m[2]^m[3])},S=function(e){var t=e.coordinates,r=e.lines,n=e.rings,i=function(){for(var e=y(1.4*t.length,k,M,Int32Array,-1,Int32Array),r=new Int32Array(t.length),n=0,i=t.length;n<i;++n)r[n]=e.maybeSet(n,n);return r}(),o=new Int32Array(t.length),a=new Int32Array(t.length),s=new Int32Array(t.length),l=new Int8Array(t.length),u=0,c=void 0,f=void 0,h=void 0,d=void 0;for(c=0,f=t.length;c<f;++c)o[c]=a[c]=s[c]=-1;for(c=0,f=r.length;c<f;++c){var p=r[c],v=p[0],m=p[1];for(h=i[v],d=i[++v],++u,l[h]=1;++v<=m;)w(c,h,h=d,d=i[v]);++u,l[d]=1}for(c=0,f=t.length;c<f;++c)o[c]=-1;for(c=0,f=n.length;c<f;++c){var S=n[c],x=S[0]+1,b=S[1];for(w(c,i[b-1],h=i[x-1],d=i[x]);++x<=b;)w(c,h,h=d,d=i[x])}function w(e,t,r,n){if(o[r]!==e){o[r]=e;var i=a[r];if(i>=0){var c=s[r];i===t&&c===n||i===n&&c===t||(++u,l[r]=1)}else a[r]=t,s[r]=n}}function k(e){return _(t[e])}function M(e,r){return g(t[e],t[r])}o=a=s=null;var E=function(e,t,r,n,i){3===arguments.length&&(n=Array,i=null);for(var o=new n(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),a=e-1,s=0;s<e;++s)o[s]=i;return{add:function(n){for(var s=t(n)&a,l=o[s],u=0;l!=i;){if(r(l,n))return!0;if(++u>=e)throw new Error("full hashset");l=o[s=s+1&a]}return o[s]=n,!0},has:function(n){for(var s=t(n)&a,l=o[s],u=0;l!=i;){if(r(l,n))return!0;if(++u>=e)break;l=o[s=s+1&a]}return!1},values:function(){for(var e=[],t=0,r=o.length;t<r;++t){var n=o[t];n!=i&&e.push(n)}return e}}}(1.4*u,_,g),I=void 0;for(c=0,f=t.length;c<f;++c)l[I=i[c]]&&E.add(t[I]);return E};function x(e,t,r,n){b(e,t,r),b(e,t,t+n),b(e,t+n,r)}function b(e,t,r){for(var n,i=t+(r---t>>1);t<i;++t,--r)n=e[t],e[t]=e[r],e[r]=n}function w(e){return null==e?{type:null}:("FeatureCollection"===e.type?function(e){var t={type:"GeometryCollection",geometries:e.features.map(k)};return null!=e.bbox&&(t.bbox=e.bbox),t}:"Feature"===e.type?k:M)(e)}function k(e){var t=M(e.geometry),r=void 0;for(r in null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),e.properties){t.properties=e.properties;break}return t}function M(e){if(null==e)return{type:null};var t="GeometryCollection"===e.type?{type:"GeometryCollection",geometries:e.geometries.map(M)}:"Point"===e.type||"MultiPoint"===e.type?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};return null!=e.bbox&&(t.bbox=e.bbox),t}function E(e){var t=e[0],r=e[1],n=void 0;return r<t&&(n=t,t=r,r=n),t+31*r}function I(e,t){var r=e[0],n=e[1],i=t[0],o=t[1],a=void 0;return n<r&&(a=r,r=n,n=a),o<i&&(a=i,i=o,o=a),r===i&&n===o}function T(){return!0}function L(e){return e}function P(e){return null!=e.type}var C=function(e){var t=new Array(e.arcs.length),r=0,n=void 0;function i(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(i);break;case"Polygon":o(e.arcs);break;case"MultiPolygon":e.arcs.forEach(o)}}function o(e){for(var n=0,i=e.length;n<i;++n,++r)for(var o=e[n],a=0,s=o.length;a<s;++a){var l=o[a];l<0&&(l=~l);var u=t[l];null==u?t[l]=r:u!==r&&(t[l]=-1)}}for(n in e.objects)i(e.objects[n]);return function(e){for(var r,n=0,i=e.length;n<i;++n)if(-1===t[(r=e[n])<0?~r:r])return!0;return!1}};function N(e){var t=e[0],r=e[1],n=e[2];return Math.abs((t[0]-n[0])*(r[1]-t[1])-(t[0]-r[0])*(n[1]-t[1]))/2}function O(e){for(var t=-1,r=e.length,n=void 0,i=e[r-1],o=0;++t<r;)n=i,i=e[t],o+=n[0]*i[1]-n[1]*i[0];return Math.abs(o)/2}var R=function(e,t,r){return t=null==t?Number.MIN_VALUE:+t,null==r&&(r=O),function(n,i){return r(s(e,{type:"Polygon",arcs:[n]}).geometry.coordinates[0],i)>=t}};function V(e,t){return e[1][2]-t[1][2]}function G(e){return[e[0],e[1],0]}function A(e,t){return t-e}var F=Math.PI,D=2*F,j=F/4,B=F/180,q=Math.abs,U=Math.atan2,J=Math.cos,z=Math.sin;function W(e,t){for(var r=0,n=e.length,i=0,o=e[t?r++:n-1],a=void 0,s=o[0]*B,l=o[1]*B/2+j,u=void 0,c=J(l),f=void 0,h=z(l);r<n;++r){a=s,s=(o=e[r])[0]*B,l=o[1]*B/2+j,u=c,c=J(l),f=h,h=z(l);var d=s-a,p=d>=0?1:-1,y=p*d,g=f*h,v=u*c+g*J(y),m=g*p*z(y);i+=U(m,v)}return i}t.bbox=o,t.feature=s,t.mesh=function(e){return u(e,f.apply(this,arguments))},t.meshArcs=f,t.merge=function(e){return u(e,h.apply(this,arguments))},t.mergeArcs=h,t.neighbors=function(e){var t={},r=e.map(function(){return[]});function n(e,r){e.forEach(function(e){e<0&&(e=~e);var n=t[e];n?n.push(r):t[e]=[r]})}function i(e,t){e.forEach(function(e){n(e,t)})}var o={LineString:n,MultiLineString:i,Polygon:i,MultiPolygon:function(e,t){e.forEach(function(e){i(e,t)})}};for(var a in e.forEach(function e(t,r){"GeometryCollection"===t.type?t.geometries.forEach(function(t){e(t,r)}):t.type in o&&o[t.type](t.arcs,r)}),t)for(var s=t[a],l=s.length,u=0;u<l;++u)for(var c=u+1;c<l;++c){var f,h=s[u],p=s[c];(f=r[h])[a=d(f,p)]!==p&&f.splice(a,0,p),(f=r[p])[a=d(f,h)]!==h&&f.splice(a,0,h)}return r},t.quantize=function(e,t){if(e.transform)throw new Error("already quantized");if(t&&t.scale)l=e.bbox;else{if(!(Math.floor(t)>=2))throw new Error("n must be ≥2");var r=(l=e.bbox||o(e))[0],n=l[1],i=l[2],a=l[3];t={scale:[i-r?(i-r)/NaN:1,a-n?(a-n)/NaN:1],translate:[r,n]}}var s=p(t),l=void 0,u=void 0,c=e.objects,f={};function h(e){return s(e)}function d(e){var t=void 0;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(d)};break;case"Point":t={type:"Point",coordinates:h(e.coordinates)};break;case"MultiPoint":t={type:"MultiPoint",coordinates:e.coordinates.map(h)};break;default:return e}return null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),null!=e.properties&&(t.properties=e.properties),t}for(u in c)f[u]=d(c[u]);return{type:"Topology",bbox:l,transform:t,objects:f,arcs:e.arcs.map(function(e){var t=0,r=1,n=e.length,i=void 0,o=new Array(n);for(o[0]=s(e[0],0);++t<n;)((i=s(e[t],t))[0]||i[1])&&(o[r++]=i);return 1===r&&(o[r++]=[0,0]),o.length=r,o})}},t.transform=i,t.untransform=p,t.topology=function(e,t){var r=function(e){var t=1/0,r=1/0,n=-1/0,i=-1/0;function o(e){null!=e&&a.hasOwnProperty(e.type)&&a[e.type](e)}var a={GeometryCollection:function(e){e.geometries.forEach(o)},Point:function(e){s(e.coordinates)},MultiPoint:function(e){e.coordinates.forEach(s)},LineString:function(e){l(e.arcs)},MultiLineString:function(e){e.arcs.forEach(l)},Polygon:function(e){e.arcs.forEach(l)},MultiPolygon:function(e){e.arcs.forEach(u)}};function s(e){var o=e[0],a=e[1];o<t&&(t=o),o>n&&(n=o),a<r&&(r=a),a>i&&(i=a)}function l(e){e.forEach(s)}function u(e){e.forEach(l)}for(var c in e)o(e[c]);return n>=t&&i>=r?[t,r,n,i]:void 0}(e=function(e){var t={},r=void 0;for(r in e)t[r]=w(e[r]);return t}(e)),n=t>0&&r&&function(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=o-n?(r-1)/(o-n):1,l=a-i?(r-1)/(a-i):1;function u(e){return[Math.round((e[0]-n)*s),Math.round((e[1]-i)*l)]}function c(e,t){for(var r=-1,o=0,a=e.length,u=new Array(a),c=void 0,f=void 0,h=void 0,d=void 0,p=void 0;++r<a;)c=e[r],d=Math.round((c[0]-n)*s),p=Math.round((c[1]-i)*l),d===f&&p===h||(u[o++]=[f=d,h=p]);for(u.length=o;o<t;)o=u.push([u[0][0],u[0][1]]);return u}function f(e){return c(e,2)}function h(e){return c(e,4)}function d(e){return e.map(h)}function p(e){null!=e&&y.hasOwnProperty(e.type)&&y[e.type](e)}var y={GeometryCollection:function(e){e.geometries.forEach(p)},Point:function(e){e.coordinates=u(e.coordinates)},MultiPoint:function(e){e.coordinates=e.coordinates.map(u)},LineString:function(e){e.arcs=f(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(f)},Polygon:function(e){e.arcs=d(e.arcs)},MultiPolygon:function(e){e.arcs=e.arcs.map(d)}};for(var g in e)p(e[g]);return{scale:[1/s,1/l],translate:[n,i]}}(e,r,t),i=function(e){var t=e.coordinates,r=e.lines,n=void 0,i=e.rings,o=void 0,a=r.length+i.length,s=void 0,l=void 0;for(delete e.lines,delete e.rings,s=0,l=r.length;s<l;++s)for(n=r[s];n=n.next;)++a;for(s=0,l=i.length;s<l;++s)for(o=i[s];o=o.next;)++a;var u=y(2*a*1.4,_,g),c=e.arcs=[];for(s=0,l=r.length;s<l;++s){n=r[s];do{f(n)}while(n=n.next)}for(s=0,l=i.length;s<l;++s)if((o=i[s]).next)do{f(o)}while(o=o.next);else h(o);function f(e){var r,n,i=void 0,o=void 0,a=void 0,s=void 0,l=void 0,f=void 0;if(i=u.get(r=t[e[0]]))for(l=0,f=i.length;l<f;++l)if(d(o=i[l],e))return e[0]=o[0],void(e[1]=o[1]);if(a=u.get(n=t[e[1]]))for(l=0,f=a.length;l<f;++l)if(p(s=a[l],e))return e[1]=s[0],void(e[0]=s[1]);i?i.push(e):u.set(r,[e]),a?a.push(e):u.set(n,[e]),c.push(e)}function h(e){var r,n=void 0,i=void 0,o=void 0,a=void 0;if(n=u.get(t[e[0]]))for(o=0,a=n.length;o<a;++o){if(v(i=n[o],e))return e[0]=i[0],void(e[1]=i[1]);if(m(i,e))return e[0]=i[1],void(e[1]=i[0])}if(n=u.get(r=t[e[0]+S(e)]))for(o=0,a=n.length;o<a;++o){if(v(i=n[o],e))return e[0]=i[0],void(e[1]=i[1]);if(m(i,e))return e[0]=i[1],void(e[1]=i[0])}n?n.push(e):u.set(r,[e]),c.push(e)}function d(e,r){var n=e[0],i=r[0],o=e[1];if(n-o!=i-r[1])return!1;for(;n<=o;++n,++i)if(!g(t[n],t[i]))return!1;return!0}function p(e,r){var n=e[0],i=r[0],o=e[1],a=r[1];if(n-o!=i-a)return!1;for(;n<=o;++n,--a)if(!g(t[n],t[a]))return!1;return!0}function v(e,r){var n=e[0],i=r[0],o=e[1]-n;if(o!==r[1]-i)return!1;for(var a=S(e),s=S(r),l=0;l<o;++l)if(!g(t[n+(l+a)%o],t[i+(l+s)%o]))return!1;return!0}function m(e,r){var n=e[0],i=r[0],o=e[1],a=r[1],s=o-n;if(s!==a-i)return!1;for(var l=S(e),u=s-S(r),c=0;c<s;++c)if(!g(t[n+(c+l)%s],t[a-(c+u)%s]))return!1;return!0}function S(e){for(var r=e[0],n=e[1],i=r,o=i,a=t[i];++i<n;){var s=t[i];(s[0]<a[0]||s[0]===a[0]&&s[1]<a[1])&&(o=i,a=s)}return o-r}return e}(function(e){var t=S(e),r=e.coordinates,n=e.lines,i=e.rings,o=void 0,a=void 0,s=void 0;for(a=0,s=n.length;a<s;++a)for(var l=n[a],u=l[0],c=l[1];++u<c;)t.has(r[u])&&(o={0:u,1:l[1]},l[1]=u,l=l.next=o);for(a=0,s=i.length;a<s;++a)for(var f=i[a],h=f[0],d=h,p=f[1],y=t.has(r[h]);++d<p;)t.has(r[d])&&(y?(o={0:d,1:f[1]},f[1]=d,f=f.next=o):(x(r,h,p,p-d),r[p]=r[h],y=!0,d=h));return e}(function(e){var t=-1,r=[],n=[],i=[];function o(e){e&&a.hasOwnProperty(e.type)&&a[e.type](e)}var a={GeometryCollection:function(e){e.geometries.forEach(o)},LineString:function(e){e.arcs=s(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(s)},Polygon:function(e){e.arcs=e.arcs.map(l)},MultiPolygon:function(e){e.arcs=e.arcs.map(u)}};function s(e){for(var n=0,o=e.length;n<o;++n)i[++t]=e[n];var a={0:t-o+1,1:t};return r.push(a),a}function l(e){for(var r=0,o=e.length;r<o;++r)i[++t]=e[r];var a={0:t-o+1,1:t};return n.push(a),a}function u(e){return e.map(l)}for(var c in e)o(e[c]);return{type:"Topology",coordinates:i,lines:r,rings:n,objects:e}}(e))),o=i.coordinates,a=y(1.4*i.arcs.length,E,I);function s(e){e&&l.hasOwnProperty(e.type)&&l[e.type](e)}e=i.objects,i.bbox=r,i.arcs=i.arcs.map(function(e,t){return a.set(e,t),o.slice(e[0],e[1]+1)}),delete i.coordinates,o=null;var l={GeometryCollection:function(e){e.geometries.forEach(s)},LineString:function(e){e.arcs=u(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(u)},Polygon:function(e){e.arcs=e.arcs.map(u)},MultiPolygon:function(e){e.arcs=e.arcs.map(c)}};function u(e){var t=[];do{var r=a.get(e);t.push(e[0]<e[1]?r:~r)}while(e=e.next);return t}function c(e){return e.map(u)}for(var f in e)s(e[f]);return n&&(i.transform=n,i.arcs=function(e){for(var t=-1,r=e.length;++t<r;){for(var n,i,o=e[t],a=0,s=1,l=o.length,u=o[0],c=u[0],f=u[1];++a<l;)n=(u=o[a])[0],i=u[1],n===c&&i===f||(o[s++]=[n-c,i-f],c=n,f=i);1===s&&(o[s++]=[0,0]),o.length=s}return e}(i.arcs)),i},t.filter=function(e,t){var r=e.objects,n={},i=void 0;function o(e){var t=void 0,r=void 0;switch(e.type){case"Polygon":t=(r=a(e.arcs))?{type:"Polygon",arcs:r}:{type:null};break;case"MultiPolygon":t=(r=e.arcs.map(a).filter(L)).length?{type:"MultiPolygon",arcs:r}:{type:null};break;case"GeometryCollection":t=(r=e.geometries.map(o).filter(P)).length?{type:"GeometryCollection",geometries:r}:{type:null};break;default:return e}return null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),null!=e.properties&&(t.properties=e.properties),t}function a(e){return e.length&&function(e){return t(e,!1)}(e[0])?[e[0]].concat(e.slice(1).filter(s)):null}function s(e){return t(e,!0)}for(i in null==t&&(t=T),r)n[i]=o(r[i]);return function(e){var t=e.objects,r={},n=e.arcs,i=n.length,o=-1,a=new Array(i),s=0,l=void 0,u=-1,c=void 0;function f(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(f);break;case"LineString":d(e.arcs);break;case"MultiLineString":case"Polygon":e.arcs.forEach(d);break;case"MultiPolygon":e.arcs.forEach(p)}}function h(e){e<0&&(e=~e),a[e]||(a[e]=1,++s)}function d(e){e.forEach(h)}function p(e){e.forEach(d)}function y(e){var t=void 0;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(y)};break;case"LineString":t={type:"LineString",arcs:v(e.arcs)};break;case"MultiLineString":t={type:"MultiLineString",arcs:e.arcs.map(v)};break;case"Polygon":t={type:"Polygon",arcs:e.arcs.map(v)};break;case"MultiPolygon":t={type:"MultiPolygon",arcs:e.arcs.map(m)};break;default:return e}return null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),null!=e.properties&&(t.properties=e.properties),t}function g(e){return e<0?~a[~e]:a[e]}function v(e){return e.map(g)}function m(e){return e.map(v)}for(c in t)f(t[c]);for(l=new Array(s);++o<i;)a[o]&&(a[o]=++u,l[u]=n[o]);for(c in t)r[c]=y(t[c]);return{type:"Topology",bbox:e.bbox,transform:e.transform,objects:r,arcs:l}}({type:"Topology",bbox:e.bbox,transform:e.transform,objects:n,arcs:e.arcs})},t.filterAttached=C,t.filterAttachedWeight=function(e,t,r){var n=C(e),i=R(e,t,r);return function(e,t){return n(e,t)||i(e,t)}},t.filterWeight=R,t.planarRingArea=O,t.planarTriangleArea=N,t.presimplify=function(e,t){var r=e.transform?i(e.transform):G,n=function(){var e={},t=[],r=0;function n(e,r){for(;r>0;){var n=(r+1>>1)-1,i=t[n];if(V(e,i)>=0)break;t[i._=r]=i,t[e._=r=n]=e}}function i(e,n){for(;;){var i=n+1<<1,o=i-1,a=n,s=t[a];if(o<r&&V(t[o],s)<0&&(s=t[a=o]),i<r&&V(t[i],s)<0&&(s=t[a=i]),a===n)break;t[s._=n]=s,t[e._=n=a]=e}}return e.push=function(e){return n(t[e._=r]=e,r++),r},e.pop=function(){if(!(r<=0)){var e=t[0],n=void 0;return--r>0&&(n=t[r],i(t[n._=0]=n,0)),e}},e.remove=function(e){var o=e._,a=void 0;if(t[o]===e)return o!==--r&&(V(a=t[r],e)<0?n:i)(t[a._=o]=a,o),o},e}();null==t&&(t=N);var o=e.arcs.map(function(e){var i=[],o=0,s=void 0,l=void 0,u=void 0;for(l=1,u=(e=e.map(r)).length-1;l<u;++l)(s=[e[l-1],e[l],e[l+1]])[1][2]=t(s),i.push(s),n.push(s);for(e[0][2]=e[u][2]=1/0,l=0,u=i.length;l<u;++l)(s=i[l]).previous=i[l-1],s.next=i[l+1];for(;s=n.pop();){var c=s.previous,f=s.next;s[1][2]<o?s[1][2]=o:o=s[1][2],c&&(c.next=f,c[2]=s[2],a(c)),f&&(f.previous=c,f[0]=s[0],a(f))}return e});function a(e){n.remove(e),e[1][2]=t(e),n.push(e)}return{type:"Topology",bbox:e.bbox,objects:e.objects,arcs:o}},t.quantile=function(e,t){var r=[];return e.arcs.forEach(function(e){e.forEach(function(e){isFinite(e[2])&&r.push(e[2])})}),r.length&&function(e,t){if(r=e.length){if((t=+t)<=0||r<2)return e[0];if(t>=1)return e[r-1];var r=void 0,n=(r-1)*t,i=Math.floor(n),o=e[i];return o+(e[i+1]-o)*(n-i)}}(r.sort(A),t)},t.simplify=function(e,t){t=null==t?Number.MIN_VALUE:+t;var r=e.arcs.map(function(e){for(var r=-1,n=0,i=e.length,o=new Array(i),a=void 0;++r<i;)(a=e[r])[2]>=t&&(o[n++]=[a[0],a[1]]);return o.length=n,o});return{type:"Topology",transform:e.transform,bbox:e.bbox,objects:e.objects,arcs:r}},t.sphericalRingArea=function(e,t){var r=W(e,!0);return t&&(r*=-1),2*(r<0?D+r:r)},t.sphericalTriangleArea=function(e){return 2*q(W(e,!1))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFeaturesFromFeatureSet=void 0;var n=r(183);t.getFeaturesFromFeatureSet=n.getFeaturesFromFeatureSet},function(e,t,r){r(76),r(63),e.exports=r(391)},function(e,t,r){var n=r(28),i=r(117);e.exports=r(12).getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(0)),i=l(r(2)),o=r(1),a=l(r(194)),s=l(r(195));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.endField=(0,o.defaultValue)(t.endField,""),this.fullTimeExtent=t.fullTimeExtent?a.default.fromJSON(t.fullTimeExtent):null,this.interval=t.interval?s.default.fromJSON(t.interval):null,this.startField=(0,o.defaultValue)(t.startField,""),this.stops=Array.isArray(t.stops)?t.stops.map(function(e){return(0,o.toDate)(e)}):null,this.timeZone=(0,o.defaultValue)(t.timeZone,null)}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.endField=this.endField,e.fullTimeExtent=this.fullTimeExtent?this.fullTimeExtent.toJSON():null,e.interval=this.interval?this.interval.toJSON():null,e.startField=this.startField,e.stops=this.stops?this.stops.map(function(e){return e?e.toString():e}):null,e.timeZone=this.timeZone,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t=(0,o.defaultValue)(t,{}))}}]),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalize=function(e){var t=e.clone(),r=function(e){return Math.sqrt(function(e){return e.hasZ?e.coordinates[0]*e.coordinates[0]+e.coordinates[1]*e.coordinates[1]+e.coordinates[2]*e.coordinates[2]:e.coordinates[0]*e.coordinates[0]+e.coordinates[1]*e.coordinates[1]}(e))}(t);return t.coordinates[0]/=r,t.coordinates[1]/=r,t.hasZ&&(t.coordinates[2]/=r),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getGeometryCenter=t.createGeometry=void 0;var n=r(19),i=function(e){return e&&e.__esModule?e:{default:e}}(r(95)),o=r(105);t.createGeometry=function(e){switch((e=(0,n.defaultValue)(e,{})).type){case i.default.circle:return new o.Circle(e);case i.default.extent:return new o.Extent(e);case i.default.lineString:return new o.LineString(e);case i.default.multiPolygon:return new o.MultiPolygon(e);case i.default.point:return new o.Point(e);case i.default.polygon:default:return new o.Polygon(e)}},t.getGeometryCenter=function(e){e||o.Log.error("几何为空");var t=void 0;switch(e.type){case i.default.point:t=e;break;case i.default.multiPoint:case i.default.lineString:case i.default.multiLineString:case i.default.multiPolygon:t=e.extent.center;break;case i.default.polygon:t=e.centroid;break;case i.default.extent:case i.default.circle:t=e.center;break;default:t=e.extent.center}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionParser=void 0;var n=s(r(396)),i=s(r(400)),o=r(404),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(405));function s(e){return e&&e.__esModule?e:{default:e}}o.Parser.createValueExpressionParser=function(){var e=new o.Parser;return(0,i.default)(a).forEach(function(t){var r=(0,n.default)(t,2),i=r[0],o=r[1];e.functions[i]=o}),e.binaryOps["+"]=function(e,t){return e+t},e},t.ExpressionParser=o.Parser},function(e,t,r){"use strict";t.__esModule=!0;var n=o(r(397)),i=o(r(187));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if(Array.isArray(e))return e;if((0,n.default)(Object(e)))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var s,l=(0,i.default)(e);!(n=(s=l.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,r){e.exports={default:r(398),__esModule:!0}},function(e,t,r){r(76),r(63),e.exports=r(399)},function(e,t,r){var n=r(93),i=r(21)("iterator"),o=r(64);e.exports=r(12).isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||o.hasOwnProperty(n(t))}},function(e,t,r){e.exports={default:r(401),__esModule:!0}},function(e,t,r){r(402),e.exports=r(12).Object.entries},function(e,t,r){var n=r(18),i=r(403)(!0);n(n.S,"Object",{entries:function(e){return i(e)}})},function(e,t,r){var n=r(26),i=r(61),o=r(44),a=r(78).f;e.exports=function(e){return function(t){for(var r,s=o(t),l=i(s),u=l.length,c=0,f=[];u>c;)r=l[c++],n&&!a.call(s,r)||f.push(e?[r,s[r]]:s[r]);return f}}},function(e,t,r){"use strict";r.r(t),r.d(t,"Expression",function(){return T}),r.d(t,"Parser",function(){return Oe});var n="INUMBER",i="IOP1",o="IOP2",a="IOP3",s="IVAR",l="IVARNAME",u="IFUNCALL",c="IFUNDEF",f="IEXPR",h="IEXPREVAL",d="IMEMBER",p="IENDSTATEMENT",y="IARRAY";function g(e,t){this.type=e,this.value=void 0!==t&&null!==t?t:0}function v(e){return new g(i,e)}function m(e){return new g(o,e)}function _(e){return new g(a,e)}function S(e,t,r){var g,v,m,_,k,M,E=[];if(b(e))return w(e,r);for(var I=e.length,T=0;T<I;T++){var L=e[T],P=L.type;if(P===n||P===l)E.push(L.value);else if(P===o)v=E.pop(),g=E.pop(),"and"===L.value?E.push(!!g&&!!S(v,t,r)):"or"===L.value?E.push(!!g||!!S(v,t,r)):"="===L.value?(_=t.binaryOps[L.value],E.push(_(g,S(v,t,r),r))):(_=t.binaryOps[L.value],E.push(_(w(g,r),w(v,r))));else if(P===a)m=E.pop(),v=E.pop(),g=E.pop(),"?"===L.value?E.push(S(g?v:m,t,r)):(_=t.ternaryOps[L.value],E.push(_(w(g,r),w(v,r),w(m,r))));else if(P===s)if(L.value in t.functions)E.push(t.functions[L.value]);else if(L.value in t.unaryOps&&t.parser.isOperatorEnabled(L.value))E.push(t.unaryOps[L.value]);else{var C=r[L.value];if(void 0===C)throw new Error("undefined variable: "+L.value);E.push(C)}else if(P===i)g=E.pop(),_=t.unaryOps[L.value],E.push(_(w(g,r)));else if(P===u){for(M=L.value,k=[];M-- >0;)k.unshift(w(E.pop(),r));if(!(_=E.pop()).apply||!_.call)throw new Error(_+" is not a function");E.push(_.apply(void 0,k))}else if(P===c)E.push(function(){for(var e=E.pop(),n=[],i=L.value;i-- >0;)n.unshift(E.pop());var o=E.pop(),a=function(){for(var i=Object.assign({},r),o=0,a=n.length;o<a;o++)i[n[o]]=arguments[o];return S(e,t,i)};return Object.defineProperty(a,"name",{value:o,writable:!1}),r[o]=a,a}());else if(P===f)E.push(x(L,t));else if(P===h)E.push(L);else if(P===d)g=E.pop(),E.push(g[L.value]);else if(P===p)E.pop();else{if(P!==y)throw new Error("invalid Expression");for(M=L.value,k=[];M-- >0;)k.unshift(E.pop());E.push(k)}}if(E.length>1)throw new Error("invalid Expression (parity)");return 0===E[0]?0:w(E[0],r)}function x(e,t,r){return b(e)?e:{type:h,value:function(r){return S(e.value,t,r)}}}function b(e){return e&&e.type===h}function w(e,t){return b(e)?e.value(t):e}function k(e,t){for(var r,h,g,v,m,_,S=[],x=0;x<e.length;x++){var b=e[x],w=b.type;if(w===n)"number"==typeof b.value&&b.value<0?S.push("("+b.value+")"):Array.isArray(b.value)?S.push("["+b.value.map(M).join(", ")+"]"):S.push(M(b.value));else if(w===o)h=S.pop(),r=S.pop(),v=b.value,t?"^"===v?S.push("Math.pow("+r+", "+h+")"):"and"===v?S.push("(!!"+r+" && !!"+h+")"):"or"===v?S.push("(!!"+r+" || !!"+h+")"):"||"===v?S.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+r+"),("+h+")))"):"=="===v?S.push("("+r+" === "+h+")"):"!="===v?S.push("("+r+" !== "+h+")"):"["===v?S.push(r+"[("+h+") | 0]"):S.push("("+r+" "+v+" "+h+")"):"["===v?S.push(r+"["+h+"]"):S.push("("+r+" "+v+" "+h+")");else if(w===a){if(g=S.pop(),h=S.pop(),r=S.pop(),"?"!==(v=b.value))throw new Error("invalid Expression");S.push("("+r+" ? "+h+" : "+g+")")}else if(w===s||w===l)S.push(b.value);else if(w===i)r=S.pop(),"-"===(v=b.value)||"+"===v?S.push("("+v+r+")"):t?"not"===v?S.push("(!"+r+")"):"!"===v?S.push("fac("+r+")"):S.push(v+"("+r+")"):"!"===v?S.push("("+r+"!)"):S.push("("+v+" "+r+")");else if(w===u){for(_=b.value,m=[];_-- >0;)m.unshift(S.pop());v=S.pop(),S.push(v+"("+m.join(", ")+")")}else if(w===c){for(h=S.pop(),_=b.value,m=[];_-- >0;)m.unshift(S.pop());r=S.pop(),t?S.push("("+r+" = function("+m.join(", ")+") { return "+h+" })"):S.push("("+r+"("+m.join(", ")+") = "+h+")")}else if(w===d)r=S.pop(),S.push(r+"."+b.value);else if(w===y){for(_=b.value,m=[];_-- >0;)m.unshift(S.pop());S.push("["+m.join(", ")+"]")}else if(w===f)S.push("("+k(b.value,t)+")");else if(w!==p)throw new Error("invalid Expression")}return S.length>1&&(S=t?[S.join(",")]:[S.join(";")]),String(S[0])}function M(e){return"string"==typeof e?JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):e}function E(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1}function I(e,t,r){for(var n=!!(r=r||{}).withMembers,i=null,o=0;o<e.length;o++){var a=e[o];a.type===s||a.type===l?n||E(t,a.value)?null!==i?(E(t,i)||t.push(i),i=a.value):i=a.value:t.push(a.value):a.type===d&&n&&null!==i?i+="."+a.value:a.type===f?I(a.value,t,r):null!==i&&(E(t,i)||t.push(i),i=null)}null===i||E(t,i)||t.push(i)}function T(e,t){this.tokens=e,this.parser=t,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.functions=t.functions}g.prototype.toString=function(){switch(this.type){case n:case i:case o:case a:case s:case l:case p:return this.value;case u:return"CALL "+this.value;case c:return"DEF "+this.value;case y:return"ARRAY "+this.value;case d:return"."+this.value;default:return"Invalid Instruction"}},T.prototype.simplify=function(e){return e=e||{},new T(function e(t,r,u,c,h){for(var p,v,m,_,S=[],x=[],b=0;b<t.length;b++){var w=t[b],k=w.type;if(k===n||k===l)Array.isArray(w.value)?S.push.apply(S,e(w.value.map(function(e){return new g(n,e)}).concat(new g(y,w.value.length)),r,u,c,h)):S.push(w);else if(k===s&&h.hasOwnProperty(w.value))w=new g(n,h[w.value]),S.push(w);else if(k===o&&S.length>1)v=S.pop(),p=S.pop(),_=u[w.value],w=new g(n,_(p.value,v.value)),S.push(w);else if(k===a&&S.length>2)m=S.pop(),v=S.pop(),p=S.pop(),"?"===w.value?S.push(p.value?v.value:m.value):(_=c[w.value],w=new g(n,_(p.value,v.value,m.value)),S.push(w));else if(k===i&&S.length>0)p=S.pop(),_=r[w.value],w=new g(n,_(p.value)),S.push(w);else if(k===f){for(;S.length>0;)x.push(S.shift());x.push(new g(f,e(w.value,r,u,c,h)))}else if(k===d&&S.length>0)p=S.pop(),S.push(new g(n,p.value[w.value]));else{for(;S.length>0;)x.push(S.shift());x.push(w)}}for(;S.length>0;)x.push(S.shift());return x}(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,e),this.parser)},T.prototype.substitute=function(e,t){return t instanceof T||(t=this.parser.parse(String(t))),new T(function e(t,r,n){for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.type;if(h===s&&c.value===r)for(var d=0;d<n.tokens.length;d++){var p,y=n.tokens[d];p=y.type===i?v(y.value):y.type===o?m(y.value):y.type===a?_(y.value):new g(y.type,y.value),l.push(p)}else h===f?l.push(new g(f,e(c.value,r,n))):l.push(c)}return l}(this.tokens,e,t),this.parser)},T.prototype.evaluate=function(e){return e=e||{},S(this.tokens,this,e)},T.prototype.toString=function(){return k(this.tokens,!1)},T.prototype.symbols=function(e){e=e||{};var t=[];return I(this.tokens,t,e),t},T.prototype.variables=function(e){e=e||{};var t=[];I(this.tokens,t,e);var r=this.functions;return t.filter(function(e){return!(e in r)})},T.prototype.toJSFunction=function(e,t){var r=this,n=new Function(e,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+k(this.simplify(t).tokens,!0)+"; }");return function(){return n.apply(r,arguments)}};var L="TOP",P="TPAREN";function C(e,t,r){this.type=e,this.value=t,this.index=r}function N(e,t){this.pos=0,this.current=null,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.consts=e.consts,this.expression=t,this.savedPosition=0,this.savedCurrent=null,this.options=e.options,this.parser=e}C.prototype.toString=function(){return this.type+": "+this.value},N.prototype.newToken=function(e,t,r){return new C(e,t,null!=r?r:this.pos)},N.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},N.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},N.prototype.next=function(){return this.pos>=this.expression.length?this.newToken("TEOF","EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},N.prototype.isString=function(){var e=!1,t=this.pos,r=this.expression.charAt(t);if("'"===r||'"'===r)for(var n=this.expression.indexOf(r,t+1);n>=0&&this.pos<this.expression.length;){if(this.pos=n+1,"\\"!==this.expression.charAt(n-1)){var i=this.expression.substring(t+1,n);this.current=this.newToken("TSTRING",this.unescape(i),t),e=!0;break}n=this.expression.indexOf(r,n+1)}return e},N.prototype.isParen=function(){var e=this.expression.charAt(this.pos);return("("===e||")"===e)&&(this.current=this.newToken(P,e),this.pos++,!0)},N.prototype.isBracket=function(){var e=this.expression.charAt(this.pos);return!("["!==e&&"]"!==e||!this.isOperatorEnabled("[")||(this.current=this.newToken("TBRACKET",e),this.pos++,0))},N.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken("TCOMMA",","),this.pos++,!0)},N.prototype.isSemicolon=function(){return";"===this.expression.charAt(this.pos)&&(this.current=this.newToken("TSEMICOLON",";"),this.pos++,!0)},N.prototype.isConst=function(){for(var e=this.pos,t=e;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||"_"!==r&&"."!==r&&(r<"0"||r>"9")))break}if(t>e){var n=this.expression.substring(e,t);if(n in this.consts)return this.current=this.newToken("TNUMBER",this.consts[n]),this.pos+=n.length,!0}return!1},N.prototype.isNamedOp=function(){for(var e=this.pos,t=e;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||"_"!==r&&(r<"0"||r>"9")))break}if(t>e){var n=this.expression.substring(e,t);if(this.isOperatorEnabled(n)&&(n in this.binaryOps||n in this.unaryOps||n in this.ternaryOps))return this.current=this.newToken(L,n),this.pos+=n.length,!0}return!1},N.prototype.isName=function(){for(var e=this.pos,t=e,r=!1;t<this.expression.length;t++){var n=this.expression.charAt(t);if(n.toUpperCase()===n.toLowerCase()){if(t===this.pos&&("$"===n||"_"===n)){"_"===n&&(r=!0);continue}if(t===this.pos||!r||"_"!==n&&(n<"0"||n>"9"))break}else r=!0}if(r){var i=this.expression.substring(e,t);return this.current=this.newToken("TNAME",i),this.pos+=i.length,!0}return!1},N.prototype.isWhitespace=function(){for(var e=!1,t=this.expression.charAt(this.pos);!(" "!==t&&"\t"!==t&&"\n"!==t&&"\r"!==t||(e=!0,this.pos++,this.pos>=this.expression.length));)t=this.expression.charAt(this.pos);return e};var O=/^[0-9a-f]{4}$/i;function R(e,t,r){this.parser=e,this.tokens=t,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==r.allowMemberAccess}N.prototype.unescape=function(e){var t=e.indexOf("\\");if(t<0)return e;for(var r=e.substring(0,t);t>=0;){var n=e.charAt(++t);switch(n){case"'":r+="'";break;case'"':r+='"';break;case"\\":r+="\\";break;case"/":r+="/";break;case"b":r+="\b";break;case"f":r+="\f";break;case"n":r+="\n";break;case"r":r+="\r";break;case"t":r+="\t";break;case"u":var i=e.substring(t+1,t+5);O.test(i)||this.parseError("Illegal escape sequence: \\u"+i),r+=String.fromCharCode(parseInt(i,16)),t+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+n+'"')}++t;var o=e.indexOf("\\",t);r+=e.substring(t,o<0?e.length:o),t=o}return r},N.prototype.isComment=function(){return"/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},N.prototype.isRadixInteger=function(){var e,t,r=this.pos;if(r>=this.expression.length-2||"0"!==this.expression.charAt(r))return!1;if(++r,"x"===this.expression.charAt(r))e=16,t=/^[0-9a-f]$/i,++r;else{if("b"!==this.expression.charAt(r))return!1;e=2,t=/^[01]$/i,++r}for(var n=!1,i=r;r<this.expression.length;){var o=this.expression.charAt(r);if(!t.test(o))break;r++,n=!0}return n&&(this.current=this.newToken("TNUMBER",parseInt(this.expression.substring(i,r),e)),this.pos=r),n},N.prototype.isNumber=function(){for(var e,t=!1,r=this.pos,n=r,i=r,o=!1,a=!1;r<this.expression.length&&((e=this.expression.charAt(r))>="0"&&e<="9"||!o&&"."===e);)"."===e?o=!0:a=!0,r++,t=a;if(t&&(i=r),"e"===e||"E"===e){r++;for(var s=!0,l=!1;r<this.expression.length;){if(e=this.expression.charAt(r),!s||"+"!==e&&"-"!==e){if(!(e>="0"&&e<="9"))break;l=!0,s=!1}else s=!1;r++}l||(r=i)}return t?(this.current=this.newToken("TNUMBER",parseFloat(this.expression.substring(n,r))),this.pos=r):this.pos=i,t},N.prototype.isOperator=function(){var e=this.pos,t=this.expression.charAt(this.pos);if("+"===t||"-"===t||"*"===t||"/"===t||"%"===t||"^"===t||"?"===t||":"===t||"."===t)this.current=this.newToken(L,t);else if("∙"===t||"•"===t)this.current=this.newToken(L,"*");else if(">"===t)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(L,">="),this.pos++):this.current=this.newToken(L,">");else if("<"===t)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(L,"<="),this.pos++):this.current=this.newToken(L,"<");else if("|"===t){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(L,"||"),this.pos++}else if("="===t)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(L,"=="),this.pos++):this.current=this.newToken(L,t);else{if("!"!==t)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(L,"!="),this.pos++):this.current=this.newToken(L,t)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=e,!1)},N.prototype.isOperatorEnabled=function(e){return this.parser.isOperatorEnabled(e)},N.prototype.getCoordinates=function(){var e,t=0,r=-1;do{t++,e=this.pos-r,r=this.expression.indexOf("\n",r+1)}while(r>=0&&r<this.pos);return{line:t,column:e}},N.prototype.parseError=function(e){var t=this.getCoordinates();throw new Error("parse error ["+t.line+":"+t.column+"]: "+e)},R.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},R.prototype.tokenMatches=function(e,t){return void 0===t||(Array.isArray(t)?E(t,e.value):"function"==typeof t?t(e):e.value===t)},R.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},R.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},R.prototype.accept=function(e,t){return!(this.nextToken.type!==e||!this.tokenMatches(this.nextToken,t)||(this.next(),0))},R.prototype.expect=function(e,t){if(!this.accept(e,t)){var r=this.tokens.getCoordinates();throw new Error("parse error ["+r.line+":"+r.column+"]: Expected "+(t||e))}},R.prototype.parseAtom=function(e){var t=this.tokens.unaryOps;if(this.accept("TNAME")||this.accept(L,function(e){return e.value in t}))e.push(new g(s,this.current.value));else if(this.accept("TNUMBER"))e.push(new g(n,this.current.value));else if(this.accept("TSTRING"))e.push(new g(n,this.current.value));else if(this.accept(P,"("))this.parseExpression(e),this.expect(P,")");else{if(!this.accept("TBRACKET","["))throw new Error("unexpected "+this.nextToken);if(this.accept("TBRACKET","]"))e.push(new g(y,0));else{var r=this.parseArrayList(e);e.push(new g(y,r))}}},R.prototype.parseExpression=function(e){var t=[];this.parseUntilEndStatement(e,t)||(this.parseVariableAssignmentExpression(t),this.parseUntilEndStatement(e,t)||this.pushExpression(e,t))},R.prototype.pushExpression=function(e,t){for(var r=0,n=t.length;r<n;r++)e.push(t[r])},R.prototype.parseUntilEndStatement=function(e,t){return!!this.accept("TSEMICOLON")&&(!this.nextToken||"TEOF"===this.nextToken.type||this.nextToken.type===P&&")"===this.nextToken.value||t.push(new g(p)),"TEOF"!==this.nextToken.type&&this.parseExpression(t),e.push(new g(f,t)),!0)},R.prototype.parseArrayList=function(e){for(var t=0;!this.accept("TBRACKET","]");)for(this.parseExpression(e),++t;this.accept("TCOMMA");)this.parseExpression(e),++t;return t},R.prototype.parseVariableAssignmentExpression=function(e){for(this.parseConditionalExpression(e);this.accept(L,"=");){var t=e.pop(),r=[],n=e.length-1;if(t.type!==u){if(t.type!==s&&t.type!==d)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(r),e.push(new g(l,t.value)),e.push(new g(f,r)),e.push(m("="))}else{if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var i=0,o=t.value+1;i<o;i++){var a=n-i;e[a].type===s&&(e[a]=new g(l,e[a].value))}this.parseVariableAssignmentExpression(r),e.push(new g(f,r)),e.push(new g(c,t.value))}}},R.prototype.parseConditionalExpression=function(e){for(this.parseOrExpression(e);this.accept(L,"?");){var t=[],r=[];this.parseConditionalExpression(t),this.expect(L,":"),this.parseConditionalExpression(r),e.push(new g(f,t)),e.push(new g(f,r)),e.push(_("?"))}},R.prototype.parseOrExpression=function(e){for(this.parseAndExpression(e);this.accept(L,"or");){var t=[];this.parseAndExpression(t),e.push(new g(f,t)),e.push(m("or"))}},R.prototype.parseAndExpression=function(e){for(this.parseComparison(e);this.accept(L,"and");){var t=[];this.parseComparison(t),e.push(new g(f,t)),e.push(m("and"))}};var V=["==","!=","<","<=",">=",">","in"];R.prototype.parseComparison=function(e){for(this.parseAddSub(e);this.accept(L,V);){var t=this.current;this.parseAddSub(e),e.push(m(t.value))}};var G=["+","-","||"];R.prototype.parseAddSub=function(e){for(this.parseTerm(e);this.accept(L,G);){var t=this.current;this.parseTerm(e),e.push(m(t.value))}};var A=["*","/","%"];function F(e,t){return Number(e)+Number(t)}function D(e,t){return e-t}function j(e,t){return e*t}function B(e,t){return e/t}function q(e,t){return e%t}function U(e,t){return Array.isArray(e)&&Array.isArray(t)?e.concat(t):""+e+t}function J(e,t){return e===t}function z(e,t){return e!==t}function W(e,t){return e>t}function H(e,t){return e<t}function X(e,t){return e>=t}function Y(e,t){return e<=t}function Z(e,t){return Boolean(e&&t)}function K(e,t){return Boolean(e||t)}function Q(e,t){return E(t,e)}function $(e){return(Math.exp(e)-Math.exp(-e))/2}function ee(e){return(Math.exp(e)+Math.exp(-e))/2}function te(e){return e===1/0?1:e===-1/0?-1:(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))}function re(e){return e===-1/0?e:Math.log(e+Math.sqrt(e*e+1))}function ne(e){return Math.log(e+Math.sqrt(e*e-1))}function ie(e){return Math.log((1+e)/(1-e))/2}function oe(e){return Math.log(e)*Math.LOG10E}function ae(e){return-e}function se(e){return!e}function le(e){return e<0?Math.ceil(e):Math.floor(e)}function ue(e){return Math.random()*(e||1)}function ce(e){return de(e+1)}R.prototype.parseTerm=function(e){for(this.parseFactor(e);this.accept(L,A);){var t=this.current;this.parseFactor(e),e.push(m(t.value))}},R.prototype.parseFactor=function(e){var t=this.tokens.unaryOps;if(this.save(),this.accept(L,function(e){return e.value in t})){if("-"!==this.current.value&&"+"!==this.current.value){if(this.nextToken.type===P&&"("===this.nextToken.value)return this.restore(),void this.parseExponential(e);if("TSEMICOLON"===this.nextToken.type||"TCOMMA"===this.nextToken.type||"TEOF"===this.nextToken.type||this.nextToken.type===P&&")"===this.nextToken.value)return this.restore(),void this.parseAtom(e)}var r=this.current;this.parseFactor(e),e.push(v(r.value))}else this.parseExponential(e)},R.prototype.parseExponential=function(e){for(this.parsePostfixExpression(e);this.accept(L,"^");)this.parseFactor(e),e.push(m("^"))},R.prototype.parsePostfixExpression=function(e){for(this.parseFunctionCall(e);this.accept(L,"!");)e.push(v("!"))},R.prototype.parseFunctionCall=function(e){var t=this.tokens.unaryOps;if(this.accept(L,function(e){return e.value in t})){var r=this.current;this.parseAtom(e),e.push(v(r.value))}else for(this.parseMemberExpression(e);this.accept(P,"(");)if(this.accept(P,")"))e.push(new g(u,0));else{var n=this.parseArgumentList(e);e.push(new g(u,n))}},R.prototype.parseArgumentList=function(e){for(var t=0;!this.accept(P,")");)for(this.parseExpression(e),++t;this.accept("TCOMMA");)this.parseExpression(e),++t;return t},R.prototype.parseMemberExpression=function(e){for(this.parseAtom(e);this.accept(L,".")||this.accept("TBRACKET","[");){var t=this.current;if("."===t.value){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect("TNAME"),e.push(new g(d,this.current.value))}else{if("["!==t.value)throw new Error("unexpected symbol: "+t.value);if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(e),this.expect("TBRACKET","]"),e.push(m("["))}}};var fe=4.7421875,he=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function de(e){var t,r;if(function(e){return isFinite(e)&&e===Math.round(e)}(e)){if(e<=0)return isFinite(e)?1/0:NaN;if(e>171)return 1/0;for(var n=e-2,i=e-1;n>1;)i*=n,n--;return 0===i&&(i=1),i}if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*de(1-e));if(e>=171.35)return 1/0;if(e>85){var o=e*e,a=o*e,s=a*e,l=s*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*o)-139/(51840*a)-571/(2488320*s)+163879/(209018880*l)+5246819/(75246796800*l*e))}--e,r=he[0];for(var u=1;u<he.length;++u)r+=he[u]/(e+u);return t=e+fe+.5,Math.sqrt(2*Math.PI)*Math.pow(t,e+.5)*Math.exp(-t)*r}function pe(e){return Array.isArray(e)?e.length:String(e).length}function ye(){for(var e=0,t=0,r=0;r<arguments.length;r++){var n,i=Math.abs(arguments[r]);t<i?(e=e*(n=t/i)*n+1,t=i):e+=i>0?(n=i/t)*n:i}return t===1/0?1/0:t*Math.sqrt(e)}function ge(e,t,r){return e?t:r}function ve(e,t){return void 0===t||0==+t?Math.round(e):(e=+e,t=-+t,isNaN(e)||"number"!=typeof t||t%1!=0?NaN:(e=e.toString().split("e"),+((e=(e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t)))).toString().split("e"))[0]+"e"+(e[1]?+e[1]+t:t))))}function me(e,t,r){return r&&(r[e]=t),t}function _e(e,t){return e[0|t]}function Se(e){return 1===arguments.length&&Array.isArray(e)?Math.max.apply(Math,e):Math.max.apply(Math,arguments)}function xe(e){return 1===arguments.length&&Array.isArray(e)?Math.min.apply(Math,e):Math.min.apply(Math,arguments)}function be(e,t){if("function"!=typeof e)throw new Error("First argument to map is not a function");if(!Array.isArray(t))throw new Error("Second argument to map is not an array");return t.map(function(t,r){return e(t,r)})}function we(e,t,r){if("function"!=typeof e)throw new Error("First argument to fold is not a function");if(!Array.isArray(r))throw new Error("Second argument to fold is not an array");return r.reduce(function(t,r,n){return e(t,r,n)},t)}function ke(e,t){if("function"!=typeof e)throw new Error("First argument to filter is not a function");if(!Array.isArray(t))throw new Error("Second argument to filter is not an array");return t.filter(function(t,r){return e(t,r)})}function Me(e,t){if(!Array.isArray(t)&&"string"!=typeof t)throw new Error("Second argument to indexOf is not a string or array");return t.indexOf(e)}function Ee(e,t){if(!Array.isArray(t))throw new Error("Second argument to join is not an array");return t.join(e)}function Ie(e){return(e>0)-(e<0)||+e}var Te=1/3;function Le(e){return e<0?-Math.pow(-e,Te):Math.pow(e,Te)}function Pe(e){return Math.exp(e)-1}function Ce(e){return Math.log(1+e)}function Ne(e){return Math.log(e)/Math.LN2}function Oe(e){this.options=e||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||$,cosh:Math.cosh||ee,tanh:Math.tanh||te,asinh:Math.asinh||re,acosh:Math.acosh||ne,atanh:Math.atanh||ie,sqrt:Math.sqrt,cbrt:Math.cbrt||Le,log:Math.log,log2:Math.log2||Ne,ln:Math.log,lg:Math.log10||oe,log10:Math.log10||oe,expm1:Math.expm1||Pe,log1p:Math.log1p||Ce,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||le,"-":ae,"+":Number,exp:Math.exp,not:se,length:pe,"!":ce,sign:Math.sign||Ie},this.binaryOps={"+":F,"-":D,"*":j,"/":B,"%":q,"^":Math.pow,"||":U,"==":J,"!=":z,">":W,"<":H,">=":X,"<=":Y,and:Z,or:K,in:Q,"=":me,"[":_e},this.ternaryOps={"?":ge},this.functions={random:ue,fac:ce,min:xe,max:Se,hypot:Math.hypot||ye,pyt:Math.hypot||ye,pow:Math.pow,atan2:Math.atan2,if:ge,gamma:de,roundTo:ve,map:be,fold:we,filter:ke,indexOf:Me,join:Ee},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}Oe.prototype.parse=function(e){var t=[],r=new R(this,new N(this,e),{allowMemberAccess:this.options.allowMemberAccess});return r.parseExpression(t),r.expect("TEOF","EOF"),new T(t,this)},Oe.prototype.evaluate=function(e,t){return this.parse(e).evaluate(t)};var Re=new Oe;Oe.parse=function(e){return Re.parse(e)},Oe.evaluate=function(e,t){return Re.parse(e).evaluate(t)};var Ve={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};Oe.prototype.isOperatorEnabled=function(e){var t=function(e){return Ve.hasOwnProperty(e)?Ve[e]:e}(e),r=this.options.operators||{};return!(t in r&&!r[t])};
/*!
 Based on ndef.parser, by Raphael Graf(r@undefined.ch)
 http://www.undefined.ch/mparser/index.html

 Ported to JavaScript and modified by Matthew Crumley (email@matthewcrumley.com, http://silentmatt.com/)

 You are free to use and modify this code in anyway you find useful. Please leave this comment in the code
 to acknowledge its original source. If you feel like it, I enjoy hearing about projects that use my code,
 but don't feel like you have to let me know or ask permission.
*/
var Ge={Parser:Oe,Expression:T};t.default=Ge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.when=function(){if(arguments.length<3)throw new Error("表达式when函数传入参数错误");for(var e=1;e<arguments.length-1;e+=2)if(arguments[e-1])return arguments[e];return arguments[arguments.length-1]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:2592e6,years:31104e6};t.toDate=function(e){return e instanceof Date?e:"string"==typeof e||"number"==typeof e?new Date(e):e},t.convertByDateUnit=function(e,t,r){var i=n[t],o=n[r];if(!i||!o)throw new Error("传入的时间单位未定义");return i*e/o}},function(e,t,r){r(408),e.exports=r(12).Object.assign},function(e,t,r){var n=r(18);n(n.S+n.F,"Object",{assign:r(409)})},function(e,t,r){"use strict";var n=r(26),i=r(61),o=r(123),a=r(78),s=r(51),l=r(107),u=Object.assign;e.exports=!u||r(52)(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=u({},e)[r]||Object.keys(u({},t)).join("")!=n})?function(e,t){for(var r=s(e),u=arguments.length,c=1,f=o.f,h=a.f;u>c;)for(var d,p=l(arguments[c++]),y=f?i(p).concat(f(p)):i(p),g=y.length,v=0;g>v;)d=y[v++],n&&!h.call(p,d)||(r[d]=p[d]);return r}:u},function(e,t,r){e.exports={default:r(411),__esModule:!0}},function(e,t,r){r(114),r(63),r(76),r(412),r(418),r(421),r(423),e.exports=r(12).Set},function(e,t,r){"use strict";var n=r(413),i=r(197);e.exports=r(414)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},function(e,t,r){"use strict";var n=r(27).f,i=r(91),o=r(119),a=r(34),s=r(116),l=r(77),u=r(115),c=r(154),f=r(161),h=r(26),d=r(94).fastKey,p=r(197),y=h?"_s":"size",g=function(e,t){var r,n=d(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var c=e(function(e,n){s(e,c,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[y]=0,void 0!=n&&l(n,r,e[u],e)});return o(c.prototype,{clear:function(){for(var e=p(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[y]=0},delete:function(e){var r=p(this,t),n=g(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[y]--}return!!n},forEach:function(e){p(this,t);for(var r,n=a(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!g(p(this,t),e)}}),h&&n(c.prototype,"size",{get:function(){return p(this,t)[y]}}),c},def:function(e,t,r){var n,i,o=g(e,t);return o?o.v=r:(e._l=o={i:i=d(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[y]++,"F"!==i&&(e._i[i]=o)),e},getEntry:g,setStrong:function(e,t,r){u(e,t,function(e,r){this._t=p(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?c(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,c(1))},r?"entries":"values",!r,!0),f(t)}}},function(e,t,r){"use strict";var n=r(20),i=r(18),o=r(94),a=r(52),s=r(45),l=r(119),u=r(77),c=r(116),f=r(24),h=r(75),d=r(27).f,p=r(415)(0),y=r(26);e.exports=function(e,t,r,g,v,m){var _=n[e],S=_,x=v?"set":"add",b=S&&S.prototype,w={};return y&&"function"==typeof S&&(m||b.forEach&&!a(function(){(new S).entries().next()}))?(S=t(function(t,r){c(t,S,e,"_c"),t._c=new _,void 0!=r&&u(r,v,t[x],t)}),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in b&&(!m||"clear"!=e)&&s(S.prototype,e,function(r,n){if(c(this,S,e),!t&&m&&!f(r))return"get"==e&&void 0;var i=this._c[e](0===r?0:r,n);return t?this:i})}),m||d(S.prototype,"size",{get:function(){return this._c.size}})):(S=g.getConstructor(t,e,v,x),l(S.prototype,r),o.NEED=!0),h(S,e),w[e]=S,i(i.G+i.W+i.F,w),m||g.setStrong(S,e,v),S}},function(e,t,r){var n=r(34),i=r(107),o=r(51),a=r(88),s=r(416);e.exports=function(e,t){var r=1==e,l=2==e,u=3==e,c=4==e,f=6==e,h=5==e||f,d=t||s;return function(t,s,p){for(var y,g,v=o(t),m=i(v),_=n(s,p,3),S=a(m.length),x=0,b=r?d(t,S):l?d(t,0):void 0;S>x;x++)if((h||x in m)&&(g=_(y=m[x],x,v),e))if(r)b[x]=g;else if(g)switch(e){case 3:return!0;case 5:return y;case 6:return x;case 2:b.push(y)}else if(c)return!1;return f?-1:u||c?c:b}}},function(e,t,r){var n=r(417);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,r){var n=r(24),i=r(163),o=r(21)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,r){var n=r(18);n(n.P+n.R,"Set",{toJSON:r(419)("Set")})},function(e,t,r){var n=r(93),i=r(420);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,r){var n=r(77);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},function(e,t,r){r(422)("Set")},function(e,t,r){"use strict";var n=r(18);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,r){r(424)("Set")},function(e,t,r){"use strict";var n=r(18),i=r(74),o=r(34),a=r(77);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,s,l=arguments[1];return i(this),(t=void 0!==l)&&i(l),void 0==e?new this:(r=[],t?(n=0,s=o(l,arguments[2],2),a(e,!1,function(e){r.push(s(e,n++))})):a(e,!1,r.push,r),new this(r))}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),this.interceptors=(0,i.defaultValue)(t.interceptors,[])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1),o=r(8);t.default=function e(t){(0,n.default)(this,e),t=(0,i.defaultValue)(t,{}),this.geometry=(0,i.defaultValue)(t.geometry,void 0),this.spatialRelation=(0,i.defaultValue)(t.spatialRelation,o.SpatialRelation.Intersects)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),this.urls=(0,i.defaultValue)(t.urls,[]),this.before=(0,i.defaultValue)(t.before,void 0),this.after=(0,i.defaultValue)(t.urls,void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(16)),i=r(1),o=r(139),a=u(r(30)),s=u(r(487)),l=u(r(67));function u(e){return e&&e.__esModule?e:{default:e}}var c={getTile:function(e,t){t=(0,i.defaultValue)(t,{});var r=(0,i.defaultValue)(t.queryParameters,{}),a=(0,i.defaultValue)(t.tokenKey,"token"),u=(0,i.defaultValue)(t.tokenValue,null);r[a]=u;var c=new o.TileServer({url:e});c._queryParameters=(0,n.default)(c._queryParameters,r);var f=c.getTile(t),h=l.default.getBaseUrlAndParams(f);return new s.default({url:h.baseUrl,headers:t.headers,queryParameters:h.params,commonQueryParameters:(0,i.deleteNullValue)((0,n.default)(c._queryParameters,t))})},getWMTSTile:function(e,t){t=(0,i.defaultValue)(t,{});var r=(0,i.defaultValue)(t.queryParameters,{}),a=(0,i.defaultValue)(t.tokenKey,"token"),u=(0,i.defaultValue)(t.tokenValue,null);r[a]=u;var c=new o.WMTSServer({url:e});c._queryParameters=(0,n.default)(c._queryParameters,r);var f=c.getTile(t),h=l.default.getBaseUrlAndParams(f);return new s.default({url:h.baseUrl,headers:t.headers,queryParameters:h.params,commonQueryParameters:(0,i.deleteNullValue)((0,n.default)(c._queryParameters,t))})},getWMSImage:function(e,t){t=(0,i.defaultValue)(t,{});var r=(0,i.defaultValue)(t.queryParameters,{}),a=(0,i.defaultValue)(t.tokenKey,"token"),u=(0,i.defaultValue)(t.tokenValue,null);r[a]=u;var c=new o.WMSServer({url:e});c._queryParameters=(0,n.default)(c._queryParameters,r);var f=c.getImage(t),h=l.default.getBaseUrlAndParams(f);return new s.default({url:h.baseUrl,headers:t.headers,queryParameters:h.params,commonQueryParameters:(0,i.deleteNullValue)((0,n.default)(c._queryParameters,t))})},getArcGISTile:function(e,t){t=(0,i.defaultValue)(t,{});var r=(0,i.defaultValue)(t.queryParameters,{}),a=(0,i.defaultValue)(t.tokenKey,"token"),u=(0,i.defaultValue)(t.tokenValue,null);r[a]=u;var c=new o.ArcGISMapServer({url:e});c._queryParameters=(0,n.default)(c._queryParameters,r);var f=c.getTile(t),h=l.default.getBaseUrlAndParams(f);return new s.default({url:h.baseUrl,headers:t.headers,queryParameters:h.params,commonQueryParameters:(0,i.deleteNullValue)((0,n.default)(c._queryParameters,t))})},getArcGISImage:function(e,t){(t=(0,i.defaultValue)(t,{})).format=(0,i.defaultValue)(t.format,"png"),t.f=(0,i.defaultValue)(t.f,"image"),t.transparent=(0,i.defaultValue)(t.transparent,!0),t.bbox=(0,i.defaultValue)(t.bbox,"{bbox}");var r=(0,i.defaultValue)(t.queryParameters,{}),a=(0,i.defaultValue)(t.tokenKey,"token"),u=(0,i.defaultValue)(t.tokenValue,null);r[a]=u;var c=new o.ArcGISMapServer({url:e});c._queryParameters=(0,n.default)(c._queryParameters,r);var f=c.getImage(t),h=l.default.getBaseUrlAndParams(f);return new s.default({url:h.baseUrl,headers:t.headers,queryParameters:h.params,commonQueryParameters:(0,i.deleteNullValue)((0,n.default)(c._queryParameters,t))})},getImage:function(e,t){t=(0,i.defaultValue)(t,{});var r=(0,i.defaultValue)(t.queryParameters,{}),u=(0,i.defaultValue)(t.tokenKey,"token"),c=(0,i.defaultValue)(t.tokenValue,null);r[u]=c;var f=void 0,h=void 0;a.default.testByRegExpNames(e,["SceneServerV1","SceneServerV2"])?((h=new o.SceneServer({url:e}))._queryParameters=(0,n.default)(h._queryParameters,r),f=h.getCoverings(t)):a.default.testByRegExpNames(e,["ResourceServerV2"])?((h=new o.ResourceServer({url:e}))._queryParameters=(0,n.default)(h._queryParameters,r),f=h.getImage(t)):((h=new o.MapServer({url:e}))._queryParameters=(0,n.default)(h._queryParameters,r),f=h.getImage(t));var d=l.default.getBaseUrlAndParams(f);return new s.default({url:d.baseUrl,headers:t.headers,queryParameters:d.params,commonQueryParameters:(0,i.deleteNullValue)((0,n.default)(h._queryParameters,t))})},getTerrainTile:function(e,t){t=(0,i.defaultValue)(t,{});var r=(0,i.defaultValue)(t.queryParameters,{}),a=(0,i.defaultValue)(t.tokenKey,"token"),u=(0,i.defaultValue)(t.tokenValue,null);r[a]=u;var c=new o.SceneServer({url:e});c._queryParameters=(0,n.default)(c._queryParameters,r);var f=c.getTerrainTile(t),h=l.default.getBaseUrlAndParams(f);return new s.default({url:h.baseUrl,headers:t.headers,queryParameters:h.params,commonQueryParameters:(0,i.deleteNullValue)((0,n.default)(c._queryParameters,t))})},getWebTile:function(e,t){t=(0,i.defaultValue)(t,{});var r=(0,i.defaultValue)(t.queryParameters,{}),o=(0,i.defaultValue)(t.tokenKey,"token"),a=(0,i.defaultValue)(t.tokenValue,null);r[o]=a;var u=l.default.getBaseUrlAndParams(e),c=(0,n.default)(u.params,r);return new s.default({url:u.baseUrl,headers:t.headers,queryParameters:c,commonQueryParameters:c})},getLabel:function(e,t){t=(0,i.defaultValue)(t,{});var r=(0,i.defaultValue)(t.queryParameters,{}),a=(0,i.defaultValue)(t.tokenKey,"token"),u=(0,i.defaultValue)(t.tokenValue,null);r[a]=u;var c=new o.SceneServer({url:e});c._queryParameters=(0,n.default)(c._queryParameters,r);var f=c.getLabel(t),h=l.default.getBaseUrlAndParams(f);return new s.default({url:h.baseUrl,headers:t.headers,queryParameters:h.params,commonQueryParameters:(0,i.deleteNullValue)((0,n.default)(c._queryParameters,t))})}};t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(16)),i=y(r(10)),o=y(r(3)),a=y(r(0)),s=y(r(2)),l=y(r(4)),u=y(r(5)),c=y(r(13)),f=r(6),h=r(1),d=r(38),p=y(r(30));function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return p.default.testByRegExpNames(r.url,["MapServerV2"])?r.igsType="2.0":r.igsType="1.0",r}return(0,u.default)(t,e),(0,s.default)(t,[{key:"queryLayerList",value:function(e){return"2.0"===this.igsType?this._querySimpleInfo(e,function(e){return e+"/layers?f=json"}):"1.0"===this.igsType?this._queryByParameters(e,{mapIndex:{type:"String"}},{guid:{type:"String"}},function(e,t){return(e=e.replace("mrms","mrcs"))+"/"+t.mapIndex+"/layers?f=json"}):void 0}},{key:"addLayer",value:function(e){if("1.0"===this.igsType){var t={s:{type:"Array",required:!0,process:function(e){return"&s="+(0,i.default)(e)}}};return e.method=f.FetchMethod.post,this._queryByParameters(e,{mapIndex:{type:"String"}},t,function(e,t){return e+"/"+t.mapIndex+"/layers/add?f=json"})}var r={addInfo:{type:"Array",required:!0,process:function(e){return"&addInfo="+(0,i.default)(e)}},clientId:{type:"String"}};return e.method=f.FetchMethod.post,this._queryByParameters(e,{},r,function(e){return e+"/layers?addInfo"})}},{key:"queryLayerInfo",value:function(e){return"2.0"===this.igsType?this._queryInfoByLayerId(e,function(e,t){return e+"/layers/"+t.layerId+"?f=json"}):"1.0"===this.igsType?this._queryByParameters(e,{mapIndex:{type:"String"},layerId:{type:"String"}},{guid:{type:"String"},returnFullStyle:{type:"Boolean"}},function(e,t){return e+"/"+t.mapIndex+"/"+t.layerId+"?f=json"}):void 0}},{key:"deleteLayer",value:function(e){return e.method=f.FetchMethod.delete,this._queryByParameters(e,{layerId:{type:"String"}},{clientId:{type:"String"}},function(e,t){return e+"/layers/"+t.layerId+"?f=json"})}},{key:"queryFeatures",value:function(e){return this._queryByParameters(e,{layerId:{type:"String"}},{where:{type:"String"},geometry:{type:"Geometry"},distance:{type:"Number"},geometryPrecision:{type:"Number"},spatialRel:{type:"String"},outFields:{type:"String"},objectIds:{type:"String"},orderByFields:{type:"String"},groupByFieldsForStatistics:{type:"String"},resultRecordCount:{type:"Number"},resultOffset:{type:"Number"},outStatistics:{type:"OutStatistics"},returnGeometry:{type:"Boolean"},returnAttribute:{type:"Boolean"},returnStyle:{type:"Boolean"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},returnExtentOnly:{type:"Boolean"},returnZ:{type:"Boolean"}},function(e,t){return e+"/layers/"+t.layerId+"/query?f=json"})}},{key:"setSystemLib",value:function(e){return e.method=f.FetchMethod.put,this._queryByParameters(e,{layerId:{type:"String"}},{systemLibId:{type:"String",required:!0},systemLibName:{type:"String",required:!0}},function(e,t){return e+"/layers/"+t.layerId+"/systemLib?f=json"})}},{key:"getLegend",value:function(e){return this._queryByParameters(e,{},{layers:{type:"String"},where:{type:"String"},bbox:{type:"Extent"},page:{type:"Number"},pageSize:{type:"Number"},maxQueryFeatureCount:{type:"Number"},clientId:{type:"String"},size:{type:"String"}},function(e){return e+"/legend?f=json"})}},{key:"queryFeaturesInLayers",value:function(e){var t={layerDefs:{type:"Array",process:function(e){return"&layerDefs="+(0,i.default)(e)}},geometry:{type:"Geometry"},distance:{type:"Number"},geometryPrecision:{type:"Number"},spatialRel:{type:"String"},resultRecordCount:{type:"Number"},returnGeometry:{type:"Boolean"},returnAttribute:{type:"Boolean"},returnStyle:{type:"Boolean"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},returnZ:{type:"Boolean"}};return this._queryByParameters(e,{},t,function(e){return e+"/query?f=json"})}},{key:"getImage",value:function(e){e=(0,h.defaultValue)(e,{});var t=(0,h.defaultValue)(e.formatMode,"normal"),r=(0,h.defaultValue)(e.imageWidth,256),i=(0,h.defaultValue)(e.imageHeight,256),o=(0,h.defaultValue)(e.layerFilters,null),a=(0,h.defaultValue)(e.style,null),s=(0,h.defaultValue)(e.gdbps,null),l=(0,h.defaultValue)(e.imageFormat,"png"),u=(0,h.defaultValue)(e.layers,null),c=(0,h.defaultValue)(e.isAntialiasing,null),f=(0,h.defaultValue)(e.mode,null),p=(0,h.defaultValue)(e.clientId,(0,h.getGUID)()),y=(0,h.defaultValue)(e.imageTransparent,null),g=(0,h.defaultValue)(e.dynamicLayers,null),v=(0,h.defaultValue)(e.dpi,"96"),m=(0,h.defaultValue)(e.returnFormat,"image"),_=(0,h.defaultValue)(e.clipping,null),S=(0,h.defaultValue)(e.layerStyles,null),x=(0,h.defaultValue)(e.mapUri,null),b="{bbox}";e.bbox&&(b=e.bbox.toString());var w=void 0;e.spatialReference&&(w=e.spatialReference.toString());var k=this._baseUrl,M={bbox:b,isAntialiasing:c};this._baseUrl.indexOf("mrms/layers")>-1?(M.gdbps=s,M.f=l,M.w=r,M.h=i,M.filters=o,M.style=a,M.proj=w,M.guid=p,M.mapUri=x):"1.0"===this.igsType?("normal"===t?(M.w=r,M.h=i):(M.w="{w}",M.h="{h}"),M.layers=u,M.f=l,M.filters=o,M.mode=f,M.style=a,M.guid=p,M.proj=w):(M.size="normal"===t?r+","+i:"{size}",M.layers=u,M.transparent=y,M.format=l,M.layerFilters=o,M.dynamicLayers=g,M.dpi=v,M.f=m,M.clientId=p,M.projectionSrs=w,M.clipping=_,M.layerStyles=S,k+="/image"),M=(0,n.default)(this._queryParameters,M);var E=d.UrlUtil.getStringFromObject(M);return E&&(k=d.UrlUtil.completeUrlEndMark(k),k+=E),k}},{key:"exportImage",value:function(e){(e=(0,h.defaultValue)(e,{})).method=(0,h.defaultValue)(e.method,f.FetchMethod.post),e.method===f.FetchMethod.post&&(e.headers={"Content-Type":"application/x-www-form-urlencoded"},e.responseType="blob");var t=(0,h.defaultValue)(e.imageWidth,256),r=(0,h.defaultValue)(e.imageHeight,256),i={bbox:{type:"Extent",process:function(e){return"&bbox="+e.toString()}},isAntialiasing:{type:"Boolean"}};return"1.0"===this.igsType?(i=(0,n.default)(i,{imageWidth:{type:"String",alias:"w"},imageHeight:{type:"String",alias:"h"},imageFormat:{type:"String",alias:"f",default:"png"},layerFilters:{type:"String",alias:"filters"},mode:{type:"String"},style:{type:"String"},clientId:{type:"String",alias:"guid",default:(0,h.getGUID)()},spatialReference:{type:"SpatialReference",process:function(e){return"&proj="+e.toString()}}}),this._baseUrl.indexOf("/igs/rest/mrms/docs")>0?i.layers={type:"String"}:i.gdbps={type:"Array"}):i=(0,n.default)(i,{layers:{type:"String"},imageWidth:{type:"Number",alias:"size",process:function(){return"&size="+t+","+r}},clientId:{type:"String",default:(0,h.getGUID)()},imageFormat:{type:"String",alias:"format"},dynamicLayers:{type:"String"},layerFilters:{type:"String"},imageTransparent:{type:"Boolean",alias:"transparent"},returnFormat:{type:"String",alias:"f",default:"image"},clipping:{type:"String"},layerStyles:{type:"String"},dpi:{type:"String",default:96},spatialReference:{type:"SpatialReference",process:function(e){return"&projectionSrs="+e.toString()}}}),this._queryByParameters(e,{},i,function(e){return e+"/image"})}}]),t}(c.default);t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(10)),i=d(r(3)),o=d(r(0)),a=d(r(2)),s=d(r(4)),l=d(r(5)),u=d(r(13)),c=r(6),f=r(1),h=d(r(30));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return h.default.testByRegExpNames(r._baseUrl,["FeatureServerV1"])?r.igsType="1.0":r.igsType="2.0",r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"queryLayerInfo",value:function(e){if("1.0"===this.igsType){var t=this._baseUrl.replace("mrfs","mrcs");return this._queryInfoByLayerId(e,function(e,r){return t+"/0/"+r.layerId+"?f=json"})}return this._queryInfoByLayerId(e,function(e,t){return e+"/"+t.layerId+"?f=json"})}},{key:"queryFeatures",value:function(e){var t=this,r=void 0,i=void 0;return"1.0"===this.igsType?(r={layerId:{type:"String"}},i={where:{type:"String"},geometry:{type:"Geometry"},geometryPrecision:{type:"Number",alias:"coordPrecision"},outFields:{type:"String",alias:"fields"},objectIds:{type:"String"},orderByFields:{type:"String",alias:"orderField"},groupByFieldsForStatistics:{type:"Array",process:function(e){return"&groupByFieldsForStatistics="+encodeURIComponent((0,n.default)(e))}},resultRecordCount:{type:"Number",alias:"pageCount"},resultOffset:{type:"Number",alias:"page"},outStatistics:{type:"OutStatistics",alias:"statistics"},rule:{type:"Object",process:function(e){return"&rule="+encodeURIComponent((0,n.default)(e))}},isAsc:{type:"Boolean"},returnZ:{type:"Boolean",alias:"is3d"}}):(r={layerId:{type:"String"}},i={where:{type:"String"},geometry:{type:"Geometry"},distance:{type:"Number"},geometryPrecision:{type:"Number"},spatialRel:{type:"String"},outFields:{type:"String"},objectIds:{type:"String"},orderByFields:{type:"String"},groupByFieldsForStatistics:{type:"String"},resultRecordCount:{type:"Number"},resultOffset:{type:"Number"},outStatistics:{type:"OutStatistics"},returnGeometry:{type:"Boolean"},returnAttribute:{type:"Boolean"},returnStyle:{type:"Boolean"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},returnExtentOnly:{type:"Boolean"},returnZ:{type:"Boolean"},supportArc3:{type:"Boolean"},inSrs:{type:"String"},outSrs:{type:"String"}}),this._queryByParameters(e,r,i,function(e,r){if("1.0"===t.igsType){var i={IncludeAttribute:!0,IncludeGeometry:!0,IncludeWebGraphic:!1},o=r||{};return o&&((0,f.defined)(o.returnGeometry)&&(i.IncludeGeometry=o.returnGeometry),(0,f.defined)(o.returnAttribute)&&(i.IncludeAttribute=o.returnAttribute),(0,f.defined)(o.returnStyle)&&(i.IncludeWebGraphic=o.returnStyle)),e+"/0/"+r.layerId+"/query?f=json&structs="+encodeURIComponent((0,n.default)(i))}return e+"/"+r.layerId+"/query?f=json"})}},{key:"queryFeaturesInLayers",value:function(e){var t=void 0,r=void 0;return this._baseUrl.indexOf("/igs/rest/mrfs/layer")>-1?(t={},r={gdbp:{type:"String",required:!0},geometry:{type:"Geometry",process:"igsGeometryOld"},distance:{type:"Number",process:function(){return""},default:0},where:{type:"String"},objectIds:{type:"String"},page:{type:"Number"},pageCount:{type:"Number"},rule:{type:"Object",process:function(e){return"&rule="+encodeURIComponent((0,n.default)(e))}},structs:{type:"Object",process:function(e,t){return"&structs="+encodeURIComponent((0,n.default)(e||t))},default:{IncludeAttribute:!0,IncludeGeometry:!0,IncludeWebGraphic:!0}},orderField:{type:"String"},isAsc:{type:"Boolean"}},this._queryByParameters(e,t,r,function(e){return e+"/query?f=json"})):this._baseUrl.indexOf("/igs/rest/mrfs/docs/")>-1?(t={mapIndex:{type:"Number"},layerIndexes:{type:"String"}},r={geometry:{type:"Geometry",process:"igsGeometryOld"},distance:{type:"Number",process:function(){return""},default:0},where:{type:"String"},objectIds:{type:"String"},page:{type:"Number"},pageCount:{type:"Number"},rule:{type:"Object",process:function(e){return"&rule="+encodeURIComponent((0,n.default)(e))}},structs:{type:"Object",process:function(e,t){return"&structs="+encodeURIComponent((0,n.default)(e||t))},default:{IncludeAttribute:!0,IncludeGeometry:!0,IncludeWebGraphic:!0}},orderField:{type:"String"},isAsc:{type:"Boolean"}},this._queryByParameters(e,t,r,function(e,t){return e+"/"+t.mapIndex+"/"+t.layerIndexes+"/query?f=json"})):(t={},r={layerDefs:{type:"Array"},geometry:{type:"Geometry"},distance:{type:"Number"},geometryPrecision:{type:"Number"},spatialRel:{type:"String"},resultRecordCount:{type:"Number"},returnGeometry:{type:"Boolean"},returnAttribute:{type:"Boolean"},returnStyle:{type:"Boolean"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},returnZ:{type:"Boolean"},inSrs:{type:"String"},outSrs:{type:"String"}},this._queryByParameters(e,t,r,function(e){return e+"/query?f=json"}))}},{key:"addFeature",value:function(e){var t=void 0,r=void 0;return e.method=c.FetchMethod.post,this._baseUrl.indexOf("/igs/rest/mrfs/layer")>-1?(t={},r={gdbp:{type:"String",required:!0,process:function(){return""}},featureSet:{type:"Object",required:!0,process:function(e){return encodeURIComponent((0,n.default)(e))}}},e.headers={"Content-Type":"text/plain;charset=UTF-8"},this._queryByParameters(e,t,r,function(e,t){return e+"/addFeatures?f=json&gdbp="+t.gdbp})):this._baseUrl.indexOf("/igs/rest/mrfs/docs")>-1?(t={mapIndex:{type:"Number"},layerIndex:{type:"Number"}},r={featureSet:{type:"Object",required:!0,process:function(e){return encodeURIComponent((0,n.default)(e))}}},e.headers={"Content-Type":"text/plain;charset=UTF-8"},this._queryByParameters(e,t,r,function(e,t){return e+"/"+t.mapIndex+"/"+t.layerIndex+"/addFeatures?f=json"})):(t={layerId:{type:"String"}},r={features:{type:"Array",process:function(e){var t=e.map(function(e){return e.toIGSFeature()});return"&features="+encodeURIComponent((0,n.default)(t))}}},this._queryByParameters(e,t,r,function(t){return t+"/"+e.layerId+"/add?f=json"}))}},{key:"deleteFeature",value:function(e){var t=void 0,r=void 0;return this._baseUrl.indexOf("/igs/rest/mrfs/layer")>-1?(t={},r={gdbp:{type:"String"},objectIds:{type:"String"}},this._queryByParameters(e,t,r,function(e){return e+"/deleteFeatures?f=json"})):this._baseUrl.indexOf("/igs/rest/mrfs/docs")>-1?(t={mapIndex:{type:"Number"},layerIndex:{type:"Number"}},r={objectIds:{type:"String",required:!0}},this._queryByParameters(e,t,r,function(e,t){return e+"/"+t.mapIndex+"/"+t.layerIndex+"/deleteFeatures?f=json"})):(t={layerId:{type:"String"}},r={objectIds:{type:"String"},where:{type:"String"},geometry:{type:"Geometry"},distance:{type:"Number"},returnDeleteResults:{type:"Boolean"}},this._queryByParameters(e,t,r,function(t){return t+"/"+e.layerId+"/delete?f=json"}))}},{key:"updateFeature",value:function(e){var t=void 0,r=void 0;return e.method=c.FetchMethod.post,this._baseUrl.indexOf("/igs/rest/mrfs/layer")>-1?(t={},r={gdbp:{type:"String",required:!0,process:function(){return""}},featureSet:{type:"Object",required:!0,process:function(e){return encodeURIComponent((0,n.default)(e))}}},e.headers={"Content-Type":"text/plain;charset=UTF-8"},this._queryByParameters(e,t,r,function(e,t){return e+"/updateFeatures?f=json&gdbp="+t.gdbp})):this._baseUrl.indexOf("/igs/rest/mrfs/docs")>-1?(t={mapIndex:{type:"Number"},layerIndex:{type:"Number"}},r={featureSet:{type:"Object",required:!0,process:function(e){return encodeURIComponent((0,n.default)(e))}}},e.headers={"Content-Type":"text/plain;charset=UTF-8"},this._queryByParameters(e,t,r,function(e,t){return e+"/"+t.mapIndex+"/"+t.layerIndex+"/updateFeatures?f=json"})):(t={layerId:{type:"String"}},r={features:{type:"Array",process:function(e){var t=e.map(function(e){return e.toIGSFeature()});return"&features="+encodeURIComponent((0,n.default)(t))}}},this._queryByParameters(e,t,r,function(t){return t+"/"+e.layerId+"/update?f=json"}))}},{key:"queryFeatureById",value:function(e){return e.method=c.FetchMethod.get,this._queryByParameters(e,{layerId:{type:"String"},featureId:{type:"String"}},{},function(t){return t+"/"+e.layerId+"/"+e.featureId+"?f=json"})}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"queryRootNodeInfo",value:function(e){return this._queryByParameters(e,{},{include:{type:"String"},maxDepth:{type:"Number"},maxCount:{type:"Number"}},function(e){return e+"/nodes/root?f=json"})}},{key:"queryNodeInfo",value:function(e){return this._queryByParameters(e,{nodeId:{type:"String"}},{include:{type:"String"},maxDepth:{type:"Number"},maxCount:{type:"Number"}},function(e,t){return e+"/nodes/"+t.nodeId+"?f=json"})}},{key:"getSharedResources",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/sharedResources?f=json"})}}]),t}(l(r(13)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"queryImageInfo",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/info?f=json"})}},{key:"getColorMap",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/colorMap?f=json"})}},{key:"getHistograms",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/histograms?f=json"})}},{key:"getLegend",value:function(e){return this._queryByParameters(e,{},{size:{type:"String"},bandIds:{type:"String"}},function(e){return e+"/legend?f=json"})}},{key:"getRasterValue",value:function(e){return this._queryByParameters(e,{},{x:{type:"Number",required:!0},y:{type:"Number",required:!0}},function(e){return e+"/rasterValue/?f=json"})}},{key:"getStatistics",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/statistics?f=json"})}}]),t}(l(r(13)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(10)),i=h(r(3)),o=h(r(0)),a=h(r(2)),s=h(r(4)),l=h(r(5)),u=h(r(13)),c=r(6),f=r(1);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,a.default)(t,[{key:"calculateAreasAndLengths",value:function(e){return(e=(0,f.defaultValue)(e,{})).method=(0,f.defaultValue)(e.method,c.FetchMethod.post),this._queryByParameters(e,{},{polygons:{type:"Polygon",required:!0,process:"igsGeometryServer"}},function(e){return e+"/areasAndLengths?f=json"})}},{key:"calculateArea",value:function(e){return e.headers={"Content-Type":"text/plain;charset=UTF-8"},e.method=c.FetchMethod.post,e.useObject=!0,this._queryByParameters(e,{},{polygon:{type:"Polygon",required:!0,alias:"Dots",process:"igsDots"},projectInfo:{type:"Object",alias:"ProjectInfo",required:!0,oneOf:["projectInfoBySrsID"]},projectInfoBySrsID:{type:"Object",alias:"ProjectInfoBySrsID",required:!0,oneOf:["projectInfo"]}},function(e){return e+"/calArea?f=json"})}},{key:"calculateLength",value:function(e){return e.headers={"Content-Type":"text/plain;charset=UTF-8"},e.method=c.FetchMethod.post,e.useObject=!0,this._queryByParameters(e,{},{lineString:{type:"LineString",required:!0,alias:"Dots",process:"igsDots"},projectInfo:{type:"Object",alias:"ProjectInfo",required:!0,oneOf:["projectInfoBySrsID"]},projectInfoBySrsID:{type:"Object",alias:"ProjectInfoBySrsID",required:!0,oneOf:["projectInfo"]}},function(e){return e+"/callength?f=json"})}},{key:"projectInExtent",value:function(e){return this._queryByParameters(e,{gdbsvrName:{type:"String"},gdbName:{type:"String"},srefID:{type:"String"},desfID:{type:"String"}},{extent:{type:"Extent",alias:"rang",required:!0,process:"igsRange$"},userName:{type:"String"},password:{type:"String"}},function(e,t){return e+"/"+t.gdbsvrName+"/"+t.gdbName+"/"+t.srefID+"/"+t.desfID+"?f=json"})}},{key:"bufferAnalyse",value:function(e){return(e=(0,f.defaultValue)(e,{})).method=(0,f.defaultValue)(e.method,c.FetchMethod.post),this._queryByParameters(e,{},{geometries:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},distance:{type:"Number",required:!0}},function(e){return e+"/buffer?f=json"})}},{key:"calculateDifference",value:function(e){return(e=(0,f.defaultValue)(e,{})).method=(0,f.defaultValue)(e.method,c.FetchMethod.post),this._queryByParameters(e,{},{geometry1:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},geometry2:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},tolerance:{type:"Number",required:!0}},function(e){return e+"/difference?f=json"})}},{key:"calculateDistance",value:function(e){return(e=(0,f.defaultValue)(e,{})).method=(0,f.defaultValue)(e.method,c.FetchMethod.post),this._queryByParameters(e,{},{geometry1:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},geometry2:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},srs:{type:"String",required:!0}},function(e){return e+"/distance?f=json"})}},{key:"calculateIntersect",value:function(e){return(e=(0,f.defaultValue)(e,{})).method=(0,f.defaultValue)(e.method,c.FetchMethod.post),this._queryByParameters(e,{},{geometry1:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},geometry2:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},tolerance:{type:"Number",required:!0}},function(e){return e+"/intersect?f=json"})}},{key:"calculateLabelPoints",value:function(e){return(e=(0,f.defaultValue)(e,{})).method=(0,f.defaultValue)(e.method,c.FetchMethod.post),this._queryByParameters(e,{},{polygons:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"}},function(e){return e+"/labelPoints?f=json"})}},{key:"calculateLengths",value:function(e){return(e=(0,f.defaultValue)(e,{})).method=(0,f.defaultValue)(e.method,c.FetchMethod.post),this._queryByParameters(e,{},{polylines:{type:"LineString | MultiLineString",required:!0,process:"igsGeometryServer"}},function(e){return e+"/lengths?f=json"})}},{key:"geometryProject",value:function(e){return(e=(0,f.defaultValue)(e,{})).method=(0,f.defaultValue)(e.method,c.FetchMethod.post),this._queryByParameters(e,{},{geometries:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},inSrs:{type:"String",required:!0},outSrs:{type:"String",required:!0}},function(e){return e+"/project?f=json"})}},{key:"calculateTopologyRelation",value:function(e){(e=(0,f.defaultValue)(e,{})).method=(0,f.defaultValue)(e.method,c.FetchMethod.post);var t=void 0,r=void 0;return this.url.indexOf("/igs/rest/mrgs/geomservice")>-1?(t={},r={distance:{type:"Number",alias:"NearDis",default:.01},point:{type:"Point",alias:"Pnt",process:"toOldIGSGeometry"},lingString:{type:"LineString",alias:"Line",process:"toOldIGSGeometry"},polygon:{type:"Polygon",alias:"Reg",process:"toOldIGSGeometry"},topologyPolygon:{type:"Polygon",alias:"RelativeObj",process:"toOldIGSGeometry"}},e.headers={"Content-Type":"text/plain;charset=UTF-8"},e.method=c.FetchMethod.post,e.useObject=!0,this._queryByParameters(e,t,r,function(e){return e+"/topanalysis?f=json"})):(t={},r={geometry1:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},geometry2:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},tolerance:{type:"Number",required:!0}},this._queryByParameters(e,t,r,function(e){return e+"/relation?f=json"}))}},{key:"smoothLineString",value:function(e){if(e=(0,f.defaultValue)(e,{}),!(0,f.isNull)(e.type)&&!(0,f.isNull)(e.lineString))return e.step=(0,f.defaultValue)(e.step,1),e.headers={"Content-Type":"text/plain;charset=UTF-8"},e.method=c.FetchMethod.post,e.data=(0,n.default)(e.lineString.toDots()),this._postRequest(this.url+"/smooth?f=json&type="+e.type+"&step="+e.step,e)}},{key:"calculateUnion",value:function(e){return this._queryByParameters(e,{},{geometry1:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},geometry2:{type:"Geometry",required:!0,process:"igsGeometryServerNoSRS"},tolerance:{type:"Number",required:!0}},function(e){return e+"/union?f=json"})}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"getGeoCode",value:function(e){return this._queryByParameters(e,{},{address:{type:"String",required:!0},province:{type:"String"},city:{type:"String"},country:{type:"String"},geometry:{type:"Polygon | Extent"},where:{type:"String"},aggLevel:{type:"Number"},aggFormat:{type:"Number"},fuzzy:{type:"Boolean"},page:{type:"Number"},pageSize:{type:"Number"}},function(e){return e+"/geocode?f=json"})}},{key:"getReverseGeoCode",value:function(e){return this._queryByParameters(e,{},{location:{type:"String",required:!0},province:{type:"String"},city:{type:"String"},radius:{type:"Number"},geometry:{type:"Geometry"},where:{type:"String"},page:{type:"Number"},pageSize:{type:"Number"}},function(e){return e+"/reverseGeocode?f=json"})}}]),t}(l(r(13)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"getTileSetJSON",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/tileset.json"})}},{key:"queryTileMetadata",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"?f=json"})}}]),t}(l(r(13)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"queryPoi",value:function(e){return this._queryByParameters(e,{},{keywords:{type:"String"},typeCode:{type:"String"},type:{type:"String"},geometry:{type:"Geometry"},city:{type:"String"},cityCode:{type:"String"},adCode:{type:"String"},cityLimit:{type:"Boolean"},page:{type:"Number"},pageSize:{type:"Number"}},function(e){return e+"/search?f=json"})}}]),t}(l(r(13)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"addToken",value:function(e){return this._queryByParameters(e,{userName:{type:"String"}},{password:{type:"String",required:!0},clientType:{type:"String"},clientInfo:{type:"String"},expirationTime:{type:"Number",required:!0}},function(e,t){return e+"/tokens?"+t.userName})}}]),t}(l(r(13)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"queryRootServiceList",value:function(e){return this._queryByParameters(e,{},{name:{type:"String"},protocols:{type:"String"}},function(e){return e+"?f=json"})}},{key:"queryFolderServiceList",value:function(e){return this._queryByParameters(e,{folder:"String"},{name:{type:"String"},protocols:{type:"String"}},function(t){return t+"/"+e.folder+"?f=json"})}}]),t}(l(r(13)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(5)),l=r(1),u=h(r(13)),c=r(38),f=h(r(30));function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return f.default.testByRegExpNames(r.url,["TileServerV1"])?r.igsType="1.0":r.igsType="2.0",r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"getTile",value:function(e){e=(0,l.defaultValue)(e,{});var t="";if("1.0"===this.igsTy)t=this._baseUrl+"/{z}/{y}/{x}";else{var r={f:(0,l.defaultValue)(e.format,"image"),blankTile:(0,l.defaultValue)(e.returnBlankTile,null)},n=c.UrlUtil.getStringFromObject(r);t=this._baseUrl+"/tileImage/{z}/{y}/{x}?"+n}var i=c.UrlUtil.getStringFromObject(this._queryParameters);return i&&(t=c.UrlUtil.completeUrlEndMark(t),t+=i),t}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(5)),l=h(r(13)),u=r(1),c=h(r(67)),f=h(r(30));function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return f.default.testByRegExpNames(r.url,["VectorTileServerV1"])?r.igsType="1.0":r.igsType="2.0",r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"queryServerInfo",value:function(e){var t=this;return this._querySimpleInfo(e,function(e){return"1.0"===t.igsType?e.replace("/mrcs/vtiles/","/mrcs/tiles/")+"?f=json":e+"?f=json"})}},{key:"getFonts",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/fonts?f=json"})}},{key:"getSprite",value:function(e){var t=this;return e=(0,u.defaultValue)(e,{}),this._querySimpleInfo(e,function(r){return"1.0"===t.igsType?r+"/sprite"+(0,u.defaultValue)(e.param,".json"):r+"/sprites/sprite"+(0,u.defaultValue)(e.param,".json")})}},{key:"getStyle",value:function(e){var t=this;return this._querySimpleInfo(e,function(e){return"1.0"===t.igsType?e.replace("mrcs/vtiles","mrcs/vtiles/0")+"?f=json":e+"/style?f=json"})}},{key:"getRootJSON",value:function(e){var t=void 0,r="";if((e=(0,u.defaultValue)(e,{})).url){var n=c.default.getBaseUrlAndParams(e.url),i=n.params;(0,u.defined)(this.tokenKey)&&(0,u.defined)(this.tokenValue)&&delete i[e.tokenValue],t=n.baseUrl,(r=c.default.getStringFromObject(i))&&(r="?"+r)}return this._queryByParameters(e,{},{},function(e){return(0,u.defined)(t)?""+t+r:e+"/resources/styles/root.json"})}}]),t}(l.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(13)),u=r(6);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"queryLayerList",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/layers?f=json"})}},{key:"updateLayer",value:function(e){return e.method=u.FetchMethod.post,this._queryByParameters(e,{},{layerName:{type:"String",required:!0},content:{type:"FeatureCollection",required:!0},layerId:{type:"String"}},function(e){return e+"/layers?f=json"})}},{key:"getLayer",value:function(e){return this._queryByParameters(e,{},{layerId:{type:"String",required:!0}},function(e,t){return e+"/layers/"+t.layerId+"?f=json"})}},{key:"deleteLayer",value:function(e){return e.method=u.FetchMethod.delete,this._queryByParameters(e,{layerId:{type:"String"}},{},function(e,t){return e+"/layers/"+t.layerId+"?f=json"})}},{key:"queryAnimationScriptList",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/scripts?f=json"})}},{key:"updateAnimationScript",value:function(e){return e.method=u.FetchMethod.post,this._queryByParameters(e,{},{scriptName:{type:"String",required:!0},content:{type:"String",required:!0},scriptId:{type:"String"}},function(e){return e+"/scripts?f=json"})}},{key:"getAnimationScript",value:function(e){return this._queryByParameters(e,{scriptId:{type:"String"}},{},function(e,t){return e+"/scripts/"+t.scriptId+"?f=json"})}},{key:"deleteAnimationScript",value:function(e){return e.method=u.FetchMethod.delete,this._queryByParameters(e,{scriptId:{type:"String"}},{},function(e,t){return e+"/scripts/"+t.scriptId+"?f=json"})}},{key:"getSymbolLibList",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/symbolLibs?f=json"})}},{key:"getSymbolLib",value:function(e){return this._queryByParameters(e,{libId:{type:"String"}},{},function(e,t){return e+"/symbolLibs/"+t.libId+"?f=json"})}},{key:"getSymbol",value:function(e){return this._queryByParameters(e,{libId:{type:"String"},symbolId:{type:"String"}},{},function(e,t){return e+"/symbolLibs/"+t.libId+"/symbols/"+t.symbolId+"?f=xml"})}},{key:"deleteSymbol",value:function(e){return e.method=u.FetchMethod.delete,this._queryByParameters(e,{libId:{type:"String"},symbolId:{type:"String"}},{},function(e,t){return e+"/symbolLibs/"+t.libId+"/symbols/"+t.symbolId+"?f=json"})}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(16)),i=y(r(10)),o=y(r(3)),a=y(r(0)),s=y(r(2)),l=y(r(4)),u=y(r(5)),c=y(r(13)),f=r(1),h=y(r(100)),d=r(38),p=y(r(30));function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return p.default.testByRegExpNames(r.url,["ResourceServerV1"])?r.igsType="1.0":r.igsType="2.0",r}return(0,u.default)(t,e),(0,s.default)(t,[{key:"queryDataSourceList",value:function(e){var t=this;return this._queryByParameters(e,{},{},function(e){var r="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?e+"/"+r:e+"/"+r+"?f=json"})}},{key:"queryDataSourceInfo",value:function(e){return this._queryByParameters(e,{datasource:{type:"String"}},{},function(t){return t+"/datasources/"+e.datasource+"?f=json"})}},{key:"queryGDBList",value:function(e){var t=this;return this._queryByParameters(e,{datasource:{type:"String"}},{userName:{type:"String"}},function(r){var n="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?r+"/"+n+"/"+e.datasource:r+"/"+n+"/"+e.datasource+"/gdbs?f=json"})}},{key:"addGDB",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={datasource:{type:"String"}},n={gdbName:{type:"String"},userName:{type:"String"},path:{type:"String"}}):(r={gdbName:{type:"String"}},n={datasource:{type:"String",alias:"gdbSvrName"},userName:{type:"String",alias:"gdbUserName"},path:{type:"String"}}),this._queryByParameters(e,r,n,function(r){var n="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?r+"/gdb/creat/"+e.gdbName:r+"/"+n+"/"+e.datasource+"/gdbs"})}},{key:"attachGDB",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={datasource:{type:"String"}},n={gdbName:{type:"String",required:!0},useName:{type:"String"},path:{type:"String",required:!0}}):(r={gdbName:{type:"String"}},n={datasource:{type:"String",alias:"gdbSvrName"},userName:{type:"String",alias:"gdbUserName"},path:{type:"String"}}),this._queryByParameters(e,r,n,function(r){var n="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?r+"/gdb/attach/"+e.gdbName:r+"/"+n+"/"+e.datasource+"/gdbs/attach"})}},{key:"deleteGDB",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={datasource:{type:"String"},gdbName:{type:"String"}},n={useName:{type:"String"}}):(r={gdbName:{type:"String"}},n={datasource:{type:"String",alias:"gdbSvrName"},userName:{type:"String",alias:"gdbUserName"},path:{type:"String"}}),this._queryByParameters(e,r,n,function(r){var n="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?r+"/gdb/delete/"+e.gdbName:r+"/"+n+"/"+e.datasource+"/gdbs/"+e.gdbName})}},{key:"detachGDB",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={datasource:{type:"String"},gdbName:{type:"String"}},n={useName:{type:"String"}}):(r={gdbName:{type:"String"}},n={datasource:{type:"String",alias:"gdbSvrName"},userName:{type:"String",alias:"gdbUserName"},path:{type:"String"}}),this._queryByParameters(e,r,n,function(r){var n="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?r+"/gdb/delete/"+e.gdbName:r+"/"+n+"/"+e.datasource+"/gdbs/"+e.gdbName+"/detach"})}},{key:"queryFeatureDataSourceList",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={datasource:{type:"String"},gdbName:{type:"String"}},n={useName:{type:"String"}}):r={datasource:{type:"String"},gdbName:{type:"String"}},this._queryByParameters(e,r,n,function(r){var n="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?r+"/"+n+"/"+e.datasource+"/"+e.gdbName+"/fds":r+"/"+n+"/"+e.datasource+"/gdbs/"+e.gdbName+"/fds?f=json"})}},{key:"queryTileDataSourceList",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={datasource:{type:"String"},gdbName:{type:"String"}},n={useName:{type:"String"}}):r={datasource:{type:"String"},gdbName:{type:"String"}},this._queryByParameters(e,r,n,function(r){var n="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?r+"/"+n+"/"+e.datasource+"/"+e.gdbName+"/rds":r+"/"+n+"/"+e.datasource+"/gdbs/"+e.gdbName+"/rds?f=json"})}},{key:"querySimpleFeatureList",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={datasource:{type:"String"},gdbName:{type:"String"}},n={useName:{type:"String"},fdsName:{type:"String"},includeAll:{type:"Boolean"}}):r={datasource:{type:"String"},gdbName:{type:"String"}},this._queryByParameters(e,r,n,function(r){var n="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?r+"/"+n+"/"+e.datasource+"/"+e.gdbName+"/sfcls":r+"/"+n+"/"+e.datasource+"/gdbs/"+e.gdbName+"/sfcls?f=json"})}},{key:"addClass",value:function(e){var t,r;t={datasource:{type:"String"},gdbName:{type:"String"},featureType:{type:"String"}},r={userName:{type:"String"},layerName:{type:"String",required:!0},geomType:{type:"String",required:!0},srs:{type:"String"},fdsName:{type:"String"},fields:{type:"Array",process:function(e){return"&fields="+(0,i.default)(e)},required:!0}};var n=e||{};return n.featureType=(0,f.defaultValue)(n.featureType,"sfcls"),this._queryByParameters(n,t,r,function(t){return t+"/datasources/"+e.datasource+"/gdbs/"+e.gdbName+"/"+e.featureType})}},{key:"getSimpleFeature",value:function(e){return this._queryByParameters(e,{datasource:{type:"String"},gdbName:{type:"String"},featureSetName:{type:"String"}},{userName:{type:"String"}},function(t){return t+"/datasources/"+e.datasource+"/gdbs/"+e.gdbName+"/sfcls/"+e.featureSetName+"?f=json"})}},{key:"updateSimpleFeature",value:function(e){var t={userName:{type:"String"},updateInfo:{type:"Object",required:!0,process:function(e){return"&updateInfo="+(0,i.default)(e)}}};return this._queryByParameters(e,{datasource:{type:"String"},gdbName:{type:"String"},featureSetName:{type:"String"}},t,function(t){return t+"/datasources/"+e.datasource+"/gdbs/"+e.gdbName+"/sfcls/"+e.featureSetName})}},{key:"deleteSimpleFeature",value:function(e){return this._queryByParameters(e,{datasource:{type:"String"},gdbName:{type:"String"},featureSetName:{type:"String"}},{userName:{type:"String"}},function(t){return t+"/datasources/"+e.datasource+"/gdbs/"+e.gdbName+"/sfcls/"+e.featureSetName})}},{key:"querySrsList",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={datasource:{type:"String"},gdbName:{type:"String"}},n={useName:{type:"String"}}):(r={datasource:{type:"String"},gdbName:{type:"String"}},n={useName:{type:"String",alias:"user"}}),this._queryByParameters(e,r,n,function(r){var n="1.0"===t.igsType?"datasource":"datasources";return"1.0"===t.igsType?r+"/"+n+"/"+e.datasource+"/"+e.gdbName+"?f=json":r+"/datasources/"+e.datasource+"/gdbs/"+e.gdbName+"/spatialRefs?f=json"})}},{key:"querySrsInfo",value:function(e){var t,r,n=this;return this.igsType,t={datasource:{type:"String"},gdbName:{type:"String"},srsName:{type:"String"}},r={useName:{type:"String"}},this._queryByParameters(e,t,r,function(t){var r="1.0"===n.igsType?"datasource":"datasources";return"1.0"===n.igsType?t+"/"+r+"/"+e.datasource+"/"+e.gdbName+"/"+e.srsName+"?f=json":t+"/datasources/"+e.datasource+"/gdbs/"+e.gdbName+"/spatialRefs/"+e.srsName+"?f=json"})}},{key:"querySystemLibList",value:function(e){var t=this;return this._queryByParameters(e,{},{},function(e){return"1.0"===t.igsType?e+"/systemlibraries?f=json":e+"/systemLibs?f=json"})}},{key:"querySystemColorList",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={sysLib:{type:"String"}},n={page:{type:"Number"},pageSize:{type:"Number"}}):(r={},n={page:{type:"Number"},pageSize:{type:"Number",alias:"size"},sysLib:{type:"String",alias:"systemLib"}}),this._queryByParameters(e,r,n,function(r){return"1.0"===t.igsType?r+"/colors?f=json":r+"/systemLibs/"+e.sysLib+"/colors?f=json"})}},{key:"getColorIndex",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={sysLib:{type:"String"}},n={color:{type:"Color",required:!0,process:function(e){return"&red="+e.red+"&green="+e.green+"&blue="+e.blue}},addIfNotExist:{type:"Boolean"}}):(r={},n={sysLib:{type:"String",alias:"libID"},color:{type:"Color",required:!0,process:function(e){return"&r="+e.red+"&g="+e.green+"&b="+e.blue}},addIfNotExist:{type:"Boolean",alias:"addNewColor"}}),this._queryByParameters(e,r,n,function(r){return"1.0"===t.igsType?r+"/ColorLib/getColorNO?f=json":r+"/systemLibs/"+e.sysLib+"/colors/findColorNo?f=json"})}},{key:"getColorByIndex",value:function(e){var t=this,r={},n={};return"2.0"===this.igsType?(r={sysLib:{type:"String"},colorIndex:{type:"String"}},n={}):(r={},n={sysLib:{type:"String",alias:"libID"},colorIndex:{type:"String",alias:"colorNO"}}),this._queryByParameters(e,r,n,function(r){return"1.0"===t.igsType?r+"/ColorLib/getColorRGB?f=json":r+"/systemLibs/"+e.sysLib+"/colors/"+e.colorIndex+"?f=json"})}},{key:"queryTempDataServerInfo",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/tempData?f=json"})}},{key:"queryTempDataFeatures",value:function(e){var t={url:{type:"String"},mapResource:{type:"Object",process:function(e){return"&mapResource="+(0,i.default)(e)}},where:{type:"String"},geometry:{type:"Geometry"},distance:{type:"Number"},geometryPrecision:{type:"Number"},spatialRel:{type:"String"},outFields:{type:"String"},objectIds:{type:"String"},orderByFields:{type:"String"},groupByFieldsForStatistics:{type:"String"},resultRecordCount:{type:"Number"},resultOffset:{type:"Number"},outStatistics:{type:"OutStatistics"},returnGeometry:{type:"Boolean"},returnAttribute:{type:"Boolean"},returnStyle:{type:"Boolean"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},returnExtentOnly:{type:"Boolean"},returnZ:{type:"Boolean"},is6xAcls:{type:"Boolean"}};return this._queryByParameters(e,{},t,function(e){return e+"/tempData/features/query?f=json"})}},{key:"queryTempDataInfo",value:function(e){return this._queryByParameters(e,{},{url:{type:"String",required:!0}},function(e){return e+"/tempData/info?f=json"})}},{key:"editTempDataInfo",value:function(e){return this._queryByParameters(e,{},{urls:{type:"String",required:!0},systemLibId:{type:"String"},systemLibName:{type:"String"}},function(e){return e+"/tempData/systemLib?f=json"})}},{key:"createGdbLayer",value:function(e){var t={attStruct:{type:function(e){return e instanceof h.default},process:function(e){return(0,i.default)(e)},required:!0}};return this._queryByParameters(e,{gdbSvrName:{type:"String"},gdbName:{type:"String"},featureType:{type:"String"},layerName:{type:"String"}},t,function(t){var r=(0,f.defaultValue)(e,{}),n=(0,f.defaultValue)(r.srefName,""),i=(0,f.defaultValue)(r.dsName,"");return t+"/datasource/"+e.gdbSvrName+"/"+e.gdbName+"/"+e.featureType+"/"+e.layerName+"/create?f=json&geoType="+e.geoType+"&srefName="+n+"&dsName="+i})}},{key:"queryGdbpAllData",value:function(e){return this._queryByParameters(e,{gdbSvrName:{type:"String"},gdbName:{type:"String"},clsType:{type:"String"}},{useName:{type:"String",alias:"user"},password:{type:"String",alias:"pwd"}},function(t){return t+"/datasource/"+e.gdbSvrName+"/"+e.gdbName+"/"+e.clsType+"?f=json"})}},{key:"queryDsAllData",value:function(e){return this._queryByParameters(e,{gdbSvrName:{type:"String"},gdbName:{type:"String"},clsType:{type:"String"},dsName:{type:"String"}},{useName:{type:"String",alias:"user"},password:{type:"String",alias:"pwd"}},function(t){return t+"/datasource/"+e.gdbSvrName+"/"+e.gdbName+"/"+e.dsName+"/"+e.clsType+"?f=json"})}},{key:"createLayerInGdbp",value:function(e){var t={attStruct:{type:function(e){return e instanceof h.default},process:function(e){return(0,i.default)(e)},required:!0}};return this._queryByParameters(e,{gdbSvrName:{type:"String"},gdbName:{type:"String"},featureType:{type:"String"},layerName:{type:"String"}},t,function(t){var r=(0,f.defaultValue)(e.srefName,"");r||f.Log.error("geoType传入参数为空");var n=(0,f.defaultValue)(e.srefName,""),i=(0,f.defaultValue)(e.dsName,"");return t+"/datasource/"+e.gdbSvrName+"/"+e.gdbName+"/"+e.featureType+"/"+e.layerName+"/create?f=json&geoType="+r+"&srefName="+n+"&dsName="+i})}},{key:"deleteLayerInGdbp",value:function(e){return this._queryByParameters(e,{gdbSvrName:{type:"String"},gdbName:{type:"String"},featureType:{type:"String"},layerName:{type:"String"}},{},function(t){return t+"/datasource/"+e.gdbSvrName+"/"+e.gdbName+"/"+e.featureType+"/"+e.layerName+"/delete?f=json"})}},{key:"updateLayerInGdbp",value:function(e){var t={updateObject:{type:"Object",process:function(e){return(0,i.default)(e)}}};return this._queryByParameters(e,{gdbSvrName:{type:"String"},gdbName:{type:"String"},featureType:{type:"String"},layerName:{type:"String"}},t,function(t){return t+"/datasource/"+e.gdbSvrName+"/"+e.gdbName+"/"+e.featureType+"/"+e.layerName+"?f=json&userName="+(0,f.defaultValue)(e.userName,"")})}},{key:"editMapLayerSystemLib",value:function(e){return this._queryByParameters(e,{docName:{type:"String"},mapIndex:{type:"String"}},{systemLib:{type:"String"},layerIndexs:{type:"String"},guid:{type:"String"}},function(t){return t+"/doc/"+e.docName+"/"+e.mapIndex+"/setSystemLibrary?f=json"})}},{key:"queryMapDocList",value:function(e){return this._queryByParameters(e,{},{version:{type:"String",alias:"v"}},function(e){return e+"/docs?f=json"})}},{key:"addMapLayer",value:function(e){var t={updateObject:{type:"Object",process:function(e){return(0,i.default)(e)}}};return this._queryByParameters(e,{docName:{type:"String"},mapIndex:{type:"String"}},t,function(t){return t+"/docs/"+e.docName+"/"+e.mapIndex+"/layers/add?f=json"})}},{key:"removeMapLayer",value:function(e){return this._queryByParameters(e,{docName:{type:"String"},mapIndex:{type:"String"}},{layerIndexs:{type:"String",alias:"layerIDs"},guid:{type:"String"}},function(t){return t+"/docs/"+e.docName+"/"+e.mapIndex+"/layers/delete?f=json"})}},{key:"editMapLayerIndex",value:function(e){var t={updateObject:{type:"Object",process:function(e){return(0,i.default)(e)}}};return this._queryByParameters(e,{docName:{type:"String"},mapIndex:{type:"String"}},t,function(t){return t+"/docs/"+e.docName+"/"+e.mapIndex+"/layers/index?f=json&guid="+e.guid})}},{key:"queryMapInfo",value:function(e){var t={tree:{type:"Boolean"},include:{type:"Object",process:function(e){return(0,i.default)(e)}},returnFullStyle:{type:"String"},guid:{type:"String"}};return this._queryByParameters(e,{docName:{type:"String"}},t,function(t){return t+"/docs/"+e.docName+"?f=json"})}},{key:"queryMapInfoByIndex",value:function(e){var t={include:{type:"Object",process:function(e){return(0,i.default)(e)}},returnFullStyle:{type:"String"},guid:{type:"String"}};return this._queryByParameters(e,{docName:{type:"String"},mapIndex:{type:"String"}},t,function(t){return t+"/docs/"+e.docName+"/"+e.mapIndex+"?f=json"})}},{key:"queryMapLayerInfo",value:function(e){return this._queryByParameters(e,{docName:{type:"String"},mapIndex:{type:"String"}},{guid:{type:"String"}},function(t){return t+"/docs/"+e.docName+"/"+e.mapIndex+"/layers?f=json"})}},{key:"queryMapLayerInfoByIndex",value:function(e){return this._queryByParameters(e,{docName:{type:"String"},mapIndex:{type:"String"},layerIndex:{type:"String"}},{returnFullStyle:{type:"String"},guid:{type:"String"}},function(t){return t+"/docs/"+e.docName+"/"+e.mapIndex+"/"+e.layerIndex+"?f=json"})}},{key:"queryDataSourceFeatureClassList",value:function(e){return this._queryByParameters(e,{gdbServerName:{type:"String"},gdbName:{type:"String"},dsName:{type:"String"}},{useName:{type:"String",alias:"user"},password:{type:"String",alias:"pwd"}},function(t){return t+"/featurelist/"+e.gdbServerName+"/"+e.gdbName+"/"+e.dsName+"?f=json"})}},{key:"operaGdbp",value:function(e){return this._queryByParameters(e,{operType:{type:"String"},gdbName:{type:"String"}},{gdbServerName:{type:"String",alias:"gdbSvrName"},gdbUserName:{type:"String",alias:"gdbUserName"},password:{type:"String",alias:"gdbPwd"},path:{type:"String"}},function(t){return t+"/gdb/"+e.operType+"/"+e.gdbName+"?f=json"})}},{key:"editLayerSystemLib",value:function(e){return this._queryByParameters(e,{},{systemLib:{type:"String"},gdbps:{type:"String"}},function(e){return e+"/layer/setSystemLibrary?f=json"})}},{key:"queryGDBPInfo",value:function(e){return this._queryByParameters(e,{},{gdbpUrl:{type:"String"},proj:{type:"String"}},function(e){return e+"/layerinfo?f=json"})}},{key:"queryLegendInfo",value:function(e){return this._queryByParameters(e,{docName:{type:"String"}},{layerIndex:{type:"String"},size:{type:"String"},guid:{type:"String"},maxCount:{type:"String"},page:{type:"String"},pageSize:{type:"String"},where:{type:"String"},range:{type:"String"}},function(t){return t+"/legend/"+e.docName+"?f=json"})}},{key:"querySymbol",value:function(e){return this._queryByParameters(e,{},{systemLib:{type:"String"},type:{type:"String"},systemNo:{type:"String"},systemSubNo:{type:"String"}},function(e){return e+"/symbol?f=json"})}},{key:"querySymbolList",value:function(e){return this._queryByParameters(e,{},{systemLib:{type:"String"},type:{type:"String"},page:{type:"String"},size:{type:"String"}},function(e){return e+"/symbols?f=json"})}},{key:"queryTileList",value:function(e){return this._queryByParameters(e,{},{version:{type:"String",alias:"v"}},function(e){return e+"/tiles?f=json"})}},{key:"queryTileInfo",value:function(e){return this._queryByParameters(e,{name:{type:"String"}},{version:{type:"String",alias:"v"}},function(t){return t+"/tiles/"+e.name+"?f=json"})}},{key:"queryVectorTileFontList",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/vtiles/fonts"})}},{key:"queryVectorTileFont",value:function(e){return this._queryByParameters(e,{fontstack:{type:"String"},range:{type:"String"}},{},function(t){return t+"/vtiles/fonts/"+e.fontstack+"/"+e.range+"?f=json"})}},{key:"queryVectorTileStyleList",value:function(e){return this._queryByParameters(e,{},{},function(e){return e+"/vtiles/styles?f=json"})}},{key:"queryVectorTileStyle",value:function(e){return this._queryByParameters(e,{fileName:{type:"String"}},{},function(t){return t+"/vtiles/styles/"+e.fileName+".json"})}},{key:"queryVectorTileServiceFont",value:function(e){return this._queryByParameters(e,{serviceName:{type:"String"}},{},function(t){return t+"/vtiles/"+e.serviceName+"/fonts"})}},{key:"queryVectorTileServiceSprite",value:function(e){return this._queryByParameters(e,{format:{type:"String"},serviceName:{type:"String"}},{},function(t){return t+"/vtiles/"+e.serviceName+"/sprite"+e.format})}},{key:"updateVectorTileServiceStyle",value:function(e){var t={updateObject:{type:"Object",process:function(e){return(0,i.default)(e)}}};return this._queryByParameters(e,{serviceName:{type:"String"}},t,function(t){return t+"/vtiles/"+e.serviceName+"/styles"})}},{key:"queryVectorTileServiceStyle",value:function(e){return this._queryByParameters(e,{serviceName:{type:"String"},tpl:{type:"String"}},{},function(t){return t+"/vtiles/"+e.tpl+"/"+e.serviceName})}},{key:"getImage",value:function(e){e=(0,f.defaultValue)(e,{});var t=this._baseUrl+"/tempData/image",r=(0,f.defaultValue)(e.imageWidth,256),i=(0,f.defaultValue)(e.imageHeight,256),o={bbox:(0,f.defaultValue)(e.bbox,"{bbox}"),isAntialiasing:(0,f.defaultValue)(e.isAntialiasing,null),size:r+","+i,transparent:(0,f.defaultValue)(e.transparent,!0),format:(0,f.defaultValue)(e.imageFormat,"png"),layerFilters:(0,f.defaultValue)(e.layerFilters,null),dpi:(0,f.defaultValue)(e.dpi,"96"),f:(0,f.defaultValue)(e.returnFormat,"image"),clientId:(0,f.defaultValue)(e.clientId,(0,f.getGUID)()),layerStyles:(0,f.defaultValue)(e.layerStyles,null)};e.spatialReference&&(o.projectionSrs=e.spatialReference.toString()),e.mapResource?o.mapResource=(0,f.defaultValue)(e.mapResource,null):o.urls=(0,f.defaultValue)(e.urls,null),o=(0,n.default)(this._queryParameters,o);var a=d.UrlUtil.getStringFromObject(o);return a&&(t=d.UrlUtil.completeUrlEndMark(t),t+=a),t}}]),t}(c.default);t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(10)),i=p(r(16)),o=p(r(3)),a=p(r(0)),s=p(r(2)),l=p(r(4)),u=p(r(5)),c=p(r(13)),f=r(1),h=r(38),d=p(r(30));function p(e){return e&&e.__esModule?e:{default:e}}r(9);var y=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return d.default.testByRegExpNames(r.url,["SceneServerV2"])?r.igsType="2.0":r.igsType="1.0",r}return(0,u.default)(t,e),(0,s.default)(t,[{key:"queryLayerListInfo",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/layers?f=json"})}},{key:"queryLayerInfo",value:function(e){return this._queryInfoByLayerId(e,function(e,t){return e+"/layers/"+t.layerId+"?f=json"})}},{key:"getCoverings",value:function(e){e=(0,f.defaultValue)(e,{});var t=(0,f.defaultValue)(e.layerIndex,0),r=void 0,n={};if("1.0"===this.igsType)r=this._baseUrl+"/GetCovering",n.sceneIndex=(0,f.defaultValue)(e.sceneIndex,0),n.layerIndex=(0,f.defaultValue)(e.layerRenderIndex,0),n.col=(0,f.defaultValue)(e.x,"{x}"),n.row=(0,f.defaultValue)(e.y,"{y}"),n.level=(0,f.defaultValue)(e.z,"{z}");else{var o=(0,f.defaultValue)(e.imageWidth,256),a=(0,f.defaultValue)(e.imageHeight,256);r=this._baseUrl+"/layers/"+t+"/coverings",n={bbox:(0,f.defaultValue)(e.bbox,"{bbox}"),size:o+","+a,transparent:(0,f.defaultValue)(e.imageTransparent,null),format:(0,f.defaultValue)(e.imageFormat,"png"),f:(0,f.defaultValue)(e.returnFormat,"image"),isAntialiasing:(0,f.defaultValue)(e.isAntialiasing,null)}}n=(0,i.default)(this._queryParameters,n);var s=h.UrlUtil.getStringFromObject(n);return s&&(r=h.UrlUtil.completeUrlEndMark(r),r+=s),r}},{key:"queryM3DInfo",value:function(e){return this._queryInfoByLayerId(e,function(e,t){return e+"/layers/"+t.layerId+"/m3d?f=json"})}},{key:"queryRootNodeInfo",value:function(e){return this._queryByParameters(e,{layerId:{type:"String"}},{include:{type:"String"},maxDepth:{type:"Number"},maxCount:{type:"Number"}},function(e,t){return e+"/layers/"+t.layerId+"/m3d/nodes/root?f=json"})}},{key:"queryNodeInfo",value:function(e){return this._queryByParameters(e,{layerId:{type:"String"},nodeId:{type:"String"}},{include:{type:"String"},maxDepth:{type:"Number"},maxCount:{type:"Number"}},function(e,t){return e+"/layers/"+t.layerId+"/m3d/nodes/"+t.nodeId+"?f=json"})}},{key:"getSharedResources",value:function(e){return this._queryInfoByLayerId(e,function(e,t){return e+"/layers/"+t.layerId+"/m3d/sharedResources"})}},{key:"queryFeatures",value:function(e){return this._queryByParameters(e,{layerId:{type:"String"}},{geometry:{type:"Geometry"},where:{type:"String"},outFields:{type:"String"},objectIds:{type:"String"},distance:{type:"Number"},geometryPrecision:{type:"Number"},spatialRel:{type:"String"},orderByFields:{type:"String"},groupByFieldsForStatistics:{type:"String"},resultRecordCount:{type:"Number"},resultOffset:{type:"Number"},outStatistics:{type:"OutStatistics"},returnGeometry:{type:"Boolean"},returnAttribute:{type:"Boolean"},returnStyle:{type:"Boolean"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},returnExtentOnly:{type:"Boolean"},returnZ:{type:"Boolean"}},function(e,t){return e+"/layers/"+t.layerId+"/query?f=json"})}},{key:"queryFeaturesInLayers",value:function(e){if(this.url.indexOf("/igs/rest/g3d/")>-1){var t={docName:{type:"String"},layerIndex:{type:"String"},gdbp:{type:"String"},where:{type:"String"},geometry:{type:"Geometry",process:"igsGeometryOld"},distance:{type:"Number",default:0},structs:{type:"Object",process:function(e,t){return"&structs="+(0,n.default)(e||t)},default:{IncludeAttribute:!0,IncludeGeometry:!0,IncludeWebGraphic:!0}},page:{type:"Number"},pageCount:{type:"Number"},objectIds:{type:"String"},orderField:{type:"String"},isAsc:{type:"Boolean"},rtnLabel:{type:"Boolean"}};return this._queryByParameters(e,{ip:{type:"String"},port:{type:"String"}},t,function(e,t){return"http://"+t.ip+":"+t.port+"/igs/rest/g3d/getFeature?f=json"})}var r={layerDefs:{type:"Array",process:function(e){return"&layerDefs="+(0,n.default)(e)}},geometry:{type:"Geometry"},distance:{type:"Number"},geometryPrecision:{type:"Number"},spatialRel:{type:"String"},resultRecordCount:{type:"Number"},returnGeometry:{type:"Boolean"},returnAttribute:{type:"Boolean"},returnStyle:{type:"Boolean"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},returnZ:{type:"Boolean"}};return this._queryByParameters(e,{},r,function(e){return e+"/query?f=json"})}},{key:"queryDocInfo",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/GetDocInfo?f=json&format=json"})}},{key:"queryDocListInfo",value:function(e){return this._queryByParameters(e,{ip:{type:"String"},port:{type:"String"}},{},function(e,t){return"http://"+t.ip+":"+t.port+"/igs/rest/g3d/GetDocList?f=json"})}},{key:"getTerrainTile",value:function(e){e=(0,f.defaultValue)(e,{});var t=(0,f.defaultValue)(e.layerIndex,0),r=(0,f.defaultValue)(e.sceneIndex,0),n={level:(0,f.defaultValue)(e.level,"{z}"),row:(0,f.defaultValue)(e.row,"{x}"),col:(0,f.defaultValue)(e.col,"{y}"),hasNormals:(0,f.defaultValue)(e.requestVertexNormals,!1),xDensity:(0,f.defaultValue)(e.xDensity,65),yDensity:(0,f.defaultValue)(e.yDensity,65)},o=this._baseUrl;"1.0"===this.igsType?(n.layerIndex=t,n.sceneIndex=r,n.webGL=(0,f.defaultValue)(e.webGL,null),o+="/GetTerrain"):o+="/layers/"+t+"/terrains",n=(0,i.default)(this._queryParameters,n),o+="?"+h.UrlUtil.getStringFromObject(n);var a=h.UrlUtil.getStringFromObject(this._queryParameters);return a&&(o=h.UrlUtil.completeUrlEndMark(o),o+=a),o}},{key:"getLabel",value:function(e){e=(0,f.defaultValue)(e,{});var t=(0,f.defaultValue)(e.spatialReference,null),r={level:(0,f.defaultValue)(e.z,0),row:(0,f.defaultValue)(e.y,0),col:(0,f.defaultValue)(e.x,0),format:(0,f.defaultValue)(e.format,"json"),srsName:t?t.toString():"EPSG:4326"},n=this._baseUrl;"1.0"===this.igsType?(r.layerIndex=(0,f.defaultValue)(e.layerRenderIndex,0),r.sceneIndex=(0,f.defaultValue)(e.sceneIndex,0),n+="/GetLabels"):n+="/layers/"+(0,f.defaultValue)(e.layerIndex,0)+"/labels",r=(0,i.default)(this._queryParameters,r),n+="?"+h.UrlUtil.getStringFromObject(r);var o=h.UrlUtil.getStringFromObject(this._queryParameters);return o&&(n=h.UrlUtil.completeUrlEndMark(n),n+=o),n}}]),t}(c.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WPSServer=t.WMTSServer=t.WMSServer=t.WFSServer=t.WCSServer=void 0;var n=l(r(445)),i=l(r(446)),o=l(r(447)),a=l(r(448)),s=l(r(449));function l(e){return e&&e.__esModule?e:{default:e}}t.WCSServer=n.default,t.WFSServer=i.default,t.WMSServer=o.default,t.WMTSServer=a.default,t.WPSServer=s.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(3)),i=s(r(0)),o=s(r(4)),a=s(r(5));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,a.default)(t,e),t}(s(r(13)).default);t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(13)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.version=(0,u.defaultValue)(e.version,"2.0.0"),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"getCapabitities",value:function(e){var t=this;return this._querySimpleInfo(e,function(e){return e+"?request=GetCapabilities&service=WFS&version="+t.version})}},{key:"queryFeatures",value:function(e){var t=this;return this._queryByParameters(e,{},{maxfeatures:{type:"Number",default:1e3},typename:{type:"String",required:!0}},function(e){return e+"?request=GetFeature&service=WFS&version="+t.version})}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(16)),i=d(r(3)),o=d(r(0)),a=d(r(2)),s=d(r(4)),l=d(r(5)),u=d(r(13)),c=r(1),f=r(38),h=d(r(30));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r.version=(0,c.defaultValue)(e.version,"1.1.1"),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"getCapabitities",value:function(e){var t=this;return this._querySimpleInfo(e,function(e){return h.default.testByRegExpNames(e,["WMSV1"]),e+"?version="+t.version+"&service=WMS&request=GetCapabilities"})}},{key:"getImage",value:function(e){e=(0,c.defaultValue)(e,{});var t={service:(0,c.defaultValue)(e.service,"WMS"),request:(0,c.defaultValue)(e.service,"GetMap"),version:(0,c.defaultValue)(e.version,"1.1.1"),layers:(0,c.defaultValue)(e.layers,null),styles:(0,c.defaultValue)(e.styles,null),bbox:(0,c.defaultValue)(e.bbox,"{bbox}"),width:(0,c.defaultValue)(e.width,256),height:(0,c.defaultValue)(e.tilematrixset,256),format:(0,c.defaultValue)(e.format,"image/png"),transparent:(0,c.defaultValue)(e.transparent,!0)};e.spatialReference&&("1.1.1"===t.version?t.srs=e.spatialReference.toString():t.crs=e.spatialReference.toString());var r=this._baseUrl;if(r.indexOf("igs/rest/services")>-1){var i=(r=r.replace("services","ogc/doc")).split("igs/rest/ogc/doc/"),o=i[0],a=i[1].split("/WMSServer")[0];r=o+"igs/rest/ogc/doc/"+(a=a.replace("/",":"))+"/WMSServer"}t=(0,n.default)(this._queryParameters,t),r+="?"+f.UrlUtil.getStringFromObject(t);var s=f.UrlUtil.getStringFromObject(this._queryParameters);return s&&(r=f.UrlUtil.completeUrlEndMark(r),r+=s),r}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(16)),i=d(r(3)),o=d(r(0)),a=d(r(2)),s=d(r(4)),l=d(r(5)),u=r(1),c=d(r(13)),f=r(38),h=d(r(30));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,a.default)(t,[{key:"getCapabitities",value:function(e){return this._querySimpleInfo(e,function(e){return h.default.testByRegExpNames(e,["WMTSServerV1"])?e+"/1.0.0/WMTSCapabilities.xml":e+"?request=GetCapabilities&service=WMTS&acceptversions=1.0.0"})}},{key:"getTile",value:function(e){e=(0,u.defaultValue)(e,{});var t={service:(0,u.defaultValue)(e.service,"WMTS"),request:(0,u.defaultValue)(e.service,"GetTile"),version:(0,u.defaultValue)(e.version,"1.0.0"),layer:(0,u.defaultValue)(e.layer,null),style:(0,u.defaultValue)(e.style,null),format:(0,u.defaultValue)(e.format,"image/png"),tilematrixset:(0,u.defaultValue)(e.tilematrixset,null),tilematrix:(0,u.defaultValue)(e.tilematrix,"{tilematrix}"),tilerow:(0,u.defaultValue)(e.tilerow,"{tilerow}"),tilecol:(0,u.defaultValue)(e.tilecol,"{tilecol}")};t=(0,n.default)(this._queryParameters,t);var r=this._baseUrl+"?"+f.UrlUtil.getStringFromObject(t),i=f.UrlUtil.getStringFromObject(this._queryParameters);return i&&(r=f.UrlUtil.completeUrlEndMark(r),r+=i),r}}]),t}(c.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(3)),i=s(r(0)),o=s(r(4)),a=s(r(5));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,a.default)(t,e),t}(s(r(13)).default);t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArcGISVectorTileServer=t.ArcGISFeatureServer=t.ArcGISGeometryServer=t.ArcGISMapServer=void 0;var n=s(r(451)),i=s(r(452)),o=s(r(453)),a=s(r(200));function s(e){return e&&e.__esModule?e:{default:e}}t.ArcGISMapServer=n.default,t.ArcGISGeometryServer=i.default,t.ArcGISFeatureServer=o.default,t.ArcGISVectorTileServer=a.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(16)),i=d(r(3)),o=d(r(0)),a=d(r(2)),s=d(r(4)),l=d(r(5)),u=d(r(13)),c=r(1),f=r(6),h=r(38);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,a.default)(t,[{key:"find",value:function(e){return this._queryByParameters(e,{},{searchText:{type:"String",required:!0},contains:{type:"Boolean"},searchFields:{type:"String"},sr:{type:"String"},layers:{type:"String",required:!0},returnGeometry:{type:"Boolean"},geometryPrecision:{type:"Number"},callback:{type:"String"}},function(e){return e+"/find?f=json"})}},{key:"identify",value:function(e){return this._queryByParameters(e,{},{geometry:{type:"String"},geometryType:{type:"String"},sr:{type:"String"},layers:{type:"String"},layerDefs:{type:"Array"},tolerance:{type:"String"},mapExtent:{type:"String"},imageDisplay:{type:"String"},returnGeometry:{type:"String"},geometryPrecision:{type:"String"},spatialFilter:{type:"String"}},function(e){return e+"/identify?f=json"})}},{key:"getLayers",value:function(e){return this._queryByParameters(e,{},{callback:{type:"String"}},function(e){return e+"/layers?f=json"})}},{key:"getLegend",value:function(e){return this._queryByParameters(e,{},{dpi:{type:"Number"},size:{dpi:"String"},callback:{dpi:"String"}},function(e){return e+"/legend?f=json"})}},{key:"queryLayerInfo",value:function(e){return this._queryInfoByLayerId(e,function(e,t){return e+"/"+t.layerId+"?f=json"})}},{key:"queryFeatureInLayers",value:function(e){return this._queryByParameters(e,{layerId:{type:"String"}},{geometry:{type:"String"},geometryType:{type:"String"},geometryPrecision:{type:"Number"},inSR:{type:"String"},outSR:{type:"String"},spatialRel:{type:"String"},where:{type:"String"},objectIds:{type:"String"},distance:{type:"String"},units:{type:"String"},outFields:{type:"String"},returnGeometry:{type:"Boolean"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},orderByFields:{type:"String"},outStatistics:{type:"OutStatistics"},groupByFieldsForStatistics:{type:"String"},resultOffset:{type:"Number"},resultRecordCount:{type:"String"},returnZ:{type:"Boolean"}},function(e,t){return e+"/"+t.layerId+"/query?f=json"})}},{key:"exportImage",value:function(e){(e=(0,c.defaultValue)(e,{})).method=(0,c.defaultValue)(e.method,f.FetchMethod.post),e.imageWidth=(0,c.defaultValue)(e.imageWidth,256),e.imageHeight=(0,c.defaultValue)(e.imageHeight,256),e.method===f.FetchMethod.post&&(e.headers={"Content-Type":"application/x-www-form-urlencoded"},e.responseType="blob");var t={imageWidth:{alias:"size",type:"Number",process:function(){return"&size="+e.imageWidth+","+e.imageHeight}},format:{type:"String"},layers:{type:"String"},imageTransparent:{alias:"transparent",type:"Boolean"},f:{type:"String"},bbox:{type:"Extent",process:function(){return e.bbox?"&bbox="+e.bbox.toString():""}},imageSR:{type:"Object",process:function(){return e.spatialReference?"&imageSR="+e.spatialReference.toString():""}}};return this._queryByParameters(e,{},t,function(e){return e+"/export"})}},{key:"getImage",value:function(e){e=(0,c.defaultValue)(e,{});var t={layers:(0,c.defaultValue)(e.layers,null),format:(0,c.defaultValue)(e.format,"png"),f:(0,c.defaultValue)(e.f,"image"),transparent:(0,c.defaultValue)(e.transparent,!0),bbox:(0,c.defaultValue)(e.bbox,"{bbox}")},r=(0,c.defaultValue)(e.imageWidth,256),i=(0,c.defaultValue)(e.imageHeight,256);t.size=r+","+i,(0,c.defined)(e.spatialReference)&&(0,c.defined)(e.spatialReference.wkid)&&(t.imageSR=e.spatialReference.wkid),t=(0,n.default)(this._queryParameters,t);var o=this._baseUrl+"/export?"+h.UrlUtil.getStringFromObject(t),a=h.UrlUtil.getStringFromObject(this._queryParameters);return a&&(o=h.UrlUtil.completeUrlEndMark(o),o+=a),o}},{key:"getTile",value:function(){var e=this._baseUrl+"/tile/{z}/{y}/{x}",t=h.UrlUtil.getStringFromObject(this._queryParameters);return t&&(e=h.UrlUtil.completeUrlEndMark(e),e+=t),e}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(10)),i=f(r(3)),o=f(r(0)),a=f(r(2)),s=f(r(4)),l=f(r(5)),u=f(r(13)),c=r(6);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,a.default)(t,[{key:"bufferAnalyse",value:function(e){var t={geometries:{type:"Object",required:!0,process:function(e){return"&geometries="+(0,n.default)(e)}},inSR:{type:"String",required:!0},distances:{type:"Number",required:!0},outSR:{type:"String"},unit:{type:"String"},bufferSR:{type:"String"}};return e.method=c.FetchMethod.get,this._queryByParameters(e,{},t,function(e){return e+"/buffer?f=json"})}},{key:"cutGeometry",value:function(e){var t={cutter:{type:"Object",required:!0,process:function(e){return"&cutter="+(0,n.default)(e)}},target:{type:"Object",required:!0,process:function(e){return"&target="+(0,n.default)(e)}},sr:{type:"String",required:!0}};return e.method=c.FetchMethod.get,this._queryByParameters(e,{},t,function(e){return e+"/cut?f=json"})}},{key:"calculateDifference",value:function(e){var t={geometries:{type:"Object",required:!0,process:function(e){return"&geometries="+(0,n.default)(e)}},geometry:{type:"Object",required:!0,process:function(e){return"&geometry="+(0,n.default)(e)}},sr:{type:"String",required:!0}};return e.method=c.FetchMethod.get,this._queryByParameters(e,{},t,function(e){return e+"/difference?f=json"})}},{key:"calculateDistance",value:function(e){var t={geometry1:{type:"Object",required:!0,process:function(e){return"&geometry1="+(0,n.default)(e)}},geometry2:{type:"Object",required:!0,process:function(e){return"&geometry2="+(0,n.default)(e)}},sr:{type:"String",required:!0},distanceUnit:{type:"String"}};return e.method=c.FetchMethod.get,this._queryByParameters(e,{},t,function(e){return e+"/distance?f=json"})}},{key:"calculateIntersect",value:function(e){var t={geometries:{type:"Object",required:!0,process:function(e){return"&geometries="+(0,n.default)(e)}},geometry:{type:"Object",required:!0,process:function(e){return"&geometry="+(0,n.default)(e)}},sr:{type:"String",required:!0}};return e.method=c.FetchMethod.get,this._queryByParameters(e,{},t,function(e){return e+"/intersect?f=json"})}},{key:"calculateTopologyRelation",value:function(e){var t={geometries1:{type:"Object",required:!0,process:function(e){return"&geometries1="+(0,n.default)(e)}},geometries2:{type:"Object",required:!0,process:function(e){return"&geometries2="+(0,n.default)(e)}},sr:{type:"String",required:!0},relation:{type:"String",required:!0},relationParam:{type:"String",required:!0}};return e.method=c.FetchMethod.get,this._queryByParameters(e,{},t,function(e){return e+"/relation?f=json"})}},{key:"simplifyGeometry",value:function(e){var t={geometries:{type:"Object",required:!0,process:function(e){return"&geometries="+(0,n.default)(e)}},sr:{type:"String",required:!0}};return e.method=c.FetchMethod.get,this._queryByParameters(e,{},t,function(e){return e+"/simplify?f=json"})}},{key:"calculateUnion",value:function(e){var t={geometries:{type:"Object",required:!0,process:function(e){return"&geometries="+(0,n.default)(e)}},sr:{type:"String",required:!0}};return e.method=c.FetchMethod.get,this._queryByParameters(e,{},t,function(e){return e+"/union?f=json"})}}]),t}(u.default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(10)),i=f(r(3)),o=f(r(0)),a=f(r(2)),s=f(r(4)),l=f(r(5)),u=f(r(13)),c=r(6);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,a.default)(t,[{key:"queryFeatures",value:function(e){var t={layerDefs:{type:"Array"},geometries:{type:"Object",required:!0,process:function(e){return"&geometries="+(0,n.default)(e)}},geometryType:{type:"String"},inSR:{type:"String"},spatialRel:{type:"String"},time:{type:"Number"},outSR:{type:"Number"},gdbVersion:{type:"Number"},returnGeometry:{type:"Boolean"},maxAllowableOffset:{type:"Number"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},returnZ:{type:"Boolean"},returnM:{type:"Boolean"},geometryPrecision:{type:"Boolean"}};return e.method=c.FetchMethod.get,this._queryByParameters(e,{},t,function(e){return e+"/query?f=json"})}},{key:"queryLayerInfo",value:function(e){return e.method=c.FetchMethod.get,this._queryByParameters(e,{layerId:"String"},{},function(e,t){return e+"/"+t.layerId+"?f=json"})}},{key:"addFeatures",value:function(e){return e.method=c.FetchMethod.get,this._queryByParameters(e,{layerId:{type:"String"}},{features:{type:"Array",required:!0},gdbVersion:{type:"String"},rollbackOnFailure:{type:"Boolean"}},function(e,t){return e+"/"+t.layerId+"/addFeatures?f=json"})}},{key:"editFeatures",value:function(e){return e.method=c.FetchMethod.get,this._queryByParameters(e,{layerId:{type:"String"}},{adds:{type:"String"},updates:{type:"String"},deletes:{type:"String"},features:{type:"Array",required:!0},gdbVersion:{type:"String"},rollbackOnFailure:{type:"Boolean"}},function(e,t){return e+"/"+t.layerId+"/addFeatures?f=json"})}},{key:"deleteFeatures",value:function(e){return e.method=c.FetchMethod.get,this._queryByParameters(e,{layerId:{type:"String"}},{objectIds:{type:"String"},where:{type:"String"},geometry:{type:"Object"},geometryType:{type:"String"},inSR:{type:"String"},spatialRel:{type:"String"},gdbVersion:{type:"String"},rollbackOnFailure:{type:"String"}},function(e,t){return e+"/"+t.layerId+"/addFeatures?f=json"})}},{key:"queryFeaturesInLayer",value:function(e){return this._queryByParameters(e,{layerId:{type:"String"}},{where:{type:"String"},geometry:{type:"Geometry"},distance:{type:"Number"},geometryPrecision:{type:"Number"},spatialRel:{type:"String"},outFields:{type:"String"},objectIds:{type:"String"},orderByFields:{type:"String"},groupByFieldsForStatistics:{type:"String"},resultRecordCount:{type:"Number"},resultOffset:{type:"Number"},outStatistics:{type:"OutStatistics"},returnGeometry:{type:"Boolean"},returnAttribute:{type:"Boolean"},returnStyle:{type:"Boolean"},returnIdsOnly:{type:"Boolean"},returnCountOnly:{type:"Boolean"},returnExtentOnly:{type:"Boolean"},returnZ:{type:"Boolean"}},function(e,t){return e+"/"+t.layerId+"/query?f=json"})}},{key:"updateFeatures",value:function(e){return e.method=c.FetchMethod.get,this._queryByParameters(e,{layerId:{type:"String"}},{features:{type:"Array",required:!0},gdbVersion:{type:"String"},rollbackOnFailure:{type:"Boolean"}},function(e,t){return e+"/"+t.layerId+"/updateFeatures?f=json"})}},{key:"queryFeatureInfo",value:function(e){return e.method=c.FetchMethod.get,this._queryByParameters(e,{layerId:{type:"String"},featureId:{type:"String"}},{},function(e,t){return e+"/"+t.layerId+"/"+t.featureId+"?f=json"})}}]),t}(u.default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemesInfo=t.ThemeServer=t.ItemValue=t.FolderInfoAttribute=t.FolderInfo=t.ExpInfo=t.CUniqueThemeInfo=t.CUniqueTheme=t.CThemeInfo=t.CTheme=t.CSimpleTheme=t.CRegInfo=t.CRangeThemeInfo=t.CRangeTheme=t.CRandomTheme=t.CPntInfo=t.CMultiClassTheme=t.CLinInfo=t.CGraduatedSymbolTheme=t.CFourColorTheme=t.CDotDensityTheme=t.CChartType=t.CChartThemeRepresentInfo=t.CChartThemeInfo=t.CChartTheme=t.CChartLabelFormat=t.CAnnInfo=t.CAllOtherDataItemInfoSource=void 0;var n=C(r(201)),i=C(r(202)),o=C(r(203)),a=C(r(204)),s=C(r(455)),l=C(r(456)),u=C(r(205)),c=C(r(206)),f=C(r(207)),h=C(r(208)),d=C(r(457)),p=C(r(210)),y=C(r(458)),g=C(r(211)),v=C(r(212)),m=C(r(459)),_=C(r(460)),S=C(r(213)),x=C(r(32)),b=C(r(84)),w=C(r(214)),k=C(r(461)),M=C(r(462)),E=C(r(215)),I=C(r(216)),T=C(r(463)),L=C(r(464)),P=C(r(217));function C(e){return e&&e.__esModule?e:{default:e}}t.CAllOtherDataItemInfoSource=n.default,t.CAnnInfo=i.default,t.CChartLabelFormat=o.default,t.CChartTheme=a.default,t.CChartThemeInfo=s.default,t.CChartThemeRepresentInfo=l.default,t.CChartType=u.default,t.CDotDensityTheme=c.default,t.CFourColorTheme=f.default,t.CGraduatedSymbolTheme=h.default,t.CLinInfo=d.default,t.CMultiClassTheme=p.default,t.CPntInfo=y.default,t.CRandomTheme=g.default,t.CRangeTheme=v.default,t.CRangeThemeInfo=m.default,t.CRegInfo=_.default,t.CSimpleTheme=S.default,t.CTheme=x.default,t.CThemeInfo=b.default,t.CUniqueTheme=w.default,t.CUniqueThemeInfo=k.default,t.ExpInfo=M.default,t.FolderInfo=E.default,t.FolderInfoAttribute=I.default,t.ItemValue=T.default,t.ThemeServer=L.default,t.ThemesInfo=P.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=u(r(84)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,r){(0,i.default)(this,t);var a=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));return r=(0,l.defaultValue)(r,{}),a.Expression=void 0!==e?e:"",a}return(0,a.default)(t,e),t}(s.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=a(r(202)),o=a(r(203));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){e=(0,n.defaultValue)(e,{}),(0,n.extend)(this,e),this.AnnInfoLabel=void 0!==e.AnnInfoLabel?e.AnnInfoLabel:new i.default,this.DigitLabel=void 0!==e.DigitLabel?e.DigitLabel:0,this.FormatLabel=void 0!==e.FormatLabel?e.FormatLabel:o.default.Unknown,this.IsDrawLabel=void 0===e.IsDrawLabel||e.IsDrawLabel,this.LineColor=void 0!==e.LineColor?e.LineColor:-1,this.MaxLength=void 0!==e.MaxLength?e.MaxLength:30,this.MinRadius=void 0!==e.MinRadius?e.MinRadius:10,this.PieSizeFixFlag=void 0!==e.PieSizeFixFlag?e.PieSizeFixFlag:0,this.PieTiltedAngle=void 0!==e.PieTiltedAngle?e.PieTiltedAngle:30,this.PlotRadius=void 0!==e.PlotRadius?e.PlotRadius:1,this.ThickPersent=void 0!==e.ThickPersent?e.ThickPersent:10,this.Width=void 0!==e.Width?e.Width:3}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(209);t.default=function(e){e=(0,n.defaultValue)(e,{}),(0,n.extend)(this,e),this.LibID=void 0!==e.LibID?e.LibID:0,this.Ovprnt=void 0!==e.Ovprnt&&e.Ovprnt,this.AdjustFlg=void 0!==e.AdjustFlg?e.AdjustFlg:i.CLinAdjustType.Adjust,this.HeadType=void 0!==e.HeadType?e.HeadType:i.CLinHeadType.Round,this.JointType=void 0!==e.JointType?e.JointType:i.CLinJointType.Round,this.LinStyID=void 0!==e.LinStyID?e.LinStyID:0,this.MakeMethod=void 0!==e.MakeMethod?e.MakeMethod:i.CLinStyleMakeType.Byrule,this.OutClr=void 0!==e.OutClr?e.OutClr:[46,4,3],this.XScale=void 0!==e.XScale?e.XScale:10,this.YScale=void 0!==e.YScale?e.YScale:10,this.OutPenW=void 0!==e.OutPenW?e.OutPenW:[.05,.05,.05]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.default=function(e){e=(0,n.defaultValue)(e,{}),(0,n.extend)(this,e),this.LibID=void 0!==e.LibID?e.LibID:0,this.Ovprnt=void 0!==e.Ovprnt&&e.Ovprnt,this.Angle=void 0!==e.Angle?e.Angle:0,this.BackClr=void 0!==e.BackClr?e.BackClr:0,this.BackExp=void 0!==e.BackExp?e.BackExp:0,this.FillFlg=void 0!==e.FillFlg?e.FillFlg:0,this.Height=void 0!==e.Height?e.Height:0,this.Width=void 0!==e.Width?e.Width:0,this.OutClr=void 0!==e.OutClr?e.OutClr:[0,0,0],this.SymID=void 0!==e.SymID?e.SymID:0,this.OutPenW=void 0!==e.OutPenW?e.OutPenW:[.05,.05,.05]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=u(r(84)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,r,a){(0,i.default)(this,t),a=(0,l.defaultValue)(a,{});var s=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,a));return s.StartValue=void 0!==e?e:"",s.EndValue=void 0!==r?r:"",s}return(0,a.default)(t,e),t}(s.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.default=function(e){e=(0,n.defaultValue)(e,{}),(0,n.extend)(this,e),this.LibID=void 0!==e.LibID?e.LibID:0,this.Ovprnt=void 0!==e.Ovprnt&&e.Ovprnt,this.Angle=void 0!==e.Angle?e.Angle:0,this.EndClr=void 0!==e.EndClr?e.EndClr:0,this.FillClr=void 0!==e.FillClr?e.FillClr:46,this.FillMode=void 0!==e.FillMode?e.FillMode:0,this.FullPatFlg=void 0===e.FullPatFlg||e.FullPatFlg,this.PatClr=void 0!==e.PatClr?e.PatClr:3,this.PatHeight=void 0!==e.PatHeight?e.PatHeight:5,this.PatID=void 0!==e.PatID?e.PatID:0,this.PatWidth=void 0!==e.PatWidth?e.PatWidth:5,this.OutPenW=void 0!==e.OutPenW?e.OutPenW:1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=u(r(84)),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,r){(0,i.default)(this,t),r=(0,l.defaultValue)(r,{});var a=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));return a.Value=void 0!==e?e:"",a}return(0,a.default)(t,e),t}(s.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.default=function(e,t,r){r=(0,n.defaultValue)(r,{}),(0,n.extend)(this,r),this.Expression=void 0!==e?e:"",this.ItemValueArr=void 0!==t?t:null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(209);t.default=function(e,t,r,o){o=(0,n.defaultValue)(o,{}),(0,n.extend)(this,o),this.StartValue=void 0!==e?e:"",this.EndValue=void 0!==t?t:"",this.ClassItemType=void 0!==r?r:i.CItemType.RangeTheme}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=w(r(10)),i=w(r(3)),o=w(r(0)),a=w(r(2)),s=w(r(4)),l=w(r(5)),u=w(r(13)),c=r(1),f=w(r(210)),h=w(r(213)),d=w(r(204)),p=w(r(208)),y=w(r(206)),g=w(r(211)),v=w(r(207)),m=w(r(214)),_=w(r(212)),S=w(r(216)),x=w(r(215)),b=w(r(217));function w(e){return e&&e.__esModule?e:{default:e}}var k=function(e){function t(e){(0,o.default)(this,t),e=(0,c.defaultValue)(e,{});var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r.guid=(0,c.defaultValue)(e.guid,(0,c.newGuid)()),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"formatThemInfo",value:function(e){var t=new x.default;if((0,c.extendDeep)(t,e.result||e),null!==t&&null!==t.attribute&&t.attribute.length>0)for(var r=[],n=null,i=0;i<t.attribute.length;i++){if(r[i]=new b.default,null!==t.attribute[i]&&(r[i].LayerName=t.attribute[i].name,null!==(n=JSON.parse(t.attribute[i].value))&&n.length>0)){r[i].ThemeArr=[];for(var o=0;o<n.length;o++){switch(n[o].name){case"CMultiClassTheme":r[i].ThemeArr[o]=new f.default;break;case"CSimpleTheme":r[i].ThemeArr[o]=new h.default;break;case"CChartTheme":r[i].ThemeArr[o]=new d.default;break;case"CGraduatedSymbolTheme":r[i].ThemeArr[o]=new p.default;break;case"CDotDensityTheme":r[i].ThemeArr[o]=new y.default;break;case"CRandomTheme":r[i].ThemeArr[o]=new g.default;break;case"CFourColorTheme":r[i].ThemeArr[o]=new v.default;break;case"CUniqueTheme":r[i].ThemeArr[o]=new m.default;break;case"CRangeTheme":r[i].ThemeArr[o]=new _.default;break;default:r[i].ThemeArr[o]=new h.default}(0,c.extendDeep)(r[i].ThemeArr[o],JSON.parse(n[o].value))}}return r}}},{key:"queryThemeInfo",value:function(e){e=(0,c.defaultValue)(e,{});var t=(0,c.defaultValue)(e.idxArr,void 0);if((0,c.isNull)(t))c.Log.error("idxArr不能为空！");else{if("string"==typeof t){var r=this.url+"/get?idxArr="+t+"&guid="+this.guid;return this._getRequest(r,e)}c.Log.error("idxArr类型错误！")}}},{key:"deleteTheme",value:function(e){e=(0,c.defaultValue)(e,{});var t=(0,c.defaultValue)(e.idxArr,void 0);if((0,c.isNull)(t))c.Log.error("idxArr不能为空！");else{if("string"==typeof t){var r=this.url+"/remove?idxArr="+t+"&guid="+this.guid;return this._getRequest(r,e)}c.Log.error("idxArr类型错误！")}}},{key:"updateThemesInfo",value:function(e){e=(0,c.defaultValue)(e,{});var t=(0,c.defaultValue)(e.idxArr,void 0);if((0,c.isNull)(t))c.Log.error("idxArr不能为空！");else if("string"==typeof t){var r=(0,c.defaultValue)(e.themeInfoArray,void 0);if((0,c.isNull)(r))c.Log.error("themeInfoArray不能为空！");else{if(r instanceof Array){var i=this.url+"/update?idxArr="+t+"&guid="+this.guid,o=new x.default;if(r.length>0){o.name="ThemeInfo",o.attribute=[];for(var a=0;a<r.length;a++)if(o.attribute[a]=new S.default,o.attribute[a].name=r[a].LayerName,null!==r[a].ThemeArr&&r[a].ThemeArr.length>0){for(var s=[],l=0;l<r[a].ThemeArr.length;l++)null!==r[a].ThemeArr[l]&&(s[l]=new S.default(r[a].ThemeArr[l].Type,(0,n.default)(r[a].ThemeArr[l])));o.attribute[a].value=(0,n.default)(s)}}return e.data=(0,n.default)(o),this._postRequest(i,e)}c.Log.error("themeInfoArray类型错误！")}}else c.Log.error("idxArr类型错误！")}},{key:"addTheme",value:function(e){e=(0,c.defaultValue)(e,{});var t=(0,c.defaultValue)(e.idxArr,void 0);if((0,c.isNull)(t))c.Log.error("idxArr不能为空！");else if("string"==typeof t){var r=(0,c.defaultValue)(e.themeInfoArray,void 0);if((0,c.isNull)(r))c.Log.error("themeInfoArray不能为空！");else{if(r instanceof Array){var i=this.url+"/add?idxArr="+t+"&guid="+this.guid,o=new x.default;if(r.length>0){o.name="ThemeInfo",o.attribute=[];for(var a=0;a<r.length;a++)if(o.attribute[a]=new S.default,o.attribute[a].name=r[a].LayerName,null!==r[a].ThemeArr&&r[a].ThemeArr.length>0){for(var s=[],l=0;l<r[a].ThemeArr.length;l++)null!==r[a].ThemeArr[l]&&(s[l]=new S.default(r[a].ThemeArr[l].Type,(0,n.default)(r[a].ThemeArr[l])));o.attribute[a].value=(0,n.default)(s)}}return e.data=(0,n.default)(o),this._postRequest(i,e)}c.Log.error("themeInfoArray类型错误！")}}else c.Log.error("idxArr类型错误！")}}]),t}(u.default);t.default=k},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600227,r.description="图层叠加分析",r.groupName="叠加分析",r.srcInfo1=o.srcInfo1,r.srcInfo2=o.srcInfo2,r.src1AttFilter=(0,u.defaultValue)(o.src1AttFilter,""),r.src2AttFilter=(0,u.defaultValue)(o.src2AttFilter,""),r.desInfo=o.desInfo,r.attOptType=o.attOptType,r.infoOptType=o.infoOptType,r.overType=o.overType,r.radius=o.radius,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo1:{required:!0,type:"String"},srcInfo2:{required:!0,type:"String"},src1AttFilter:{type:"String"},src2AttFilter:{type:"String"},desInfo:{required:!0,type:"String"},attOptType:{required:!0,type:"Number"},infoOptType:{required:!0,type:"Number"},overType:{required:!0,type:"Number"},radius:{required:!0,type:"Number"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600228,r.description="多边形裁剪(sfcls)",r.groupName="裁剪分析",r.srcInfo=o.srcInfo,r.desInfo=o.desInfo,r.geometry=o.geometry,r.attOptType=o.attOptType,r.infoOptType=o.infoOptType,r.overType=o.overType,r.tolerance=o.tolerance,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo:{required:!0,type:"String"},desInfo:{required:!0,type:"String"},geometry:{required:!0,type:"Geometry",alias:"strPos",process:function(e){return e.toString()}},attOptType:{required:!0,type:"Number"},infoOptType:{required:!0,type:"Number"},overType:{required:!0,type:"Number"},tolerance:{required:!0,type:"Number"}}}}]),t}(l(r(17)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600229,r.description="圆裁剪(sfcls)",r.groupName="裁剪分析",r.srcInfo=o.srcInfo,r.desInfo=o.desInfo,r.center=o.center,r.radius=o.radius,r.step=o.step,r.attOptType=o.attOptType,r.infoOptType=o.infoOptType,r.overType=o.overType,r.tolerance=o.tolerance,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo:{required:!0,type:"String"},desInfo:{required:!0,type:"String"},center:{required:!0,type:"String"},radius:{required:!0,type:"Number"},step:{required:!0,type:"Number"},attOptType:{required:!0,type:"Number"},infoOptType:{required:!0,type:"Number"},overType:{required:!0,type:"Number"},tolerance:{required:!0,type:"Number"}}}}]),t}(l(r(17)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600230,r.description="图层裁剪(sfcls/acls)",r.groupName="裁剪分析",r.srcInfo1=o.srcInfo1,r.srcInfo2=o.srcInfo2,r.src1AttFilter=(0,u.defaultValue)(o.src1AttFilter,""),r.src2AttFilter=(0,u.defaultValue)(o.src2AttFilter,""),r.desInfo=o.desInfo,r.attOptType=o.attOptType,r.infoOptType=o.infoOptType,r.overType=o.overType,r.tolerance=o.tolerance,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo1:{required:!0,type:"String"},srcInfo2:{required:!0,type:"String"},src1AttFilter:{type:"String"},src2AttFilter:{type:"String"},desInfo:{required:!0,type:"String"},attOptType:{required:!0,type:"Number"},infoOptType:{required:!0,type:"Number"},overType:{required:!0,type:"Number"},tolerance:{required:!0,type:"Number"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600231,r.description="类缓冲分析（单圈）",r.groupName="缓冲分析",r.srcInfo=o.srcInfo,r.desInfo=o.desInfo,r.idstr=(0,u.defaultValue)(o.idstr,""),r.leftRad=(0,u.defaultValue)(o.leftRad,5),r.rightRad=(0,u.defaultValue)(o.rightRad,5),r.isByAtt=o.isByAtt,r.fldName=(0,u.defaultValue)(o.fldName,""),r.angleType=o.angleType,r.isDynPrj=o.isDynPrj,r.dynPrjRad=(0,u.defaultValue)(o.dynPrjRad,0),r.isDissolve=o.isDissolve,r.color=(0,u.defaultValue)(o.color,1),r.isMultiFeatureOpr=o.isMultiFeatureOpr,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo:{required:!0,type:"String"},desInfo:{required:!0,type:"String"},idstr:{type:"String"},leftRad:{type:"Number"},rightRad:{type:"Number"},isByAtt:{required:!0,type:"Boolean"},fldName:{type:"String"},angleType:{required:!0,type:"Number"},isDynPrj:{required:!0,type:"Boolean"},dynPrjRad:{type:"Number"},isDissolve:{required:!0,type:"Boolean"},color:{type:"Number"},isMultiFeatureOpr:{required:!0,type:"Boolean"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600232,r.description="类缓冲分析（多圈）",r.groupName="缓冲分析",r.srcInfo=o.srcInfo,r.desInfo=o.desInfo,r.idstr=(0,u.defaultValue)(o.idstr,""),r.radiusStr=(0,u.defaultValue)(o.radiusStr,""),r.angleType=o.angleType,r.isDissolve=o.isDissolve,r.isDynPrj=o.isDynPrj,r.color=(0,u.defaultValue)(o.color,1),r.isMultiFeatureOpr=o.isMultiFeatureOpr,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo:{required:!0,type:"String"},desInfo:{required:!0,type:"String"},idstr:{type:"String"},radiusStr:{type:"String"},angleType:{required:!0,type:"Number"},isDissolve:{required:!0,type:"Boolean"},isDynPrj:{required:!0,type:"Boolean"},color:{type:"Number"},isMultiFeatureOpr:{required:!0,type:"Boolean"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600233,r.description="路径分析",r.groupName="网络分析",r.netClsUrl=o.netClsUrl,r.flagGeometry=o.flagGeometry,r.elementType=o.elementType,r.barrierGeometry=o.barrierGeometry,r.nearDis=o.nearDis,r.analyTp=o.analyTp,r.weight=(0,u.defaultValue)(o.weight,",Weight1,Weight1"),r.outFormat=o.outFormat,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{netClsUrl:{required:!0,type:"String"},flagGeometry:{required:!0,type:"Geometry",alias:"flagPosStr",process:function(e){return e.toString()}},elementType:{required:!0,type:"Number"},barrierGeometry:{required:!0,type:"Geometry",alias:"barrierPosStr",process:function(e){return e.toString()}},nearDis:{required:!0,type:"Number"},analyTp:{required:!0,type:"String"},weight:{type:"String"},outFormat:{required:!0,type:"String"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600235,r.description="根据参照系名称进行投影转换",r.groupName="投影转换",r.clsName=o.clsName,r.desClsName=o.desClsName,r.crsName=o.crsName,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{clsName:{required:!0,type:"String"},desClsName:{required:!0,type:"String"},crsName:{required:!0,type:"String"}}}}]),t}(l(r(17)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(10)),i=u(r(3)),o=u(r(0)),a=u(r(2)),s=u(r(4)),l=u(r(5));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),n=e||{};return r.url=n.url,r.flowId=600237,r.description="多边形叠加分析",r.groupName="叠加分析",r.srcInfo1=n.srcInfo1,r.geometry=n.geometry,r.desInfo=n.desInfo,r.attOptType=n.attOptType,r.infoOptType=n.infoOptType,r.overType=n.overType,r.radius=n.radius,r.inFormat=n.inFormat,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo1:{required:!0,type:"String"},geometry:{required:!0,type:"Geometry",alias:"strGRegionXML",process:function(e){var t=e.toOldIGSGeometry().RegGeom[0];return(0,n.default)(t)}},desInfo:{required:!0,type:"String"},attOptType:{required:!0,type:"Number"},infoOptType:{required:!0,type:"Number"},overType:{required:!0,type:"Number"},radius:{required:!0,type:"Number"},inFormat:{required:!0,type:"String"}}}}]),t}(u(r(17)).default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(10)),i=p(r(3)),o=p(r(0)),a=p(r(2)),s=p(r(4)),l=p(r(5)),u=p(r(17)),c=r(1),f=p(r(140)),h=p(r(100)),d=r(9);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),n=e||{};return r.url=n.url,r.flowId=600238,r.description="要素缓冲分析（单圈）",r.groupName="缓冲分析",r.geometrys=n.geometrys,r.attStrct=(0,c.defaultValue)(n.attStrct,{}),r.attRows=(0,c.defaultValue)(n.attRows,[]),r.leftRad=(0,c.defaultValue)(n.leftRad,.001),r.rightRad=(0,c.defaultValue)(n.rightRad,.001),r.traceRadius=n.traceRadius,r.color=(0,c.defaultValue)(n.color,1),r.isMultiFeatureOpr=n.isMultiFeatureOpr,r.inFormat=n.inFormat,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{geometrys:{required:!0,type:function(e){return!(!Array.isArray(e)||!e.every(function(e){return e instanceof d.Geometry}))},alias:"sfGeometryXML",process:function(e){var t=[];return e.forEach(function(e){var r=e.toOldIGSGeometry();t.push(r)}),(0,n.default)(t)}},attStrct:{type:function(e){return e instanceof h.default},alias:"attStrctXML",process:function(e){return(0,n.default)(e)}},attRows:{type:function(e){return!(!Array.isArray(e)||!e.every(function(e){return e instanceof f.default}))},alias:"attRowsXML",process:function(e){return(0,n.default)(e)}},leftRad:{type:"Number"},rightRad:{type:"Number"},traceRadius:{required:!0,type:"Number"},color:{type:"Number"},isMultiFeatureOpr:{required:!0,type:"Boolean"},inFormat:{required:!0,type:"String"}}}}]),t}(u.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(10)),i=p(r(3)),o=p(r(0)),a=p(r(2)),s=p(r(4)),l=p(r(5)),u=p(r(17)),c=r(1),f=p(r(140)),h=p(r(100)),d=r(9);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),n=e||{};return r.url=n.url,r.flowId=600239,r.description="要素缓冲分析（多圈）",r.groupName="缓冲分析",r.geometrys=n.geometrys,r.attStrct=(0,c.defaultValue)(n.attStrct,{}),r.attRows=(0,c.defaultValue)(n.attRows,[]),r.radiusStr=n.radiusStr,r.traceRadius=n.traceRadius,r.color=(0,c.defaultValue)(n.color,1),r.isMultiFeatureOpr=n.isMultiFeatureOpr,r.inFormat=n.inFormat,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{geometrys:{required:!0,type:function(e){return!(!Array.isArray(e)||!e.every(function(e){return e instanceof d.Geometry}))},alias:"sfGeometryXML",process:function(e){var t=[];return e.forEach(function(e){var r=e.toOldIGSGeometry();t.push(r)}),(0,n.default)(t)}},attStrct:{type:function(e){return e instanceof h.default},alias:"attStrctXML",process:function(e){return(0,n.default)(e)}},attRows:{type:function(e){return!(!Array.isArray(e)||!e.every(function(e){return e instanceof f.default}))},alias:"attRowsXML",process:function(e){return(0,n.default)(e)}},radiusStr:{required:!0,type:"String"},traceRadius:{required:!0,type:"Number"},color:{type:"Number"},isMultiFeatureOpr:{required:!0,type:"Boolean"},inFormat:{required:!0,type:"String"}}}}]),t}(u.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(10)),i=u(r(3)),o=u(r(0)),a=u(r(2)),s=u(r(4)),l=u(r(5));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),n=e||{};return r.url=n.url,r.flowId=600307,r.description="要素叠加分析",r.groupName="叠加分析",r.geometry1=n.geometry1,r.geometry2=n.geometry2,r.desInfo=n.desInfo,r.attOptType=n.attOptType,r.infoOptType=n.infoOptType,r.overType=n.overType,r.radius=n.radius,r.inFormat=n.inFormat,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{geometry1:{required:!0,type:"Geometry",alias:"strGeometry1XML",process:function(e){return(0,n.default)(e.toOldIGSGeometry())}},geometry2:{required:!0,type:"Geometry",alias:"strGeometry2XML",process:function(e){return(0,n.default)(e.toOldIGSGeometry())}},desInfo:{required:!0,type:"String"},attOptType:{required:!0,type:"Number"},infoOptType:{required:!0,type:"Number"},overType:{required:!0,type:"Number"},radius:{required:!0,type:"Number"},inFormat:{required:!0,type:"String"}}}}]),t}(u(r(17)).default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(10)),i=u(r(3)),o=u(r(0)),a=u(r(2)),s=u(r(4)),l=u(r(5));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),n=e||{};return r.url=n.url,r.flowId=600308,r.description="要素与图层叠加分析",r.groupName="叠加分析",r.srcInfo1=n.srcInfo1,r.geometry=n.geometry,r.desInfo=n.desInfo,r.attOptType=n.attOptType,r.infoOptType=n.infoOptType,r.overType=n.overType,r.radius=n.radius,r.inFormat=n.inFormat,r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo1:{required:!0,type:"String"},geometry:{required:!0,type:"Geometry",alias:"strGeometryXML",process:function(e){var t=e.toOldIGSGeometry();return(0,n.default)(t)}},desInfo:{required:!0,type:"String"},attOptType:{required:!0,type:"Number"},infoOptType:{required:!0,type:"Number"},overType:{required:!0,type:"Number"},radius:{required:!0,type:"Number"},inFormat:{required:!0,type:"String"}}}}]),t}(u(r(17)).default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600309,r.description="根据FID进行要素叠加分析",r.groupName="叠加分析",r.srcInfo1=o.srcInfo1,r.srcInfo2=o.srcInfo2,r.FIDs1=o.FIDs1,r.FIDs2=o.FIDs2,r.desInfo=o.desInfo,r.attOptType=o.attOptType,r.infoOptType=o.infoOptType,r.overType=o.overType,r.radius=o.radius,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo1:{required:!0,type:"String"},srcInfo2:{required:!0,type:"String"},FIDs1:{required:!0,type:"String"},FIDs2:{required:!0,type:"String"},desInfo:{required:!0,type:"String"},attOptType:{required:!0,type:"String"},infoOptType:{required:!0,type:"Number"},overType:{required:!0,type:"Number"},radius:{required:!0,type:"Number"}}}}]),t}(l(r(17)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600314,r.description="地图打印",r.groupName="地图操作",r.layerURLStr=o.layerURLStr,r.imageFilePath=o.imageFilePath,r.dpi=(0,u.defaultValue)(o.dpi,72),r.colorMode=o.colorMode,r.mapRectStr=o.mapRectStr,r.layoutWidth=o.layoutWidth,r.layoutHeight=o.layoutHeight,r.pageWidth=o.pageWidth,r.pageHeight=o.pageHeight,r.sOrig=o.sOrig,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{layerURLStr:{required:!0,type:"String"},imageFilePath:{required:!0,type:"String"},dpi:{type:"Number"},colorMode:{required:!0,type:"Number"},mapRectStr:{required:!0,type:"String"},layoutWidth:{required:!0,type:"Number"},layoutHeight:{required:!0,type:"Number"},pageWidth:{required:!0,type:"Number"},pageHeight:{required:!0,type:"Number"},sOrig:{required:!0,type:"Boolean"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600334,r.description="高性能图层叠加分析（新）",r.groupName="高性能叠加分析",r.srcInfo1=o.srcInfo1,r.srcInfo2=o.srcInfo2,r.desInfo=o.desInfo,r.attOptType=o.attOptType,r.infoOptType=o.infoOptType,r.overType=o.overType,r.radius=o.radius,r.src1AttFilter=(0,u.defaultValue)(o.src1AttFilter,""),r.isCreateDesCls=o.isCreateDesCls,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo1:{required:!0,type:"String"},srcInfo2:{required:!0,type:"String"},desInfo:{required:!0,type:"String"},attOptType:{required:!0,type:"Number"},infoOptType:{required:!0,type:"Number"},overType:{required:!0,type:"Number"},radius:{required:!0,type:"Number"},src1AttFilter:{type:"Boolean"},isCreateDesCls:{required:!0,type:"Boolean"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600336,r.description="连通与非连通分析",r.groupName="网络分析",r.netClsUrl=o.netClsUrl,r.flag=o.flag,r.flagPosStr=o.flagPosStr,r.elementType=o.elementType,r.nearDis=o.nearDis,r.weight=(0,u.defaultValue)(o.weight,",Weight1,Weight1"),r.analyTp=o.analyTp,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{netClsUrl:{required:!0,type:"String"},flag:{required:!0,type:"Boolean"},flagPosStr:{required:!0,type:"String"},elementType:{required:!0,type:"String"},nearDis:{required:!0,type:"Number"},weight:{type:"String"},analyTp:{required:!0,type:"String"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600340,r.description="根据空间参照信息投影(sfcls/acls)",r.groupName="投影转换",r.clsName=(0,u.defaultValue)(o.clsName,"GDBP://MapGISLocal/Sample/sfcls/wh_中心线new"),r.desClsName=(0,u.defaultValue)(o.desClsName,"GDBP://MapGISLocal/Sample/sfcls/wh_中心线Reult9"),r.projTypeID=(0,u.defaultValue)(o.projTypeID,5),r.sphereType=(0,u.defaultValue)(o.sphereType,2),r.projAngleUnit=(0,u.defaultValue)(o.projAngleUnit,0),r.projType=(0,u.defaultValue)(o.projType,3),r.projZoneType=(0,u.defaultValue)(o.projZoneType,0),r.projZoneNO=(0,u.defaultValue)(o.projZoneNO,0),r.projLon=(0,u.defaultValue)(o.projLon,117e4),r.projLat=(0,u.defaultValue)(o.projLat,0),r.projLat1=(0,u.defaultValue)(o.projLat1,0),r.projLat2=(0,u.defaultValue)(o.projLat2,0),r.projUnit=(0,u.defaultValue)(o.projUnit,2),r.projRate=(0,u.defaultValue)(o.projRate,1),r.x=(0,u.defaultValue)(o.x,0),r.y=(0,u.defaultValue)(o.y,0),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{clsName:{type:"String"},desClsName:{type:"String"},projTypeID:{type:"Number"},sphereType:{type:"Number"},projAngleUnit:{type:"Number"},projType:{type:"Number"},projZoneType:{type:"Number"},projZoneNO:{type:"Number"},projLon:{type:"Number"},projLat:{type:"Number"},projLat1:{type:"Number"},projLat2:{type:"Number"},projUnit:{type:"Number"},projRate:{type:"Number"},x:{type:"Number"},y:{type:"Number"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600354,r.description="最近设施分析",r.groupName="网络分析",r.netClsUrl=o.netClsUrl,r.facilityPosStr=o.facilityPosStr,r.eventPosStr=o.eventPosStr,r.elementType=o.elementType,r.barrierPosStr=(0,u.defaultValue)(o.barrierPosStr,""),r.nearDis=o.nearDis,r.direction=(0,u.defaultValue)(o.direction,"从设施"),r.outFormat=o.outFormat,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{netClsUrl:{required:!0,type:"String"},facilityPosStr:{required:!0,type:"String"},eventPosStr:{required:!0,type:"String"},elementType:{required:!0,type:"Number"},barrierPosStr:{type:"String"},nearDis:{required:!0,type:"Number"},direction:{type:"String"},outFormat:{required:!0,type:"String"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(2)),a=l(r(4)),s=l(r(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600368,r.description="三维体对象空间关系判定",r.groupName="三维分析",r.srcInfo1=o.srcInfo1,r.srcInfo2=o.srcInfo2,r.FID1=o.FID1,r.FID2=o.FID2,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo1:{required:!0,type:"String"},srcInfo2:{required:!0,type:"String"},FID1:{required:!0,type:"String"},FID2:{required:!0,type:"String"}}}}]),t}(l(r(17)).default);t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600369,r.description="三维体对象空间运算",r.groupName="三维分析",r.srcInfo1=o.srcInfo1,r.srcInfo2=o.srcInfo2,r.desInfo=o.desInfo,r.FIDs1=(0,u.defaultValue)(o.FIDs1,""),r.FIDs2=(0,u.defaultValue)(o.FIDs2,""),r.spatialOperationType=o.spatialOperationType,r.radius=o.radius,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfo1:{required:!0,type:"String"},srcInfo2:{required:!0,type:"String"},desInfo:{required:!0,type:"String"},FIDs1:{type:"String"},FIDs2:{type:"String"},spatialOperationType:{required:!0,type:"String"},radius:{required:!0,type:"String"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(17)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),o=e||{};return r.url=o.url,r.flowId=600370,r.description="栅格代数运算",r.groupName="其它",r.srcInfos=o.srcInfos,r.desInfo=o.desInfo,r.expression=o.expression,r.pixelType=(0,u.defaultValue)(o.pixelType,-1),r.cellSizeX=(0,u.defaultValue)(o.cellSizeX,""),r.cellSizeY=(0,u.defaultValue)(o.cellSizeY,""),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_getCheckQueryOpts",value:function(){return{srcInfos:{required:!0,type:"String"},desInfo:{required:!0,type:"String"},expression:{required:!0,type:"String"},pixelType:{required:!0,type:"Number"},cellSizeX:{type:"String"},cellSizeY:{type:"String"}}}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1);t.default=function e(t){(0,n.default)(this,e),t=(0,i.defaultValue)(t,{}),this.url=(0,i.defaultValue)(t.url,null),this.headers=(0,i.defaultValue)(t.headers,{}),this.queryParameters=(0,i.defaultValue)(t.queryParameters,{}),this.commonQueryParameters=(0,i.defaultValue)(t.commonQueryParameters,{})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerBaseUrlRegExp=t.LayerBaseUrlRegExp=t.BaseRegExp=void 0;var n=a(r(138)),i=a(r(489)),o=a(r(30));function a(e){return e&&e.__esModule?e:{default:e}}t.BaseRegExp=n.default,t.LayerBaseUrlRegExp=i.default,t.ServerBaseUrlRegExp=o.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(7)),l=f(r(5)),u=r(1),c=f(r(138));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,o.default)(t,null,[{key:"initRegExps",value:function(){var e=this;this.regExps={};var t="http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/{ServerName}/"+c.default.requestWordRegExp;this.regExps.WMTSLayerV1=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/ogc/"+c.default.requestWordRegExp+"/WMTSServer"),this.regExps.WMSLayerV1=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/ogc/doc/"+c.default.requestWordRegExp+"/WMSServer"),this.regExps.WFSLayerV1=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/ogc/layer/"+c.default.requestWordRegExp+"/WFSServer"),this.regExps.IGSFeatureLayerV1GDBP=new RegExp("http://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/mrfs/layer"),[{key:"IGSMapImageLayerV1",value:"mrms/docs"},{key:"IGSMapImageLayerV1Wrong",value:"mrcs/docs"},{key:"IGSTileLayerV1",value:"mrms/tile"},{key:"IGSFeatureLayerV1",value:"mrfs/docs"},{key:"IGSVectorTileLayerV1",value:"mrcs/vtiles"},{key:"IGSSceneLayerV1",value:"g3d"}].forEach(function(r){e.regExps[r.key]=new RegExp(t.replace("{ServerName}",r.value))});var r="(http|https)://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/igs/rest/services/("+c.default.requestWordRegExp+"|"+c.default.requestWordRegExp+"/"+c.default.requestWordRegExp+")/";[{key:"IGSMapImageLayerV2",value:"MapServer"},{key:"IGSTileLayerV2",value:"TileServer"},{key:"IGSFeatureLayerV2",value:"FeatureServer"},{key:"IGSVectorTileLayerV2",value:"VectorTileServer"},{key:"IGSSceneLayerV2",value:"SceneServer"},{key:"M3DModelCacheLayer",value:"M3dServer"},{key:"WMTSLayerV2",value:"WMTSServer"},{key:"WMSLayerV2",value:"WMSServer"},{key:"WFSLayerV2",value:"WFSServer"},{key:"IGS-ArcGISMapImageLayer",value:"arcgis/MapServer"},{key:"IGS-ArcGISTileLayer",value:"arcgis/MapServer"},{key:"IGS-ArcGISVectorTileLayer",value:"arcgis/VectorTileServer"}].forEach(function(t){e.regExps[t.key]=new RegExp(""+r+t.value)});var n="(http|https)://([0-9.a-zA-Z]+:[0-9]{1,5}|[0-9.a-zA-Z]+)/arcgis/rest/services/("+c.default.requestWordRegExp+"|"+c.default.requestWordRegExp+"/"+c.default.requestWordRegExp+")/";[{key:"ArcGISMapImageLayer",value:"MapServer"},{key:"ArcGISTileLayer",value:"MapServer"},{key:"ArcGISVectorTileLayer",value:"VectorTileServer"}].forEach(function(t){e.regExps[t.key]=new RegExp(""+n+t.value)})}},{key:"matchString",value:function(e){if((0,u.defined)(e)){var r=e.indexOf("?"),i="",o="";return r<0?i=e:(i=e.substring(0,r),o=e.substring(r,e.length)),(i=(0,s.default)(t.__proto__||(0,n.default)(t),"matchString",this).call(this,i))+o}}},{key:"matchStringByRegExpNames",value:function(e,r){if((0,u.defined)(e)){var i=e.indexOf("?"),o="",a="";return i<0?o=e:(o=e.substring(0,i),a=e.substring(i,e.length)),(o=(0,s.default)(t.__proto__||(0,n.default)(t),"matchStringByRegExpNames",this).call(this,o,r))+a}}}]),t}(c.default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ISSceneServer=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(491));t.ISSceneServer=n.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(2)),a=u(r(4)),s=u(r(5)),l=u(r(13));function u(e){return e&&e.__esModule?e:{default:e}}r(8);var c=function(e){function t(e){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"queryLayerListInfoBySceneName",value:function(e){var t=e.sceneName,r=e.success,n=e.failure;return this._querySimpleInfo({success:r,failure:n},function(e){return e+"/scenes/"+t+"/layers.json"})}},{key:"querySceneListInfo",value:function(e){return this._querySimpleInfo(e,function(e){return e+"/scenes.json"})}}]),t}(l.default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=k(r(16)),i=k(r(23)),o=k(r(14)),a=k(r(10)),s=k(r(3)),l=k(r(0)),u=k(r(2)),c=k(r(4)),f=k(r(7)),h=k(r(5)),d=r(15),p=r(6),y=r(8),g=r(1),v=r(9),m=k(r(226)),_=k(r(86)),S=r(19),x=r(25),b=k(r(521)),w=k(r(67));function k(e){return e&&e.__esModule?e:{default:e}}var M=function(e){function t(e){(0,l.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return e=(0,g.defaultValue)(e,{}),r.type=p.LayerType.igsVectorTile,r.description="IGS矢量瓦片图层",r.sublayers=(0,g.defaultValue)(e.sublayers,void 0),r.replaceStyleURL=(0,g.defaultValue)(e.replaceStyleURL,!0),r.replaceStyleURLRegExp=(0,g.defaultValue)(e.replaceStyleURLRegExp,new RegExp("(https?://)(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+[A-Z]{2,6}\\.?|(?:\\d{1,3}\\.){3}\\d{1,3}|localhost)(?::[-+]?\\d+(?:\\.\\d+)?)?/igs/rest/","gi")),r._getSubLayerFromUrl(),r._mapinfo=void 0,r}return(0,h.default)(t,e),(0,u.default)(t,[{key:"covertCustomStyleToMVTStyle",value:function(e){var t=this,r=(0,g.cloneObject)(e),n=r,i=n.layers,o=n.mapinfo;i.forEach(function(e){e.hasOwnProperty("paint")||(e.paint={}),e.hasOwnProperty("layout")||(e.layout={}),"[object Object]"!==Object.prototype.toString.call(e.extendProperties)&&(e.extendProperties={}),"[object Object]"!==Object.prototype.toString.call(e._backupProperties)&&(e._backupProperties={}),e._backupProperties.visibility=t._getStyleLayerVisibility(e),e._backupProperties.opacities=t._getStyleLayerOpacitiesMap(e)});var s=o;if(!s){s={children:[]};for(var l=0;l<i.length;l++)s.children.push({baseRenderStyleIDs:[i[l].id],index:i[l].id,name:i[l].id,type:"SFeatureLayer"})}if(this._mapinfo=s,this.replaceStyleURL){var u=this.url.match(this.replaceStyleURLRegExp);if(u){var c=(0,a.default)(r);c=c.replace(this.replaceStyleURLRegExp,u[0]),r=JSON.parse(c)}}return r}},{key:"setPaintProperties",value:function(e,r){(0,f.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"setPaintProperties",this).call(this,e,r),this._setBackupProperties(e,"opacities",this._getStyleLayerOpacitiesMap(this.getStyleLayer(e)))}},{key:"setLayoutProperties",value:function(e,r){(0,f.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"setLayoutProperties",this).call(this,e,r),this._setBackupProperties(e,"visibility",this._getStyleLayerVisibility(this.getStyleLayer(e)))}},{key:"findSublayerById",value:function(e){return this._findSublayerById(this.sublayers,e)}},{key:"_findSublayerById",value:function(e,t){for(var r=0;r<e.items.length;r++){var n=e.items[r];if(n instanceof m.default&&n.id===t)return n;if(n instanceof b.default)return n.id===t?n:this._findSublayerById(n.sublayers,t)}}},{key:"toJSON",value:function(){var e=(0,f.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.description=this.description,e.sublayers=this.sublayers.map(function(e){return(0,g.toJSON)(e,m.default)}),e.labelsRenderMode=this.labelsRenderMode,e}},{key:"_load",value:function(){var e=this;return this.url&&"string"==typeof this.url?this.url.indexOf(".json")>-1?(this._vectorTileServer=new x.VectorTileServer({url:this.url,tokenKey:this.tokenKey,tokenValue:this.tokenValue,headers:this.headers}),this._vectorTileServer.getRootJSON({url:this._vectorTileServer._baseUrl}).then(function(t){var r=t.data;return g.Log.info("矢量瓦片样式查询成功:",r),e._style=e.covertCustomStyleToMVTStyle(r),e._initCurrentStyleInfo(),e._initSubLayers(),e._vectorTileServer=new x.VectorTileServer({url:e._getServerUrlFromStyle(),tokenKey:e.tokenKey,tokenValue:e.tokenValue,headers:e.headers}),e._vectorTileServer._queryParameters=w.default.getBaseUrlAndParams(e.url).params,e._vectorTileServer.queryServerInfo().then(function(t){g.Log.info("矢量瓦片信息查询成功:",t);var r=t.data;return e._initLayerInfo(r),e._style.sprite?e._requestSprite():new o.default(function(t){e.loadStatus=p.LoadStatus.loaded,e.loaded=!0,t(e)})})})):this._vectorTileServer.queryServerInfo().then(function(t){g.Log.info("矢量瓦片信息查询成功:",t);var r=t.data;return e._initLayerInfo(r),e._vectorTileServer.getStyle().then(function(t){return g.Log.info("矢量瓦片样式查询成功:",t),e._style=e.covertCustomStyleToMVTStyle(t.data),e._initCurrentStyleInfo(),e._initSubLayers(),e._style.sprite?e._requestSprite():new o.default(function(t){e.loadStatus=p.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){g.Log.error("矢量瓦片样式查询失败:",e)})}).catch(function(e){g.Log.error("矢量瓦片信息查询失败:",e)}):this.style&&this.style instanceof Object?(this._style=this.covertCustomStyleToMVTStyle(this.style),this._initCurrentStyleInfo(),this._initSubLayers(),this._vectorTileServer=new x.VectorTileServer({url:this._getServerUrlFromStyle(),tokenKey:this.tokenKey,tokenValue:this.tokenValue,headers:this.headers}),this._vectorTileServer.queryServerInfo().then(function(t){g.Log.info("矢量瓦片信息查询成功:",t);var r=t.data;return e._initLayerInfo(r),e._style.sprite?e._requestSprite():new o.default(function(t){e.loadStatus=p.LoadStatus.loaded,e.loaded=!0,t(e)})})):void 0}},{key:"_getStyleLayerVisibility",value:function(e){if((0,g.isObject)(e)){var t=e.layout,r=void 0===t?{}:t;return r.visibility?r.visibility:"visible"}return!0}},{key:"_getStyleLayerOpacitiesMap",value:function(e){if((0,g.isObject)(e)){var t=e.paint,r=void 0===t?{}:t,n=e.type,o={};switch(n){case"symbol":o["text-opacity"]=void 0,o["icon-opacity"]=void 0;break;default:o[n+"-opacity"]=void 0}return(0,i.default)(o).forEach(function(e){o[e]=isNaN(Number(r[e]))?1:Number(r[e])}),o}return null}},{key:"_initCurrentStyleInfo",value:function(){this.currentStyleInfo.serviceUrl=this.url,this.currentStyleInfo.styleUrl=this.url+"/style?f=json",this.currentStyleInfo.spriteUrl=this._style.sprite,this.currentStyleInfo.glyphsUrl=this._style.glyphs,this.currentStyleInfo.style=this._style}},{key:"_initSubLayers",value:function(){var e=this._style.layers,t=this._mapinfo;if(this.sublayers&&0===this.sublayers.length)this._style.layers=[],this.sublayers=new y.Collection;else if(t){var r=new y.Collection,n=[];this.sublayers&&this.sublayers.forEach(function(e){n.push(e)});var i=t.children;this._updateMapInfoSubLayers(i,n,e),this._initSubLayersByMapInfoSubLayers(e,i,r,this),this.sublayers=r;var o=[];this._initStyleLayers(r,o),this._style.layers=o}else g.Log.warning("缺少MapInfo属性，将显示所有样式图层！")}},{key:"_initSubLayersByMapInfoSubLayers",value:function(e,t,r,n){var i=this;return t.forEach(function(t){var o=void 0;if(t._canInit)if(t.type===p.SeverVectorTileSubLayerType.GroupLayer){var a=t.children;o=i._initSubLayersByMapInfoSubLayers(e,a,new b.default({id:t.index,visible:t.visible,opacity:t.opacity}),n)}else o=new m.default({type:t.type,id:t.index,title:t.name,styleLayers:t.styleLayers,layer:n,visible:(0,g.defaultValue)(t.visible,!0),opacity:(0,g.defaultValue)(t.opacity,1),labelingInfo:(0,g.defaultValue)(t.labelingInfo,[])});o&&(r instanceof y.Collection?r.add(o):r.sublayers.add(o))}),r}},{key:"_updateMapInfoSubLayers",value:function(e,t,r){for(var i=0;i<e.length;i++)if(t.length>0){for(var o=0;o<t.length;o++)if(e[i]._canInit=!1,e[i].index===t[o].id){if(e[i]=(0,n.default)(e[i],t[o]),e[i].type===p.SeverVectorTileSubLayerType.GroupLayer){var a=t[o].sublayers;if(!a||a&&!(a instanceof Array)){if(a=e[i].children,!1===e[i].visible)for(var s=0;s<a.length;s++)a[s].visible=!1;e[i].hasOwnProperty("opacity")||(e[i].opacity=1);for(var l=0;l<a.length;l++)a[l].hasOwnProperty("opacity")||(a[l].opacity=1),a[l].opacity*=e[i].opacity,a[l].id=a[l].index}this._updateMapInfoSubLayers(e[i].children,a,r)}else e[i].styleLayers=this._getValidStyleLayers(r,e[i].baseRenderStyleIDs,e[i].labelRenderStyleIDs);e[i]._canInit=!0;break}}else e[i]._canInit=!0,e[i].type!==p.SeverVectorTileSubLayerType.GroupLayer&&(e[i].styleLayers=this._getValidStyleLayers(r,e[i].baseRenderStyleIDs,e[i].labelRenderStyleIDs)),this._updateMapInfoSubLayers(e[i].children||[],[],r)}},{key:"_getValidStyleLayers",value:function(e,t,r){var n=(0,g.defaultValue)(e,[]),i=(0,g.defaultValue)(t,[]),o=(0,g.defaultValue)(r,[]);return n.filter(function(e){return i.indexOf(e.id)>=0||o.indexOf(e.id)>=0})}},{key:"_initStyleLayers",value:function(e,t){var r=this;e instanceof y.Collection?e.forEach(function(e){e instanceof b.default?r._initStyleLayers(e.sublayers,t):e.styleLayers.forEach(function(e){t.push(e)})}):this._initStyleLayers(e.sublayers,t)}},{key:"_initLayerInfo",value:function(e){"1.0"===this._vectorTileServer.igsType?this._spatialReference||g.Log.error("该服务为IGS1.0版本的矢量瓦片服务，请手动设置坐标系参数"):this._spatialReference=v.SpatialReference.fromJSON(e.tileInfo.spatialReference),this.title=e.name,this.tileInfo=_.default.parseTileInfo2(e.tileInfo);var t;t="1.0"===this._vectorTileServer.igsType?e.fullExtent:e.extent,this.extent=new v.Extent({xmin:t.xmin,ymin:t.ymin,xmax:t.xmax,ymax:t.ymax,spatialReference:this._spatialReference}),e.capabilities&&(this.capabilities=Array.isArray(e.capabilities)?e.capabilities:[e.capabilities])}},{key:"_requestSprite",value:function(){var e=this,t=[];return this._style.sprite&&(t=w.default.getBaseUrlAndParams(this._style.sprite).params),this._vectorTileServer.getSprite({extensions:t}).then(function(t){return g.Log.info("矢量瓦片样式查询成功:",t),e._style.spritedata=t.data,new o.default(function(t){e.loadStatus=p.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){g.Log.error("矢量瓦片样式查询失败:",e)})}},{key:"_getServerUrlFromStyle",value:function(){var e=this._style.sources,t=e[(0,i.default)(e)[0]].tiles[0];return t.indexOf("/igs/rest/services/")>-1?t.split("/tiles/{z}/{y}/{x}?type=pbf")[0]:t.split("/{z}/{y}/{x}?type=pbf")[0].replace("/mrms/tile/","/mrcs/vtiles/")}},{key:"_getSubLayerFromUrl",value:function(){var e=void 0,t=void 0,r=void 0;if("1.0"===this._vectorTileServer.igsType?(r=(t=this.url.split("/igs/rest/mrcs/vtiles/"))[t.length-1].split("/")).length>1&&(e=r[r.length-1]):(t=this.url.split("/VectorTileServer/")).length>1&&(e=t[t.length-1]),e){var n=void 0;if(this.sublayers&&this.sublayers instanceof Array&&(n=this.sublayers.filter(function(t){return String(t.id)===e})),this.sublayers=n||[{id:e}],"1.0"===this._vectorTileServer.igsType){this.url=""+t[0];for(var i=0;i<r.length-1;i++)this.url+=r[i];this._vectorTileServer._url=this.url}else this.url=t[0]+"/VectorTileServer",this._vectorTileServer._url=this.url}}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,S.jsonClone)(e));return r.loadStatus=p.LoadStatus.loaded,r.loaded=!0,r}}]),t}(d.VectorTileLayer);t.default=M},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(11)),i=v(r(16)),o=v(r(3)),a=v(r(0)),s=v(r(2)),l=v(r(4)),u=v(r(7)),c=v(r(5)),f=v(r(40)),h=r(1),d=r(6),p=r(46),y=r(139),g=r(19);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r.url=(0,h.defaultValue)(e.url,""),r.tileInfo=void 0,r.mvtExtent=(0,h.defaultValue)(e.mvtExtent,4096),r.capabilities=[],r.currentStyleInfo={},r._labelsRenderMode=(0,h.defaultValue)(e.labelsRenderMode,"off-screen"),r._clippingArea=(0,h.defaultValue)(e.clippingArea,null),r._style=(0,h.defaultValue)(e.style,null),r._vectorTileServer=new y.VectorTileServer({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"getStyleLayer",value:function(e){for(var t=this.style.layers,r=0;r<t.length;r++)if(t[r].id===e)return t[r];return null}},{key:"getStyleLayerIndex",value:function(e){return this.style.layers.findIndex(function(t){return t.id===e})}},{key:"getStyleLayerId",value:function(e){var t=this.style.layers;return e>t.length-1?null:t[e]}},{key:"setStyleLayer",value:function(e,t){var r=e||{},n=this.getStyleLayer(r.id);if(n){var i=this.getStyleLayerIndex(e.id),o=this.style.layers;void 0!==t&&null!==t&&"number"==typeof t&&t>=0?(o.splice(i,1),o.splice(t,0,n)):o[i]=e,this._fireLayerUpdateEvent([{params:arguments,dataChanged:!0,name:"setStyleLayer",operationType:"method"}])}}},{key:"deleteStyleLayer",value:function(e){if(this.getStyleLayer(e)){var t=this.style.layers,r=this.getStyleLayerIndex(e);t.splice(r,1),this._fireLayerUpdateEvent([{params:arguments,dataChanged:!0,name:"deleteStyleLayer",operationType:"method"}])}}},{key:"setStyleLayerVisibility",value:function(e,t){var r=t?"visible":"none";this.setLayoutProperties(e,{visibility:r})}},{key:"getStyleLayerVisibility",value:function(e){var t=this.getLayoutProperties(e);return!t||"visible"===t.visibility}},{key:"getPaintProperties",value:function(e){var t=this.getStyleLayer(e);return(0,h.isObject)(t)?t.paint||{}:null}},{key:"setPaintProperties",value:function(e,t){var r=this.getStyleLayer(e);(0,h.isObject)(r)&&(r.paint=(0,i.default)(r.paint||{},t||{}),this._fireLayerUpdateEvent([{params:arguments,dataChanged:!0,name:"setPaintProperties",operationType:"method"}]))}},{key:"getLayoutProperties",value:function(e){var t=this.getStyleLayer(e);return(0,h.isObject)(t)?t.layout||{}:null}},{key:"setLayoutProperties",value:function(e,t){var r=this.getStyleLayer(e);(0,h.isObject)(r)&&(r.layout=(0,i.default)(r.layout||{},t||{}),this._fireLayerUpdateEvent([{params:arguments,dataChanged:!0,name:"setLayoutProperties",operationType:"method"}]))}},{key:"setExtendProperties",value:function(e,t,r){var n=this.getStyleLayer(e);(0,h.isObject)(n)&&(n.extendProperties[t]=r)}},{key:"getExtendProperties",value:function(e,t){var r=this.getStyleLayer(e);return(0,h.isObject)(r)&&(0,h.isObject)(r.extendProperties)?r.extendProperties[t]:null}},{key:"_setBackupProperties",value:function(e,t,r){var n=this.getStyleLayer(e);(0,h.isObject)(n)&&(0,h.isObject)(n._backupProperties)&&(n._backupProperties[t]=r)}},{key:"_getBackupProperties",value:function(e,t){var r=this.getStyleLayer(e);return(0,h.isObject)(r)&&(0,h.isObject)(r._backupProperties)?r._backupProperties[t]:null}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e&&(e.minScale=this.minScale,e.maxScale=this.maxScale,e.capabilities=this.capabilities),e}},{key:"clone",value:function(){return new f.default(this.toJSON())}},{key:"_fireLayerUpdateEvent",value:function(e){this._map&&this._map.fire(d.LayerEventType.layerUpdate,new p.LayerViewUpdateEvent({type:d.LayerEventType.layerUpdate,target:this._map,layer:this,message:"",updateContent:e}))}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,g.jsonClone)(e));return r.loadStatus=d.LoadStatus.loaded,r.loaded=!0,r}}]),t}(f.default);(0,n.default)(m.prototype,{clippingArea:{get:function(){return this._clippingArea},set:function(e){this._clippingArea=e,this._fireUpdateEvent("空间裁剪区域",[{name:"clippingArea",params:[this._clippingArea],dataChanged:!0,operationType:"property"}])}},style:{get:function(){return this._style},set:function(e){this._style=e}},labelsRenderMode:{get:function(){return this._labelsRenderMode},set:function(e){this._labelsRenderMode=e,this._fireLayerUpdateEvent([{params:[],dataChanged:!0,name:"refresh",operationType:"method"}])}}}),t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(23)),i=u(r(0)),o=u(r(2)),a=r(495),s=r(19),l=r(221);function u(e){return e&&e.__esModule?e:{default:e}}var c=" \nfill-color fill-opacity fill-outline-color fill-pattern fill-sort-key \nline-blur line-color line-dasharray line-gap-width line-gradient line-join line-offset line-opacity line-pattern line-sort-key line-width \nicon-anchor icon-color icon-halo-blur icon-halo-color icon-halo-width icon-image icon-offset icon-opacity icon-rotate icon-size symbol-sort-key text-anchor text-color text-field text-font text-halo-blur text-halo-color text-halo-width text-justify text-letter-spacing text-line-height text-max-width text-offset text-opacity text-radial-offset text-rotate text-size text-transform\ncircle-blur circle-color circle-opacity circle-radius circle-sort-key circle-stroke-opacity circle-stroke-width\n ",f=function(){function e(t,r){(0,i.default)(this,e),this.attrName=t,this.defValue=r,this.steps=[]}return(0,o.default)(e,[{key:"addStep",value:function(e,t){t===this.defValue||(0,l.isMapboxExpression)(t)||(this.steps.push(["==",["get",this.attrName],e]),this.steps.push(t))}},{key:"toExpress",value:function(){if(0===this.steps.length)return this.defValue;var e=this.steps.map(function(e){return e});return e.unshift("case"),e.push(this.defValue),e}}]),e}(),h=function(){function e(t,r){(0,i.default)(this,e),this.attrName=t,this.defValue=r,this.steps=[]}return(0,o.default)(e,[{key:"addStep",value:function(e,t,r){r===this.defValue||(0,l.isMapboxExpression)(r)||(this.steps.push(["all",[">=",["get",this.attrName],e],["<=",["get",this.attrName],t]]),this.steps.push(r))}},{key:"toExpress",value:function(){if(0===this.steps.length)return this.defValue;var e=this.steps.map(function(e){return e});return e.unshift("case"),e.push(this.defValue),e}}]),e}(),d=function(){function e(){(0,i.default)(this,e)}return(0,o.default)(e,null,[{key:"renderToStyle",value:function(t,r,n){var i={paint:{},layout:{}};if(!t)return i;switch(t.type){case"simple":i=e.tranSimpleRender(t,r,n);break;case"unique-value":i=e.tranUniqueValueRender(t,r,n);break;case"class-breaks":i=e.tranClassBreaksRender(t,r,n);break;default:i=e.tranSimpleRender(t,r,n)}return i}},{key:"tranSimpleRender",value:function(e,t,r){if(!e||!e.symbol)return{};var n=(0,a.convertSymbol)(e.symbol,t);return e.visualVariables&&Array.isArray(e.visualVariables)&&e.visualVariables.forEach(function(e){switch(e.type){case"color":case"opacity":case"rotation":case"size":break;default:throw new Error("未识别视觉变量类型")}}),n}},{key:"tranUniqueValueRender",value:function(e,t,r){if(!e)return{};var i={};(0,s.defined)(e.defaultSymbol)&&(i=(0,a.convertSymbol)(e.defaultSymbol,t));var o=e.field,u=(0,s.defaultValue)(i.paint,{}),h=(0,s.defaultValue)(i.layout,{}),d={},p={};return(0,n.default)(u).forEach(function(e){c.indexOf(e)>-1&&!(0,l.isMapboxExpression)(u[e])&&(d[e]=new f(o,u[e]))}),(0,n.default)(h).forEach(function(e){c.indexOf(e)>-1&&!(0,l.isMapboxExpression)(u[e])&&(p[e]=new f(o,h[e]))}),(0,s.defaultValue)(e.uniqueValueInfos,[]).forEach(function(e){var r=(0,a.convertSymbol)(e.symbol,t),i=e.value,u=(0,s.defaultValue)(r.paint,{}),h=(0,s.defaultValue)(r.layout,{});(0,n.default)(u).forEach(function(e){c.indexOf(e)>-1&&!(0,l.isMapboxExpression)(u[e])&&(d[e]||(d[e]=new f(o,u[e])),d[e].addStep(i,u[e]))}),(0,n.default)(h).forEach(function(e){c.indexOf(e)>-1&&!(0,l.isMapboxExpression)(h[e])&&(p[e]||(p[e]=new f(o,h[e])),p[e].addStep(i,h[e]))})}),(0,n.default)(d).forEach(function(e){u[e]=d[e].toExpress()}),(0,n.default)(p).forEach(function(e){h[e]=p[e].toExpress()}),i.paint=u,i.layout=h,i}},{key:"tranClassBreaksRender",value:function(e,t,r){if(!e)return{};var i={};(0,s.defined)(e.defaultSymbol)&&(i=(0,a.convertSymbol)(e.defaultSymbol,t));var o=e.field,u=(0,s.defaultValue)(i.paint,{}),f=(0,s.defaultValue)(i.layout,{}),d={},p={};return(0,n.default)(u).forEach(function(e){c.indexOf(e)>-1&&!(0,l.isMapboxExpression)(u[e])&&(d[e]=new h(o,u[e]))}),(0,n.default)(f).forEach(function(e){c.indexOf(e)>-1&&!(0,l.isMapboxExpression)(u[e])&&(p[e]=new h(o,f[e]))}),(0,s.defaultValue)(e.classBreakInfos,[]).forEach(function(e){var r=(0,a.convertSymbol)(e.symbol,t),i=(0,s.defaultValue)(r.paint,{}),u=(0,s.defaultValue)(r.layout,{});(0,n.default)(i).forEach(function(t){c.indexOf(t)>-1&&!(0,l.isMapboxExpression)(i[t])&&(d[t]||(d[t]=new h(o,i[t])),d[t].addStep(e.minValue,e.maxValue,i[t]))}),(0,n.default)(u).forEach(function(t){c.indexOf(t)>-1&&!(0,l.isMapboxExpression)(u[t])&&(p[t]||(p[t]=new h(o,u[t])),p[t].addStep(e.minValue,e.maxValue,u[t]))})}),(0,n.default)(d).forEach(function(e){u[e]=d[e].toExpress()}),(0,n.default)(p).forEach(function(e){f[e]=p[e].toExpress()}),i.paint=u,i.layout=f,i}}]),e}();t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertSymbol=void 0;var n=r(19),i=r(221);function o(e,t,r,o){if((0,n.defined)(o.color)&&(t["line-color"]=(0,i.convertColorToRgb)(o.color)),(0,n.defined)(o.width)&&(t["line-width"]=o.width),(0,n.defined)(o.opacity)&&(t["line-opacity"]=o.opacity),(0,n.defined)(o.cap)&&(r["line-cap"]=o.cap),(0,n.defined)(o.join)&&(r["line-join"]=o.join),(0,n.defined)(o.miterLimit)&&(r["line-miter-limit"]=o.miterLimit),(0,n.defined)(o.style)){var a=(0,i.convertLineStyle)(o.style,"butt"===o.cap);a&&(t["line-dasharray"]=a)}}t.convertSymbol=function(e,t){var r={};(0,n.defined)(r)||(r={}),(0,n.defined)(r.paint)||(r.paint={}),(0,n.defined)(r.layout)||(r.layout={});var a=r.paint,s=r.layout;switch(e.type){case"simple-line":o(0,a,s,e);break;case"simple-fill":!function(e,t,r,o){switch(e){case"fill":(0,n.defined)(o.color)&&(t["fill-color"]=(0,i.convertColorToRgb)(o.color)),(0,n.defined)(o.opacity)&&(t["fill-opacity"]=o.opacity),(0,n.defined)(o.outline)&&(0,n.defined)(o.outline.color)&&(t["fill-outline-color"]=(0,i.convertColorToRgb)(o.outline.color));break;case"background":(0,n.defined)(o.color)&&(t["background-color"]=(0,i.convertColorToRgb)(o.color)),(0,n.defined)(o.opacity)&&(t["background-opacity"]=o.opacity)}}(t,a,0,e);break;case"simple-marker":!function(e,t,r,a){switch(e){case"symbol":(0,n.defined)(a.angle)&&(r["icon-rotate"]=a.angle),(0,n.defined)(a.color)&&(t["icon-color"]=(0,i.convertColorToRgb)(a.color)),(0,n.defined)(a.outline)&&((0,n.defined)(a.outline.color)&&(t["icon-halo-color"]=(0,i.convertColorToRgb)(a.outline.color)),(0,n.defined)(a.outline.width)&&(t["icon-halo-width"]=a.outline.width)),(0,n.defined)(a.size)&&(r["icon-size"]=parseInt(a.size));var s=(0,n.defined)(a.xoffset)?parseFloat((0,n.defaultValue)(a.xoffset,0)):0,l=(0,n.defined)(a.yoffset)?parseFloat((0,n.defaultValue)(a.yoffset,0)):0;r["icon-offset"]=[s,l];break;case"circle":var u=(0,n.defaultValue)(a.xoffset,0),c=(0,n.defaultValue)(a.yoffset,0);if(t["circle-translate"]=[parseFloat(u),parseFloat(c)],(0,n.defined)(a.opacity)&&(t["circle-opacity"]=a.opacity),(0,n.defined)(a.color)&&(t["circle-color"]=a.color),(0,n.defined)(a.outline)){var f={};o(0,{},a.outline),(0,n.defined)(f["line-color"])&&(t["circle-stroke-color"]=(0,i.convertColorToRgb)(f["line-color"])),(0,n.defined)(f["line-opacity"])&&(t["circle-stroke-opacity"]=f["line-opacity"]),(0,n.defined)(f["line-width"])&&(t["circle-stroke-width"]=f["line-width"])}t["circle-radius"]=parseFloat((0,n.defaultValue)(a.size,12))}}(t,a,s,e);break;case"text":!function(e,t,r,o){if((0,n.defined)(o.backgroundColor)&&(t["icon-color"]=(0,i.convertColorToRgb)(o.backgroundColor)),(0,n.defined)(o.borderLineColor)&&(t["icon-halo-color"]=(0,i.convertColorToRgb)(o.borderLineColor)),(0,n.defined)(o.borderLineSize)&&(t["icon-halo-width"]=parseFloat(o.borderLineSize)),(0,n.defined)(o.color)&&(t["text-color"]=(0,i.convertColorToRgb)(o.color)),(0,n.defined)(o.font)){var a=o.font;(0,n.defined)(a.family)&&(r["text-font"]=[a.family]),r["text-size"]=parseFloat((0,n.defaultValue)(a.size,9))}switch((0,n.defined)(o.haloColor)&&(t["text-halo-color"]=(0,i.convertColorToRgb)(o.haloColor)),(0,n.defined)(o.haloSize)&&(t["text-halo-width"]=parseFloat(o.haloSize)),(0,n.defined)(o.horizontalAlignment)&&(r["text-justify"]=o.horizontalAlignment),(0,n.defined)(o.kerning)&&(r["text-letter-spacing"]=o.kerning?1.2:0),(0,n.defined)(o.lineHeight)&&(r["text-line-height"]=o.lineHeight?1.2:0),r["text-max-width"]=(0,n.defaultValue)(o.lineWidth,192),o.rotated&&(0,n.defined)(o.angle)&&(t["text-rotate"]=o.angle,t["icon-rotate"]=o.angle),r["text-anchor"]="center",o.verticalAlignment){case"top":r["text-anchor"]="top";break;case"middle":r["text-anchor"]="center";break;case"bottom":r["text-anchor"]="bottom";break;default:r["text-anchor"]="center"}var s=(0,n.defined)(o.xoffset)?parseFloat((0,n.defaultValue)(o.xoffset,0)/r["text-font"]):0,l=(0,n.defined)(o.yoffset)?parseFloat((0,n.defaultValue)(o.yoffset,0)/r["text-font"]):0;r["text-offset"]=[s,l]}(0,a,s,e)}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(3)),i=p(r(0)),o=p(r(2)),a=p(r(4)),s=p(r(7)),l=p(r(5)),u=p(r(40)),c=r(8),f=r(6),h=r(1),d=r(70);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r.type=f.LayerType.feature,r.elevationInfo=new c.ElevationInfo(e.elevationInfo),r.geometryType=f.GeometryType.geometry,r.renderer=r._decorate("renderer",e.renderer,d.BaseRenderer,d.BaseRenderer.fromJSON),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.renderer=(0,h.toJSON)(this.renderer,d.BaseRenderer),e.elevationInfo=(0,h.toJSON)(this.elevationInfo,c.ElevationInfo),e.geometryType=this.geometryType,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(3)),i=y(r(0)),o=y(r(2)),a=y(r(4)),s=y(r(7)),l=y(r(5)),u=y(r(50)),c=r(1),f=r(6),h=r(22),d=r(85),p=y(r(222));function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.RendererType.uniqueValue,r.field=(0,c.defaultValue)(e.field,""),r.uniqueValueInfos=r._decorate("uniqueValueInfos",(0,c.defaultValue)(e.uniqueValueInfos,[]),null,function(e){return e.map(function(e){return p.default.fromJSON(e)})}),r.defaultSymbol=r._decorate("symbol",e.defaultSymbol,h.Symbol,h.Symbol.fromJSON),r.defaultVisible=(0,c.defaultValue)(e.defaultVisible,!0),r.visualVariables=r._decorate("visualVariables",(0,c.defaultValue)(e.visualVariables,[]),null,function(e){return e.map(function(e){return d.VisualVariable.fromJSON(e)})}),r.valueExpressionTitle=(0,c.defaultValue)(e.valueExpressionTitle,""),r.valueExpression=(0,c.defaultValue)(e.valueExpression,""),r.defaultLabel=(0,c.defaultValue)(e.defaultLabel,null),r.defaultDescription=(0,c.defaultValue)(e.defaultDescription,null),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.field=this.field,e.defaultSymbol=this.defaultSymbol.toJSON(),e.uniqueValueInfos=this.uniqueValueInfos.map(function(e){return e.toJSON()}),e.visualVariables=this.visualVariables.map(function(e){return e.toJSON()}),e.valueExpression=this.valueExpression,e.valueExpressionTitle=this.valueExpressionTitle,e.defaultLabel=this.defaultLabel,e.defaultDescription=this.defaultDescription,e.defaultVisible=this.defaultVisible,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.default);g.fromJSON=function(e){return e=(0,c.defaultValue)(e,{}),new g(e)},t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=d(r(102)),c=r(1),f=d(r(55)),h=d(r(499));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.default.color,r.stops=(0,c.defaultValue)(e.stops,[]),r.stops=r.stops.map(function(e){return h.default.fromJSON(e)}),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.normalizationField=this.normalizationField,e.stops=this.stops.map(function(e){return e.toJSON()}),e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=r(8);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.color=a.Color.fromColor((0,o.defaultValue)(t.color,{})),this.value=t.value,this.label=t.label}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.color=this.color.toJSON(),e.value=this.value,e.label=this.label,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=d(r(102)),c=r(1),f=d(r(55)),h=d(r(501));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.default.size,r.maxDataValue=e.maxDataValue,r.maxSize=e.maxSize,r.minDataValue=e.minDataValue,r.minSize=e.minSize,r.stops=(0,c.defaultValue)(e.stops,[]),r.stops=r.stops.map(function(e){return h.default.fromJSON(e)}),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.minSize=this.minSize,e.maxSize=this.maxSize,e.minDataValue=this.minDataValue,e.maxDataValue=this.maxDataValue,e.normalizationField=this.normalizationField,e.stops=this.stops.map(function(e){return e.toJSON()}),e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.size=t.size,this.value=t.value,this.label=t.label}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.size=this.size,e.value=this.value,e.label=this.label,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=d(r(102)),c=r(1),f=d(r(55)),h=d(r(503));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.default.opacity,r.stops=(0,c.defaultValue)(e.stops,[]),r.stops=r.stops.map(function(e){return h.default.fromJSON(e)}),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.normalizationField=this.normalizationField,e.stops=this.stops.map(function(e){return e.toJSON()}),e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{}),this.opacity=t.opacity,this.value=t.value,this.label=t.label}return(0,i.default)(e,[{key:"toJSON",value:function(){var e={};return e.opacity=this.opacity,e.value=this.value,e.label=this.label,e}},{key:"clone",value:function(){return new e(this.toJSON())}}],[{key:"fromJSON",value:function(t){return new e(t)}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(3)),i=y(r(0)),o=y(r(2)),a=y(r(4)),s=y(r(7)),l=y(r(5)),u=y(r(50)),c=r(1),f=r(6),h=r(22),d=r(85),p=y(r(224));function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.RendererType.classBreak,r.field=(0,c.defaultValue)(e.field,""),r.classBreakInfos=r._decorate("classBreakInfos",(0,c.defaultValue)(e.classBreakInfos,[]),null,function(e){return e.map(function(e){return p.default.fromJSON(e)})}),r.defaultSymbol=r._decorate("symbol",e.defaultSymbol,h.Symbol,h.Symbol.fromJSON),r.defaultVisible=(0,c.defaultValue)(e.defaultVisible,!0),r.visualVariables=r._decorate("visualVariables",(0,c.defaultValue)(e.visualVariables,[]),null,function(e){return e.map(function(e){return d.VisualVariable.fromJSON(e)})}),r.valueExpressionTitle=(0,c.defaultValue)(e.valueExpressionTitle,""),r.valueExpression=(0,c.defaultValue)(e.valueExpression,""),r.defaultLabel=(0,c.defaultValue)(e.defaultLabel,null),r.defaultDescription=(0,c.defaultValue)(e.defaultDescription,null),r.normalizationField=e.normalizationField,r.normalizationTotal=e.normalizationTotal,r.normalizationType=(0,c.defaultValue)(e.normalizationType,""),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.field=this.field,e.classBreakInfos=this.classBreakInfos,e.defaultSymbol=this.defaultSymbol.toJSON(),e.classBreakInfos=this.classBreakInfos.map(function(e){return e.toJSON()}),e.visualVariables=this.visualVariables.map(function(e){return e.toJSON()}),e.valueExpression=this.valueExpression,e.valueExpressionTitle=this.valueExpressionTitle,e.defaultLabel=this.defaultLabel,e.defaultDescription=this.defaultDescription,e.defaultVisible=this.defaultVisible,e.normalizationField=this.normalizationField,e.normalizationTotal=this.normalizationTotal,e.normalizationType=this.normalizationType,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.default);g.fromJSON=function(e){return e=(0,c.defaultValue)(e,{}),new g(e)},t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(3)),i=p(r(0)),o=p(r(2)),a=p(r(4)),s=p(r(7)),l=p(r(5)),u=p(r(50)),c=r(1),f=r(6),h=r(22),d=r(85);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.RendererType.simple,r.symbol=r._decorate("symbol",e.symbol,h.Symbol,h.Symbol.fromJSON),r.label=(0,c.defaultValue)(e.label,null),r.description=(0,c.defaultValue)(e.description,null),r.visualVariables=r._decorate("visualVariables",(0,c.defaultValue)(e.visualVariables,[]),null,function(e){return e.map(function(e){return d.VisualVariable.fromJSON(e)})}),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.symbol=this.symbol.toJSON(),e.visualVariables=this.visualVariables.map(function(e){return e.toJSON()}),e.label=this.label,e.description=this.description,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.default);y.fromJSON=function(e){return e=(0,c.defaultValue)(e,{}),new y(e)},t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(10)),i=g(r(3)),o=g(r(0)),a=g(r(2)),s=g(r(4)),l=g(r(7)),u=g(r(5)),c=g(r(50)),f=r(1),h=r(6),d=r(22),p=g(r(507)),y=g(r(508));function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,f.defaultValue)(e,{}),r.type=h.RendererType.cluster,r.radius=(0,f.defaultValue)(e.radius,80),r.clusterBoundSymbol=r._decorate("clusterBoundSymbol",e.clusterBoundSymbol,d.SimpleFillSymbol,d.SimpleFillSymbol.fromJSON),r.clusterInfos=r._decorate("clusterInfos",(0,f.defaultValue)(e.clusterInfos,[]),null,function(e){return e.map(function(e){return void 0!==e.value?y.default.fromJSON(e):p.default.fromJSON(e)})}),r.defaultSymbol=r._decorate("defaultSymbol",(0,f.defaultValue)(e.defaultSymbol,new d.SimpleMarkerSymbol({color:"rgba(240, 194, 12, 0.6)",size:30,outline:{color:"rgba(241, 211, 87, 0.6)",width:5}})),d.Symbol,d.Symbol.fromJSON),r.maxScale=(0,f.defaultValue)(e.maxScale,20),r.isExpandOnClick=(0,f.defaultValue)(e.isExpandOnClick,!0),r.isHoverShowBound=(0,f.defaultValue)(e.isHoverShowBound,!1),r.defaultLabelSymbol=r._decorate("defaultLabelSymbol",(0,f.defaultValue)(e.defaultLabelSymbol,{}),d.TextSymbol,d.TextSymbol.fromJSON),r.defaultLabelExpressionInfo=(0,f.defaultValue)(e.defaultLabelExpressionInfo,null),r.valueExpressionTitle=(0,f.defaultValue)(e.valueExpressionTitle,""),r.valueExpression=(0,f.defaultValue)(e.valueExpression,"$cluster_count"),r.minHybridClusterCount=(0,f.defaultValue)(e.minHybridClusterCount,0),r.deconflictionStrategy=(0,f.defaultValue)(e.deconflictionStrategy,"none"),r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.radius=this.radius,e.clusterBoundSymbol=this.clusterBoundSymbol.toJSON(),e.clusterInfos=this.clusterInfos.map(function(e){return e.toJSON()}),e.defaultSymbol=this.defaultSymbol.toJSON(),e.maxScale=this.maxScale,e.isExpandOnClick=this.isExpandOnClick,e.isHoverShowBound=this.isHoverShowBound,e.defaultLabelSymbol=this.defaultLabelSymbol.toJSON(),e.defaultLabelExpressionInfo=this.defaultLabelExpressionInfo?JSON.parse((0,n.default)(this.defaultLabelExpressionInfo)):null,e.valueExpression=this.valueExpression,e.valueExpressionTitle=this.valueExpressionTitle,e.minHybridClusterCount=this.minHybridClusterCount,e.deconflictionStrategy=this.deconflictionStrategy,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,f.defaultValue)(e,{}))}}]),t}(c.default);t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(10)),i=d(r(3)),o=d(r(0)),a=d(r(2)),s=d(r(4)),l=d(r(7)),u=d(r(5)),c=r(1),f=d(r(224)),h=r(22);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.labelSymbol=e.labelSymbol?h.Symbol.fromJSON(e.labelSymbol):null,r.labelExpressionInfo=(0,c.defaultValue)(e.labelExpressionInfo,null),r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return e.labelSymbol=this.labelSymbol?this.labelSymbol.toJSON():null,e.labelExpressionInfo=this.labelExpressionInfo?JSON.parse((0,n.default)(this.labelExpressionInfo)):null,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,c.defaultValue)(e,{}))}}]),t}(f.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(10)),i=d(r(3)),o=d(r(0)),a=d(r(2)),s=d(r(4)),l=d(r(7)),u=d(r(5)),c=r(1),f=d(r(222)),h=r(22);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.labelSymbol=e.labelSymbol?h.Symbol.fromJSON(e.labelSymbol):null,r.labelExpressionInfo=(0,c.defaultValue)(e.labelExpressionInfo,null),r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return e.labelSymbol=this.labelSymbol?this.labelSymbol.toJSON():null,e.labelExpressionInfo=this.labelExpressionInfo?JSON.parse((0,n.default)(this.labelExpressionInfo)):null,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,c.defaultValue)(e,{}))}}]),t}(f.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(7)),l=h(r(5)),u=h(r(50)),c=r(1),f=r(6);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.RendererType.random,r.field=(0,c.defaultValue)(e.field,void 0),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,c.defaultValue)(e,{}))}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=d(r(50)),c=r(1),f=r(6),h=r(22);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.RendererType.rank,r.maxSize=(0,c.defaultValue)(e.maxSize,50),r.minSize=(0,c.defaultValue)(e.minSize,12),r.maxDataValue=e.maxDataValue,r.minDataValue=e.minDataValue,r.symbol=r._decorate("symbol",e.symbol,h.Symbol,h.Symbol.fromJSON),r.field=e.field,r.valueExpression=e.valueExpression,r.valueExpressionTitle=e.valueExpressionTitle,r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.maxSize=this.maxSize,e.minSize=this.minSize,e.maxDataValue=this.maxDataValue,e.minDataValue=this.minDataValue,e.symbol=this.symbol.toJSON(),e.field=this.field,e.valueExpression=this.valueExpression,e.valueExpressionTitle=this.valueExpressionTitle,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,c.defaultValue)(e,{}))}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=d(r(50)),c=r(1),f=d(r(225)),h=r(6);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=h.RendererType.heatmap,r.colorStops=(0,c.defaultValue)(e.colorStops,[]).map(function(e){return f.default.fromJSON(e)}),r.radius=e.radius,r.field=e.field,r.valueExpression=e.valueExpression,r.valueExpressionTitle=e.valueExpressionTitle,r.maxDataValue=e.maxDataValue,r.minDataValue=e.minDataValue,r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.colorStops=this.colorStops.map(function(e){return e.toJSON()}),e.radius=this.radius,e.field=this.field,e.valueExpression=this.valueExpression,e.valueExpressionTitle=this.valueExpressionTitle,e.maxDataValue=this.maxDataValue,e.minDataValue=this.minDataValue,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,c.defaultValue)(e,{}))}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIGSDynamicLayer=void 0;var n=s(r(513)),i=r(6),o=r(1),a=s(r(516));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=(0,o.defaultValue)(e,{}),r={};switch(t.type){case i.SymbolType.simpleMarker:r={color:[(0,n.default)(t.color.red),(0,n.default)(t.color.green),(0,n.default)(t.color.blue),(0,n.default)(255*t.color.alpha)],type:t.type,angle:t.angle,xoffset:t.xoffset,yoffset:t.yoffset,size:t.size,outline:null,style:t.style},t.outline&&(r.outline={type:t.outline.type,color:[(0,n.default)(t.outline.color.red),(0,n.default)(t.outline.color.green),(0,n.default)(t.outline.color.blue),(0,n.default)(255*t.outline.color.alpha)],width:t.outline.width,style:t.outline.style});break;case i.SymbolType.simpleFill:r={color:[(0,n.default)(t.color.red),(0,n.default)(t.color.green),(0,n.default)(t.color.blue),(0,n.default)(255*t.color.alpha)],type:t.type,outline:{color:[(0,n.default)(t.outline.color.red),(0,n.default)(t.outline.color.green),(0,n.default)(t.outline.color.blue),(0,n.default)(255*t.outline.color.alpha)],type:t.outline.type,width:t.outline.width,style:t.outline.style},style:t.style};break;case i.SymbolType.simpleLine:r={color:[(0,n.default)(t.color.red),(0,n.default)(t.color.green),(0,n.default)(t.color.blue),(0,n.default)(255*t.color.alpha)],type:t.type,width:t.width,style:t.style};break;case i.SymbolType.pictureMarker:r={color:[(0,n.default)(t.color.red),(0,n.default)(t.color.green),(0,n.default)(t.color.blue),(0,n.default)(255*t.color.alpha)],type:t.type,angle:t.angle,xoffset:t.xoffset,yoffset:t.yoffset,width:t.width,height:t.height,url:a.default.isBase64(t.url)?void 0:t.url,imageData:a.default.isBase64(t.url)?t.url:void 0,contentType:"image/png"};break;case i.SymbolType.pictureFill:r={type:t.type,outline:{color:[(0,n.default)(t.outline.color.red),(0,n.default)(t.outline.color.green),(0,n.default)(t.outline.color.blue),(0,n.default)(255*t.outline.color.alpha)],type:t.outline.type,width:t.outline.width,style:t.outline.style},url:a.default.isBase64(t.url)?void 0:t.url,imageData:a.default.isBase64(t.url)?t.url:void 0,contentType:"image/png",width:t.width,height:t.height,xoffset:t.xoffset,yoffset:t.yoffset};break;case i.SymbolType.text:r={type:t.type,color:[(0,n.default)(t.color.red),(0,n.default)(t.color.green),(0,n.default)(t.color.blue),(0,n.default)(255*t.color.alpha)],angle:t.angle,backgroundColor:[(0,n.default)(t.backgroundColor.red),(0,n.default)(t.backgroundColor.green),(0,n.default)(t.backgroundColor.blue),(0,n.default)(255*t.backgroundColor.alpha)],borderLineColor:[(0,n.default)(t.borderLineColor.red),(0,n.default)(t.borderLineColor.green),(0,n.default)(t.borderLineColor.blue),(0,n.default)(255*t.borderLineColor.alpha)],borderLineSize:t.borderLineSize,font:{family:t.font.family,size:t.font.size,style:t.font.style,weight:t.font.weight},haloColor:[(0,n.default)(t.haloColor.red),(0,n.default)(t.haloColor.green),(0,n.default)(t.haloColor.blue),(0,n.default)(255*t.haloColor.alpha)],haloSize:t.haloSize,horizontalAlignment:t.horizontalAlignment,kerning:t.kerning,verticalAlignment:t.verticalAlignment,xoffset:t.xoffset,yoffset:t.yoffset};break;default:r={}}return r}t.getIGSDynamicLayer=function(e){for(var t=[],r=e.allSublayers.items.sort(function(e,t){return Number(e.index)-Number(t.index)}),n=!1,o=0;o<r.length;o++)r[o].renderer&&(n=!0),r[o].id!==e.allSublayers.items[o].id&&(n=!0);if(n)for(var a=0;a<r.length;a++){var s=r[a].renderer,u={layerId:r[a].id};if(s&&"Group"!==r[a].type){u.drawingInfo={renderer:{}};var c=s.toJSON(),f=void 0,h=void 0;switch(s.type){case i.RendererType.simple:f={type:c.type,symbol:l(c.symbol),label:c.label,description:c.description};break;case i.RendererType.uniqueValue:h=c.valueExpression.split("$feature.").join(""),f={type:c.type,field1:h||c.field,field2:null,field3:null,fieldDelimiter:null,defaultLabel:c.defaultLabel,defaultDescription:c.defaultDescription,uniqueValueInfos:[],defaultSymbol:l(c.defaultSymbol)};for(var d=0;d<c.uniqueValueInfos.length;d++)f.uniqueValueInfos.push({value:c.uniqueValueInfos[d].value,symbol:l(c.uniqueValueInfos[d].symbol),label:c.uniqueValueInfos[d].label,description:c.uniqueValueInfos[d].description,visible:c.uniqueValueInfos[d].visible});break;case i.RendererType.classBreak:h=c.valueExpression.split("$feature.").join(""),f={type:c.type,field:h||c.field,defaultLabel:c.defaultLabel,defaultDescription:c.defaultDescription,normalizationType:null,normalizationField:null,minValue:0,classBreakInfos:[],defaultSymbol:l(c.defaultSymbol)};for(var p=[],y=c.classBreakInfos,g=0;g<y.length;g++)p.push(Number(y[g].minValue));p=p.sort(function(e,t){return e-t}),f.minValue=p[0];var v=[].concat(c.classBreakInfos);v=v.sort(function(e,t){return e.maxValue-t.maxValue});for(var m=0;m<v.length;m++)f.classBreakInfos.push({classMaxValue:v[m].minValue,symbol:l(v[m].symbol),label:v[m].label,description:v[m].description,visible:v[m].visible}),f.classBreakInfos.push({classMaxValue:v[m].maxValue,symbol:l(v[m].symbol),label:v[m].label,description:v[m].description,visible:v[m].visible})}u.drawingInfo.renderer=f}"Group"!==r[a].type&&t.push(u)}return t}},function(e,t,r){e.exports={default:r(514),__esModule:!0}},function(e,t,r){r(515),e.exports=r(12).Math.trunc},function(e,t,r){var n=r(18);n(n.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(3)),i=s(r(53)),o=s(r(0)),a=s(r(2));function s(e){return e&&e.__esModule?e:{default:e}}var l=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),u=function(){function e(){(0,o.default)(this,e)}return(0,a.default)(e,null,[{key:"getTag",value:function(e){return null===e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}},{key:"isBoolean",value:function(t){return!0===t||!1===t||e.isObjectLike(t)&&"[object Boolean]"===e.getTag(t)}},{key:"isObject",value:function(e){var t=void 0===e?"undefined":(0,i.default)(e);return null!==e&&("object"===t||"function"===t)}},{key:"isObjectLike",value:function(e){return"object"===(void 0===e?"undefined":(0,i.default)(e))&&null!==e}},{key:"isFunction",value:function(e){return"function"==typeof e}},{key:"isLength",value:function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},{key:"isString",value:function(t){var r=void 0===t?"undefined":(0,i.default)(t);return"string"===r||"object"===r&&null!==t&&!Array.isArray(t)&&"[object String]"===e.getTag(t)}},{key:"isSymbol",value:function(t){var r=void 0===t?"undefined":(0,i.default)(t);return"symbol"===r||"object"===r&&null!==t&&"[object Symbol]"===e.getTag(t)}},{key:"isUndefined",value:function(e){return void 0===e}},{key:"isNull",value:function(e){return null===e}},{key:"isArray",value:function(e){return Array.isArray(e)}},{key:"isArrayLike",value:function(t){return null!==t&&"function"!=typeof t&&e.isLength(t.length)}},{key:"isArrayLikeObject",value:function(t){return e.isObjectLike(t)&&e.isArrayLike(t)}},{key:"isNil",value:function(e){return null===e}},{key:"isNumber",value:function(t){return"number"==typeof t||e.isObjectLike(t)&&"[object Number]"===e.getTag(t)}},{key:"isPlainObject",value:function(t){if(!e.isObjectLike(t)||"[object Object]"!==e.getTag(t))return!1;if(null===(0,n.default)(t))return!0;for(var r=t;null!==(0,n.default)(r);)r=(0,n.default)(r);return(0,n.default)(t)===r}},{key:"isElement",value:function(t){return e.isObjectLike(t)&&1===t.nodeType&&!e.isPlainObject(t)}},{key:"isError",value:function(t){if(!e.isObjectLike(t))return!1;var r=e.getTag(t);return"[object Error]"===r||"[object DOMException]"===r||"string"==typeof t.message&&"string"==typeof t.name&&!e.isPlainObject(t)}},{key:"isArguments",value:function(t){return e.isObjectLike(t)&&"[object Arguments]"===e.getTag(t)}},{key:"isNative",value:function(t){return e.isObject(t)&&l.test(t)}},{key:"isBase64",value:function(e){return!!e.match(/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/)}}]),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(11)),i=g(r(3)),o=g(r(0)),a=g(r(2)),s=g(r(4)),l=g(r(7)),u=g(r(5)),c=g(r(40)),f=r(1),h=r(8),d=g(r(58)),p=g(r(69)),y=r(9);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,f.defaultValue)(e,{}),r.url=(0,f.defaultValue)(e.url,""),r.mapName=(0,f.defaultValue)(e.mapName,void 0),r.documentInfo=(0,f.defaultValue)(e.documentInfo,void 0),r.capabilities=[],r.renderMode=(0,f.defaultValue)(e.renderMode,"tile"),r.imageWidth=(0,f.defaultValue)(e.imageWidth,256),r.imageHeight=(0,f.defaultValue)(e.imageHeight,256),r.imageFormat=(0,f.defaultValue)(e.imageFormat,"png"),r.imageTransparency=(0,f.defaultValue)(e.imageTransparency,!0),r.dynamicProjectionEnabled=(0,f.defaultValue)(e.dynamicProjectionEnabled,!1),r._extentSrc=e.extent?d.default.fromJSON(e.extent):void 0,r._spatialReferenceSrc=e.spatialReference?y.SpatialReference.fromJSON(e.spatialReference):void 0,r._sublayers=(0,f.defaultValue)(e.sublayers,void 0),r._allSublayers=void 0,r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);e.url=this.url,e.mapName=this.mapName,e.documentInfo=this.documentInfo,e.capabilities=this.capabilities,e.imageWidth=this.imageWidth,e.imageHeight=this.imageHeight,e.imageFormat=this.imageFormat,e.imageTransparency=this.imageTransparency,e.dynamicProjectionEnabled=this.dynamicProjectionEnabled,e.spatialReference=(0,f.toJSON)(this.spatialReference,y.SpatialReference),e.extent=(0,f.toJSON)(this.extent,d.default);var r=[];return this.sublayers.forEach(function(e){r.push(e instanceof p.default?e.toJSON():e)}),e.sublayers=r,e}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"_getSubLayers",value:function(e,t){var r=this;t.add(e),e.sublayers&&e.sublayers instanceof h.Collection&&e.sublayers.items.length>0&&e.sublayers.forEach(function(e){r._getSubLayers(e,t)})}}]),t}(c.default);(0,n.default)(v.prototype,{allSublayers:{get:function(){var e=this;if(!this.loaded)return new h.Collection;if(!this._allSublayers){var t=new h.Collection;this._sublayers.forEach(function(r){e._getSubLayers(r,t)}),this._allSublayers=t}return this._allSublayers}},sublayers:{get:function(){return this.loaded?this._sublayers:new h.Collection},set:function(e){this._sublayers=e}},extent:{get:function(){return self.spatialReference?self.spatialReference.equals(self._spatialReferenceSrc)?this._extentSrc:h.Projection.project(this._extentSrc,self.spatialReference):this._extentSrc}},spatialReference:{get:function(){return this._spatialReferenceSrc},set:function(e){this._spatialReferenceSrc=e}}}),t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(7)),l=f(r(5)),u=f(r(40)),c=r(1);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.url=(0,c.defaultValue)(e.url,void 0),r.tokenKey=(0,c.defaultValue)(e.tokenKey,"token"),r.tokenValue=(0,c.defaultValue)(e.tokenValue,void 0),r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.url=this.url,e.tokenKey=this.tokenKey,e.tokenValue=this.tokenValue,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=d(r(40)),c=r(1),f=r(6),h=d(r(71));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.LayerType.tile,r.url=(0,c.defaultValue)(e.url,void 0),r.tileInfo=void 0,r.tileSliceType=f.TileSliceType.wmts,r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.url=this.url,e.tileInfo=(0,c.toJSON)(this.tileInfo,h.default),e.tileSliceType=this.tileSliceType,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(3)),i=h(r(0)),o=h(r(2)),a=h(r(4)),s=h(r(7)),l=h(r(5)),u=h(r(40)),c=r(1),f=r(6);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.LayerType.modelCache,r.url=(0,c.defaultValue)(e.url,""),r.version=void 0,r.position=void 0,r.spatialReference=void 0,r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.url=this.url,e.version=this.version,e.position=this.position,e.spatialReference=this.spatialReference?this.spatialReference.clone():null,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,c.defaultValue)(e,{}))}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(11)),i=f(r(3)),o=f(r(0)),a=f(r(2)),s=f(r(4)),l=f(r(5)),u=r(8),c=r(1);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.id=(0,c.defaultValue)(e.id,(0,c.getGUID)()),r.layer=(0,c.defaultValue)(e.layer,void 0),r.sublayers=(0,c.defaultValue)(e.sublayers,new u.Collection),r.title=(0,c.defaultValue)(e.title||e.layerName,void 0),r._visible=(0,c.defaultValue)(e.visible,!0),r._opacity=(0,c.defaultValue)(e.opacity,1),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=[];return this.sublayers.forEach(function(r){e.push((0,c.toJSON)(r,t))}),{id:this.id,sublayers:e,title:this.title,visible:this.visible}}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(f(r(69)).default);(0,n.default)(h.prototype,{visible:{get:function(){return this._visible},set:function(e){this._visible=e,this.sublayers.forEach(function(t){t.visible=e})}},opacity:{get:function(){return this._opacity},set:function(e){this._opacity=e,this.sublayers.forEach(function(t){t.opacity=e})}}}),t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=b(r(11)),i=b(r(10)),o=b(r(16)),a=b(r(14)),s=b(r(3)),l=b(r(0)),u=b(r(2)),c=b(r(4)),f=b(r(7)),h=b(r(5)),d=r(15),p=r(8),y=r(6),g=r(1),v=r(25),m=r(9),_=b(r(227)),S=r(49),x=r(59);function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){function t(e){(0,l.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));if(e=(0,g.defaultValue)(e,{}),r.type=y.LayerType.igsMapImage,r.renderMode=(0,g.defaultValue)(e.renderMode,"tile"),r.clientId=(0,g.defaultValue)(e.clientId,void 0),!r.clientId){var n=localStorage.getItem("MapGIS-MapServer-ClientId");n?r.clientId=n:(r.clientId=(0,g.getGUID)(),localStorage.setItem("MapGIS-MapServer-ClientId",r.clientId))}r._isAntialiasing=(0,g.defaultValue)(e.isAntialiasing,void 0),r.description="IGS地图服务图层",r._clippingArea=(0,g.defaultValue)(e.clippingArea,null),r._igsVersion="2.0";var i=r.url.split("MapServer/");if(1===i.length)r._url=i[0];else{r._url=i[0]+"MapServer";var o=i[1],a=void 0;r._sublayers&&(a=r._sublayers.filter(function(e){return e.id===o})),r._sublayers=a||[{id:o}]}return r._mapServer=new v.MapServer({url:r._url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r._flatServerSublayerInfosCache=[],r._serverSpatialReference=void 0,r}return(0,h.default)(t,e),(0,u.default)(t,[{key:"load",value:function(){return(0,f.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"load",this).call(this)}},{key:"_load",value:function(){var e=this;return this._mapServer.queryServerInfo().then(function(t){g.Log.info("MapServer信息查询成功:",t);var r=t.data,n={};if(e.url.indexOf("/igs/rest/services/")>-1){if(e._igsVersion="2.0",e.documentInfo=(0,g.defaultValue)(e.documentInfo,r.documentInfo),e.mapName=(0,g.defaultValue)(e.mapName,r.mapName),e.title||(e.title=r.mapName),0===e.capabilities.length&&(e.capabilities=r.childResources.split(",")),e.dynamicProjectionEnabled=(0,g.defaultValue)(e.dynamicProjectionEnabled,r.dynamicProjectionEnabled),r.spatialReference&&(e._serverSpatialReference=new m.SpatialReference({wkid:r.spatialReference.wkid,wkt:r.spatialReference.wkt}),e._spatialReferenceSrc||(e._spatialReferenceSrc=new m.SpatialReference({wkid:r.spatialReference.wkid,wkt:r.spatialReference.wkt}))),!e._extentSrc&&!(0,g.isNull)(r.extent)){var i=new m.SpatialReference(r.spatialReference);e._extentSrc=new m.Extent({xmin:r.extent.xmin,ymin:r.extent.ymin,xmax:r.extent.xmax,ymax:r.extent.ymax,spatialReference:i}),i.equals(e._spatialReferenceSrc)||(e._extentSrc=p.Projection.project(e._extentSrc,e._spatialReferenceSrc))}}else e._igsVersion="1.0",n.mapIndex="0",e._spatialReferenceSrc||g.Log.error("IGS1.0服务必须设置参考系"),e._extentSrc||(0,g.isNull)(r.xMin)||(0,g.isNull)(r.yMin)||(0,g.isNull)(r.xMax)||(0,g.isNull)(r.yMax)||(e._extentSrc=new m.Extent({xmin:r.xMin,ymin:r.yMin,xmax:r.xMax,ymax:r.yMax,spatialReference:e._spatialReferenceSrc})),e.mapName=r.name,e.title||(e.title=r.name);return e._mapServer.queryLayerList(n).then(function(t){g.Log.info("子图层信息查询成功:",t);var r=[];if("2.0"===e._igsVersion)r=t.data.layers;else{r=t.data;for(var n=0;n<r.length;n++)r[n].visible="Visible"===r[n].State,r[n].index=r[n].LayerIndex,r[n].type="Unknown"===r[n].GeomType?"Group":r[n].GeomType}e._flatServerSublayerInfosCache=[],(0,S.flatServerSublayerInfos)(r,e._flatServerSublayerInfosCache);for(var i=new p.Collection,o=function(t){var n=r[t],o=!0,a={},s=(0,S.toSublayerArr)(e._sublayers);if(s&&(o=!1,s.some(function(e){return String(n.index)===String(e.id)})&&(o=!0,a=s[s.findIndex(function(e){return String(n.index)===String(e.id)})])),o){var l=e._createIGSMapImageSubLayer(n,a);i.add(l)}},s=0;s<r.length;s++)o(s);return e._sublayers=i,e.loadStatus=y.LoadStatus.loaded,e.loaded=!0,new a.default(function(t){t(e)})})})}},{key:"toJSON",value:function(){var e=(0,f.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"toJSON",this).call(this);return e.description=this.description,e.documentInfo=this.documentInfo,e.renderMode=this.renderMode,e}},{key:"_createIGSMapImageSubLayer",value:function(e,t){e=e||{},t=t||{};var r={};this._createSublayerOptions(r,e,t);var n=new _.default(r);return n.layer=this,n}},{key:"_createSublayerOptions",value:function(e,t,r){var n=this;e.url=t.url,e.name=t.name,e.type=t.type,e.fields=t.fields,e.geomType=t.geomType,e.maxScale=t.maxScale,e.minScale=t.minScale,e.range=t.range,e.systemLibGuid=t.systemLibGuid,e.systemLibName=t.systemLibName,e.index=t.index,e.visible=t.visible;var i=(t.filter||{}).where;(i||r.definitionExpression)&&(e.definitionExpression=i,r.definitionExpression&&r.definitionExpression!==i&&(e.definitionExpression=r.definitionExpression));var a=Array.isArray(t.children)?t.children:[],s=r.sublayers,l=[];return a.forEach(function(e){var t={},r=!0,i=void 0;s&&Array.isArray(s)?(r=!1,(i=s.find(function(t){return String(t.id)===String(e.index)}))&&(r=!0)):i={},r&&(n._createSublayerOptions(t,e,i),l.push(t))}),(e=(0,o.default)(e,r)).sublayers=l,e}},{key:"findSublayerById",value:function(e){if(this.loadStatus===y.LoadStatus.loaded&&this.allSublayers)for(var t=0;t<this.allSublayers.items.length;t++)if(String(this.allSublayers.items[t].id)===String(e))return this.allSublayers.items[t]}},{key:"fetchImage",value:function(e,t,r){t=(0,g.defaultValue)(t,256),r=(0,g.defaultValue)(r,256);var n=this.getImageUrl({extent:e,width:t,height:r});return new a.default(function(e){var i=new Image;i.src=n,i.width=t,i.height=r,e(i)})}},{key:"getImageUrl",value:function(e){return this._mapServer.getImage(e)}},{key:"setSubLayer",value:function(e){(0,S.setSublayer)(this,e,_.default),(0,S.fireEvent)(this,y.LayerEventType.layerUpdate,y.LayerEventType.layerSublayerVisible)}},{key:"getFilters",value:function(){var e={};return this.allSublayers.forEach(function(t){var r=t.definitionExpression,n=t.geometryFilter,a=(0,g.defaultValue)(e[t.id],{});if(r&&(a.where=r),n){var s=(0,x.getGeometryFilter)(n.geometry,n.spatialReference);s&&(0,o.default)(a,s)}"{}"!==(0,i.default)(a)&&(e[t.id]=a)}),"{}"===(0,i.default)(e)?void 0:e}}],[{key:"clone",value:function(e){return new t(e.toJSON())}},{key:"fromJSON",value:function(e){var r=this,n=new t(e=(0,g.defaultValue)(e,{}));n.loadStatus=y.LoadStatus.loaded,n.loaded=!0;var i=e.sublayers||[],o=new p.Collection;return i.forEach(function(e){var t=new _.default(e);t.layer=r,o.add(t)}),n._sublayers=o,n.loadStatus=y.LoadStatus.loaded,n.loaded=!0,n}}]),t}(d.MapImageLayer);(0,n.default)(w.prototype,{clippingArea:{get:function(){return this._clippingArea},set:function(e){this._clippingArea=e,this._fireUpdateEvent("空间裁剪区域",[{name:"clippingArea",params:[this._clippingArea],dataChanged:!0,operationType:"property"}])}},layers:{get:function(){var e="show:";if(this.allSublayers.forEach(function(t){"Group"!==t.type&&t.visible&&(e+=t.id+",")}),5===e.length){var t=this._flatServerSublayerInfosCache,r="";Array.isArray(t)&&t.length>0?(t.forEach(function(e){"Group"!==e.type&&(r+=e.index+",")}),r=r.substring(0,r.length-1)):g.Log.info("服务器图层缓存为空，暂时不支持隐藏全部图层"),e="hide:"+r}else e=e.substring(0,e.length-1);return e}},isAntialiasing:{get:function(){return this._isAntialiasing},set:function(e){this._isAntialiasing=e,this._fireUpdateEvent("服务端抗锯齿",[{name:"refresh",params:[this._isAntialiasing],dataChanged:!0,operationType:"property"}])}}}),t.default=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(11)),i=v(r(14)),o=v(r(3)),a=v(r(0)),s=v(r(2)),l=v(r(4)),u=v(r(7)),c=v(r(5)),f=r(15),h=r(1),d=r(6),p=r(25),y=r(9),g=v(r(86));function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r.type=d.LayerType.igsTile,r.description="IGS瓦片图层",r.mapName=(0,h.defaultValue)(e.mapName,""),r._clippingArea=(0,h.defaultValue)(e.clippingArea,null),r._igsVersion="2.0",r.url.indexOf("/igs/rest/mrms/tile/")>-1&&(r._igsVersion="1.0"),r._tileServer=new p.TileServer({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"load",value:function(){return(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"load",this).call(this)}},{key:"_load",value:function(){var e=this;return this._tileServer.queryServerInfo().then(function(t){h.Log.info("TileServer信息查询成功:",t);var r=t.data;return"1.0"===e._igsVersion?(e.tileSize=r.tileWidth,e.tileInfo=g.default.parseTileInfo1(r),e.tileInfo.origin.spatialReference=e._spatialReference,e.tileInfo.spatialReference=e._spatialReference,e._spatialReference||h.Log.error("IGS1.0服务必须设置参考系"),e.extent=new y.Extent({xmin:r.xMin,ymin:r.yMin,xmax:r.xMax,ymax:r.yMax,spatialReference:y.SpatialReference.fromJSON(e._spatialReference)})):(e.mapName=r.mapName,e.tileSize=r.tileInfo.cols,e.tileInfo=g.default.parseTileInfo2(r.tileInfo),e.spatialReference=new y.SpatialReference(e.tileInfo.spatialReference),e.extent=new y.Extent({xmin:r.extent.xmin,ymin:r.extent.ymin,xmax:r.extent.xmax,ymax:r.extent.ymax,spatialReference:y.SpatialReference.fromJSON(e.spatialReference)})),e.title||(e.title=r.mapName),new i.default(function(t){e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){h.Log.error("TileServer信息查询失败:",e)})}},{key:"getTileUrl",value:function(e,t,r){return this.url+"/tileImage/"+e+"/"+t+"/"+r+"?f=image"}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);e.description=this.description,e.url=this.url,e.mapName=this.mapName,e.tileSize=this.tileSize;var r={size:this.tileInfo.size,dpi:this.tileInfo.dpi,format:this.tileInfo.format,spatialReference:(0,h.toJSON)(this.tileInfo.spatialReference,y.SpatialReference),origin:(0,h.toJSON)(this.tileInfo.origin,y.Point),lods:this.tileInfo.lods};return e.tileInfo=r,e}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,h.defaultValue)(e,{}));return r.tileSize=e.tileSize,r.tileInfo={dpi:e.tileInfo.dpi,format:e.tileInfo.format,size:e.tileInfo.size,spatialReference:y.SpatialReference.fromJSON(e.tileInfo.spatialReference),lods:e.tileInfo.lods,origin:y.Geometry.fromJSON(e.tileInfo.origin)},r.spatialReference=y.SpatialReference.fromJSON(e.spatialReference),r.extent=y.Geometry.fromJSON(e.extent),r.loadStatus=d.LoadStatus.loaded,r.loaded=!0,r}}]),t}(f.TileLayer);(0,n.default)(m.prototype,{clippingArea:{get:function(){return this._clippingArea},set:function(e){this._clippingArea=e,this._fireUpdateEvent("空间裁剪区域",[{name:"clippingArea",params:[this._clippingArea],dataChanged:!0,operationType:"property"}])}}}),t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=S(r(16)),i=S(r(14)),o=S(r(3)),a=S(r(0)),s=S(r(2)),l=S(r(4)),u=S(r(7)),c=S(r(5)),f=r(8),h=r(25),d=r(1),p=r(6),y=r(15),g=S(r(228)),v=S(r(142)),m=r(19),_=r(9);function S(e){return e&&e.__esModule?e:{default:e}}var x=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,d.defaultValue)(e,{}),r.url=(0,d.defaultValue)(e.url,""),r.type=p.LayerType.scene,r.version=void 0,r.boundingVolume=void 0,r.boundingSphere=void 0,r.sceneName=void 0,r.sceneIndex=void 0,r.fieldInfo=void 0,r.position=void 0,r.spatialReference=void 0,r.description="场景图层",r.scenes=(0,d.defaultValue)(e.scenes,[]),r._sceneServer=new h.SceneServer({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r._getSubLayerFromUrl(),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"_load",value:function(){var e=this;return this._sceneServer.queryServerInfo().then(function(t){if(d.Log.info("SceneServer信息查询成功:",t),"2.0"===e._sceneServer.igsType){var r=t.data;return e._initLayerInfo(r),e._sceneServer.queryLayerListInfo().then(function(t){var n=t.data.layers,o=[],a={};e.scenes.length>=1&&(a=e.scenes[0],o=e.scenes[0].sublayers||[]);var s=e._getSubLayerInitOptions(n,o,o.length>0),l=new f.Collection;e._initSubLayers(s,l);var u=e._getSceneInitOptions(r,a,l);return e.scenes=[new g.default(u)],e.activeScene=e.scenes[0],new i.default(function(t){e.loadStatus=p.LoadStatus.loaded,e.loaded=!0,t(e)})})}var n=t.data.sceneInfos[0];n.docName=t.data.docName,e._initLayerInfo(n);var o=n.layers,a=[],s={};e.scenes.length>=1&&(s=e.scenes[0],a=e.scenes[0].sublayers);var l=e._getSubLayerInitOptions(o,a),u=new f.Collection;e._initSubLayers(l,u);var c=e._getSceneInitOptions(n,s,u);return e.scenes=[new g.default(c)],e.activeScene=e.scenes[0],new i.default(function(t){e.loadStatus=p.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){d.Log.info("SceneServer信息查询失败:",e)})}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);e.url=this.url,e.version=this.version,e.boundingVolume=this.boundingVolume,e.sceneName=this.sceneName,e.sceneIndex=this.sceneIndex,e.fieldInfo=this.fieldInfo,e.position=this.position,e.documentInfo=this.documentInfo,e.activeScene=(0,d.toJSON)(this.activeScene,g.default),e.boundingSphere={radius:this.boundingSphere.radius,center:{x:this.boundingSphere.center.x,y:this.boundingSphere.center.y,z:this.boundingSphere.center.z}};for(var r=[],n=0;n<this.scenes.length;n++)r.push((0,d.toJSON)(this.scenes[n],g.default));return e.scenes=r,e}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"_initLayerInfo",value:function(e){this.sceneName=e.sceneName,this.sceneIndex=e.sceneIndex,this.documentInfo=e;var t=e.sceneRange;this.boundingSphere={},this.boundingSphere.center=Cesium.Cartesian3.fromDegrees((t.xMin+t.xMax)/2,(t.yMin+t.yMax)/2);var r=Cesium.Cartesian3.fromDegrees(t.xMax-t.xMin,t.yMax-t.yMin);this.boundingSphere.radius=Math.abs(Math.min(r.x,r.y)),"2.0"===this._sceneServer.igsType?this.title=this.title||e.documentInfo.title:this.title=this.title||e.docName}},{key:"_initSubLayers",value:function(e,t){for(var r=0;r<e.length;r++)t.add(new v.default(e[r]))}},{key:"_getSubLayerInitOptions",value:function(e,t){var r=this,i=[];return e.forEach(function(e){var o=void 0,a=!1;if(!Array.isArray(t)||Array.isArray(t)&&0===t.length)a=!0,o={sublayers:[]};else for(var s=0;s<t.length;s++)if(String(t[s].id)===String(e.layerIndex)||String(t[s].layerIndex)===String(e.layerIndex)){a=!0,!(o=t[s]).sublayers&&e.children&&e.children.length>0&&(o.sublayers=e.children),o.sublayers||(o.sublayers=[]),o.hasOwnProperty("opacity")&&o.sublayers.forEach(function(e){e.hasOwnProperty("opacity")?e.opacity*=o.opacity:e.opacity=o.opacity}),o.hasOwnProperty("visible")&&o.sublayers.forEach(function(e){e.hasOwnProperty("visible")?e.visible=e.visible&&o.visible:e.visible=o.visible}),o.hasOwnProperty("labelingInfo")&&(e.labelingInfo=(0,n.default)(e.labelingInfo||{},o.labelingInfo)),o.hasOwnProperty("spatialReference")&&(e.spatialReference=o.spatialReference?_.SpatialReference.fromJSON(o.spatialReference):void 0);break}if(a){var l={id:e.layerIndex,layerIndex:e.layerIndex,layerRenderIndex:e.layerRenderIndex,layerType:e.layerType,renderType:e.layerRenderType,labelingInfo:e.labelingInfo,beginLevel:e.beginLevel,endLevel:e.endLevel,renderer:e.renderer,originalPoints:e.originalPoints,frameSizes:e.frameSizes,url:e.url,range:e.range,range3D:e.range3D,layer:r,sublayers:r._getSubLayerInitOptions(e.children||[],o.sublayers),elevationScale:e.elevationScale,requestVertexNormals:e.requestVertexNormals,labelLayer:e.labelLayer,layerName:e.layerName,opacity:(0,d.defaultValue)(e.opacity,1),visible:(0,d.defaultValue)(e.visible,!0),title:e.title,spatialReference:e.spatialReference},u=l.sublayers;(l=(0,n.default)(l,o)).sublayers=u,i.push(l)}}),i}},{key:"_getSceneInitOptions",value:function(e,t,r){var i={sceneIndex:e.sceneIndex,sceneName:e.sceneName,sceneMode:e.sceneMode,sceneRange:e.sceneRange,layer:this};return(i=(0,n.default)(i,t)).sublayers=r,i}},{key:"_getSubLayerFromUrl",value:function(){var e=void 0,t=void 0,r=void 0;if("1.0"===this._sceneServer.igsType?(r=(t=this.url.split("/igs/rest/g3d/"))[t.length-1].split("/")).length>1&&(e=r[r.length-1]):(t=this.url.split("/SceneServer/")).length>1&&(e=t[t.length-1]),e){var n=void 0;if(this.scenes&&this.scenes instanceof Array&&this.scenes[0]&&this.scenes[0].sublayers&&this.scenes[0].sublayers instanceof Array&&(n=this.scenes[0].sublayers.filter(function(t){return String(t.id)===e})[0]),this.scenes=n?[{sublayers:[n]}]:[{sublayers:[{id:e}]}],"1.0"===this._sceneServer.igsType){this.url=t[0]+"/igs/rest/g3d/";for(var i=0;i<r.length-1;i++)this.url+=r[i];this._sceneServer._url=this.url}else this.url=t[0]+"/SceneServer",this._sceneServer._url=this.url}}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,m.jsonClone)(e));r.documentInfo=e.documentInfo,r.boundingSphere=e.boundingSphere,r.boundingSphere.center=new Cesium.Cartesian3(e.boundingSphere.center.x,e.boundingSphere.center.y,e.boundingSphere.center.z);for(var n=[],i=0;i<e.scenes.length;i++)n.push(new g.default(e.scenes[i]));r.scenes=n;for(var o=0;o<r.scenes.length;o++)for(var a=0;a<r.scenes[o].sublayers.length;a++)r.scenes[o].sublayers[a]=new v.default(r.scenes[o].sublayers[a]);return r.activeScene=n[0],r}}]),t}(y.SceneLayer);t.default=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=w(r(11)),i=w(r(16)),o=w(r(14)),a=w(r(3)),s=w(r(0)),l=w(r(2)),u=w(r(4)),c=w(r(7)),f=w(r(5)),h=r(15),d=r(6),p=r(1),y=r(25),g=r(9),v=w(r(126)),m=r(19),_=w(r(101)),S=r(190),x=w(r(229)),b=r(8);function w(e){return e&&e.__esModule?e:{default:e}}var k=function(e){function t(e){(0,s.default)(this,t);var r=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));e=(0,p.defaultValue)(e,{}),r.url=(0,p.defaultValue)(e.url,void 0),r.type=d.LayerType.igsFeature,r.gdbp=(0,p.defaultValue)(e.gdbp,""),r.outFields=(0,p.defaultValue)(e.outFields,null),r.capabilities=[],r.sublayerId=(0,p.defaultValue)(e.sublayerId,0),r.supportArc3=(0,p.defaultValue)(e.supportArc3,!0),r.labelsVisible=(0,p.defaultValue)(e.labelsVisible,!1);for(var n=[],i=(0,p.defaultValue)(e.labelingInfo,[]),o=0;o<i.length;o++)n.push(new _.default(i[o]));r.labelingInfo=n,r.renderMode=(0,p.defaultValue)(e.renderMode,"client"),r.timeInfo=e.timeInfo?b.TimeInfo.fromJSON(e.timeInfo):null,r._timeExtent=e.timeExtent?b.TimeExtent.fromJSON(e.timeExtent):null,r._definitionExpression=(0,p.defaultValue)(e.definitionExpression,""),r._serverFilter=e.serverFilter?x.default.fromJSON(e.serverFilter):null,r._igsVersion="2.0";var l={url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers},c=(0,m.getBaseUrl)(r.url),f=y.UrlUtil.getBaseUrlAndParams(r.url),h=y.UrlUtil.getStringFromObject(f.params);return h&&(h="?"+h),r.url.indexOf("/igs/rest/mrfs/layer")>-1||r.url.indexOf("/igs/rest/mrfs/docs")>-1?(r._igsVersion="1.0",r._resourceServer=new y.ResourceServer({url:c+"/igs/rest/mrcs"+h,headers:r.headers,tokenKey:r.tokenKey,tokenValue:r.tokenValue}),r._featureServer=new y.FeatureServer(l)):(r._igsVersion="2.0",r._resourceServer=new y.ResourceServer({url:c+"/igs/rest/services/system/ResourceServer"+h,headers:r.headers,tokenKey:r.tokenKey,tokenValue:r.tokenValue}),function(){var e=r.url.match(/^.*FeatureServer/),t=r.url.match(/^.*\/igs\/rest\/mrfs\/docs\//);if(e){var n=e[0];if(r.url.length!==n.length){var i=r.url.length-n.length,o=r.url.substr(n.length+1,i-1);r.sublayerId=o,r.url=n}}else if(t){var a=t[0],s=r.url.replace(a,"");if(s){var l=s.split("/");l.length>1&&(r.url=a+l[0],r.sublayerId=l[1])}}}(),l.url=r.url,r._featureServer=new y.FeatureServer(l)),r}return(0,f.default)(t,e),(0,l.default)(t,[{key:"load",value:function(){return(0,c.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"load",this).call(this)}},{key:"_load",value:function(){var e=this;return"client"===e.renderMode||"grid"===e.renderMode?this.gdbp?"1.0"===this._igsVersion?this._resourceServer.queryGDBPInfo({gdbpUrl:this.gdbp}).then(function(t){var r=t.data;return e._processDataInfo(e,r),new o.default(function(t){e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){p.Log.error("资源服务获取图层信息失败:",e)}):this._resourceServer.queryTempDataInfo({method:d.FetchMethod.get,url:this.gdbp}).then(function(t){var r=t.data;return e._processDataInfo(e,r),new o.default(function(t){e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){p.Log.error("资源服务获取图层信息失败:",e)}):e._featureServer.queryLayerInfo({layerId:""+e.sublayerId}).then(function(t){var r=t.data;return e.title||(e.title=r.name),e._processDataInfo(e,r),new o.default(function(t){e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){p.Log.error("要素服务图层信息获取失败:",e)}):"server"===e.renderMode?this.gdbp?"1.0"===this._igsVersion?this._resourceServer.queryGDBPInfo({gdbpUrl:this.gdbp}).then(function(t){var r=t.data;return e._processDataInfo(e,r),new o.default(function(t){e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){p.Log.error("资源服务获取图层信息失败:",e)}):this._resourceServer.queryTempDataInfo({method:d.FetchMethod.get,url:e.gdbp}).then(function(t){var r=t.data;return e._processDataInfo(e,r),new o.default(function(t){e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){p.Log.error("资源服务获取图层信息失败:",e)}):void p.Log.error("缺少gdbp数据，无法进行服务端出图"):void p.Log.error("无法解析渲染模式")}},{key:"queryFeatures",value:function(e){var t=this,r=this._createQueryOption(e);return(this.gdbp?this.url.indexOf("/igs/rest/mrfs/layer")>-1?this._featureServer.queryFeaturesInLayers(r):this._resourceServer.queryTempDataFeatures(r):this._featureServer.queryFeatures(r)).then(function(e){var r=e.data;r||p.Log.error("添加图层视图失败，未获取到请求数据");var n=r.featureSet;return t._setFeatureSetSpatialReference(n),n||p.Log.error("添加图层视图失败，未获取到几何要素信息"),n})}},{key:"queryFeaturesCount",value:function(e){if(!this.gdbp){var t=this._createQueryOption(e);return t.returnCountOnly=!0,this._featureServer.queryFeatures(t).then(function(e){var t=e.data;return t||p.Log.error("添加图层视图失败，未获取到请求数据"),t.count})}p.Log.error("gdbp模式不支持查询要素条数,igs1.0不支持此操作")}},{key:"toJSON",value:function(){var e=(0,c.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"toJSON",this).call(this);e.url=this.url,e.gdbp=this.gdbp,e.outFields=this.outFields,e.capabilities=this.capabilities,e.sublayerId=this.sublayerId,e.labelsVisible=this.labelsVisible,e.renderMode=this.renderMode,e.definitionExpression=this.definitionExpression,e.serverFilter=this.serverFilter?this.serverFilter.toJSON():null,e.timeExtent=this.timeExtent?this._timeExtent.toJSON():null,e.timeInfo=this.timeInfo?this.timeInfo.toJSON():null;for(var r=[],n=0;n<this.labelingInfo.length;n++)r.push((0,p.toJSON)(this.labelingInfo[n],_.default));return e.labelingInfo=r,e}},{key:"_reloadFeatures",value:function(){if(!this._reloadFeaturesPromise){var e=this._createQueryOption();e.resultRecordCount=1e5,this._reloadFeaturesPromise=this.queryFeatures(e)}return this._reloadFeaturesPromise}},{key:"_createQueryOption",value:function(e){var t=(0,p.defaultValue)(e,{}),r={layerId:""+this.sublayerId,where:this.definitionExpression||"",supportArc3:this.supportArc3,outSrs:"EPSG:4326",method:this.httpMethod};if(this.outFields&&Array.isArray(this.outFields)&&(0===this.outFields.length?r.outFields=",":r.outFields=this.outFields.join(",")),this._serverFilter){var n=this._serverFilter,o=n.distance,a=n.units,s=n.geometry,l=n.objectIds,u=n.spatialRelation,c=n.where;if(s){var f=this.spatialReference,h=b.Projection.projectGeometry(s,f),y=S.LengthUnitToMeter[a];y||(y=1,p.Log.error("传入的长度单位有误，请检查传入参数"));var g=void 0,v=!1,m=(0,S.getMetersPerSpatialReference)(f);f.isGeographic?(v=!0,g=o*y/S.DegreesUnitToMeter.degrees):g=o*y/m,r.distance=g,r.spatialRelation=u,h.type===d.GeometryType.circle&&(h.radius=h.radius*S.RadiusUnitToMeter[h.radiusUnit]/m,h.radiusUnit=v?d.RadiusUnit.degrees:d.RadiusUnit.meters),r.geometry=h,r.inSrs="EPSG:"+h.spatialReference.wkid}Array.isArray(l)&&(0===l.length?r.objectIds=",":r.objectIds=l.join(",")),c&&!r.where&&(r.where=c)}return this.gdbp&&(this.url.indexOf("/igs/rest/mrfs/layer")>-1?(t.gdbp=this.gdbp,t.pageCount=t.resultRecordCount):t.url=this.gdbp),(0,i.default)(r,t)}},{key:"_processDataInfo",value:function(e,t){if(!t)throw new Error("要素服务源数据请求失败");if(!e._spatialReference){var r=t.srsName||t.SRSName||t.SrName;if(t.spatialReference)e._spatialReference=g.SpatialReference.fromJSON(t.spatialReference);else if(r&&v.default.find(function(e){return e.name===r})){var n=v.default.find(function(e){return e.name===r});e._spatialReference=new g.SpatialReference({wkid:n.id,wkt:n.strProject})}else e._spatialReference=new g.SpatialReference("EPSG:4326")}if((0,p.isNull)(e.extent)){var i=e.extent||t.extent||t.Range||t.range;i&&(e.extent=new g.Extent({xmin:i.xmin,ymin:i.ymin,xmax:i.xmax,ymax:i.ymax,spatialReference:e._spatialReference}))}t.capabilities&&(e.capabilities=Array.isArray(t.capabilities)?t.capabilities:[t.capabilities]),t.geometryType?e.geometryType=t.geometryType:t.GeomType&&(e.geometryType=t.GeomType)}},{key:"_setFeatureSetSpatialReference",value:function(e){e||p.Log.error("服务器请求错误,未返回FeatureSet数据，请检查服务状态");var t=this;(!e.spatialReference||e.spatialReference&&0===e.spatialReference.wkid)&&(e.spatialReference=t._spatialReference,e.features.forEach(function(e){e&&e.geometry&&(e.geometry.spatialReference=t._spatialReference)}))}}],[{key:"fromJSON",value:function(e){for(var r=new t(e=(0,m.jsonClone)(e)),n=[],i=0;i<e.labelingInfo.length;i++)n.push(new _.default(e.labelingInfo[i]));return r.labelingInfo=n,r.loadStatus=d.LoadStatus.loaded,r.loaded=!0,r}}]),t}(h.FeatureLayer);(0,n.default)(k.prototype,{definitionExpression:{get:function(){return this._definitionExpression},set:function(e){this._definitionExpression=e,this._reloadFeaturesPromise=null,this.loaded&&this.refresh()}},serverFilter:{get:function(){return this._serverFilter},set:function(e){this._serverFilter=x.default.fromJSON(e),this._reloadFeaturesPromise=null,this.loaded&&this.refresh()}},timeExtent:{get:function(){return this._timeExtent},set:function(e){this._timeExtent=b.TimeExtent.fromJSON(e),this._fireUpdateEvent("设置时间范围",[{name:"timeExtent",params:[this._timeExtent],dataChanged:!0,operationType:"property"}])}}}),t.default=k},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ISSceneSubLayer=t.ISScene=t.ISSceneLayer=void 0;var n=a(r(527)),i=a(r(230)),o=a(r(231));function a(e){return e&&e.__esModule?e:{default:e}}t.ISSceneLayer=n.default,t.ISScene=i.default,t.ISSceneSubLayer=o.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(14)),i=v(r(16)),o=v(r(3)),a=v(r(0)),s=v(r(2)),l=v(r(4)),u=v(r(7)),c=v(r(5)),f=(r(8),r(25)),h=r(1),d=r(6),p=r(15),y=r(19),g=v(r(230));function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r.url=(0,h.defaultValue)(e.url,""),r.type=d.LayerType.iserverScene,r.version=void 0,r.boundingVolume=void 0,r.boundingSphere=void 0,r.sceneName=void 0,r.position=void 0,r.spatialReference=void 0,r.description="IS场景图层",r.scenes=(0,h.defaultValue)(e.scenes,[]),r._sceneServer=new f.ISSceneServer({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"_load",value:function(){var e=this;return this._sceneServer.querySceneListInfo().then(function(t){h.Log.info("SceneServer信息查询成功:",t);var r=void 0;e.scenes.length>0?e.scenes.forEach(function(e){r=t.data.filter(function(t){return e.name===t.name})}):r=t.data,e.subLayers=[],e.scenes=r;var o=r.map(function(t,r){return e._sceneServer.queryLayerListInfoBySceneName({sceneName:t.name}).then(function(n){console.info(n),t.subLayers=[];var o=[];if(e.scenes&&e.scenes.length>0){var a=e.scenes.find(function(e){return e.name===t.name});o=a&&a.subLayers}var s=[];o&&o.length>0?o.forEach(function(e){n.data.map(function(t){e.name===t.name&&(t=(0,i.default)(t,e),s.push(t))})}):s=n.data,(s=n.data).map(function(r){r.configUrl=e.url+"/datas/"+r.name+"/config",r.layer=e,t.subLayers.push(r)}),t instanceof g.default||(t=new g.default({sceneIndex:t.sceneIndex?t.sceneIndex:r,sceneName:t.name?t.name:"",resourceConfigId:t.resourceConfigID?t.resourceConfigID:"",supportedMediaTypes:t.supportedMediaTypes?t.supportedMediaTypes:[],resourceType:t.resourceType?t.resourceType:"",sublayers:t.subLayers?t.subLayers:[]}),e.scenes[r]=t),0===r&&(e.activeScene=t,e.subLayers=e.subLayers.concat(t.sublayers.items))})});return n.default.all(o).then(function(){return new n.default(function(t){e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,t(e)})})}).catch(function(e){h.Log.info("SceneServer信息查询失败:",e)})}},{key:"_getSubLayerInitOptions",value:function(e){var t={id:_subLayer.layerIndex,layerIndex:_subLayer.layerIndex,layerRenderIndex:_subLayer.layerRenderIndex,layerType:_subLayer.layerType,renderType:_subLayer.layerRenderType,labelingInfo:_subLayer.labelingInfo,beginLevel:_subLayer.beginLevel,endLevel:_subLayer.endLevel,renderer:_subLayer.renderer,originalPoints:_subLayer.originalPoints,frameSizes:_subLayer.frameSizes,url:_subLayer.url,range:_subLayer.range,range3D:_subLayer.range3D,layer:this,sublayers:this._getSubLayerInitOptions(_subLayer.children||[],_inputSubLayerInfo.sublayers),elevationScale:_subLayer.elevationScale,requestVertexNormals:_subLayer.requestVertexNormals,labelLayer:_subLayer.labelLayer,layerName:_subLayer.layerName,opacity:(0,h.defaultValue)(_subLayer.opacity,1),visible:(0,h.defaultValue)(_subLayer.visible,!0),title:_subLayer.title,spatialReference:_subLayer.spatialReference},r=t.sublayers;return(t=(0,i.default)(t,_inputSubLayerInfo)).sublayers=r,_subLayerInitOptions.push(t),_subLayerInitOptions}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.url=this.url,e.version=this.version,e.boundingVolume=this.boundingVolume,e.sceneName=this.sceneName,e.position=this.position,e.boundingSphere={radius:this.boundingSphere.radius,center:{x:this.boundingSphere.center.x,y:this.boundingSphere.center.y,z:this.boundingSphere.center.z}},e.scenes=this.scenes,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,y.jsonClone)(e));return r.boundingSphere=e.boundingSphere,r.boundingSphere.center=new Cesium.Cartesian3(e.boundingSphere.center.x,e.boundingSphere.center.y,e.boundingSphere.center.z),r.scenes=e.scenes,r}}]),t}(p.SceneLayer);t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArcGISVectorTileLayer=t.ArcGISTileLayer=t.ArcGISMapImageSubLayer=t.ArcGISMapImageLayer=void 0;var n=s(r(529)),i=s(r(232)),o=s(r(531)),a=s(r(532));function s(e){return e&&e.__esModule?e:{default:e}}t.ArcGISMapImageLayer=n.default,t.ArcGISMapImageSubLayer=i.default,t.ArcGISTileLayer=o.default,t.ArcGISVectorTileLayer=a.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(r(11)),i=_(r(14)),o=_(r(10)),a=_(r(16)),s=_(r(3)),l=_(r(0)),u=_(r(2)),c=_(r(4)),f=_(r(5)),h=_(r(530)),d=r(6),p=r(1),y=r(25),g=r(9),v=_(r(232)),m=r(49);function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){(0,l.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return e=(0,p.defaultValue)(e,{}),r.type=d.LayerType.arcgisMapImage,r.description="ArcGIS地图图片图层",r._mapServer=new y.ArcGISMapServer({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,f.default)(t,e),(0,u.default)(t,[{key:"_load",value:function(){var e=this;return this._mapServer.queryServerInfo().then(function(t){p.Log.info("MapServer信息查询成功:",t);var r=t.data;return e.documentInfo=r.documentInfo,e.mapName=r.mapName,e.capabilities=r.capabilities,(0,p.isNull)(r.spatialReference)||(e._spatialReferenceSrc=new g.SpatialReference({wkid:r.spatialReference.latestWkid||r.spatialReference.wkid}),(0,p.isNull)(e.spatialReference)&&(e._spatialReference=g.SpatialReference.fromJSON(e._spatialReferenceSrc.toJSON()))),(0,p.isNull)(r.fullExtent)||(e._extentSrc=new g.Extent({xmin:r.fullExtent.xmin,ymin:r.fullExtent.ymin,xmax:r.fullExtent.xmax,ymax:r.fullExtent.ymax,spatialReference:e._spatialReferenceSrc})),e._mapServer.getLayers({}).then(function(t){p.Log.info("子图层信息查询成功:",t);var r=t.data.layers;e.serviceSublayers=r;for(var n=0;n<r.length;n++)r[n].layer=e,e.allSublayers.push(new v.default(r[n]));for(var s=0;s<e._sublayers.length;s++)for(var l=0;l<e.allSublayers.length;l++)if(String(e._sublayers[s].id)===String(e.allSublayers[l].id)||String(e._sublayers[s].name)===String(e.allSublayers[l].name)){if(!(e._sublayers[s]instanceof v.default)){var u=(0,a.default)(JSON.parse((0,o.default)(e.allSublayers[l])),e._sublayers[s]);u.layer=e,u.id=String(u.id),e._sublayers[s]=new v.default(u),e.allSublayers[l]=new v.default(u)}break}return e._setLayers(),e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,new i.default(function(t){t(e)})})})}},{key:"findSublayerById",value:function(e){if(this.loadStatus===d.LoadStatus.loaded&&this.allSublayers&&this.allSublayers instanceof Array)for(var t=0;t<this.allSublayers.length;t++)if(String(this.allSublayers[t].id)===String(e))return this.allSublayers[t]}},{key:"refresh",value:function(){this._fireUpdateEvent("刷新图层",[{params:arguments,dataChanged:!0,name:"refresh",operationType:"method"}])}},{key:"fetchImage",value:function(e,t,r){t=(0,p.defaultValue)(t,256),r=(0,p.defaultValue)(r,256);var n=this.getImageUrl({extent:e,width:t,height:r});return new i.default(function(e){var i=new Image;i.src=n,i.width=t,i.height=r,e(i)})}},{key:"createServiceSublayers",value:function(){return this.serviceSublayers}},{key:"getImageUrl",value:function(e){return this._mapServer.getImage(e)}},{key:"setSubLayer",value:function(e){(0,m.setSublayer)(this,e,e),this._setLayers(),(0,m.fireEvent)(this,d.LayerEventType.layerUpdate,d.LayerEventType.layerSublayerVisible)}},{key:"_setLayers",value:function(){var e="show:";this.allSublayers.forEach(function(t){t.visible&&(e+=t.id+",")}),"show:"===e&&(e="exclude:",this.allSublayers.forEach(function(t){e+=t.id+","})),e=e.substring(0,e.length-1),this.layers=e}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,p.defaultValue)(e,{}));return r.loadStatus=d.LoadStatus.loaded,r.loaded=!0,r}}]),t}(h.default);(0,n.default)(S.prototype,{sublayers:{get:function(){return this._sublayers},set:function(e){this._sublayers=e}}}),t.default=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(11)),i=g(r(3)),o=g(r(0)),a=g(r(2)),s=g(r(4)),l=g(r(7)),u=g(r(5)),c=g(r(40)),f=r(1),h=r(8),d=g(r(58)),p=g(r(69)),y=r(9);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,f.defaultValue)(e,{}),r.url=(0,f.defaultValue)(e.url,""),r.mapName=(0,f.defaultValue)(e.mapName,void 0),r.documentInfo=(0,f.defaultValue)(e.documentInfo,void 0),r.capabilities=[],r.renderMode=(0,f.defaultValue)(e.renderMode,"tile"),r.imageWidth=(0,f.defaultValue)(e.imageWidth,256),r.imageHeight=(0,f.defaultValue)(e.imageHeight,256),r.imageFormat=(0,f.defaultValue)(e.imageFormat,"png"),r.imageTransparency=(0,f.defaultValue)(e.imageTransparency,!0),r.allSublayers=new h.Collection,r.dynamicProjectionEnabled=(0,f.defaultValue)(e.dynamicProjectionEnabled,!1),r._extentSrc=e.extent?d.default.fromJSON(e.extent):void 0,r._spatialReferenceSrc=(0,f.defaultValue)(e.spatialReference,void 0),r._sublayers=(0,f.defaultValue)(e.sublayers,new h.Collection),r._opacity=(0,f.defaultValue)(e.opacity,1),r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);e.url=this.url,e.mapName=this.mapName,e.documentInfo=this.documentInfo,e.capabilities=this.capabilities,e.imageWidth=this.imageWidth,e.imageHeight=this.imageHeight,e.imageFormat=this.imageFormat,e.imageTransparency=this.imageTransparency,e.dynamicProjectionEnabled=this.dynamicProjectionEnabled,e.spatialReference=(0,f.toJSON)(this.spatialReference,y.SpatialReference),e.extent=(0,f.toJSON)(this.extent,d.default);var r=[];this.sublayers.forEach(function(e){r.push(e instanceof p.default?e.toJSON():e)}),e.sublayers=r;var n=[];return this.allSublayers.forEach(function(e){n.push(e.toJSON())}),e.allSublayers=n,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(c.default);(0,n.default)(v.prototype,{extent:{get:function(){return self.spatialReference?self.spatialReference.equals(self._spatialReferenceSrc)?this._extentSrc:h.Projection.project(this._extentSrc,self.spatialReference):this._extentSrc}},spatialReference:{get:function(){return this._spatialReferenceSrc},set:function(e){this._spatialReferenceSrc=e}}}),t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(14)),i=y(r(3)),o=y(r(0)),a=y(r(2)),s=y(r(4)),l=y(r(5)),u=r(15),c=r(1),f=r(6),h=r(25),d=r(9),p=y(r(86));function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.LayerType.arcgisTile,r.description="ArcGIS瓦片图层",r.url=(0,c.defaultValue)(e.url,""),r.mapName=(0,c.defaultValue)(e.mapName,""),r._tileServer=new h.TileServer({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"_load",value:function(){var e=this;return this._tileServer.queryServerInfo().then(function(t){c.Log.info("TileServer信息查询成功:",t);var r=t.data;return e.mapName=r.mapName,e.tileSize=r.tileInfo.cols,e.tileInfo=p.default.parseArcgisTileInfo(r.tileInfo),e.spatialReference=new d.SpatialReference(e.tileInfo.spatialReference),e.extent=new d.Extent({xmin:r.fullExtent.xmin,ymin:r.fullExtent.ymin,xmax:r.fullExtent.xmax,ymax:r.fullExtent.ymax,spatialReference:d.SpatialReference.fromJSON(e.spatialReference)}),new n.default(function(t){e.loadStatus=f.LoadStatus.loaded,e.loaded=!0,t(e)})}).catch(function(e){c.Log.error("TileServer信息查询失败:",e)})}},{key:"getTileUrl",value:function(e,t,r){return this.url+"/tileImage/"+e+"/"+t+"/"+r+"?f=image"}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,c.defaultValue)(e,{}));return r.loadStatus=f.LoadStatus.loaded,r.loaded=!0,r}}]),t}(u.TileLayer);t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(r(14)),i=_(r(16)),o=_(r(3)),a=_(r(0)),s=_(r(2)),l=_(r(4)),u=_(r(7)),c=_(r(5)),f=r(15),h=r(6),d=r(1),p=_(r(200)),y=r(9),g=_(r(86)),v=r(19),m=(_(r(98)),r(25));function _(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,d.defaultValue)(e,{}),r.type=h.LayerType.arcgisVectorTile,r.description="ArcGIS矢量瓦片图层",r._isInitAddStyle=!!r.style,(0,d.defined)(r.url)&&(r._vectorTileServer=new p.default({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,headers:r.headers})),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"covertCustomStyleToMVTStyle",value:function(e,t){var r=(0,d.cloneObject)(e);if(r.sprite.indexOf("http:")<0&&r.sprite.indexOf("https:")<0&&this.url.indexOf("root.json")<0){for(var n=r.sprite.split("/"),i="",o=0;o<n.length;o++)"."!==n[o]&&".."!==n[o]&&(i+="/"+n[o]);r.sprite=this._vectorTileServer._baseUrl+"/resources"+i}if(r.glyphs.indexOf("http:")<0&&r.glyphs.indexOf("https:")<0&&this.url.indexOf("root.json")<0){for(var a=r.glyphs.split("/"),s="",l=0;l<a.length;l++)"."!==a[l]&&".."!==a[l]&&(s+="/"+a[l]);r.glyphs=this._vectorTileServer._baseUrl+"/resources"+s}var u="";if(t[0].indexOf(".pbf")>-1)for(var c=t[0].split("/"),f=0;f<c.length;f++)"."!==c[f]&&".."!==c&&(u+="/"+c[f]);else u="/tile/{z}/{y}/{x}.pbf";return this.url.indexOf("root.json")>-1||this._isInitAddStyle?r.sources.esri.tiles=[""+r.sources.esri.url+u]:r.sources.esri.tiles=[""+this._vectorTileServer._baseUrl+u],delete r.sources.esri.url,r}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.description=this.description,e}},{key:"_load",value:function(){var e=this;return"string"==typeof this.url&&this.url?this.url.indexOf("root.json")>-1?this._vectorTileServer.getRootJSON({url:this._vectorTileServer._baseUrl}).then(function(t){var r=t.data;d.Log.info("矢量瓦片样式查询成功:",r);var o=m.UrlUtil.getBaseUrlAndParams(r.sources.esri.url);return e._vectorTileServer._baseUrl=o.baseUrl,e._vectorTileServer._queryParameters=(0,i.default)(e._vectorTileServer._queryParameters,o.params),e._vectorTileServer.queryServerInfo().then(function(t){return d.Log.info("矢量瓦片信息查询成功:",t),e._initLayerInfo(t.data),e._style=e.covertCustomStyleToMVTStyle(r,t.data.tiles),e._initCurrentStyleInfo(),e._style.sprite?e._requestSprite():new n.default(function(t){e.loadStatus=h.LoadStatus.loaded,e.loaded=!0,t(e)})})}):(this._vectorTileServer=new p.default({url:this.url,tokenKey:this.tokenKey,tokenValue:this.tokenValue,headers:this.headers}),this._vectorTileServer.queryServerInfo().then(function(t){return d.Log.info("矢量瓦片信息查询成功:",t),e._initLayerInfo(t.data),e._vectorTileServer.getRootJSON().then(function(r){return e._style=e.covertCustomStyleToMVTStyle(r.data,t.data.tiles),e._initCurrentStyleInfo(),e._style.sprite?e._requestSprite():new n.default(function(t){e.loadStatus=h.LoadStatus.loaded,e.loaded=!0,t(e)})})})):this._style&&this._style instanceof Object?(this._vectorTileServer=new p.default({url:this._style.sources.esri.url,tokenKey:this.tokenKey,tokenValue:this.tokenValue}),this._vectorTileServer.queryServerInfo().then(function(t){return d.Log.info("矢量瓦片信息查询成功:",t),e._initLayerInfo(t.data),e._style=e.covertCustomStyleToMVTStyle(e.style,t.data.tiles),e._initCurrentStyleInfo(),e._style.sprite?e._requestSprite():new n.default(function(t){e.loadStatus=h.LoadStatus.loaded,e.loaded=!0,t(e)})})):void 0}},{key:"_initLayerInfo",value:function(e){var t=e.tileInfo.spatialReference;t.latestWkid?this._spatialReference=new y.SpatialReference({wkid:parseInt(t.latestWkid)}):t.wkt?this._spatialReference=new y.SpatialReference({wkt:t.wkt}):d.Log.error("矢量瓦片服务坐标系信息不存在，请检查igs返回的矢量瓦片服务元信息！"),this.title=e.name,this.tileInfo=g.default.parseTileInfo2(e.tileInfo),this.extent=new y.Extent({xmin:e.fullExtent.xmin,ymin:e.fullExtent.ymin,xmax:e.fullExtent.xmax,ymax:e.fullExtent.ymax,spatialReference:this._spatialReference}),e.capabilities&&(this.capabilities=Array.isArray(e.capabilities)?e.capabilities:[e.capabilities])}},{key:"_initCurrentStyleInfo",value:function(){this.currentStyleInfo.serviceUrl=this.url,this.currentStyleInfo.styleUrl=this.url+"/resources/styles/root.json",this.currentStyleInfo.spriteUrl=this._style.sprite,this.currentStyleInfo.glyphsUrl=this._style.glyphs,this.currentStyleInfo.style=this._style}},{key:"_requestSprite",value:function(){var e=this,t={headers:this.headers};return(0,d.defined)(this.tokenKey)&&(0,d.defined)(this.tokenValue)&&(t.tokenKey=this.tokenKey,t.tokenValue=this.tokenValue),this._vectorTileServer.getSpiriteJSON({url:this._style.sprite+".json"}).then(function(t){return e._style.spritedata=t,new n.default(function(t){e.loadStatus=h.LoadStatus.loaded,e.loaded=!0,t(e)})})}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,v.jsonClone)(e));return r.loadStatus=h.LoadStatus.loaded,r.loaded=!0,r}}]),t}(f.VectorTileLayer);t.default=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WMTSSubLayer=t.WFSLayer=t.WMSSubLayer=t.WMSLayer=t.WMTSLayer=t.OGCLayer=void 0;var n=u(r(104)),i=u(r(534)),o=u(r(535)),a=u(r(234)),s=u(r(536)),l=u(r(233));function u(e){return e&&e.__esModule?e:{default:e}}t.OGCLayer=n.default,t.WMTSLayer=i.default,t.WMSLayer=o.default,t.WMSSubLayer=a.default,t.WFSLayer=s.default,t.WMTSSubLayer=l.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=b(r(11)),i=b(r(14)),o=b(r(3)),a=b(r(0)),s=b(r(2)),l=b(r(4)),u=b(r(7)),c=b(r(5)),f=r(8),h=r(6),d=r(1),p=r(25),y=b(r(233)),g=b(r(173)),v=r(9),m=r(59),_=b(r(104)),S=b(r(71)),x=b(r(103));function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,d.defaultValue)(e,{}),r.type=h.LayerType.wmts,r.sublayers=(0,d.defaultValue)(e.sublayers,new f.Collection),r.sublayers instanceof f.Collection||(r.sublayers=new f.Collection(r.sublayers)),r.url=(0,d.defaultValue)(e.url,void 0),r.spatialReference=v.SpatialReference.fromJSON(e.spatialReference),r.tileMatrixSets=(0,d.defaultValue)(e.tileMatrixSets,[]),r.corporationType=(0,m.initCorporationType)(r.url),r.minScale=(0,d.defaultValue)(e.minScale,0),r.maxScale=(0,d.defaultValue)(e.maxScale,0),r.extent=e.extent?v.Extent.fromJSON(e.extent):void 0,r._clippingArea=(0,d.defaultValue)(e.clippingArea,null),r._activeLayer=e.activeLayer?y.default.fromJSON(e.activeLayer):void 0,r._mapServer=new p.WMTSServer({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);e.type=this.type,e.activeLayer=(0,d.toJSON)(this.activeLayer,y.default),e.url=this.url,e.spatialReference=(0,d.toJSON)(this.spatialReference,v.SpatialReference),e.corporationType=this.corporationType,e.minScale=this.minScale,e.maxScale=this.maxScale;var r=[];this.sublayers.forEach(function(e){r.push((0,d.toJSON)(e,y.default))}),e.sublayers=r;for(var n=[],i=0;i<this.tileMatrixSets.length;i++)n.push((0,d.toJSON)(this.tileMatrixSets[i],g.default));return e.tileMatrixSets=n,e}},{key:"getCurrentTileInfo",value:function(){var e=this;(!Array.isArray(this.activeLayer.tileMatrixSets)||this.activeLayer.tileMatrixSets.length<=0)&&d.Log.error("获取wmts图层TileInfo失败");var t=this.activeLayer.tileMatrixSets.find(function(t){return t.id===e.activeLayer.tileMatrixSetId});return t&&t.tileInfo||d.Log.error("获取wmts图层tileMatrix失败"),t.tileInfo}},{key:"load",value:function(){return(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"load",this).call(this)}},{key:"_load",value:function(){var e=this;return this._mapServer.getCapabitities().then(function(t){d.Log.info("MapServer信息查询成功:",t);var r=t.data;return e._setTileMatrixSets(r.tileMatrixSets),e._setActiveLayer(r.layers),e.title=r.XMLInfo["ows:ServiceIdentification"].children["ows:Title"].children["#text"]["#text"],e._initLayerByActiveLayer(),new i.default(function(t){e.loadStatus=h.LoadStatus.loaded,e.loaded=!0,t(e)})})}},{key:"findSublayerById",value:function(e){return this.sublayers.items[e]}},{key:"_getExtentFromBoundingBox",value:function(e,t,r){var n=void 0,i=r.wkid;"string"==typeof e.lowerCorner&&(e.lowerCorner=e.lowerCorner.split(" ")),"string"==typeof e.upperCorner&&(e.upperCorner=e.upperCorner.split(" "));var o=(0,m.initCorporationType)(this.url);if(r.isGeographic)switch(o){case f.WMTSCorporation.corporationGeoServer:case f.WMTSCorporation.corporationArcGIS:case f.WMTSCorporation.corporationZD:default:n=new v.Extent({xmin:Number(e.lowerCorner[1]),ymin:Number(e.lowerCorner[0]),xmax:Number(e.upperCorner[1]),ymax:Number(e.upperCorner[0]),spatialReference:v.SpatialReference.fromJSON(r)});break;case f.WMTSCorporation.corporationTianDiTu:case f.WMTSCorporation.corporationSuperMap:n=new v.Extent({xmin:Number(e.lowerCorner[0]),ymin:Number(e.lowerCorner[1]),xmax:Number(e.upperCorner[0]),ymax:Number(e.upperCorner[1]),spatialReference:v.SpatialReference.fromJSON(r)})}else if(i>=2327&&i<=2442||i>=4491&&i<=4554||i>=21413&&i<=21423||i>=21473&&i<=21483)switch(o){case f.WMTSCorporation.corporationGeoServer:case f.WMTSCorporation.corporationArcGIS:case f.WMTSCorporation.corporationZD:default:n=new v.Extent({xmin:Number(e.lowerCorner[1]),ymin:Number(e.lowerCorner[0]),xmax:Number(e.upperCorner[1]),ymax:Number(e.upperCorner[0]),spatialReference:v.SpatialReference.fromJSON(r)});break;case f.WMTSCorporation.corporationSuperMap:n=new v.Extent({xmin:Number(e.lowerCorner[0]),ymin:Number(e.lowerCorner[1]),xmax:Number(e.upperCorner[0]),ymax:Number(e.upperCorner[1]),spatialReference:v.SpatialReference.fromJSON(r)})}else n=new v.Extent({xmin:Number(e.lowerCorner[0]),ymin:Number(e.lowerCorner[1]),xmax:Number(e.upperCorner[0]),ymax:Number(e.upperCorner[1]),spatialReference:v.SpatialReference.fromJSON(r)});return n}},{key:"_createWMTSSubLayer",value:function(e,t){for(var r=e.tileMatrixSetLink,n=[],i=0;i<r.length;i++)for(var o=0;o<t.length;o++)if(r[i].tileMatrixSet===t[o].identifier){n.push(t[o]);break}var a=this._getExtentFromBoundingBox(e.boundingBox,this.url,t[0].tileInfo.spatialReference);return new y.default({identifier:e.identifier,title:e.title,description:"WMTS子图层",imageFormat:e.format,imageFormats:[e.format],styleId:Array.isArray(e.Style)?e.Style[0].identifier:e.Style.identifier,styles:[new f.WMTSStyle({id:e.Style.identifier,title:e.Style.title})],tileMatrixSets:t,tileMatrixSetId:t[0].identifier,extent:a,resourceURLTemplates:[]})}},{key:"_getTopLeftCorner",value:function(e,t){var r=(0,m.initCorporationType)(this.url),n=e.split(" "),i=void 0;if(t.isGeographic)i=[Number(n[1]),Number(n[0])];else if(t.wkid>=2327&&t.wkid<=2442||t.wkid>=4491&&t.wkid<=4554||t.wkid>=21413&&t.wkid<=21423||t.wkid>=21473&&t.wkid<=21483)switch(r){case f.WMTSCorporation.corporationSuperMap:i=[Number(n[0]),Number(n[1])];break;case f.WMTSCorporation.corporationZD:case f.WMTSCorporation.corporationArcGIS:case f.WMTSCorporation.corporationGeoServer:default:i=[Number(n[1]),Number(n[0])]}else switch(r){case f.WMTSCorporation.corporationTianDiTu:i=[-20037508.3427892,20037508.3427892];break;default:i=[Number(n[0]),Number(n[1])]}return i}},{key:"_setTileMatrixSets",value:function(e){var t=this;e.forEach(function(e){var r=(0,m.getEPSGCodeFromOGCSupportedCRSString)(e.supportedCRS),n=new v.SpatialReference({wkid:r}),i=t._getTopLeftCorner(e.tileMatrix[0].topLeftCorner,n),o=[];e.tileMatrix.forEach(function(r){var i=new x.default;if(i.level=r.identifier,i.scale=Number(r.scaleDenominator),r.identifier){var a=r.identifier.lastIndexOf(":");i.level=a>=0?parseInt(r.identifier.substring(a+1)):parseInt(r.identifier)}i.resolution=(0,m.getTileResolution)(e.identifier,t.corporationType,i.scale,n),o.push(i)});var a=new S.default({origin:new v.Point({coordinates:i,spatialReference:n}),size:[Number(e.tileMatrix[0].tileWidth),Number(e.tileMatrix[0].tileHeight)],lods:o,spatialReference:n});t.tileMatrixSets.push(new g.default({extent:"",id:e.identifier,tileInfo:a,layer:t,tileMatrix:e.tileMatrix,identifier:e.identifier,supportedCRS:e.supportedCRS}))})}},{key:"_setActiveLayer",value:function(e){var t=this;e.forEach(function(e){t.sublayers.add(t._createWMTSSubLayer(e,t.tileMatrixSets))}),this._activeLayer||(this._activeLayer=this.sublayers.getItemAt(0))}},{key:"_initLayerByActiveLayer",value:function(){this._spatialReference=v.SpatialReference.fromJSON(this.activeLayer.spatialReference),this.extent=v.Extent.fromJSON(this.activeLayer.extent)}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,d.defaultValue)(e,{}));return r.loadStatus=h.LoadStatus.loaded,r.loaded=!0,r}}]),t}(_.default);w.fromServerUrl=function(e){return new w({url:e})},(0,n.default)(w.prototype,{clippingArea:{get:function(){return this._clippingArea},set:function(e){this._clippingArea=e,this._fireUpdateEvent("空间裁剪区域",[{name:"clippingArea",params:[this._clippingArea],dataChanged:!0,operationType:"property"}])}},activeLayer:{get:function(){return this._activeLayer},set:function(e){this._activeLayer=e,this._initLayerByActiveLayer()}}}),t.default=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=b(r(11)),i=b(r(14)),o=b(r(16)),a=b(r(3)),s=b(r(0)),l=b(r(2)),u=b(r(4)),c=b(r(7)),f=b(r(5)),h=r(1),d=r(8),p=r(25),y=r(6),g=r(9),v=b(r(234)),m=r(49),_=b(r(104)),S=r(19),x=r(39);function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){function t(e){(0,s.default)(this,t);var r=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r._sublayers=(0,h.defaultValue)(e.sublayers,[]),r.url=(0,h.defaultValue)(e.url,""),r.sublayers=(0,h.defaultValue)(e.sublayers,[]),r.imageWidth=(0,h.defaultValue)(e.imageWidth,256),r.imageHeight=(0,h.defaultValue)(e.imageHeight,256),r.allSublayers=[],r.layers=(0,h.defaultValue)(e.layers,void 0),r.imageFormat=(0,h.defaultValue)(e.imageFormat,"image/png"),r.imageFormats=["image/png"],r.imageTransparency=(0,h.defaultValue)(e.imageTransparency,!0),r.version=(0,h.defaultValue)(e.version,"1.1.1"),r.type=y.LayerType.wms,r.spatialReferences=(0,h.defaultValue)(e.spatialReferences,[]),r._clippingArea=(0,h.defaultValue)(e.clippingArea,null),r._extentList=[],r._WMSServer=new p.WMSServer({url:r.url,version:r.version,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,f.default)(t,e),(0,l.default)(t,[{key:"load",value:function(){return(0,c.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"load",this).call(this)}},{key:"_load",value:function(){var e=this,t=this;return this._WMSServer.getCapabitities().then(function(r){h.Log.info("WMS信息查询成功:",r),t.spatialReferences=[],t._extentList=[];var n=r.data;t.title||(t.title=n.title);for(var a=0;a<n.crs.length;a++)for(var s=0;s<n.boundingBox.length;s++)if(n.crs[a]===n.boundingBox[s].crs){var l=n.crs[a];"crs:84"===l.toLowerCase()&&(l="EPSG:4326");var u=new g.SpatialReference(l),c=n.boundingBox[s],f=t._getExtent(c,u);t.spatialReferences.push(u),t._extentList.push(f);break}if((0,h.isNull)(t.spatialReference))for(var d=0;d<t.spatialReferences.length;d++)if(t.spatialReferences[d].wkid){t._spatialReference=t.spatialReferences[d];break}t._extentSrc=t._getExtentBySP(t._spatialReference),(0,h.isNull)(t._extentSrc)&&t._extentList.length>0&&(t._extentSrc=x.Projection.project(t._extentList[0],t._spatialReference),t._extentList.push(t._extentSrc)),t.allSublayers=[];for(var p=0;p<n.layer.length;p++){n.layer[p].id=String(p),n.layer[p].visible=!0,n.layer[p].spatialReference=t.spatialReference,n.layer[p].spatialReferences=[];for(var m=n.layer[p].crs,_=0;_<m.length;_++)n.layer[p].spatialReferences.push(g.SpatialReference.fromJSON(m[p]));for(var S=n.layer[p].boundingBox,b=0;b<S.length;b++)"EPSG:"+t.spatialReference.wkid===S[b].crs&&(n.layer[p].extent=t._getExtent(S[b],t.spatialReference));t.allSublayers.push(new v.default((0,o.default)(n.layer[p],{layer:e})))}if((0,h.isNull)(t._extentSrc)){for(var w=[],k=0;k<t.allSublayers.length;k++)w.push(t.allSublayers[k].extent);t._extentSrc=g.GeometryEngine.union(w),t._extentList.push(t._extentSrc)}if((0,h.isNull)(t._extentSrc)&&h.Log.warning("无法获取WMS图层范围，服务地址为:",t.url),t._sublayers.length>0){for(var M=0;M<n.layer.length;M++)for(var E=0;E<t._sublayers.length;E++)if(String(t._sublayers[E].id)===String(n.layer[M].id)||String(t._sublayers[E].name)===String(n.layer[M].name)){t._sublayers[E]=new v.default((0,o.default)(n.layer[M],t._sublayers[E],{layer:e}));break}t._getLayersFromSubLayers()}else t._getLayersFromAllSubLayers();return new i.default(function(e){t.loadStatus=y.LoadStatus.loaded,t.loaded=!0,e(t)})}).catch(function(e){t.loadStatus=h.Log.error("WMS信息查询失败:",e)})}},{key:"_getExtent",value:function(e,t){return new g.Extent({xmin:Number(e.minx),ymin:Number(e.miny),ymax:Number(e.maxy),xmax:Number(e.maxx),spatialReference:g.SpatialReference.fromJSON(t)})}},{key:"setSubLayer",value:function(e){(0,m.setSublayer)(this,e,v.default),this._getLayersFromAllSubLayers(),this._fireUpdateEvent("更新子图层",[{name:"sublayerVisible",params:[this],dataChanged:!0,operationType:"method"}])}},{key:"_getLayersFromSubLayers",value:function(){for(var e="",t=0;t<this._sublayers.length;t++)this._sublayers[t].visible&&this._sublayers[t].name&&(e+=this._sublayers[t].name+",");return e=e.substring(0,e.length-1),this.layers=e,e}},{key:"_getLayersFromAllSubLayers",value:function(){for(var e="",t=0;t<this.allSublayers.length;t++)this.allSublayers[t].visible&&this.allSublayers[t].name&&(e+=this.allSublayers[t].name+",");return e=e.substring(0,e.length-1),this.layers=e,e}},{key:"_getExtentBySP",value:function(e){var t=null;if(!(0,h.isNull)(e))for(var r=0;r<this._extentList.length;r++)if(this._extentList[r].spatialReference.equals(e)){t=this._extentList[r];break}return t}},{key:"findSublayerById",value:function(e){for(var t=0;t<this.allSublayers.length;t++)if(this.allSublayers[t].id===e)return this.allSublayers[t];return null}},{key:"toJSON",value:function(){var e=(0,c.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"toJSON",this).call(this);e.url=this.url,e.imageWidth=this.imageWidth,e.imageHeight=this.imageHeight,e.imageFormat=this.imageFormat,e.imageFormats=this.imageFormats,e.imageTransparency=this.imageTransparency,e.version=this.version,e.type=this.type,e.layers=this.layers;for(var r=[],n=0;n<this._extentList.length;n++)r.push((0,h.toJSON)(this._extentList[n],g.Extent));e.extentList=r;var i=[];this.sublayers.forEach(function(e){i.push((0,h.toJSON)(e,v.default))}),e.sublayers=i;var o=[];return this.allSublayers.forEach(function(e){o.push((0,h.toJSON)(e,v.default))}),e.allSublayers=o,e}}],[{key:"fromJSON",value:function(e){for(var r=new t(e=(0,S.jsonClone)(e)),n=[],i=0;i<e.extentList.length;i++)n.push(g.Geometry.fromJSON(e.extentList[i]));function o(e){e.extent=g.Geometry.fromJSON(e.extent),e.spatialReference=g.SpatialReference.fromJSON(e.spatialReference);for(var t=0;t<e.spatialReferences.length;t++)e.spatialReferences[t]=g.SpatialReference.fromJSON(e.spatialReferences[t])}r._extentList=n;var a=e.sublayers;if(a&&a instanceof Array){r._sublayers=new d.Collection;for(var s=0;s<a.length;s++)o(a[s]),r._sublayers.add(new v.default(a[s]))}var l=e.allSublayers;if(l&&l instanceof Array){r.allSublayers=new d.Collection;for(var u=0;u<l.length;u++)o(l[u]),r.allSublayers.add(new v.default(l[u]))}return r.loadStatus=y.LoadStatus.loaded,r.loaded=!0,r}}]),t}(_.default);(0,n.default)(w.prototype,{sublayers:{get:function(){return this._sublayers},set:function(e){this._sublayers=e}},spatialReference:{set:function(e){var t=0;if(e&&this.spatialReferences&&this.spatialReferences instanceof Array){for(;t<this.spatialReferences.length;t++)if(this.spatialReferences[t].equals(e)){this._spatialReference=e,this._fireUpdateEvent("修改图层坐标系",[{name:"spatialReference",params:[this._spatialReference],dataChanged:!0,operationType:"property"}]);break}if(t===this.spatialReferences.length)throw new Error("该图层不支持所指定的空间参考系,设置失败！")}},get:function(){return this._spatialReference}},extent:{get:function(){return this._getExtentBySP(this.spatialReference)}}}),w.fromServerUrl=function(e){return new w({url:e})},(0,n.default)(w.prototype,{clippingArea:{get:function(){return this._clippingArea},set:function(e){this._clippingArea=e,this._fireUpdateEvent("空间裁剪区域",[{name:"clippingArea",params:[this._clippingArea],dataChanged:!0,operationType:"property"}])}}}),t.default=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=x(r(16)),i=x(r(14)),o=x(r(3)),a=x(r(0)),s=x(r(2)),l=x(r(4)),u=x(r(7)),c=x(r(5)),f=r(8),h=r(1),d=r(25),p=r(6),y=r(9),g=x(r(104)),v=r(70),m=x(r(101)),_=r(19),S=r(59);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r.type=p.LayerType.wfs,r.url=(0,h.defaultValue)(e.url,""),r.id=(0,h.defaultValue)(e.id,(0,h.getGUID)()),r._spatialReference=void 0,r.renderer=r._decorate("renderer",e.renderer,v.BaseRenderer,v.BaseRenderer.fromJSON),r.outFields=[],r.elevationInfo=(0,h.defaultValue)(e.elevationInfo,new f.ElevationInfo),r.geometryType=p.GeometryType.geometry,r.sublayerId=(0,h.defaultValue)(e.sublayerId,""),r.wfsCapabilities=(0,h.defaultValue)(e.wfsCapabilities,""),r.labelsVisible=(0,h.defaultValue)(e.labelsVisible,!1),r.labelingInfo=(0,h.defaultValue)(e.labelingInfo,[]),r._wfsServer=new d.WFSServer({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"load",value:function(){return(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"load",this).call(this)}},{key:"_load",value:function(){var e=this;return this._wfsServer.queryServerInfo().then(function(t){h.Log.info("WFS信息查询成功:",t);for(var r=t.data,n=t.data.featureTypeList,o=0;o<n.length;o++)if(n[o].name===e.sublayerId){e.title||(e.title=n[o].title);break}if(r){e.version=(0,h.defaultValue)(r.version,"2.0.0"),e.wfsCapabilities=r;var a=r.featureTypeList;if(a.length>0){var s=a[0],l=(0,S.getEPSGCodeFromOGCSupportedCRSString)(s.defaultSRS);if(e._spatialReference=l?new y.SpatialReference({wkid:l}):new y.SpatialReference({wkid:4326}),!e.sublayerId&&s.name&&(e.sublayerId=s.name),!e.extent){var u=a.find(function(t){return t.name===e.sublayerId});if(u||h.Log.error("未查询到要素图层，请检查图层名称是否正确"),u.WGS84BoundingBox){var c=u.WGS84BoundingBox.UpperCorner,f=u.WGS84BoundingBox.lowerCorner,d=void 0,g=void 0,v=void 0,m=void 0;if(c){var _=c.split(" ").map(function(e){return parseFloat(e)});v=_[0],m=_[1]}if(f){var x=f.split(" ").map(function(e){return parseFloat(e)});d=x[0],g=x[1]}e.extent=new y.Extent({xmin:d,ymin:g,xmax:v,ymax:m,spatialReference:e._spatialReference})}}}return new i.default(function(t){e.loadStatus=p.LoadStatus.loaded,e.loaded=!0,t(e)})}h.Log.error("wfs请求数据为空")}).catch(function(t){e.loadStatus=h.Log.error("WMS信息查询失败:",t)})}},{key:"queryFeatures",value:function(e){var t=this,r=this._createQueryOption(e);return this._wfsServer.queryFeatures(r).then(function(e){var r=e.data;r||h.Log.error("添加图层视图失败，未获取到请求数据");var n=r.featureSet;return t.geometryType=(0,S.getGeometryTypeByFeatureSet)(n),n||h.Log.error("添加图层视图失败，未获取到几何要素信息"),n})}},{key:"queryFeaturesCount",value:function(e){var t=this._createQueryOption(e);return t.returnCountOnly=!0,this._wfsServer.queryFeatures(t).then(function(e){var t=e.data;return t||h.Log.error("添加图层视图失败，未获取到请求数据"),t.count})}},{key:"_createQueryOption",value:function(e){var t=(0,h.defaultValue)(e,{});return(0,n.default)({typename:this.sublayerId,version:this.version},t)}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);e.url=this.url,e.sublayerId=this.sublayerId,e.geometryType=this.geometryType,e.wfsCapabilities=this.wfsCapabilities,e.labelsVisible=this.labelsVisible,e.spatialReference=(0,h.toJSON)(this._spatialReference,y.SpatialReference),e.renderer=(0,h.toJSON)(this.renderer,v.BaseRenderer),e.outFields=this.outFields,e.elevationInfo=(0,h.toJSON)(this.elevationInfo,f.ElevationInfo);var r=[];if(this.labelingInfo&&this.labelingInfo instanceof Array)for(var n=0;n<this.labelingInfo.length;n++)r.push((0,h.toJSON)(this.labelingInfo[n],m.default));return e.labelingInfo=r,e}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,_.jsonClone)(e));if(r.spatialReference=y.SpatialReference.fromJSON(e.spatialReference),r.renderer=v.BaseRenderer.fromJSON(e.renderer),r.elevationInfo=new f.ElevationInfo(e.elevationInfo),e.labelingInfo&&e.labelingInfo instanceof Array)for(var n=0;n<e.labelingInfo.length;n++)r.labelingInfo[n]=new m.default(e.labelingInfo[n]);return r.loadStatus=p.LoadStatus.loaded,r.loaded=!0,r}}]),t}(g.default);t.default=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(r(11)),i=p(r(3)),o=p(r(0)),a=p(r(2)),s=p(r(4)),l=p(r(7)),u=p(r(5)),c=r(15),f=r(1),h=r(6),d=r(19);function p(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,f.defaultValue)(e,{}),r.type=h.LayerType.cesium3DTiles,r.boundingVolume=void 0,r.sceneName=void 0,r.fieldInfo=void 0,r.description="3DTiles图层",r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.boundingVolume=this.boundingVolume,e.sceneName=this.sceneName,e.fieldInfo=this.fieldInfo,e.description=this.description,e}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"_is3DTilesServer",value:function(e){return[new RegExp("^http://[0-9.a-zA-Z]+:[0-9]{1,5}/igs/rest/services/[一-龟\\w/:_]+/3DTilesServer$"),new RegExp("^https://[0-9.a-zA-Z]+:[0-9]{1,5}/igs/rest/services/[一-龟\\w/:_]+/3DTilesServer$"),new RegExp("^http://[0-9.a-zA-Z]+/igs/rest/services/[一-龟\\w/:_]+/3DTilesServer$"),new RegExp("^https://[0-9.a-zA-Z]+/igs/rest/services/[一-龟\\w/:_]+/3DTilesServer$")].some(function(t){return t.test(e)})}}],[{key:"fromJSON",value:function(e){return new t(e=(0,d.jsonClone)(e))}}]),t}(c.ModelCacheLayer);(0,n.default)(y.prototype,{_paramUrl:{get:function(){return this._is3DTilesServer(this.url)?this.url+"/tileset.json":this.url}}}),t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(14)),i=y(r(3)),o=y(r(0)),a=y(r(2)),s=y(r(4)),l=y(r(7)),u=y(r(5)),c=r(15),f=r(1),h=y(r(199)),d=r(6),p=r(19);function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,f.defaultValue)(e,{}),r.url=(0,f.defaultValue)(e.url,void 0),r.type=d.LayerType.terrain,r._terrainServer=new h.default({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"load",value:function(){return(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"load",this).call(this)}},{key:"_load",value:function(){var e=this;return new n.default(function(t){e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,t(e)})}},{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return e.url=this.url,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,p.jsonClone)(e));return r.loadStatus=d.LoadStatus.loaded,r.loaded=!0,r}}]),t}(c.Layer);g.fromServerUrl=function(e){return new g({url:e})},t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OverlayLayer=t.MapVLayer=t.EchartsLayer=void 0;var n=a(r(540)),i=a(r(541)),o=a(r(144));function a(e){return e&&e.__esModule?e:{default:e}}t.EchartsLayer=n.default,t.MapVLayer=i.default,t.OverlayLayer=o.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(10)),i=h(r(3)),o=h(r(0)),a=h(r(2)),s=h(r(4)),l=h(r(7)),u=h(r(5)),c=r(1),f=r(6);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.echartsOptions=(0,c.defaultValue)(e.echartsOptions,{}),r.type=f.LayerType.echarts,r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return e.echartsOptions=this.echartsOptions,JSON.parse((0,n.default)(e))}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(h(r(144)).default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(10)),i=h(r(3)),o=h(r(0)),a=h(r(2)),s=h(r(4)),l=h(r(5)),u=h(r(144)),c=r(1),f=r(6);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.mapVOptions=(0,c.defaultValue)(e.mapVOptions,{}),r.type=f.LayerType.mapv,r.data=(0,c.defaultValue)(e.data,{}),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e={mapVOptions:this.mapVOptions,data:this.data};return JSON.parse((0,n.default)(e))}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(14)),i=v(r(3)),o=v(r(0)),a=v(r(2)),s=v(r(4)),l=v(r(7)),u=v(r(5)),c=r(15),f=r(8),h=r(1),d=r(6),p=r(49),y=r(46),g=r(97);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r.type=d.LayerType.group,r.layers=(0,p.getLayersCollection)(e.layers),r._setItemParent(r.layers,r,r._map),r.allLayers=new f.CollectionFlattener({getCollections:function(){return[r.layers]},getChildrenFunction:function(e){return e.layers}}),r._initHandlers(),r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"load",value:function(){var e=this,t=this;if(this.isLoaded())return n.default.resolve(this);var r=[];this.layers.items.filter(function(e){return e&&!e.isLoaded()}).forEach(function(t){var n=t.load();n.catch(function(){e._fireLoadErrorEvent(t)}),r.push(n.then(function(){return e._fireLoadEvent(t),t}))});var i=(0,g.allSettled)(r);return i.catch(function(){e._fireLoadErrorEvent(e)}),i.then(function(){return e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,e._fireLoadEvent(e),t})}},{key:"isLoaded",value:function(){return this.loadStatus===d.LoadStatus.loaded&&this.layers.items.every(function(e){return e&&e.isLoaded()})}},{key:"add",value:function(e,t){e&&(this._map?this._map._isValidateLayers([e]):this._isValidateLayers([e]),this._setItemParent(e,this,this._map),this.layers.add(e,t))}},{key:"addMany",value:function(e,t){e&&(this._map?this._map._isValidateLayers(e):this._isValidateLayers(e),this._setItemParent(e,this,this._map),this.layers.addMany(e,t))}},{key:"remove",value:function(e){e&&(this.layers.remove(e),this._setItemParent(e,null,null))}},{key:"removeMany",value:function(e){this.layers.removeMany(e),this._setItemParent(e,null,null)}},{key:"removeAll",value:function(){var e=this.layers.items.map(function(e){return e});this.layers.removeAll(),this._setItemParent(e,null,null)}},{key:"reorder",value:function(e,t){this.layers.reorder(e,t)}},{key:"getFlatLayers",value:function(){return this.allLayers.items}},{key:"findLayerById",value:function(e){return this.layers.find(function(t){return t&&t.id===e})}},{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return this.layers=this.layers.items.map(function(e){return e.toJSON()}),e}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"setMap",value:function(e){(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"setMap",this).call(this,e),this._setItemParent(this.layers,this,e)}},{key:"destroy",value:function(){(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"destroy",this).call(this),this.removeAll(),this._removeHandlers()}},{key:"_initHandlers",value:function(){var e=this;this._handlers=[];var t=function(t){for(var r=t.added,n=t.removed,i=t.moved,o=[],a=e;a;){o.push(a);var s=new y.LayerChangeEvent({added:r,removed:n,moved:i,sourceTarget:e,path:o});a.fire(d.MapEventType.layerChange,s),a=a.parent}};this.layers.on("change",t),this._handlers.push({key:"change",func:t})}},{key:"_removeHandlers",value:function(){var e=this;this._handlers.map(function(t){return e.off("change",t.func,e)})}},{key:"_setItemParent",value:function(e,t,r){(e instanceof f.Collection?e._items:Array.isArray(e)?e:[e]).forEach(function(e){e&&(e.parent=t,e.setMap&&e.setMap(r))})}},{key:"_fireLoadEvent",value:function(e){var t=new y.LayerEvent({type:d.LayerEventType.layerLoaded,target:e,message:"图层资源加载完毕",layer:e});e.fire(t)}},{key:"_fireLoadErrorEvent",value:function(e){var t=new y.LayerEvent({type:d.LayerEventType.layerLoadError,target:e,message:"图层资源加载失败",layer:e});e.fire(t)}},{key:"_isValidateLayers",value:function(e){var r=this,n=[];if(Array.isArray(e)&&e.length>0&&e.forEach(function(e){n.push(e),e instanceof t&&(n=n.concat(e.allLayers.items))}),n.some(function(e){return r.allLayers.items.some(function(t){return t.id===e.id})}))throw new Error("重复添加图层，请检查传入图层的id")}}],[{key:"fromJSON",value:function(e){return new t(e=e||{})}}]),t}(c.Layer);t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(14)),i=v(r(3)),o=v(r(0)),a=v(r(2)),s=v(r(4)),l=v(r(7)),u=v(r(5)),c=r(8),f=r(6),h=r(1),d=r(15),p=v(r(145)),y=r(19),g=r(49);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r.type=f.LayerType.graphics,r.minScale=(0,h.defaultValue)(e.minScale,0),r.maxScale=(0,h.defaultValue)(e.maxScale,0),r.tokenKey=(0,h.defaultValue)(e.tokenKey,"token"),r.tokenValue=(0,h.defaultValue)(e.tokenValue,void 0),r.elevationInfo=(0,h.defaultValue)(e.elevationInfo,new c.ElevationInfo),r.graphics=r._decorate("graphics",e.graphics,p.default,p.default.collect),r}return(0,u.default)(t,e),(0,a.default)(t,[{key:"add",value:function(e){if(e){if(this._getFeatureIndexById(e.id)>-1)throw new Error("id为'"+e.id+"'的要素重复添加，请检查传入要素的id");(0,g.setElevationInfo)(e,this),this.graphics.add(e),this._fireUpdateEvent("添加要素",[{params:arguments,dataChanged:!0,name:"add",operationType:"method"}])}}},{key:"remove",value:function(e){if(e){var t=this._getFeatureIndexById(e.id);-1!==t&&(this._removeGraphicByIndex(t),this._fireUpdateEvent("移除要素",[{params:arguments,dataChanged:!0,name:"remove",operationType:"method"}]))}}},{key:"addMany",value:function(e){var t=this;(e instanceof c.FeatureSet?e.clone().features.map(function(e){return e.clone()}):e.map(function(e){return e.clone()})).forEach(function(e){t.graphics.add(e)}),this._fireUpdateEvent("添加要素组",[{params:arguments,dataChanged:!0,name:"addMany",operationType:"method"}])}},{key:"removeMany",value:function(e){var t=this,r=[];Array.isArray(e)&&(e.forEach(function(e){var n=t._getFeatureById(e.id);n&&(t._removeGraphic(n),r.push(n))}),this._fireUpdateEvent("删除要素组",[{params:r,dataChanged:!0,name:"removeMany",operationType:"method"}]))}},{key:"removeAll",value:function(){this.graphics=[],this._fireUpdateEvent("删除全部要素",[{params:arguments,dataChanged:!0,name:"removeAll",operationType:"method"}])}},{key:"_load",value:function(){var e=this;return new n.default(function(t,r){e.loadStatus=f.LoadStatus.loaded,e.loaded=!0,t(e),r("资源请求失败!")})}},{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);e.elevationInfo=(0,h.toJSON)(this.elevationInfo,c.ElevationInfo);var r=[];return this.graphics&&this.graphics.forEach(function(e){r.push((0,h.toJSON)(e,c.Feature))}),e.graphics=r,e}},{key:"_getFeatureIndexById",value:function(e){return this.graphics.findIndex(function(t){return t.id===e})}},{key:"_getFeatureById",value:function(e){var t=this._getFeatureIndexById(e);return t>-1?this.graphics[t]:null}},{key:"_removeGraphic",value:function(e){var t=this._getFeatureIndexById(e.id);this._removeGraphicByIndex(t)}},{key:"_removeGraphicByIndex",value:function(e){-1!==e&&this.graphics.items.splice(e,1)}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,y.jsonClone)(e));r.elevationInfo=new c.ElevationInfo(e.elevationInfo);for(var n=[],i=0;i<e.graphics.length;i++)n.push(new c.Feature(e.graphics[i]));return r.graphics=n,r.loadStatus=f.LoadStatus.loaded,r.loaded=!0,r}}]),t}(d.Layer);t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=x(r(23)),i=x(r(14)),o=x(r(3)),a=x(r(0)),s=x(r(2)),l=x(r(4)),u=x(r(7)),c=x(r(5)),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(35)),h=x(r(40)),d=r(8),p=r(6),y=r(1),g=r(9),v=x(r(98)),m=r(70),_=r(19),S=r(59);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,y.defaultValue)(e,{}),r.type=p.LayerType.geojson,r.minScale=(0,y.defaultValue)(e.minScale,0),r.maxScale=(0,y.defaultValue)(e.maxScale,0),r.tokenKey=(0,y.defaultValue)(e.tokenKey,"token"),r.tokenValue=(0,y.defaultValue)(e.tokenValue,void 0),r.renderer=r._decorate("renderer",e.renderer,m.BaseRenderer,m.BaseRenderer.fromJSON),r.url=(0,y.defaultValue)(e.url,""),r.elevationInfo=(0,y.defaultValue)(e.elevationInfo,new d.ElevationInfo),r.customParameters=(0,y.defaultValue)(e.customParameters,{}),r.geometryType=p.GeometryType.geometry,r.labelsVisible=(0,y.defaultValue)(e.labelsVisible,!1),r.labelingInfo=(0,y.defaultValue)(e.labelingInfo,[]),r._source=null,r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"_load",value:function(){var e=this;return this.queryFeatures().then(function(t){var r=t;if(r){e._source=r,e._spatialReference||(e._spatialReference=r.spatialReference.clone());var n=f.bbox(r),o=parseFloat(n[0]),a=parseFloat(n[1]),s=parseFloat(n[2]),l=parseFloat(n[3]);return e.extent=new g.Extent({xmin:o,xmax:s,ymin:a,ymax:l,spatialReference:e._spatialReference}),e.geometryType=(0,S.getGeometryTypeByFeatureSet)(e._source),new i.default(function(t){e.loadStatus=p.LoadStatus.loaded,e.loaded=!0,t(e)})}y.Log.error("几何信息为空",r)})}},{key:"destroy",value:function(){}},{key:"queryFeatures",value:function(){return this._parseGeoJSON().then(function(e){return d.FeatureSet.fromGeoJSON(e)}).catch(function(e){y.Log.error(e)})}},{key:"queryFeaturesCount",value:function(){return this._parseGeoJSON().then(function(e){return d.FeatureSet.fromGeoJSON(e).features.length})}},{key:"_parseGeoJSON",value:function(){var e=this;return new i.default(function(t){if("string"==typeof e.url){var r=e.url;if(e.customParameters){var i="";(0,n.default)(e.customParameters).forEach(function(t){i+=t+"="+e.customParameters[t]+"&"}),i&&(i=i.substring(0,i.length-1))}v.default.commit("get",r,{},{tokenKey:e.tokenKey,tokenValue:e.tokenValue,headers:e.headers}).then(function(e){e&&e.json?t(e.json()):y.Log.error("GeoJSON数据请求失败，请检查服务状态！")})}else t(e.url)}).catch(function(e){y.Log.error(e)})}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.url=this.url,e.elevationInfo=(0,y.toJSON)(this.elevationInfo,d.ElevationInfo),e.customParameters=this.customParameters,e.labelsVisible=this.labelsVisible,e.geometryType=this.geometryType,e.renderer=(0,y.toJSON)(this.renderer,m.BaseRenderer),e.extent=(0,y.toJSON)(this.extent,g.Extent),e.labelingInfo=this.labelingInfo,e}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,_.jsonClone)(e));return r.renderer=m.BaseRenderer.fromJSON(e.renderer),r.elevationInfo=new d.ElevationInfo(e.elevationInfo),r.extent=g.Geometry.fromJSON(e.extent),r.loadStatus=p.LoadStatus.loaded,r.loaded=!0,r}}]),t}(h.default);t.default=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(r(11)),i=m(r(14)),o=m(r(3)),a=m(r(0)),s=m(r(2)),l=m(r(4)),u=m(r(7)),c=m(r(5)),f=r(15),h=r(1),d=r(6),p=r(25),y=r(19),g=r(8),v=m(r(235));function m(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,h.defaultValue)(e,{}),r.type=d.LayerType.m3dCache,r.boundingVolume=void 0,r.sceneName=void 0,r.fieldInfo=void 0,r.description="M3D图层",r.timeInfo=null,r._elevationInfo=new g.ElevationInfo(e.elevationInfo),r._clientFilters=Array.isArray(e.clientFilters)?e.clientFilters.map(function(e){return v.default.fromJSON(e)}):[],r._timeExtent=new g.TimeExtent(e.timeExtent),r._renderer=(0,h.defaultValue)(e.renderer,void 0),r._m3dServer=new p.M3DServer({url:r.url,tokenKey:r.tokenKey,tokenValue:r.tokenValue,enableGlobeFetch:!1,headers:r.headers}),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"load",value:function(){return(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"load",this).call(this)}},{key:"_load",value:function(){var e=this;return new i.default(function(t){e.loadStatus=d.LoadStatus.loaded,e.loaded=!0,t(e)})}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.boundingVolume=this.boundingVolume,e.sceneName=this.sceneName,e.fieldInfo=this.fieldInfo,e.description=this.description,e.elevationInfo=this.elevationInfo.toJSON(),e.clientFilters=this.clientFilters.map(function(e){return e.toJSON()}),e.timeExtent=this._timeExtent.toJSON(),e.timeInfo=this.timeInfo?this.timeInfo.toJSON():null,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,y.jsonClone)(e));return r.loadStatus=d.LoadStatus.loaded,r.loaded=!0,r}}]),t}(f.ModelCacheLayer);_.fromServerUrl=function(e){return new _({url:e})},(0,n.default)(_.prototype,{renderer:{get:function(){return this._renderer},set:function(e){this._renderer=e,this._fireUpdateEvent("设置专题图",[{name:"renderer",params:[this._renderer],dataChanged:!0,operationType:"property"}])}},timeExtent:{get:function(){return this._timeExtent},set:function(e){this._timeExtent=e,this._fireUpdateEvent("设置时间范围",[{name:"timeExtent",params:[this._timeExtent],dataChanged:!0,operationType:"property"}])}},clientFilters:{get:function(){return this._clientFilters},set:function(e){this._clientFilters=Array.isArray(e)?e.map(function(e){return v.default.fromJSON(e)}):[],this._fireUpdateEvent("设置客户端过滤器",[{name:"clientFilters",params:[this._clientFilters],dataChanged:!0,operationType:"property"}])}},elevationInfo:{get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=new g.ElevationInfo(e),this._fireUpdateEvent("设置高度模式",[{name:"elevationInfo",params:[this._elevationInfo],dataChanged:!0,operationType:"property"}])}}}),t.default=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(14)),i=h(r(3)),o=h(r(0)),a=h(r(2)),s=h(r(4)),l=h(r(7)),u=h(r(5)),c=r(6),f=r(1);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return e=(0,f.defaultValue)(e,{}),r.type="video",r.source=(0,f.defaultValue)(e.source,null),r.source?(0,f.defined)(window.videojs)?r:(f.Log.error("The video.js library is lost."),(0,s.default)(r)):(f.Log.error("The video source is lost."),(0,s.default)(r))}return(0,u.default)(t,e),(0,a.default)(t,[{key:"_load",value:function(){return self=this,new n.default(function(e){self.loadStatus=c.LoadStatus.loaded,self.loaded=!0,e(self)})}},{key:"toJSON",value:function(){var e=(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"toJSON",this).call(this);return e.source=this.source,e}},{key:"clone",value:function(){return new t(this.toJSON())}}]),t}(r(15).Layer);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(3)),i=g(r(0)),o=g(r(2)),a=g(r(4)),s=g(r(7)),l=g(r(5)),u=r(15),c=r(1),f=r(9),h=r(39),d=r(6),p=g(r(71)),y=r(19);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));if(e=(0,c.defaultValue)(e,{}),r.type=d.LayerType.webTileLayer,r.spatialReference=void 0,r.extent=void 0,r.tileSize=void 0,r.tileInfo=void 0,r.tileSliceType=(0,c.defaultValue)(e.tileSliceType,d.TileSliceType.wmts),r.subDomains=(0,c.defaultValue)(e.subDomains,["a","b","c"]),e.tileInfo)e.extent instanceof f.Extent||c.Log.error("非法的范围参数！"),r.extent=f.Extent.fromJSON(e.extent),e.tileInfo instanceof p.default||c.Log.error("非法的瓦片信息参数！"),r.tileInfo=e.tileInfo,e.spatialReference instanceof f.SpatialReference||c.Log.error("非法的坐标系参数！"),r.spatialReference=f.SpatialReference.fromJSON(e.spatialReference),r.tileInfo.size&&r.tileInfo.size[0]||c.Log.error("无法获取瓦片大小！"),r.tileSize=r.tileInfo.size[0];else{if(e.spatialReference?r.spatialReference=f.SpatialReference.fromJSON(e.spatialReference):e.spatialReference||(r.spatialReference=r._getDefaultSpatialReferenceByUrl(r.url)),[d.CustomWKID.bd09mc].indexOf(r.spatialReference.wkid)>-1){for(var o=[],s=0;s<19;s++){var l=Math.pow(2,18-s);o[s]={level:s,resolution:l,scale:null}}var u={dpi:0,format:"PNG",size:[256,256],origin:{coordinates:[0,0],type:"Point"},lods:o};return r.tileInfo=u,r.tileSize={width:u.size[0],height:u.size[1]},r.axisDirection={x:1,y:1},r.extent=new f.Extent({xmin:-20037726.37,ymin:-12474104.17,xmax:20037726.37,ymax:12474104.17,spatialReference:new f.SpatialReference("EPSG:3857")}),r.tileSize=256,(0,a.default)(r)}r.spatialReference.isGeographic?(r.extent=new f.Extent({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:f.SpatialReference.fromJSON(r.spatialReference)}),r.tileSize=256,r.url.indexOf("tianditu.com/DataServer")>-1||r.url.indexOf("tianditu.gov.cn/DataServer")>-1?r.tileInfo=h.TileInfoUtil.createCommonTileInfo({extent:r.extent,numberOfMinLevelTilesX:1,maxLevel:18}):r.tileInfo=h.TileInfoUtil.createCommonTileInfo({extent:r.extent,numberOfMinLevelTilesX:2})):r.spatialReference.isWebMercator?(r.extent=new f.Extent({xmin:-20037508.3427892,ymin:-20037508.3427892,xmax:20037508.3427892,ymax:20037508.3427892,spatialReference:f.SpatialReference.fromJSON(r.spatialReference)}),r.tileSize=256,r.url.indexOf("tianditu.com/DataServer")>-1||r.url.indexOf("tianditu.gov.cn/DataServer")>-1?r.tileInfo=h.TileInfoUtil.createCommonTileInfo({extent:r.extent,numberOfMinLevelTilesX:1,maxLevel:18}):r.tileInfo=h.TileInfoUtil.createCommonTileInfo({extent:r.extent,numberOfMinLevelTilesX:1})):c.Log.error("默认坐标系仅支持地理坐标系和Web墨卡托坐标系！")}return r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.subDomains=this.subDomains.map(function(e){return e}),e}},{key:"_getDefaultSpatialReferenceByUrl",value:function(e){var t=new f.SpatialReference({wkid:4326});if((this.url.indexOf("tianditu.com/DataServer")>-1||this.url.indexOf("tianditu.gov.cn/DataServer"))&&this.url.split("?").length>0){var r=this.url.split("?")[1].split("&").find(function(e){if(e.split("=").length>0)return"T"===e.split("=")[0]});r.indexOf("_c")>-1?t=new f.SpatialReference({wkid:4326}):r.indexOf("_w")>-1&&(t=new f.SpatialReference({wkid:3857}))}return t}}],[{key:"fromJSON",value:function(e){var r=new t(e=(0,y.jsonClone)(e));return r.loadStatus=d.LoadStatus.loaded,r.loaded=!0,r}}]),t}(u.TileLayer);t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(r(3)),i=f(r(0)),o=f(r(2)),a=f(r(4)),s=f(r(5)),l=r(15),u=r(1),c=r(6);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,u.defaultValue)(e,{}),r.type=c.LayerType.unknown,r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(l.Layer);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(r(3)),i=d(r(0)),o=d(r(2)),a=d(r(4)),s=d(r(7)),l=d(r(5)),u=r(15),c=r(1),f=r(6),h=r(19);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return e=(0,c.defaultValue)(e,{}),r.type=f.LayerType.s3m,r.description="S3MTiles图层",r}return(0,l.default)(t,e),(0,o.default)(t,[{key:"toJSON",value:function(){var e=(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"toJSON",this).call(this);return e.type=this.type,e.description=this.description,e}},{key:"clone",value:function(){return new t(this.toJSON())}}],[{key:"fromJSON",value:function(e){return new t(e=(0,h.jsonClone)(e))}}]),t}(u.ModelCacheLayer);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Basemap=t.Map=void 0;var n=o(r(236)),i=o(r(551));function o(e){return e&&e.__esModule?e:{default:e}}t.Map=n.default,t.Basemap=i.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(r(11)),i=y(r(3)),o=y(r(0)),a=y(r(2)),s=y(r(4)),l=y(r(5)),u=r(8),c=r(1),f=r(6),h=r(49),d=r(39),p=r(46);function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,o.default)(this,t),e=(0,c.defaultValue)(e,{});var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this));return r._baseLayers=(0,h.getLayersCollection)(e.baseLayers),r._baseGroupLayer=new d.GroupLayer({layers:r._baseLayers,copyright:""}),r.id=(0,c.defaultValue)(e.id,(0,c.getGUID)()),r.title=(0,c.defaultValue)(e.title,""),r.thumbnailUrl=(0,c.defaultValue)(e.thumbnailUrl,""),r._spatialReference=null,r._referenceLayer=null,r._map=null,r._initEvent(),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"toJSON",value:function(){var e={};return e.baseLayers=this._baseLayers.items.map(function(e){return e.toJSON()}),e.id=this.id,e.title=this.title,e.thumbnailUrl=this.thumbnailUrl,e.spatialReference=this.spatialReference?this.spatialReference.toJSON():void 0,e}},{key:"clone",value:function(){return new t(this.toJSON())}},{key:"destroy",value:function(){this._setBaseLayers(null),this.id=null,this.title=null,this.thumbnailUrl=null,this._spatialReference=null,this._referenceLayer=null,this._map=null}},{key:"removeEvent",value:function(){this._map&&this._map.fire(f.MapEventType.basemapChange,new p.BasemapChangeEvent({basemap:this._basemap,detail:[{action:"baseLayers-destroy"}]}))}},{key:"_initEvent",value:function(){var e=this;this._baseGroupLayer.on(f.LayerEventType.layerViewCreated+" "+f.LayerEventType.layerViewUpdate+" "+f.LayerEventType.layerViewRemove,function(t){e._map.basemap.dispatchEvent(t.type,t)})}},{key:"_setBaseLayers",value:function(e){if(!e||Array.isArray(e)&&e.length<1)this._baseLayers=Array.isArray(e)&&e.length<1?e:null,this._baseGroupLayer.removeAll(),this.removeEvent();else{var t=Array.isArray(e)?(0,h.getLayersCollection)(e):e;this._baseLayers=t,this._baseGroupLayer.layers.items=this._baseLayers.items}}},{key:"_setReferenceLayer",value:function(e){this._referenceLayer=e,this._spatialReference=e.spatialReference}},{key:"_setBasemap",value:function(e,t){t&&(this._map=t),e?(e._baseLayers&&this._setBaseLayers(e._baseLayers),this.id=e.id?e.id:this.id,this.title=e.title?e.title:this.title,this.thumbnailUrl=e.thumbnailUrl?e.id:this.thumbnailUrl,this._spatialReference=null):this.destroy()}},{key:"dispatchEvent",value:function(e,t,r){for(var n in f.LayerEventType)if(f.LayerEventType[n]===e){this.fire(e,t,r);break}return this}}],[{key:"fromJSON",value:function(e){return new t(e=(0,c.defaultValue)(e,{}))}}]),t}(u.Evented);(0,n.default)(g.prototype,{baseLayers:{get:function(){return this._baseLayers},set:function(e){this._setBaseLayers(e)}},spatialReference:{get:function(){return this._spatialReference},set:function(){}}}),t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RendererUtil=t.GroupLayerView=t.BaseFeatureLayerView=t.BaseGraphicsLayerView=t.BaseRendererLayerView=t.LayerView=t.SceneView=t.MapView=t.BaseView=void 0;var n=h(r(146)),i=h(r(554)),o=h(r(555)),a=h(r(87)),s=h(r(237)),l=h(r(556)),u=h(r(557)),c=h(r(147)),f=h(r(238));function h(e){return e&&e.__esModule?e:{default:e}}t.BaseView=n.default,t.MapView=i.default,t.SceneView=o.default,t.LayerView=a.default,t.BaseRendererLayerView=s.default,t.BaseGraphicsLayerView=l.default,t.BaseFeatureLayerView=u.default,t.GroupLayerView=c.default,t.RendererUtil=f.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(0)),i=(r(8),r(39),o(r(147)));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t){(0,n.default)(this,e),this.view=t.view,this.baseGroupLayer=t.baseGroupLayer,this.baseLayerViews=t.baseLayerViews,this.groupLayerView=new i.default({layer:this.baseGroupLayer,layerViews:this.baseLayerViews,view:this.view}),this.id=this.baseGroupLayer.id}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(11)),i=v(r(14)),o=v(r(3)),a=v(r(0)),s=v(r(2)),l=v(r(4)),u=v(r(7)),c=v(r(5)),f=r(1),h=v(r(146)),d=r(8),p=r(6),y=r(39),g=r(141);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return e=(0,f.defaultValue)(e,{}),r.mergeLevelRatio=(0,f.defaultValue)(e.mergeLevelRatio,1.05),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"_loadViewSpatialReference",value:function(){var e=this;return this._setSpatialReference(),new i.default(function(t,r){if(e._spatialReference){var n=!e.crs;if(e._setCrs(e._referenceLayer)){var i=e.allLayerViews._items.map(function(e){return e.id}).filter(function(e){return e});e._removeAllLayerViews().then(function(){e._reCreateView(n).then(function(){e._addAllLayerViews().then(function(){for(var r=e.allLayerViews._items,n=0;n<r.length;n++){var o=r[n];i.indexOf(o.id)>-1||e.groupLayerView._fireLayerViewCreated(o.layer,o)}t(!0)})})})}else t()}else f.Log.warning("视图参考系不存在！"),t(!1)})}},{key:"_addAllLayerViews",value:function(){var e=this,t=[];return this.basemapGroupLayerView&&t.push(function(){return e.basemapGroupLayerView.onAdd()}),this.groupLayerView&&t.push(function(){return e.groupLayerView.onAdd()}),this._viewLayersMap&&this._viewLayersGroupLayerView&&t.push(function(){return e._viewLayersGroupLayerView.onAdd()}),(0,f.inOrderPromise)(t)}},{key:"_removeAllLayerViews",value:function(){var e=this,t=[];return this.basemapGroupLayerView&&t.push(function(){return e.basemapGroupLayerView.onRemove()}),this.groupLayerView&&t.push(function(){return e.groupLayerView.onRemove()}),this._viewLayersMap&&this._viewLayersGroupLayerView&&t.push(function(){return e._viewLayersGroupLayerView.onRemove()}),(0,f.inOrderPromise)(t)}},{key:"_setCrs",value:function(e){var t=this._getCrsByReferenceLayer(e),r=!this._isEqualCrs(this.crs,t);return r&&(this.crs=t),r}},{key:"_setSpatialReference",value:function(){var e=null,t=null;if(this._map&&this._map.allLayers&&(t=y.TileInfoUtil.getReferenceLayer(this._map.allLayers._items))&&(e=t.spatialReference),this._map.basemap){var r=y.TileInfoUtil.getReferenceLayer(this._map.basemap._baseGroupLayer.allLayers._items);r&&(this._map.basemap._spatialReference=r.spatialReference)}e&&(!this.spatialReferenceLocked||this.spatialReferenceLocked&&!this._spatialReference)&&(this._spatialReference=e,this._referenceLayer=t,this._map._setSpatialReference(e),this._map.getFullExtent(),this._spatialReference&&y.TileInfoUtil.setLayerSpatialReference(this._map.allLayers,this._spatialReference))}},{key:"_getCrsByReferenceLayer",value:function(e){var t=null;return e&&e.spatialReference&&e.loaded?t=this._getCrs(e,this._map.allLayers.toArray()):t}},{key:"_getCrs",value:function(e,t){var r;r=this.fullExtent?this.fullExtent:this.map.fullExtent;var n=(0,g.getCrsOptions)(e,t,{fullExtent:r,mergeLevelRatio:this.mergeLevelRatio,maxScale:this.maxScale,minScale:this.minScale});return this._createCrsObject(n)}},{key:"_createLayerView",value:function(e){var t=this._createLayerViewObj(e)||null;if(t&&e&&e.spatialReference&&this._referenceLayer&&this._referenceLayer.spatialReference){var r=this._referenceLayer.spatialReference;if(!(0,g.isLayerViewValid)(r,e))return f.Log.warning("图层类型为"+e.type+"的图层空间参考系和索引图层不一致，请检查图层"),null}return t}},{key:"_initViewEvent",value:function(){var e=this;this._map.groupLayer.on(p.LayerEventType.layerViewCreated+" "+p.LayerEventType.layerViewUpdate+" "+p.LayerEventType.layerViewRemove,function(t){e._map.basemap.dispatchEvent(t.type,t)})}},{key:"toJSON",value:function(){var e=(0,u.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"toJSON",this).call(this);return e.mergeLevelRatio=this.mergeLevelRatio,e}}]),t}(h.default);m.fromJSON=function(e){return e=(0,f.defaultValue)(e,{}),new m(e)},(0,n.default)(m.prototype,{fullExtent:{get:function(){this._initFullExtent?this._fullExtent=this._initFullExtent:this._fullExtent=this.map._fullExtent;var e=void 0;return this.spatialReference&&this._fullExtent&&(e=this.spatialReference.isGeographic?this._fullExtent:d.Projection.project(this._fullExtent,this.spatialReference)),e}}}),t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(r(3)),i=l(r(0)),o=l(r(4)),a=l(r(5)),s=r(1);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return(0,i.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,a.default)(t,e),t}(l(r(146)).default);u.fromJSON=function(e){return e=(0,s.defaultValue)(e,{}),new u(e)},t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(r(3)),i=c(r(0)),o=c(r(2)),a=c(r(4)),s=c(r(5)),l=c(r(135)),u=r(1);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,i.default)(this,t);var r=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.render=(0,u.defaultValue)(e.render,new l.default),r._initHandlers(),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_initHandlers",value:function(){this._layerChangeAction=this._layerChangeAction.bind(this),this.layer.on("set",this._layerChangeAction)}},{key:"_removeHandlers",value:function(){this.layer.off("set",this._layerChangeAction)}},{key:"_layerChangeAction",value:function(e){this._featureCollectionChangeAction(e)}},{key:"_featureCollectionChangeAction",value:function(e){var t=e.eventPath||[],r=e.eventData,n=r.key,i=r.value,o=e.sourceEventData;if("graphics"===n){var a=i;if(t.length<=0||!a)return;if(1===t.length){var s=i;this.render.clear(this.innerLayer),this.render.drawFeature(this.innerLayer,s.items)}else if(t.length>1){var l=t[1],u=a.getFeatureById(l);if(!u)return;if(t.length>2){var c=t[2],f={geometryUpdated:null,symbolUpdated:null};"symbol"===c?f.symbolUpdated=o:"geometry"===c&&(f.geometryUpdated=o),this.render.updateFeature(this.innerLayer,[u],[f])}}}}}]),t}(c(r(87)).default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(r(3)),i=v(r(0)),o=v(r(2)),a=v(r(4)),s=v(r(7)),l=v(r(5)),u=v(r(135)),c=v(r(145)),f=r(1),h=v(r(237)),d=v(r(238)),p=r(8),y=r(6),g=r(68);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){return(0,i.default)(this,t),(0,a.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,o.default)(t,[{key:"_initInstance",value:function(e){(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_initInstance",this).call(this,e),this.render=(0,f.defaultValue)(e.render,new u.default),this._featureSetCache=new c.default}},{key:"_initHandlers",value:function(){(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_initHandlers",this).call(this),this._onFeatureChange=this._onFeatureChange.bind(this),this._onFeatureSetCacheChange=this._onFeatureSetCacheChange.bind(this),this._zoomChange=this._zoomChange.bind(this),this._featureSetCache.on("set",this._onFeatureChange),this._featureSetCache.on("change",this._onFeatureSetCacheChange),this.view.on("zoom",this._zoomChange)}},{key:"_removeHandlers",value:function(){(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_removeHandlers",this).call(this),this.off("set",this._onFeatureChange),this.off("change",this._onFeatureSetCacheChange),this.view.off("zoom",this._zoomChange)}},{key:"_rendererChangeAction",value:function(e){(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_rendererChangeAction",this).call(this,e);var r=this._featureSetCache.items||[];d.default.updateRenderer(r,this.layer.renderer)}},{key:"_onFeatureChange",value:function(e){var t=e.eventPath||[],r=e.eventData.value,n=e.sourceEventData;if(!(t.length<=0)&&r&&t.length>1){var i=r;if(!i)return;var o=t[1],a={geometryUpdated:null,symbolUpdated:null};"symbol"===o?a.symbolUpdated=n:"geometry"===o&&(a.geometryUpdated=n),this.render.updateFeature(this.innerLayer,[i],[a])}}},{key:"_onFeatureSetCacheChange",value:function(e){e&&(e.added&&this.render.drawFeature(this.innerLayer,e.added),e.removed&&this.render.clearFeature(this.innerLayer,e.removed))}},{key:"_zoomChange",value:function(e){if(this.layer&&this.layer.renderer){var t=this.layer.renderer;if(t.type===y.RendererType.random){var r=this._featureSetCache.items||[];d.default.updateRenderer(r,t)}}}},{key:"_initFeatures",value:function(e,t){this._featureSetCache.removeAll();var r=[];e instanceof p.FeatureSet?r=e.features:Array.isArray(e)&&e.every(function(e){return e instanceof p.Feature})?r=e:f.Log.info("传入要素集错误");for(var n=0;n<r.length;n++)(0,g.setElevationInfo)(r[n],this.layer);d.default.updateRenderer(r,t),this._featureSetCache.addMany(r)}},{key:"onRemove",value:function(e){this._featureSetCache.removeAll(),(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"onRemove",this).call(this,e)}}]),t}(h.default);t.default=m},function(e,t,r){e.exports={default:r(559),__esModule:!0}},function(e,t,r){r(560),e.exports=r(12).Number.isNaN},function(e,t,r){var n=r(18);n(n.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,r){e.exports={default:r(562),__esModule:!0}},function(e,t,r){r(563),e.exports=r(12).Math.log10},function(e,t,r){var n=r(18);n(n.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SketchFreehandPolygonDrawTool=t.SketchFreehandPolylineDrawTool=t.SketchExtentDrawTool=t.SketchCircleDrawTool=t.SketchPolygonDrawTool=t.SketchPolylineDrawTool=t.SketchPointDrawTool=t.SketchBaseDrawTool=t.SketchEditor3D=t.SketchEditor=t.SketchEditorEvent=t.SketchStyle=void 0;var n=y(r(41)),i=r(148),o=y(r(239)),a=y(r(571)),s=y(r(43)),l=y(r(42)),u=y(r(240)),c=y(r(60)),f=y(r(241)),h=y(r(242)),d=y(r(243)),p=y(r(244));function y(e){return e&&e.__esModule?e:{default:e}}t.SketchStyle=n.default,t.SketchEditorEvent=i.SketchEditorEvent,t.SketchEditor=o.default,t.SketchEditor3D=a.default,t.SketchBaseDrawTool=s.default,t.SketchPointDrawTool=l.default,t.SketchPolylineDrawTool=u.default,t.SketchPolygonDrawTool=c.default,t.SketchCircleDrawTool=f.default,t.SketchExtentDrawTool=h.default,t.SketchFreehandPolylineDrawTool=d.default,t.SketchFreehandPolygonDrawTool=p.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=r(1);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),t=(0,o.defaultValue)(t,{entityGraphic:null,vertexGraphics:[],midVertexGraphics:[],currentVertexIndex:-1,movingLineGraphics:[],selectBoxGraphics:[],selectBoxVertexGraphics:[]}),this.entityGraphic=(0,o.defaultValue)(t.entityGraphic,null),this.vertexGraphics=(0,o.defaultValue)(t.vertexGraphics,[]),this.midVertexGraphics=(0,o.defaultValue)(t.midVertexGraphics,[]),this.currentVertexIndex=(0,o.defaultValue)(t.currentVertexIndex,-1),this.movingLineGraphics=(0,o.defaultValue)(t.movingLineGraphics,[]),this.selectBoxGraphics=(0,o.defaultValue)(t.selectBoxGraphics,[]),this.selectBoxVertexGraphics=(0,o.defaultValue)(t.selectBoxVertexGraphics,[]),this.snapGraphics=(0,o.defaultValue)(t.snapGraphics,[]),this.editMode=(0,o.defaultValue)(t.editMode,0)}return(0,i.default)(e,[{key:"getFeatureById",value:function(e){for(var t=this.getAllFeatures(),r=null,n=0;n<t.length;n++)if(t[n].id===e){r=t[n];break}return r}},{key:"getAllFeatures",value:function(){var e=[];return this.entityGraphic&&(e.push(this.entityGraphic),e=e.concat(this.vertexGraphics).concat(this.midVertexGraphics).concat(this.selectBoxGraphics).concat(this.selectBoxVertexGraphics).concat(this.snapGraphics)),e}},{key:"updateGraphic",value:function(e){var t=this;this.entityGraphic.id===e.id&&(this.entityGraphic=e),this.vertexGraphics.forEach(function(r,n){e.id===r.id&&(t.vertexGraphics[n]=e)}),this.midVertexGraphics.forEach(function(r,n){e.id===r.id&&(t.midVertexGraphics[n]=e)}),this.selectBoxGraphics.forEach(function(r,n){e.id===r.id&&(t.selectBoxGraphics[n]=e)}),this.selectBoxVertexGraphics.forEach(function(r,n){e.id===r.id&&(t.selectBoxVertexGraphics[n]=e)})}},{key:"clone",value:function(){return new e(this.toJSON())}},{key:"toJSON",value:function(){var e={};return e.entityGraphic=this.entityGraphic?this.entityGraphic.clone():void 0,e.vertexGraphics=this.vertexGraphics.map(function(e){return e.clone()}),e.midVertexGraphics=this.midVertexGraphics.map(function(e){return e.clone()}),e.selectBoxGraphics=this.selectBoxGraphics.map(function(e){return e.clone()}),e.selectBoxVertexGraphics=this.selectBoxVertexGraphics.map(function(e){return e.clone()}),e.snapGraphics=this.snapGraphics.map(function(e){return e.clone()}),e.currentVertexIndex=this.currentVertexIndex,e.editMode=this.editMode,e}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(r(10)),i=h(r(567)),o=h(r(0)),a=h(r(2)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(35)),l=r(9),u=h(r(66)),c=r(8),f=r(1);function h(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,o.default)(this,e),this.pixelTolerance=(0,f.defaultValue)(t.pixelTolerance,10),this.tolerance=5,this.toleranceSlope=.02,this.isSnapVertex=!1,this.isSnapVertexCoincident=(0,f.defaultValue)(t.isSnapVertexCoincident,!1),this.isSnapVertexInLine=(0,f.defaultValue)(t.isSnapVertexInLine,!1),this.isSnapPerpendicular=(0,f.defaultValue)(t.isSnapPerpendicular,!1),this.isSnapParallel=(0,f.defaultValue)(t.isSnapParallel,!1),this.snapSketchGeometry=(0,f.defaultValue)(t.snapSketchGeometry,!1),this._view=(0,f.defaultValue)(t.view,null)}return(0,a.default)(e,[{key:"setSnapOption",value:function(e){this.pixelTolerance=void 0!==e.pixelTolerance?e.pixelTolerance:this.pixelTolerance,this.isSnapVertexCoincident=void 0!==e.isSnapVertexCoincident?e.isSnapVertexCoincident:this.isSnapVertexCoincident,this.isSnapVertexInLine=void 0!==e.isSnapVertexInLine?e.isSnapVertexInLine:this.isSnapVertexInLine,this.isSnapParallel=void 0!==e.isSnapParallel?e.isSnapParallel:this.isSnapParallel,this.isSnapPerpendicular=void 0!==e.isSnapPerpendicular?e.isSnapPerpendicular:this.isSnapPerpendicular,this.snapSketchGeometry=void 0!==e.snapSketchGeometry?e.snapSketchGeometry:this.snapSketchGeometry}},{key:"snapGeometries",value:function(e,t,r){var n=this,o=void 0,a={},s=[],u=[],c=[],f=[];if(r.forEach(function(r){if(r instanceof l.Polygon)o=r.coordinates[0];else if(r instanceof l.LineString)o=r.coordinates;else if(r instanceof l.Point)o=[r.coordinates];else if(r instanceof l.Extent){var i=r.toPolygon();o=i.coordinates[0]}else if(r instanceof l.Circle){var a=r.toPolygon();o=a.coordinates[0]}o=n._simplifyCoordinates(o);var h=n.drawingSnap(e,t,o);h.coincidentPoint&&s.push(h.coincidentPoint),h.pointInLines&&(u=u.concat(h.pointInLines)),h.parallelLines&&(c=c.concat(h.parallelLines)),h.perpendicularLines&&(f=f.concat(h.perpendicularLines))}),a.coincidentPoint=this._getBestResult(s,e),a.pointInLine=this._getBestResult(u,e),a.parallelLine=this._getBestResult(c,e),a.perpendicularLine=this._getBestResult(f,e),a.pointInLine&&a.parallelLine){var h=this.getLineCrossPoint(a.pointInLine.line,new l.LineString({coordinates:[t.coordinates[0],a.parallelLine.realPoint.coordinates],spatialReference:e.spatialReference}));if(h){if(3===e.coordinates.length){var d=this._getHight();h=new l.Point({coordinates:[].concat((0,i.default)(h.coordinates),[d]),spatialReference:e.spatialReference})}a.inLineAndParallel={realPoint:h,lines:[a.pointInLine.line,a.parallelLine.line],symbolGeometry:a.parallelLine.symbolGeometry}}}if(a.pointInLine&&a.perpendicularLine){var p=this.getLineCrossPoint(a.pointInLine.line,new l.LineString({coordinates:[t.coordinates[0],a.perpendicularLine.realPoint.coordinates],spatialReference:e.spatialReference}));if(p){if(3===e.coordinates.length){var y=this._getHight();p=new l.Point({coordinates:[].concat((0,i.default)(p.coordinates),[y]),spatialReference:e.spatialReference})}a.inLineAndPerpendicular={realPoint:p,lines:[a.pointInLine.line,a.perpendicularLine.line],symbolGeometry:a.perpendicularLine.symbolGeometry}}}return a}},{key:"getLineCrossPoint",value:function(e,t){var r=e.coordinates[0][0],n=e.coordinates[0][1],i=e.coordinates[1][0],o=e.coordinates[1][1],a={x:t.coordinates[0][0],y:t.coordinates[0][1]},s={x:t.coordinates[1][0],y:t.coordinates[1][1]},u=((a.x-s.x)*(i*n-r*o)-(r-i)*(s.x*a.y-a.x*s.y))/((a.x-s.x)*(n-o)-(r-i)*(a.y-s.y)),c=((a.y-s.y)*(o*r-n*i)-(n-o)*(s.y*a.x-a.y*s.x))/((a.y-s.y)*(r-i)-(n-o)*(a.x-s.x)),f=void 0;return!isNaN(u)&&!isNaN(c)&&u<=Math.max(a.x,s.x)&&u>=Math.min(a.x,s.x)&&c<=Math.max(a.y,s.y)&&c>=Math.min(a.y,s.y)&&(f=new l.Point({coordinates:[u,c],spatialReference:e.spatialReference})),f}},{key:"drawingSnap",value:function(e,t,r){var n=t.spatialReference,i=this.getSnapGeometryByPointArray(r,n),o={};return this.isSnapVertexCoincident&&i.points&&(o.coincidentPoint=this.pointCoincident(e,i.points,n)),this.isSnapVertexInLine&&i.lines&&(o.coincidentPoint||(o.pointInLines=this.getPointInLines(e,i.lines,n))),"LineString"===t.type&&i.lines&&(this.isSnapParallel&&(o.parallelLines=this.getParallelLine(e,t,i.lines,n)),this.isSnapPerpendicular&&(o.perpendicularLines=this.getPerpendicularLine(e,t,i.lines,n))),o}},{key:"_getBestResult",value:function(e,t){var r=void 0,n=0;return e.forEach(function(e,i){var o=u.default.distance(e.realPoint,t);0===i?(r=e,n=o):o<n&&(n=o,r=e)}),r}},{key:"getSnapGeometryByPointArray",value:function(e,t){var r=[],n=[];return e.forEach(function(i,o){var a=new l.Point({coordinates:i,spatialReference:t});if(r.push(a),o>0){var s=new l.LineString({coordinates:[e[o-1],e[o]],spatialReference:t});n.push(s)}}),{points:r,lines:n}}},{key:"_convertReference",value:function(e){if(e.isWSG48)return e;var t=e.clone();return c.Projection.project(t,new l.SpatialReference("EPSG:4326"))}},{key:"pointCoincident",value:function(e,t){for(var r=void 0,n=this._view.toScreen(e),o=0;o<t.length;o++){var a=this._view.toScreen(t[o]);if(Math.sqrt(Math.pow(n.x-a.x,2)+Math.pow(n.y-a.y,2))<=this.pixelTolerance){r=3===e.coordinates.length&&t[o].coordinates.length<3?new l.Point({coordinates:[].concat((0,i.default)(t[o].coordinates),[this._getHight()]),spatialReference:e.spatialReference}):t[o];break}}return r?{realPoint:r}:void 0}},{key:"getPointInLines",value:function(e,t,r){var n=this,i=[];return t.forEach(function(t){var o=n.getPerpendicularPoint(e,new l.Point({coordinates:t.coordinates[0],spatialReference:r}),new l.Point({coordinates:t.coordinates[1],spatialReference:r}));o&&(t=c.Projection.project(t,r),i.push({line:t,realPoint:o.realPoint,deltaTolerance:o.deltaTolerance}))}),i}},{key:"getPerpendicularPoint",value:function(e,t,r){var n=e.coordinates[0],i=e.coordinates[1],o=t.coordinates[0],a=t.coordinates[1],s=r.coordinates[0],u=r.coordinates[1],c=void 0,f=void 0,h=void 0;if(s!==o){var d=(u-a)/(s-o);h=d*((f=(d*d*o+d*(i-a)+n)/(d*d+1))-o)+a}else f=(t.coordinates[0]+r.coordinates[0])/2,h=e.coordinates[1];if(3===e.coordinates.length){var p=this._getHight();c=new l.Point({coordinates:[f,h,p],spatialReference:e.spatialReference})}else c=new l.Point({coordinates:[f,h],spatialReference:e.spatialReference});var y=this._view.toScreen(c),g=this._view.toScreen(e),v=Math.sqrt(Math.pow(g.x-y.x,2)+Math.pow(g.y-y.y,2));return v<=this.pixelTolerance?{realPoint:c,deltaTolerance:v}:null}},{key:"getParallelLine",value:function(e,t,r,n){var i=this,o=[];return r&&r.length>0&&r.forEach(function(r){var a=new l.Point({coordinates:r.coordinates[0],spatialReference:n}),s=new l.Point({coordinates:r.coordinates[1],spatialReference:n}),u=i.getParallelPoint(e,new l.Point({coordinates:t.coordinates[0],spatialReference:n}),a,s,"parallel");if(u){var c=u.realPoint,f=i._getParallelSymbolGeometry(a,s);o.push({line:r,symbolGeometry:f,realPoint:c,deltaTolerance:u.deltaTolerance})}}),o.length>0?o:void 0}},{key:"getParallelPoint",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"parallel",o=e.spatialReference,a=e.coordinates[0],s=e.coordinates[1],u={x:t.coordinates[0],y:t.coordinates[1]},c=r.coordinates[0],f=r.coordinates[1],h=n.coordinates[0],d=n.coordinates[1],p=Math.sqrt(Math.pow(a-u.x,2)+Math.pow(s-u.y,2)),y=void 0,g=!0,v=void 0,m=void 0;if("parallel"===i?h===c?(g=!1,v=u.x,m=s>u.y?u.y+p:u.y-p):y=(d-f)/(h-c):"perpendicular"===i&&(d===f?(g=!1,m=u.y,v=a>u.x?u.x+p:u.x-p):y=-(h-c)/(d-f)),g){var _=u.y-y*u.x,S=Math.pow(y,2)+1,x=2*((_-u.y)*y-u.x),b=Math.pow(_-u.y,2)+Math.pow(u.x,2)-Math.pow(p,2),w=(-x+Math.sqrt(Math.pow(x,2)-4*S*b))/(2*S),k=(-x-Math.sqrt(Math.pow(x,2)-4*S*b))/(2*S);v=0,m=y*(v=(a-u.x)*(w-u.x)>0?w:k)+_}if(isNaN(v)||isNaN(m))return null;var M=void 0;if(3===e.coordinates.length){var E=this._getHight();M=new l.Point({coordinates:[v,m,E],spatialReference:o})}else M=new l.Point({coordinates:[v,m],spatialReference:o});var I=this._view.toScreen(M),T=this._view.toScreen(e),L=Math.sqrt(Math.pow(T.x-I.x,2)+Math.pow(T.y-I.y,2));return L<=this.pixelTolerance?{realPoint:M,deltaTolerance:L}:null}},{key:"_getHight",value:function(){return 0}},{key:"_getParallelSymbolGeometry",value:function(e,t){var r=this.pixelTolerance/2,n=this._view.toScreen(e),i=this._view.toScreen(t),o={x:.375*(i.x-n.x)+n.x,y:.375*(i.y-n.y)+n.y},a={x:.625*(i.x-n.x)+n.x,y:.625*(i.y-n.y)+n.y},s=void 0,u=void 0,c=void 0,f=void 0;if(a.x===o.x)s={x:o.x+r,y:o.y},u={x:a.x+r,y:a.y},c={x:o.x-r,y:o.y},f={x:a.x-r,y:a.y};else if(a.y===o.y)s={x:o.x,y:o.y+r},u={x:a.x,y:a.y+r},c={x:o.x,y:o.y-r},f={x:a.x,y:a.y-r};else{var h=-(a.x-o.x)/(a.y-o.y),d=Math.atan(h),p=function(e,t,r){return{x:Math.cos(t)*r+e.x,y:Math.sin(t)*r+e.y}};s=p(o,d,r),u=p(a,d,r),c=p(o,d,-r),f=p(a,d,-r)}var y=this._view.toMap(s),g=this._view.toMap(u),v=this._view.toMap(c),m=this._view.toMap(f);return new l.MultiLineString({coordinates:[[y.coordinates,g.coordinates],[v.coordinates,m.coordinates]]})}},{key:"getPerpendicularLine",value:function(e,t,r,n){var i=this,o=[];return r.forEach(function(r){var a=i.getParallelPoint(e,new l.Point({coordinates:t.coordinates[0],spatialReference:n}),new l.Point({coordinates:r.coordinates[0],spatialReference:n}),new l.Point({coordinates:r.coordinates[1],spatialReference:n}),"perpendicular");if(a){var s=a.realPoint;o.push({line:r,realPoint:s,symbolGeometry:void 0,deltaTolerance:a.deltaTolerance})}}),o.length?o:void 0}},{key:"_getPerpendicularPoint",value:function(e,t,r){var n=t.coordinates[0][1]-r*t.coordinates[0][0],i=e.coordinates[1]+1/r*e.coordinates[0],o=(i-n)*r/(r*r+1);return[o,-1/r*o+i]}},{key:"getPerpendicularSymbolGeometry",value:function(e,t,r){var n=[s.point(e.coordinates[0]),s.point(e.coordinates[1])],i=[s.point(t.coordinates[0]),s.point(t.coordinates[1])],o=s.distance(n[0],n[1]),a=s.distance(i[0],i[1]),u=Math.min(o,a)/8;r=s.point(r.coordinates);var c;c=i[0].geometry.coordinates[0]===r.geometry.coordinates[0]&&i[0].geometry.coordinates[1]===r.geometry.coordinates[1]?s.rhumbBearing(r,i[1]):s.rhumbBearing(r,i[0]);var f,h=((f=n[0].geometry.coordinates[0]===r.geometry.coordinates[0]&&n[0].geometry.coordinates[1]===r.geometry.coordinates[1]?s.rhumbBearing(r,n[1]):s.rhumbBearing(r,n[0]))+c)/2,d=s.rhumbDestination(r,u,f),p=s.rhumbDestination(r,u,c),y=s.rhumbDestination(r,u*Math.sqrt(2),h),g=d.geometry.coordinates,v=p.geometry.coordinates,m=y.geometry.coordinates;return new l.LineString({coordinates:[g,m,v]})}},{key:"getPerpendicularRealPosition",value:function(e,t,r){var n=u.default.distance(t,e),i=s.rhumbBearing(s.point(t.coordinates),s.point(r.currentPoint));return s.rhumbDestination(t,n,i).geometry.coordinates}},{key:"_simplifyCoordinates",value:function(e){for(var t=JSON.parse((0,n.default)(e)),r=1;r<t.length;r++)t[r][0]===t[r-1][0]&&t[r][1]===t[r-1][1]&&(t.splice(r,1),r--);return t}},{key:"isPolylineCrossPolygon",value:function(){}},{key:"isPolygonCross",value:function(){}}]),e}();t.default=d},function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(120));t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,n.default)(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(0)),i=a(r(2)),o=a(r(66));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){(0,n.default)(this,e)}return(0,i.default)(e,[{key:"unionPolygons",value:function(e){return o.default.union(e)}},{key:"splitPolygonByPolyline",value:function(e,t){return o.default.cut(e,t)}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(0)),i=s(r(2)),o=r(1),a=r(8);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){(0,n.default)(this,e),this._id=(0,o.getGUID)(),this._init()}return(0,i.default)(e,[{key:"_init",value:function(){this.processCollection=[],this._drawProcessCollection=[],this._editProcessCollection=[],this.currentStateIndex=-1,this._editMode=0}},{key:"_initDrawProcess",value:function(){this._drawProcessCollection=[],this.processCollection=[],this.currentStateIndex=-1,this._editMode=0}},{key:"undo",value:function(){return this.canUndo()?(this.currentStateIndex--,this.processCollection[this.currentStateIndex].sketchStage.clone()):null}},{key:"redo",value:function(){return this.canRedo()?(this.currentStateIndex++,this.processCollection[this.currentStateIndex].sketchStage.clone()):null}},{key:"canUndo",value:function(){var e=!1;return this.processCollection.length>1&&this.currentStateIndex>0&&(e=!0),e}},{key:"canRedo",value:function(){var e=!1;return this.processCollection.length>1&&this.currentStateIndex<this.processCollection.length-1&&(e=!0),e}},{key:"addProcess",value:function(e,t,r){t=t.clone(),(r=void 0===r?this._editMode:r)===a.SketchEditMode.DRAWING?this.processCollection=this._drawProcessCollection:this.processCollection=this._editProcessCollection;var n={id:(0,o.getGUID)(),action:e,sketchStage:t,index:this.processCollection.length,editMode:r};this.currentStateIndex===this.processCollection.length-1?this.processCollection.push(n):this.processCollection.splice(this.currentStateIndex+1,this.processCollection.length-(this.currentStateIndex+1),n),this.currentStateIndex=this.processCollection.length-1}},{key:"reset",value:function(){this._init()}},{key:"removeProcessById",value:function(e){var t=this.getProcessById(e);t&&this.processCollection.splice(t.index,1)}},{key:"getProcessById",value:function(e){var t=this.processCollection.filter(function(t){return t.id===e});return t.length>0?t[0]:null}},{key:"_getNextProcess",value:function(){}}]),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(r(10)),i=g(r(3)),o=g(r(0)),a=g(r(2)),s=g(r(4)),l=g(r(5)),u=r(8),c=r(9),f=r(1),h=g(r(43)),d=g(r(42)),p=g(r(66)),y=r(68);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var r=(0,s.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return r.type="sketchPolylineDrawTool",r._drawTools=[r],r._otherDrawTools=[],r.snapAndReferGeometries=(0,f.defaultValue)(e.snapAndReferGeometries,[]),r}return(0,l.default)(t,e),(0,a.default)(t,[{key:"drawFeature",value:function(){var e=this;this._editMode=u.SketchEditMode.DRAWING,this.view._mapActionControl("double-click-zoom",!1),this.view._mapActionControl("video-map-active",!0);var t=!1,r=!1,i=!1,o=null,a=[],s=[];this.vertexNum=0;var l=[],h="",y=null;this.cursorStyle=this.view.cursor,(0,f.isNull)(this.cursorStyle)&&(this.view.cursor="crosshair");var g=this._getInteractiveDom(),v=this.extensionOptions&&this.extensionOptions.vertexNumber?this.extensionOptions.vertexNumber:null;this._setInitSnap(),this._fireStartDrawEvent();var m=function n(i){if(i&&i.x&&i.y)if(e._stopInitSnap(),v&&e.vertexNum===v-1)e.view.on(u.ViewEventType.immediateClick,n);else{clearTimeout(null),e._editMode=u.SketchEditMode.DRAWING;var a,g={x:i.x,y:i.y};if(a=y||e.view.toMap({x:g.x,y:g.y}),e.vertexNum++,1===e.vertexNum)s=[a.coordinates],(o=e._getFeature()).geometry.coordinates=[s[0],s[0]];else if(2===e.vertexNum)s=[o.geometry.coordinates[0],a.coordinates],o.geometry.coordinates=s,e._polylineGeometry=o;else{if((s=o.geometry.coordinates)[s.length-1]=a.coordinates,e._sketchEditor.isSimple){var m=new c.LineString({coordinates:s,spatialReference:e._spatialReference});if(!p.default.isSimple(m))return e._fireUnsimpleDraw(),f.Log.info("该坐标构成的几何不符合拓扑规范！")}o.geometry.coordinates=s}"move"===h&&s[s.length-1][0]===s[s.length-2][0]&&s[s.length-1][1]===s[s.length-2][1]&&s.splice(s.length-1);var _=new d.default({view:e.view,layer:e.layer,_parent:e,sketchStyle:e.sketchStyle,elevationInfo:e.elevationInfo});_.addFeature(a,void 0,void 0,e.sketchInnerLayer),e._drawTools.push(_);var S=_.sketchStage.entityGraphic;e.sketchStage.entityGraphic=o,e.sketchStage.vertexGraphics.push(S),o&&(r=t=!0),s.length>1&&l.push(function(e,t){return(e[1]-t[1])/(e[0]-t[0])}(s[s.length-1],s[s.length-2])),h="click",e.fire("drawn-vertex",{geometry:_.sketchStage.entityGraphic.geometry,feature:_.sketchStage.entityGraphic},self),e._fireDrawVertexEvent(o),e.undoRedoManager&&e.undoRedoManager.addProcess("add-vertex",e.sketchStage,e._editMode)}},_=!0,S=function(l){if(l&&l.x&&l.y&&t&&!i){clearTimeout(null),i=!0,e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]);var u={x:l.x,y:l.y},c=e.view.toMap({x:u.x,y:u.y});o=e.sketchStage.entityGraphic,s=1===e.vertexNum?[o.geometry.coordinates[0]]:o.geometry.coordinates.slice(0,o.geometry.coordinates.length-1),1===e.vertexNum?y=e.getSnapGraphics(c,s):e.vertexNum>1&&(y=e.getSnapGraphics(c,s)),y&&(c=y),e._currentMovePoint=c,1===e.vertexNum?o.geometry.coordinates[1]=c.coordinates:e.vertexNum>1&&(r?(o.geometry.coordinates.push(c.coordinates),r=!1):o.geometry.coordinates[o.geometry.coordinates.length-1]=c.coordinates),o.geometry._pixelCoords=a,o.geometry.coordinates=JSON.parse((0,n.default)(o.geometry.coordinates)),_&&(e._addFeatureToLayer(o,e.layer),_=!1),i=!1,h="move";var f=e._getInteractiveDom();g=g.concat(f),e._removeInteractiveStyle(f),e._fireChangeCursorEvent(o)}},x=function(){clearTimeout(null),clearTimeout(null),s=[],a=[],e.stop(),e.sketchStage.snapGraphics.length>0&&(e.sketchStage.snapGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.snapGraphics=[]),e._editMode=u.SketchEditMode.NONE,e.view.cursor=e.cursorStyle,e._addInteractiveStyle(g),e.sketchStage.vertexGraphics.forEach(function(t){e._removeFeatureFromLayer(t,e.sketchInnerLayer)}),e.sketchStage.vertexGraphics=[],e._currentMovePoint=void 0,e.undoRedoManager._initDrawProcess(),setTimeout(function(){e.view._mapActionControl("double-click-zoom",!0),e.view._mapActionControl("video-map-active",!1)},0),h="double-click";var t=e._createPolygonFeatureByPolyline(e.sketchStage.entityGraphic.geometry);e._removeFeatureFromMap(e.sketchStage.entityGraphic),e.view.cursor=e.cursorStyle,e._addInteractiveStyle(g),e.fire("drawn",{geometry:t,feature:e.sketchStage.entityGraphic},self),e._fireStopDrawEvent(o)};this._drawEventHandlers.push(m,S,x),this.view.on(u.ViewEventType.immediateClick,m),this.view.on(u.ViewEventType.pointerMove,S),this.view.on(u.ViewEventType.doubleClick,x)}},{key:"_createPolygonFeatureByPolyline",value:function(e){var t=this,r=function(e){var t=JSON.parse((0,n.default)(e.coordinates));return t.push(t[0]),new c.Polygon({coordinates:[t],spatialReference:e._spatialReference})}(e),i=function(){var r=[];return t.snapAndReferGeometries.forEach(function(n){(n instanceof c.Polygon||n instanceof c.Circle||n instanceof c.Extent)&&(y.TileInfoUtil.isSameSpatialReference(n,t._spatialReference)||(n.spatialReference=t._spatialReference,n=u.Projection.project(n,t._spatialReference)),p.default.intersects(e,n)&&r.push(n))}),r}(),o=p.default.union(i);return!o||o instanceof Array?r:p.default.difference(r,o)}},{key:"_getFeature",value:function(e){e||(e=[[0,0],[1,1]]);var t=new c.LineString({coordinates:e,spatialReference:this._spatialReference}),r=this.sketchStyle.lineStyle.clone();return new u.Feature({geometry:t,symbol:r,elevationInfo:this.elevationInfo})}}]),t}(h.default);t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(3)),i=u(r(0)),o=u(r(4)),a=u(r(5)),s=r(8),l=r(1);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,i.default)(this,t);var r=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.elevationInfo=(0,l.defaultValue)(e.elevationInfo,new s.ElevationInfo),r}return(0,a.default)(t,e),t}(u(r(239)).default);t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSimpleFillSymbolCanvas=t.createSimpleMarkerSymbolCanvas=void 0;var n=s(r(56)),i=r(6),o=r(1),a=s(r(54));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){t=(0,o.defaultValue)(t,{});var r=(0,o.defaultValue)(t.layerOpacity,1),s=(0,o.defaultValue)(t.lineWidth,10),l=n.default.fromJSON(e),u=document.createElement("canvas"),c=(0,o.defaultValue)(t.size,300);u.width=c,u.height=c;var f=u.getContext("2d"),h=void 0,d=void 0;return e.type===i.SymbolType.simpleMarker?((h=a.default.fromColor(l.color)).alpha*=r,(d=a.default.fromColor(l.outline.color)).alpha*=r,f.fillStyle=h.toCssRGBAString(),f.lineWidth=l.outline.width,f.strokeStyle=d.toCssRGBAString()):((h=a.default.fromColor(l.color)).alpha*=r,f.lineWidth=s,f.strokeStyle=h.toCssRGBAString()),f.beginPath(),{canvas:u,canvasContext:f}}t.createSimpleMarkerSymbolCanvas=function(e){var t=n.default.fromJSON(e),r=l(e),i=r.canvas,o=r.canvasContext;switch(t.style){case"circle":o.arc(150,150,150-t.outline.width,0,2*Math.PI);break;case"cross":o.moveTo(150,0),o.lineTo(150,300),o.stroke(),o.moveTo(0,150),o.lineTo(300,150);break;case"diamond":o.moveTo(140,t.outline.width),o.lineTo(75,150),o.lineTo(140,300-t.outline.width),o.lineTo(160,300-t.outline.width),o.lineTo(225,150),o.lineTo(160,t.outline.width),o.lineTo(140,t.outline.width),o.closePath();break;case"square":o.moveTo(t.outline.width,t.outline.width),o.lineTo(300-t.outline.width,t.outline.width),o.lineTo(300-t.outline.width,300-t.outline.width),o.lineTo(t.outline.width,300-t.outline.width),o.lineTo(t.outline.width,t.outline.width),o.closePath();break;case"triangle":o.moveTo(t.outline.width,300-t.outline.width),o.lineTo(300-t.outline.width,300-t.outline.width),o.lineTo(150,300-Math.sqrt(3)/2*300),o.lineTo(t.outline.width,300-t.outline.width),o.closePath();break;case"x":o.moveTo(t.outline.width,t.outline.width),o.lineTo(300-t.outline.width,300-t.outline.width),o.moveTo(300-t.outline.width,300-t.outline.width),o.moveTo(300-t.outline.width,t.outline.width),o.lineTo(t.outline.width,300-t.outline.width)}return o.stroke(),o.fill(),i},t.createSimpleFillSymbolCanvas=function(e,t){t=(0,o.defaultValue)(t,{});var r=n.default.fromJSON(e),i=l(e,t),a=i.canvas,s=i.canvasContext,u=(0,o.defaultValue)(t.size,300),c=void 0,f=void 0;switch(r.style){case"backward-diagonal":f=u/(c=10);for(var h=0;h<f;h++)s.beginPath(),s.moveTo(c*(h+1)+2,-2),s.lineTo(-2,c*(h+1)+2),s.stroke();for(var d=0;d<f;d++)s.beginPath(),s.moveTo(u+2,c*(d+1)-2),s.lineTo(c*(d+1)-2,u+2),s.stroke();break;case"cross":f=u/(c=7);for(var p=0;p<f;p++)s.beginPath(),s.moveTo(0,p*c+3),s.lineTo(u,p*c+3),s.stroke();for(var y=0;y<f;y++)s.beginPath(),s.moveTo(1+y*c,0),s.lineTo(1+y*c,u),s.stroke();break;case"diagonal-cross":f=u/(c=10);for(var g=0;g<f;g++)s.beginPath(),s.moveTo(c*(g+1)+1,-1),s.lineTo(-1,c*(g+1)+1),s.stroke();for(var v=0;v<f;v++)s.beginPath(),s.moveTo(u+1,c*(v+1)-1),s.lineTo(c*(v+1)-1,301),s.stroke();for(var m=0;m<f;m++)s.beginPath(),s.moveTo(-1,m*c-1),s.lineTo(u+1-m*c,u+1),s.stroke();for(var _=0;_<f;_++)s.beginPath(),s.moveTo(c-1+_*c,-1),s.lineTo(u+1,u-c+1-_*c),s.stroke();break;case"forward-diagonal":f=u/(c=10);for(var S=0;S<f;S++)s.beginPath(),s.moveTo(-1,S*c-1),s.lineTo(u+1-S*c,u+1),s.stroke();for(var x=0;x<f;x++)s.beginPath(),s.moveTo(c-1+x*c,-1),s.lineTo(u+1,u-c+1-x*c),s.stroke();break;case"horizontal":f=u/(c=7);for(var b=0;b<f;b++)s.beginPath(),s.moveTo(0,b*c+5.3),s.lineTo(u,b*c+5.3),s.stroke();break;case"vertical":f=u/(c=7);for(var w=-1;w<f+1;w++)s.beginPath(),s.moveTo(w*c-1,0),s.lineTo(w*c-1,u),s.stroke()}return a}}])});